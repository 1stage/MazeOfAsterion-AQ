src/asterion.asm:
     1                          INCLUDE "aquarius.inc"
src/aquarius.inc:
     1                          ; Aquarius SYSROM Routines
     2                          SLEEP_ZERO EQU $1d48
     3                          SLEEP EQU $1d4b
     4                          FILL_FULL_1024 EQU $1e59
     5                          
     6                          ; CHRRAM - Character RAM
     7                          CHRRAM EQU $3000
     8                          
     9                          ; COLRAM: Color RAM
    10                          COLRAM EQU $3400
    11                          
    12                          ; Aquarius IO ports
    13                          MODEM_A EQU $7E
    14                          MODEM_B EQU $7F
    15                          CONTROL_PADS EQU $F6
    16                          PSG EQU $F7
    17                          SPEAKER EQU $FC
    18                          VSYNC EQU $FD
    19                          PRINTER EQU $FE
    20                          KEYBOARD EQU $FF
    21                          
src/asterion.asm:
     2                          INCLUDE "asterion.inc"
src/asterion.inc:
     1                          ; CHRRAM - Character RAM
     2                          CHRRAM_LEVEL_IND_L EQU $3001
     3                          CHRRAM_LEVEL_IND_R EQU $3004
     4                          CHRRAM_SHIFT_MODE_IDX EQU $3005
     5                          CHRRAM_LADDER_IDX EQU $3007
     6                          CHRRAM_ITEM_IDX EQU $3009
     7                          CHRRAM_MONSTER_IDX EQU $300b
     8                          CHRRAM_DOOR_IDX EQU $300d
     9                          CHRRAM_MAP_IDX EQU $3011
    10                          CHRRAM_ARMOR_IDX EQU $3013
    11                          CHRRAM_HELMET_IDX EQU $3015
    12                          CHRRAM_RING_IDX EQU $3017
    13                          IDX_VIEWPORT_CHRRAM EQU $3028
    14                          DAT_ram_3050 EQU $3050
    15                          CHRRAM_WALL_F0_IDX EQU $30cc
    16                          DAT_ram_3168 EQU $3168
    17                          CHRRAM_L1_DOOR_IDX EQU $316d
    18                          DAT_ram_3177 EQU $3177
    19                          DAT_ram_317a EQU $317a
    20                          DAT_ram_317f EQU $317f
    21                          DAT_ram_3191 EQU $3191
    22                          DAT_ram_3196 EQU $3196
    23                          DAT_ram_31a1 EQU $31a1
    24                          DAT_ram_31a6 EQU $31a6
    25                          CHRRAM_POINTER_IDX EQU $31d8
    26                          DAT_ram_3259 EQU $3259
    27                          DAT_ram_3266 EQU $3266
    28                          DAT_ram_326e EQU $326e
    29                          DAT_ram_3280 EQU $3280
    30                          DAT_ram_3297 EQU $3297
    31                          
    32                          ; CHRRAM Spare 24
    33                          WALL_F0_STATE EQU $33e8
    34                          WALL_F1_STATE EQU $33e9
    35                          WALL_F2_STATE EQU $33ea
    36                          WALL_F3_STATE EQU $33eb
    37                          DAT_ram_33ec EQU $33ec
    38                          DAT_ram_33ed EQU $33ed
    39                          DAT_ram_33ee EQU $33ee
    40                          DAT_ram_33ef EQU $33ef
    41                          DAT_ram_33f0 EQU $33f0
    42                          DAT_ram_33f1 EQU $33f1
    43                          DAT_ram_33f2 EQU $33f2
    44                          DAT_ram_33f3 EQU $33f3
    45                          DAT_ram_33f4 EQU $33f4
    46                          DAT_ram_33f5 EQU $33f5
    47                          DAT_ram_33f6 EQU $33f6
    48                          DAT_ram_33f7 EQU $33f7
    49                          DAT_ram_33f9 EQU $33f9
    50                          DAT_ram_33fa EQU $33fa
    51                          DAT_ram_33fb EQU $33fb
    52                          DAT_ram_33fd EQU $33fd
    53                          
    54                          ; COLRAM: Color RAM
    55                          COLRAM_LEVEL_IDX_L EQU $3401
    56                          COLRAM_FLOOR_IDX_10 EQU $3402
    57                          COLRAM_FLOOR_IDX_1 EQU $3403
    58                          COLRAM_LEVEL_IDX_R EQU $3404
    59                          COLRAM_ARMOR_IDX EQU $3413
    60                          COLRAM_HELMET_IDX EQU $3415
    61                          COLRAM_RING_IDX EQU $3417
    62                          COLRAM_PHYS_STATS_1000 EQU $3441
    63                          COLRAM_SPRT_STATS_10 EQU $3446
    64                          DAT_ram_3568 EQU $3568
    65                          COLRAM_F0_DOOR_IDX EQU $3570
    66                          DAT_ram_357f EQU $357f
    67                          DAT_ram_3590 EQU $3590
    68                          DAT_ram_3591 EQU $3591
    69                          DAT_ram_35a6 EQU $35a6
    70                          DAT_ram_35a7 EQU $35a7
    71                          DAT_ram_35d8 EQU $35d8
    72                          DAT_ram_35e0 EQU $35e0
    73                          DAT_ram_35e1 EQU $35e1
    74                          DAT_ram_35f6 EQU $35f6
    75                          DAT_ram_35f7 EQU $35f7
    76                          DAT_ram_3608 EQU $3608
    77                          DAT_ram_361f EQU $361f
    78                          DAT_ram_3728 EQU $3728
    79                          
    80                          ; COLRAM Spare 24
    81                          ITEM_F2 EQU $37e8
    82                          ITEM_F1 EQU $37e9
    83                          ITEM_F0 EQU $37ea
    84                          ITEM_FL1 EQU $37eb
    85                          ITEM_FR1 EQU $37ec
    86                          ITEM_R1 EQU $37ed
    87                          ITEM_L1 EQU $37ee
    88                          ITEM_B1 EQU $37ef
    89                          KEY_INPUT_COL0 EQU $37f6
    90                          KEY_INPUT_COL1 EQU $37f7
    91                          KEY_INPUT_COL2 EQU $37f8
    92                          KEY_INPUT_COL3 EQU $37f9
    93                          KEY_INPUT_COL4 EQU $37fa
    94                          KEY_INPUT_COL5 EQU $37fb
    95                          KEY_INPUT_COL6 EQU $37fc
    96                          KEY_INPUT_COL7 EQU $37fd
    97                          HC_INPUT_HOLDER EQU $37fe
    98                          
    99                          ; Aquarius Built-In 2k RAM Space
   100                          MAPSPACE_WALLS EQU $3800
   101                          MAP_LADDER_OFFSET EQU $3900
   102                          LADDER_POS EQU $3901
   103                          MAP_ITEM_SPACE EQU $3902
   104                          BYTE_ram_3903 EQU $3903
   105                          BYTE_ram_3904 EQU $3904
   106                          BYTE_ram_3905 EQU $3905
   107                          BYTE_ram_3906 EQU $3906
   108                          ITEM_MOVE_CHR_BUFFER EQU $3a00
   109                          ITEM_MOVE_COL_BUFFER EQU $3a10
   110                          BYTE_ram_3a20 EQU $3a20
   111                          BYTE_ram_3a58 EQU $3a58
   112                          DIR_FACING_FW EQU $3a60
   113                          DIR_FACING_BW EQU $3a61
   114                          DIR_FACING_SHORT EQU $3a62
   115                          MON_FS EQU $3a63
   116                          RAM_AC EQU $3a64
   117                          RAM_AD EQU $3a65
   118                          RAM_AE EQU $3a66
   119                          RAM_AF EQU $3a67
   120                          DUNGEON_LEVEL EQU $3a68
   121                          TIMER_A EQU $3a69
   122                          TIMER_B EQU $3a6a
   123                          TIMER_C EQU $3a6b
   124                          TIMER_D EQU $3a88
   125                          TIMER_E EQU $3a9c
   126                          
   127                          INPUT_HOLDER EQU $3a6c
   128                          SHIELD_PHYS EQU $3a71
   129                          SHIELD_SPRT EQU $3a73
   130                          ARMOR_INV_SLOT EQU $3a74
   131                          HELMET_INV_SLOT EQU $3a75
   132                          RING_INV_SLOT EQU $3a76
   133                          PLAYER_PREV_MAP_LOC EQU $3a77
   134                          LAST_ITEM_HELD EQU $3a78
   135                          PLAYER_MAP_POS EQU $3a79
   136                          RIGHT_HAND_ITEM EQU $3a7a
   137                          LEFT_HAND_ITEM EQU $3a7b
   138                          INV_ITEM_SLOT_1 EQU $3a7c
   139                          INV_ITEM_SLOT_2 EQU $3a7d
   140                          INV_ITEM_SLOT_3 EQU $3a7e
   141                          BYTE_ram_3a82 EQU $3a82
   142                          BYTE_ram_3a83 EQU $3a83
   143                          BYTE_ram_3a85 EQU $3a85
   144                          BYTE_ram_3a87 EQU $3a87
   145                          
   146                          BYTE_ram_3a89 EQU $3a89
   147                          BYTE_ram_3a8a EQU $3a8a
   148                          MELEE_ANIM_STATE EQU $3a8b
   149                          BYTE_ram_3a8c EQU $3a8c
   150                          MONSTER_ATT_POS_COUNT EQU $3a8d
   151                          MONSTER_ATT_POS_OFFSET EQU $3a8f
   152                          RNDHOLD_AA EQU $3a91
   153                          PLAYER_PHYS_HEALTH EQU $3a93
   154                          PLAYER_PHYS_HEALTH_MAX EQU $3a95
   155                          PLAYER_SPRT_HEALTH EQU $3a97
   156                          PLAYER_SPRT_HEALTH_MAX EQU $3a98
   157                          WEAPON_PHYS EQU $3a99
   158                          WEAPON_SPRT EQU $3a9b
   159                          BYTE_ram_3a9e EQU $3a9e
   160                          BYTE_ram_3aa0 EQU $3aa0
   161                          ITEM_HOLDER EQU $3aa1
   162                          CURR_MONSTER_SPRT EQU $3aa2
   163                          CURR_MONSTER_PHYS EQU $3aa3
   164                          BYTE_ram_3aa5 EQU $3aa5
   165                          NEW_DAMAGE EQU $3aa6
   166                          WEAPON_VALUE_HOLDER EQU $3aa8
   167                          BYTE_ram_3aa9 EQU $3aa9
   168                          FOOD_INV EQU $3aab
   169                          ARROW_INV EQU $3aac
   170                          MAP_INV_SLOT EQU $3aad
   171                          SND_CYCLE_HOLDER EQU $3ab3
   172                          PITCH_UP_BOOL EQU $3ab5
   173                          SOUND_REPEAT_COUNT EQU $3ab8
   174                          GAME_BOOLEANS EQU $3ab9
   175                          NEXT_BLINK_CHECK EQU $3aba
   176                          TEMP_MAP EQU $3b00
   177                          BYTE_ram_3ffd EQU $3ffd
   178                          
   179                          ; Missing items
   180                          BYTE_ram_2400 EQU $2400
   181                          BYTE_ram_2613 EQU $2613
   182                          DAT_ram_303f EQU $303f
   183                          DAT_ram_3051 EQU $3051
   184                          DAT_ram_30a0 EQU $30a0
   185                          DAT_ram_30c8 EQU $30c8
   186                          DAT_ram_30df EQU $30df
   187                          DAT_ram_310c EQU $310c
   188                          DAT_ram_3111 EQU $3111
   189                          DAT_ram_3150 EQU $3150
   190                          DAT_ram_316c EQU $316c
   191                          DAT_ram_3178 EQU $3178
   192                          DAT_ram_317c EQU $317c
   193                          DAT_ram_31af EQU $31af
   194                          DAT_ram_31b4 EQU $31b4
   195                          DAT_ram_3200 EQU $3200
   196                          DAT_ram_3230 EQU $3230
   197                          DAT_ram_324c EQU $324c
   198                          DAT_ram_32da EQU $32da
   199                          DAT_ram_335c EQU $335c
   200                          DAT_ram_33c0 EQU $33c0
   201                          DAT_ram_34b4 EQU $34b4
   202                          DAT_ram_34c8 EQU $34c8
   203                          DAT_ram_34dc EQU $34dc
   204                          DAT_ram_351a EQU $351a
   205                          DAT_ram_352d EQU $352d
   206                          DAT_ram_3547 EQU $3547
   207                          DAT_ram_3550 EQU $3550
   208                          DAT_ram_356c EQU $356c
   209                          DAT_ram_3577 EQU $3577
   210                          DAT_ram_3578 EQU $3578
   211                          DAT_ram_357a EQU $357a
   212                          DAT_ram_357c EQU $357c
   213                          DAT_ram_35ba EQU $35ba
   214                          DAT_ram_35c0 EQU $35c0
   215                          DAT_ram_35c6 EQU $35c6
   216                          DAT_ram_35c8 EQU $35c8
   217                          DAT_ram_35ca EQU $35ca
   218                          DAT_ram_35cc EQU $35cc
   219                          LAB_ram_1208 EQU $1208
   220                          LAB_ram_efef EQU $efef
   221                          CHHRAM_INV_4_IDX EQU $31a9
   222                          CHHRAM_INV_6_IDX EQU $3251
   223                          CHHRAM_LVL_IDX EQU $33df
   224                          CHRRAM_AUTHORS_IDX EQU $3348
   225                          CHRRAM_F1_WALL_IDX EQU $3170
   226                          CHRRAM_FL1_WALL_IDX EQU $3147
   227                          CHRRAM_FO_ITEM_IDX EQU $3352
   228                          CHRRAM_LEFT_HAND_ITEM_IDX EQU $3271
   229                          CHRRAM_LEFT_HD_GFX_IDX EQU $3339
   230                          CHRRAM_LEVEL_IDX EQU $333d
   231                          CHRRAM_MONSTER_PHYS EQU $3089
   232                          CHRRAM_MONSTER_POOF_IDX EQU $323b
   233                          CHRRAM_MONSTER_SPRT EQU $3063
   234                          CHRRAM_PHYS_HEALTH_1000 EQU $3041
   235                          CHRRAM_PHYS_SHIELD_IDX EQU $3069
   236                          CHRRAM_PHYS_WEAPON_IDX EQU $3091
   237                          CHRRAM_RH_POOF_IDX EQU $336c
   238                          CHRRAM_RIGHT_HAND_ITEM_IDX EQU $327b
   239                          CHRRAM_RIGHT_HD_GFX_IDX EQU $3343
   240                          CHRRAM_SPRT_HEALTH_10 EQU $3047
   241                          CHRRAM_SPRT_SHIELD_IDX EQU $306f
   242                          CHRRAM_SPRT_WEAPON_IDX EQU $3097
   243                          CHRRAM_STATS_TOP EQU $3019
   244                          CHRRAM_YOU_DIED_IDX EQU $31e7
   245                          COLRAM_F0_WALL_MAP_IDX EQU $34cc
   246                          COLRAM_F1_DOOR_IDX EQU $35c2
   247                          COLRAM_FL00_WALL_IDX EQU $34a3
   248                          COLRAM_FL2_PLUS_WALL_IDX EQU $35be
   249                          COLRAM_FL2_WALL_IDX EQU $35bc
   250                          COLRAM_FL22_WALL_IDX EQU $35b8
   251                          COLRAM_FO_ITEM_IDX EQU $3752
   252                          COLRAM_L1_DOOR_IDX EQU $356d
   253                          COLRAM_MAP_IDX EQU $3411
   254                          COLRAM_PHYS_STATS_10 EQU $3443
   255                          COLRAM_RH_ITEM_IDX EQU $3743
   256                          COLRAM_SHIFT_MODE_IDX EQU $3405
   257                          COLRAM_SPRT_STATS_1 EQU $3447
   258                          COLRAM_VIEWPORT_IDX EQU $3428
   259                          HC_LAST_INPUT EQU $37ff
   260                          IDX_HEALTH_SPACER EQU $3045
   261                          
src/asterion.asm:
     3                          
     4                          org $c000
     5                          
     6                          include "asterion_gfx.asm"
src/asterion_gfx.asm:
     1                          ; ASTERION_GFX.ASM
     2                          ; Updated 22 SEP 2025 by Sean P. Harrington
     3                          ;
     4                          
     5                          ; Maze of Asterion Grpahics Draw Routine -
     6                          ;   The routine that draws character-based graphics in Maze of Asterion is labelled GFX_DRAW .
     7                          ;   -   Register B expects the FG/BG color value
     8                          ;   -   Register HL expects the CHRRAM screen address to start drawing
     9                          ;       - Indexed starting points for ITEMS and MONSTERS within the VIEWPORT
    10                          ;       - Indexed starting points for LEFT and RIGHT hands and inventory items
    11                          ;       - Any other indexed locations (always starting in CHRRAM!!!)
    12                          ;   -   Register DE expects the GFX start address (typically through the GFX_POINTERS table)
    13                          ;   A graphic in Maze of Asterion is a block of AQUASCII characters, $FF terminated, with six defined “control” characters:
    14                          ;   -   $00 = empty character (move right one column, NOT a space character!)
    15                          ;   -   $01 = return character (move down and back to index)
    16                          ;   -   $02 = backspace character (move left one column)
    17                          ;   -   $03 = linefeed (move down one row)
    18                          ;   -   $04 = previous line (move up one row)
    19                          ;   -   $A0 = reverse colors (swap FG/BG)
    20                          
    21                          
    22                          
    23                          ; NO_GFX is a label used for an "empty" graphic, since it's only character is the end of graphic code, $FF
    24                          NO_GFX:
    25  0000  ff                    db          $FF
    26                          
    27                          ; ITEMS:
    28                          ;   - Items range from OBJECT INDEX $00 to $77, and OBJECT TYPE $00 to $1D
    29                          ;   - OBJECT TYPE is the OBJECT INDEX bit-shifted RIGHT two times to remove the 2 bits of object level
    30                          ;   - Items (if visible in the maze) have three sizes, depending on how far away they are from the PLAYER's position:
    31                          ;       - Tiny (i.e. MAP_T): These items are either two spaces forward, or one space diagonal right or left forward from the player. These graphics are usually only a single character wide.
    32                          ;       - Small (i.e. MAP_S): These items are one space forward from the player. These graphics are usually 2x2 characters in size.
    33                          ;       - Regular (i.e. MAP): These items are in the same space as the player. These graphics are usually 4x4 characters in size, and this is the size used for items in the player's inventory pack.
    34                          ;
    35                          
    36                          ; =================================
    37                          ; BUCKLER -
    38                          ;   OBJECT TYPE:  $00
    39                          ;   OBJECT INDEX:
    40                          ;       $00 - RED BUCKLER (Starting item, HARDEST level)
    41                          ;       $01 - YELLOW BUCKLER (Starting item, HARD level)
    42                          ;       $02 - MAGENTA BUCKLER (Starting item, MEDIUM level)
    43                          ;       $03 - WHITE BUCKLER (Starting item, EASIEST level)
    44                          ; The BUCKLER is a small shield item that can be picked up and swapped to the LEFT HAND for protection.
    45                          ;
    46                          BUCKLER:
    47  0001  0101010101            db          $01,$01,$01,$01,$01
    48  0006  d7fcc901              db          $D7,$FC,$C9,$01
    49  000a  a098a07f9901          db          $A0,$98,$A0,$7F,$99,$01
    50  0010  c7afd9ff              db          $C7,$AF,$D9,$FF
    51                          BUCKLER_S:
    52  0014  0101                  db          $01,$01
    53  0016  0096ff                db          $00,$96,$FF
    54                          BUCKLER_T:
    55  0019  0087ff                db          $00,$87,$FF
    56                          
    57                          ; =================================
    58                          ; RING -
    59                          ;   OBJECT TYPE:  $01
    60                          ;   OBJECT INDEX:
    61                          ;       $04 - RED RING
    62                          ;       $05 - YELLOW RING
    63                          ;       $06 - MAGENTA RING
    64                          ;       $07 - WHITE RING
    65                          ; The RING is an enchantment item that increases protection. Once picked up they are worn immediately and cannot be removed. They are not kept in inventory. If another RING of greater level it is picked up and worn, and the old RING disappears.
    66                          ;
    67                          RING:
    68  001c  01010101010101        db          $01,$01,$01,$01,$01,$01,$01
    69  0023  006fff                db          $00,"o",$FF
    70                          RING_S:
    71  0026  010101                db          $01,$01,$01
    72  0029  00c6ff                db          $00,$C6,$FF
    73                          RING_T:
    74  002c  002eff                db          $00,".",$FF
    75                          
    76                          ; =================================
    77                          ; HELMET -
    78                          ;   OBJECT TYPE:  $02
    79                          ;   OBJECT INDEX:
    80                          ;       $08 - RED HELMET
    81                          ;       $09 - YELLOW HELMET
    82                          ;       $0A - MAGENTA HELMET
    83                          ;       $0B - WHITE HELMET
    84                          ; The HELMET is an enchantment item that increases protection. Once picked up they are worn immediately and cannot be removed. They are not kept in inventory. If another HELMET of greater level it is picked up and worn, and the old HELMET disappears.
    85                          ;
    86                          HELMET:
    87  002f  010101010101          db          $01,$01,$01,$01,$01,$01
    88  0035  00c0c101              db          $00,$C0,$C1,$01
    89  0039  00bfefff              db          $00,$BF,$EF,$FF
    90                          HELMET_S:
    91  003d  010101                db          $01,$01,$01
    92  0040  0400d201              db          $04,$00,$D2,$01
    93  0044  00a3ff                db          $00,$A3,$FF
    94                          HELMET_T:
    95  0047  005eff                db          $00,"^",$FF
    96                          
    97                          ; =================================
    98                          ; ARMOR -
    99                          ;   OBJECT TYPE:  $03
   100                          ;   OBJECT INDEX:
   101                          ;       $0C - RED ARMOR
   102                          ;       $0D - YELLOW ARMOR
   103                          ;       $0E - MAGENTA ARMOR
   104                          ;       $0F - WHITE ARMOR
   105                          ; The ARMOR is an enchantment item that increases protection. Once picked up they are worn immediately and cannot be removed. They are not kept in inventory. If another ARMOR of greater level it is picked up and worn, and the old ARMOR disappears.
   106                          ;
   107                          ARMOR:
   108  004a  0101010101            db          $01,$01,$01,$01,$01
   109  004f  a0c9c7d9d7a001        db          $A0,$C9,$C7,$D9,$D7,$A0,$01
   110  0056  ea7f7fb501            db          $EA,$7F,$7F,$B5,$01
   111  005b  a0c38888a097ff        db          $A0,$C3,$88,$88,$A0,$97,$FF
   112                          ARMOR_S:
   113  0062  0101                  db          $01,$01
   114  0064  c7a0c7d9a0d901        db          $C7,$A0,$C7,$D9,$A0,$D9,$01
   115  006b  007f7f01              db          $00,$7F,$7F,$01
   116  006f  00d9c7ff              db          $00,$D9,$C7,$FF
   117                          ARMOR_T:
   118  0073  00a0c7d901            db          $00,$A0,$C7,$D9,$01
   119  0078  0097a0c3ff            db          $00,$97,$A0,$C3,$FF
   120                          
   121                          ; =================================
   122                          ; PAVICE -
   123                          ;   OBJECT TYPE:  $04
   124                          ;   OBJECT INDEX:
   125                          ;       $00 - RED PAVICE
   126                          ;       $01 - YELLOW PAVICE
   127                          ;       $02 - MAGENTA PAVICE
   128                          ;       $03 - WHITE PAVICE
   129                          ; The PAVICE is a large shield item that can be picked up and swapped to the LEFT HAND for protection.
   130                          ;
   131                          PAVICE:
   132  007d  0101010101            db          $01,$01,$01,$01,$01
   133  0082  e8f0f0b401            db          $E8,$F0,$F0,$B4,$01
   134  0087  ea7f7fb501            db          $EA,$7F,$7F,$B5,$01
   135  008c  ea7f7fb501            db          $EA,$7F,$7F,$B5,$01
   136  0091  00efbfff              db          $00,$EF,$BF,$FF
   137                          PAVICE_S:
   138  0095  0101                  db          $01,$01
   139  0097  00f4f801              db          $00,$F4,$F8,$01
   140  009b  007f7f01              db          $00,$7F,$7F,$01
   141  009f  00aba7ff              db          $00,$AB,$A7,$FF
   142                          PAVICE_T:
   143  00a3  007f01                db          $00,$7F,$01
   144  00a6  00c2ff                db          $00,$C2,$FF
   145                          
   146                          ; =================================
   147                          ; ARROW_FLYING_RIGHT -
   148                          ;   OBJECT TYPE:  $05
   149                          ;   OBJECT INDEX: $14
   150                          ; The ARROW_FLYING_RIGHT is the object used in animation when a MONSTER performs a PHYSICAL attack on the PLAYER. Note that this item/object does not appear in the maze and cannot be picked up.
   151                          ;
   152                          ARROW_FLYING_RIGHT:
   153  00a9  010101010101          db          $01,$01,$01,$01,$01,$01
   154  00af  ac9aff                db          $AC,$9A,$FF
   155                          
   156                          ; =================================
   157                          ; BOW -
   158                          ;   OBJECT TYPE:  $06
   159                          ;   OBJECT INDEX:
   160                          ;       $18 - RED BOW (Starting item, all levels)
   161                          ;       $19 - YELLOW BOW
   162                          ;       $1A - MAGENTA BOW
   163                          ;       $1B - WHITE BOW
   164                          ; The BOW is a basic WEAPON that can be used with ARROWS by the PLAYER to make a PHYSICAL attack on a MONSTER.
   165                          ;
   166                          BOW:
   167  00b2  0101010101            db          $01,$01,$01,$01,$01
   168  00b7  d7aca38e01            db          $D7,$AC,$A3,$8E,$01
   169  00bc  d600ca01              db          $D6,$00,$CA,$01
   170  00c0  b5ca01                db          $B5,$CA,$01
   171  00c3  9f00ff                db          $9F,$00,$FF
   172                          BOW_S:
   173  00c6  0101                  db          $01,$01
   174  00c8  d7acc901              db          $D7,$AC,$C9,$01
   175  00cc  d6ca01                db          $D6,$CA,$01
   176  00cf  c7ff                  db          $C7,$FF
   177                          BOW_T:
   178  00d1  007bff                db          $00,"{",$FF
   179                          
   180                          ; =================================
   181                          ; SCROLL -
   182                          ;   OBJECT TYPE:  $07
   183                          ;   OBJECT INDEX:
   184                          ;       $1C - RED SCROLL
   185                          ;       $1D - YELLOW SCROLL
   186                          ;       $1E - MAGENTA SCROLL
   187                          ;       $1F - WHITE SCROLL
   188                          ; The SCROLL is a WEAPON that can be used by the PLAYER to make a MAGICAL attack on a MONSTER.
   189                          ;
   190                          SCROLL:
   191  00d4  0101010101            db          $01,$01,$01,$01,$01
   192  00d9  0990900901            db          "\t",$90,$90,"\t",$01
   193  00de  128f8e1201            db          $12,$8F,$8E,$12,$01
   194  00e3  129e9f1201            db          $12,$9E,$9F,$12,$01
   195  00e8  08a08080a008ff        db          "\b",$A0,$80,$80,$A0,"\b",$FF
   196                          SCROLL_S:
   197  00ef  0101                  db          $01,$01
   198  00f1  00cddd01              db          $00,$CD,$DD,$01
   199  00f5  00cdddff              db          $00,$CD,$DD,$FF
   200                          SCROLL_T:
   201  00f9  0048ff                db          $00,"H",$FF
   202                          
   203                          ; =================================
   204                          ; AXE -
   205                          ;   OBJECT TYPE:  $08
   206                          ;   OBJECT INDEX:
   207                          ;       $20 - RED AXE
   208                          ;       $21 - YELLOW AXE
   209                          ;       $22 - MAGENTA AXE
   210                          ;       $23 - WHITE AXE
   211                          ; The AXE is a WEAPON that can be thrown by the PLAYER to make a PHYSICAL attack on a MONSTER. Once used, it (usually) relocates to another part of the maze.
   212                          ;
   213                          AXE:
   214  00fc  0101010101            db          $01,$01,$01,$01,$01
   215  0101  007fb701              db          $00,$7F,$B7,$01
   216  0105  00d99801              db          $00,$D9,$98,$01
   217  0109  0000b501              db          $00,$00,$B5,$01
   218  010d  000099ff              db          $00,$00,$99,$FF
   219                          AXE_S:
   220  0111  0101                  db          $01,$01
   221  0113  00a0d7a0b701          db          $00,$A0,$D7,$A0,$B7,$01
   222  0119  00009801              db          $00,$00,$98,$01
   223  011d  0000b5ff              db          $00,$00,$B5,$FF
   224                          AXE_T:
   225  0121  0011ff                db          $00,$11,$FF
   226                          
   227                          ; =================================
   228                          ; FIREBALL -
   229                          ;   OBJECT TYPE:  $09
   230                          ;   OBJECT INDEX:
   231                          ;       $24 - RED FIREBALL
   232                          ;       $25 - YELLOW FIREBALL
   233                          ;       $26 - MAGENTA FIREBALL
   234                          ;       $27 - WHITE FIREBALL
   235                          ; The FIREBALL is a WEAPON that can be thrown by the PLAYER to make a MAGICAL attack on a MONSTER. Once used, it disappears.
   236                          ;
   237                          FIREBALL:
   238  0124  0101010101            db          $01,$01,$01,$01,$01
   239  0129  bab9e101              db          $BA,$B9,$E1,$01
   240  012d  b8beb901              db          $B8,$BE,$B9,$01
   241  0131  a8e1b6ff              db          $A8,$E1,$B6,$FF
   242                          FIREBALL_S:
   243  0135  0101                  db          $01,$01
   244  0137  00d1ff                db          $00,$D1,$FF
   245                          FIREBALL_T:
   246  013a  00d3ff                db          $00,$D3,$FF
   247                          
   248                          ; =================================
   249                          ; MACE -
   250                          ;   OBJECT TYPE:  $0A
   251                          ;   OBJECT INDEX:
   252                          ;       $28 - RED MACE
   253                          ;       $29 - YELLOW MACE
   254                          ;       $2A - MAGENTA MACE
   255                          ;       $2B - WHITE MACE
   256                          ; The MACE is a WEAPON that can be thrown by the PLAYER to make a PHYSICAL attack on a MONSTER. Once used, it (usually) relocates to another part of the maze.
   257                          ;
   258                          MACE:
   259  013d  0101010101            db          $01,$01,$01,$01,$01
   260  0142  009e8e01              db          $00,$9E,$8E,$01
   261  0146  00a0c3a09701          db          $00,$A0,$C3,$A0,$97,$01
   262  014c  00a0c3a09701          db          $00,$A0,$C3,$A0,$97,$01
   263  0152  00a099a098ff          db          $00,$A0,$99,$A0,$98,$FF
   264                          MACE_S:
   265  0158  0101                  db          $01,$01
   266  015a  00e0b001              db          $00,$E0,$B0,$01
   267  015e  00a091a08101          db          $00,$A0,$91,$A0,$81,$01
   268  0164  00a0c3a097ff          db          $00,$A0,$C3,$A0,$97,$FF
   269                          MACE_T:
   270  016a  0054ff                db          $00,"T",$FF
   271                          
   272                          ; =================================
   273                          ; STAFF -
   274                          ;   OBJECT TYPE:  $0B
   275                          ;   OBJECT INDEX:
   276                          ;       $2C - RED STAFF
   277                          ;       $2D - YELLOW STAFF
   278                          ;       $2E - MAGENTA STAFF
   279                          ;       $2F - WHITE STAFF
   280                          ; The STAFF is an advanced WEAPON that can be used by the PLAYER to make a MAGICAL attack on a MONSTER.
   281                          ;
   282                          STAFF:
   283  016d  0101010101            db          $01,$01,$01,$01,$01
   284  0172  d501                  db          $D5,$01
   285  0174  00da01                db          $00,$DA,$01
   286  0177  0000da01              db          $00,$00,$DA,$01
   287  017b  000000daff            db          $00,$00,$00,$DA,$FF
   288                          STAFF_S:
   289  0180  0101                  db          $01,$01
   290  0182  00d301                db          $00,$D3,$01
   291  0185  0000daff              db          $00,$00,$DA,$FF
   292                          STAFF_T:
   293  0189  005cff                db          $00,"\\",$FF
   294                          
   295                          ; =================================
   296                          ; CROSSBOW -
   297                          ;   OBJECT TYPE:  $0C
   298                          ;   OBJECT INDEX:
   299                          ;       $30 - RED CROSSBOW
   300                          ;       $31 - YELLOW CROSSBOW
   301                          ;       $32 - MAGENTA CROSSBOW
   302                          ;       $33 - WHITE CROSSBOW
   303                          ; The CROSSBOW is an advanced WEAPON that can be used with ARROWS by the PLAYER to make a PHYSICAL attack on a MONSTER.
   304                          ;
   305                          CROSSBOW:
   306  018c  0101010101            db          $01,$01,$01,$01,$01
   307  0191  000090f001            db          $00,$00,$90,$F0,$01
   308  0196  000cb7a091a001        db          $00,"\f",$B7,$A0,$91,$A0,$01
   309  019d  a091a0b7eda091a0      db          $A0,$91,$A0,$B7,$ED,$A0,$91,$A0,$01
              01                
   310  01a6  a099a09090a0d7a0      db          $A0,$99,$A0,$90,$90,$A0,$D7,$A0,$FF
              ff                
   311                          CROSSBOW_S:
   312  01af  0101                  db          $01,$01
   313  01b1  d7dc01                db          $D7,$DC,$01
   314  01b4  cd0dff                db          $CD,"\r",$FF
   315                          CROSSBOW_T:
   316  01b7  a091a0d8020490ff      db          $A0,$91,$A0,$D8,$02,$04,$90,$FF
   317                          
   318                          ; =================================
   319                          ; UNKNOWN ITEM -
   320                          ;   OBJECT TYPE:  $0D
   321                          ;   OBJECT INDEX: $34
   322                          ; The purpose of this item is unknown, but maybe used for the flying animation for AXE or MACE. Note that this item/object does not appear in the maze and cannot be picked up.
   323                          
   324                          ; =================================
   325                          ; UNKNOWN ITEM -
   326                          ;   OBJECT TYPE:  $0E
   327                          ;   OBJECT INDEX: $38
   328                          ; The purpose of this item is unknown, but maybe used for the flying animation for AXE or MACE. Note that this item/object does not appear in the maze and cannot be picked up.
   329                          
   330                          ; =================================
   331                          ; ARROW_FLYING_LEFT -
   332                          ;   OBJECT TYPE:  $0F
   333                          ;   OBJECT INDEX: $3C
   334                          ; The ARROW_FLYING_LEFTT is the object used in animation when the PLAYER performs a PHYSICAL attack on a MONSTER. Note that this item/object does not appear in the maze and cannot be picked up.
   335                          ;
   336                          ARROW_FLYING_LEFT:
   337  01bf  010101010101          db          $01,$01,$01,$01,$01,$01
   338  01c5  9bacff                db          $9B,$AC,$FF
   339                          
   340                          ; =================================
   341                          ; LADDDER -
   342                          ;   OBJECT TYPE:  $10
   343                          ;   OBJECT INDEX: $42 (MAGENTA LADDER)
   344                          ; The LADDER is the object that allows progressing to the next lower level of the maze. Note that this item/object cannot be picked up and only shows up in the MAGENTA form.
   345                          ;
   346                          LADDER:
   347  01c8  0101010101            db          $01,$01,$01,$01,$01
   348  01cd  ea0000b501            db          $EA,$00,$00,$B5,$01
   349  01d2  eaafafb501            db          $EA,$AF,$AF,$B5,$01
   350  01d7  fafcfcf501            db          $FA,$FC,$FC,$F5,$01
   351  01dc  abf0f0a7ff            db          $AB,$F0,$F0,$A7,$FF
   352                          LADDER_S:
   353  01e1  0101                  db          $01,$01
   354  01e3  00b4e801              db          $00,$B4,$E8,$01
   355  01e7  d7b7ebc901            db          $D7,$B7,$EB,$C9,$01
   356  01ec  c7afafd9ff            db          $C7,$AF,$AF,$D9,$FF
   357                          LADDER_T:
   358  01f1  00cd97ff              db          $00,$CD,$97,$FF
   359                          
   360                          ; =================================
   361                          ; CHEST -
   362                          ;   OBJECT TYPE:  $11
   363                          ;   OBJECT INDEX:
   364                          ;       $44 - RED CHEST
   365                          ;       $45 - YELLOW CHEST
   366                          ;       $46 - MAGENTA CHEST
   367                          ;       $47 - WHITE CHEST
   368                          ; The CHEST is an ITEM that can be picked up or opened when on the ground in front of the PLAYER. When opened, it disappears and becomes a TREASURE item, a POTION, a KEY, or a MAP. Note that the CHEST can also be thrown as a WEAPON for a PHYSICAL attack, but does not inflict much damage.
   369                          ;
   370                          CHEST:
   371  01f5  0101010101            db          $01,$01,$01,$01,$01
   372  01fa  9088889001            db          $90,$88,$88,$90,$01
   373  01ff  a090888890a001        db          $A0,$90,$88,$88,$90,$A0,$01
   374  0206  a0819090a09101        db          $A0,$81,$90,$90,$A0,$91,$01
   375  020d  a0d7fcfcc9a0ff        db          $A0,$D7,$FC,$FC,$C9,$A0,$FF
   376                          CHEST_S:
   377  0214  01e01f1fb001          db          $01,$E0,$1F,$1F,$B0,$01
   378  021a  a099a080809801        db          $A0,$99,$A0,$80,$80,$98,$01
   379  0221  a20000a1ff            db          $A2,$00,$00,$A1,$FF
   380                          CHEST_T:
   381  0226  00fcff                db          $00,$FC,$FF
   382                          
   383                          ; =================================
   384                          ; FOOD -
   385                          ;   OBJECT TYPE:  $12
   386                          ;   OBJECT INDEX:
   387                          ;       $48 - RED FOOD
   388                          ;       $49 - YELLOW FOOD
   389                          ;       $4A - MAGENTA FOOD
   390                          ;       $4B - WHITE FOOD
   391                          ; The FOOD is an ITEM that can be picked up and added to the PLAYER's rations, a separate inventory. Picking FOOD up causes it to disappear.
   392                          ;
   393                          FOOD:
   394  0229  0101010101            db          $01,$01,$01,$01,$01
   395  022e  e41ff601              db          $E4,$1F,$F6,$01
   396  0232  a0c3cbdba09701        db          $A0,$C3,$CB,$DB,$A0,$97,$01
   397  0239  00bba01fa0a9ff        db          $00,$BB,$A0,$1F,$A0,$A9,$FF
   398                          FOOD_S:
   399  0240  0101                  db          $01,$01
   400  0242  e0beb001              db          $E0,$BE,$B0,$01
   401  0246  00e9a7ff              db          $00,$E9,$A7,$FF
   402                          FOOD_T:
   403  024a  0023ff                db          $00,"#",$FF
   404                          
   405                          ; =================================
   406                          ; QUIVER -
   407                          ;   OBJECT TYPE:  $13
   408                          ;   OBJECT INDEX:
   409                          ;       $4C - RED QUIVER
   410                          ;       $4D - YELLOW QUIVER
   411                          ;       $4E - MAGENTA QUIVER
   412                          ;       $4F - WHITE QUIVER
   413                          ; The QUIVER is an ITEM that can be picked up and added to the PLAYER's arrows, a separate inventory. Picking QUIVER up causes it to disappear.
   414                          ;
   415                          QUIVER:
   416  024d  010101010101          db          $01,$01,$01,$01,$01,$01
   417  0253  7f7fa0d7a00601        db          $7F,$7F,$A0,$D7,$A0,$06,$01
   418  025a  a2acb2e901            db          $A2,$AC,$B2,$E9,$01
   419  025f  0000a2a1ff            db          $00,$00,$A2,$A1,$FF
   420                          QUIVER_S:
   421  0264  0101                  db          $01,$01
   422  0266  00afbdb001            db          $00,$AF,$BD,$B0,$01
   423  026b  0000a2ff              db          $00,$00,$A2,$FF
   424                          QUIVER_T:
   425  026f  00f0ff                db          $00,$F0,$FF
   426                          
   427                          ; =================================
   428                          ; LOCKED_CHEST -
   429                          ;   OBJECT TYPE:  $14
   430                          ;   OBJECT INDEX:
   431                          ;       $50 - RED LOCKED_CHEST
   432                          ;       $51 - YELLOW LOCKED_CHEST
   433                          ;       $52 - MAGENTA LOCKED_CHEST
   434                          ;       $53 - WHITE LOCKED_CHEST
   435                          ; The LOCKED_CHEST is an ITEM that can be picked up or unlocked/opened with a KEY of similar or greater level when on the ground in front of the PLAYER. When unlocked/opened, it disappears and becomes a TREASURE item, a POTION, a KEY, or a MAP. Note that the LOCKED_CHEST can also be thrown as a WEAPON for a PHYSICAL attack, but does not inflict much damage.
   436                          ; A tiny or small LOCKED_CHEST looks like a regular CHEST from afar, so it uses those graphics.
   437                          ;
   438                          LOCKED_CHEST:
   439  0272  0101010101            db          $01,$01,$01,$01,$01
   440  0277  9088889001            db          $90,$88,$88,$90,$01
   441  027c  a090888890a001        db          $A0,$90,$88,$88,$90,$A0,$01
   442  0283  a081cbdba09101        db          $A0,$81,$CB,$DB,$A0,$91,$01
   443  028a  a0d7fcfcc9a0ff        db          $A0,$D7,$FC,$FC,$C9,$A0,$FF
   444                          
   445                          ; =================================
   446                          ; UNKNOWN ITEM -
   447                          ;   OBJECT TYPE:  $15
   448                          ;   OBJECT INDEX: $54
   449                          ; The purpose of this item is unknown, but maybe used for the flying animation for FIREBALL. Note that this item/object does not appear in the maze and cannot be picked up.
   450                          
   451                          ; =================================
   452                          ; KEY -
   453                          ;   OBJECT TYPE:  $16
   454                          ;   OBJECT INDEX:
   455                          ;       $58 - RED KEY
   456                          ;       $59 - YELLOW KEY
   457                          ;       $5A - MAGENTA KEY
   458                          ;       $5B - WHITE KEY
   459                          ; The KEY is an ITEM that can be picked up or used to unlock/open a LOCKED_CHEST of similar or lesser level when the LOCKED_CHEST is on the ground in front of the PLAYER. When used it disappears.
   460                          ;
   461                          KEY:
   462  0291  010101010101          db          $01,$01,$01,$01,$01,$01
   463  0297  9090b8c901            db          $90,$90,$B8,$C9,$01
   464  029c  10a080a0a9d9ff        db          $10,$A0,$80,$A0,$A9,$D9,$FF
   465                          KEY_S:
   466  02a3  010101                db          $01,$01,$01
   467  02a6  bcc5ff                db          $BC,$C5,$FF
   468                          KEY_T:
   469  02a9  ff2dff                db          $FF,"-",$FF
   470                          
   471                          ; =================================
   472                          ; AMULET -
   473                          ;   OBJECT TYPE:  $17
   474                          ;   OBJECT INDEX:
   475                          ;       $5C - RED AMULET
   476                          ;       $5D - YELLOW AMULET
   477                          ;       $5E - MAGENTA AMULET
   478                          ;       $5F - WHITE AMULET
   479                          ; The AMULET is a TREASURE item that increases the PLAYER's score. When picked up it disappears. Note in future versions of this game, the score will be removed, and picking up an AMULET will perform other functions.
   480                          ;
   481                          AMULET:
   482  02ac  0101010101            db          $01,$01,$01,$01,$01
   483  02b1  d7acc901              db          $D7,$AC,$C9,$01
   484  02b5  c7acc8c901            db          $C7,$AC,$C8,$C9,$01
   485  02ba  d7acd9d601            db          $D7,$AC,$D9,$D6,$01
   486  02bf  c7ac05d9ff            db          $C7,$AC,$05,$D9,$FF
   487                          AMULET_S:
   488  02c4  0101                  db          $01,$01
   489  02c6  00d7c901              db          $00,$D7,$C9,$01
   490  02ca  00c7c8c901            db          $00,$C7,$C8,$C9,$01
   491  02cf  00cbf1a5ff            db          $00,$CB,$F1,$A5,$FF
   492                          AMULET_T:
   493  02d4  0026ff                db          $00,"&",$FF
   494                          
   495                          ; =================================
   496                          ; CHALICE -
   497                          ;   OBJECT TYPE:  $18
   498                          ;   OBJECT INDEX:
   499                          ;       $60 - RED CHALICE
   500                          ;       $61 - YELLOW CHALICE
   501                          ;       $62 - MAGENTA CHALICE
   502                          ;       $63 - WHITE CHALICE
   503                          ; The CHALICE is a TREASURE item that increases the PLAYER's score. When picked up it disappears. Note in future versions of this game, the score will be removed, and picking up an CHALICE will perform other functions.
   504                          ;
   505                          CHALICE:
   506  02d7  010101010101          db          $01,$01,$01,$01,$01,$01
   507  02dd  a0c3a0899701          db          $A0,$C3,$A0,$89,$97,$01
   508  02e3  009f01                db          $00,$9F,$01
   509  02e6  e00eb0ff              db          $E0,$0E,$B0,$FF
   510                          CHALICE_S:
   511  02ea  0101                  db          $01,$01
   512  02ec  009f01                db          $00,$9F,$01
   513  02ef  00ccff                db          $00,$CC,$FF
   514                          CHALICE_T:
   515  02f2  0059ff                db          $00,"Y",$FF
   516                          
   517                          ; =================================
   518                          ; WARRIOR_POTION -
   519                          ;   OBJECT TYPE:  $19
   520                          ;   OBJECT INDEX:
   521                          ;       $64 - RED WARRIOR_POTION
   522                          ;       $65 - YELLOW WARRIOR_POTION
   523                          ;       $66 - MAGENTA WARRIOR_POTION
   524                          ;       $67 - WHITE WARRIOR_POTION
   525                          ; The WARRIOR_POTION is a potion that can be picked up or used. When used, it disappears and usually affects the PLAYER's PHYSICAL traits. It removes any other currently active POTION effect. Note all potions use the POTION_T for their tiny view.
   526                          ;
   527                          WARRIOR_POTION:
   528  02f5  0101010101            db          $01,$01,$01,$01,$01
   529  02fa  002bd401              db          $00,"+",$D4,$01
   530  02fe  00110f01              db          $00,$11,$0F,$01
   531  0302  00cddd01              db          $00,$CD,$DD,$01
   532  0306  00c7d9ff              db          $00,$C7,$D9,$FF
   533                          WARRIOR_POTION_S:
   534  030a  0101                  db          $01,$01
   535  030c  00d401                db          $00,$D4,$01
   536  030f  001401                db          $00,$14,$01
   537  0312  00c2ff                db          $00,$C2,$FF
   538                          POTION_T:
   539  0315  005502045fff          db          $00,"U",$02,$04,"_",$FF
   540                          
   541                          ; =================================
   542                          ; MAGE_POTION -
   543                          ;   OBJECT TYPE:  $1A
   544                          ;   OBJECT INDEX:
   545                          ;       $68 - RED MAGE_POTION
   546                          ;       $69 - YELLOW MAGE_POTION
   547                          ;       $6A - MAGENTA MAGE_POTION
   548                          ;       $6B - WHITE MAGE_POTION
   549                          ; The MAGE_POTION is a potion that can be picked up or used. When used, it disappears and usually affects the PLAYER's SPIRITUAL traits. It removes any other currently active POTION effect. Note all potions use the POTION_T for their tiny view.
   550                          ;
   551                          MAGE_POTION:
   552  031b  0101010101            db          $01,$01,$01,$01,$01
   553  0320  002bd501              db          $00,"+",$D5,$01
   554  0324  00110f01              db          $00,$11,$0F,$01
   555  0328  00cddd01              db          $00,$CD,$DD,$01
   556  032c  00c7d9ff              db          $00,$C7,$D9,$FF
   557                          MAGE_POTION_S:
   558  0330  0101                  db          $01,$01
   559  0332  00d501                db          $00,$D5,$01
   560  0335  001401                db          $00,$14,$01
   561  0338  00c2ff                db          $00,$C2,$FF
   562                          
   563                          ; =================================
   564                          ; MAP -
   565                          ;   OBJECT TYPE:  $1B
   566                          ;   OBJECT INDEX:
   567                          ;       $6C - RED MAP
   568                          ;       $6D - YELLOW MAP
   569                          ;       $6E - MAGENTA MAP
   570                          ;       $6F - WHITE MAP
   571                          ; The MAP is an ITEM that can be picked up or used to view the floorplan of the current maze level.
   572                          ;
   573                          MAP:
   574  033b  0101010101            db          $01,$01,$01,$01,$01
   575  0340  f01fc89801            db          $F0,$1F,$C8,$98,$01
   576  0345  12c8ccb501            db          $12,$C8,$CC,$B5,$01
   577  034a  a0b5a0cdcc1201        db          $A0,$B5,$A0,$CD,$CC,$12,$01
   578  0351  a099a0cca01ffca0      db          $A0,$99,$A0,$CC,$A0,$1F,$FC,$A0,$FF
              ff                
   579                          MAP_S:
   580  035a  0101                  db          $01,$01
   581  035c  00d701                db          $00,$D7,$01
   582  035f  c7a0d5a0c901          db          $C7,$A0,$D5,$A0,$C9,$01
   583  0365  00d9ff                db          $00,$D9,$FF
   584                          MAP_T:
   585  0368  00d5ff                db          $00,$D5,$FF
   586                          
   587                          ; =================================
   588                          ; CHAOS_POTION -
   589                          ;   OBJECT TYPE:  $1C
   590                          ;   OBJECT INDEX:
   591                          ;       $70 - RED CHAOS_POTION
   592                          ;       $71 - YELLOW CHAOS_POTION
   593                          ;       $72 - MAGENTA CHAOS_POTION
   594                          ;       $73 - WHITE CHAOS_POTION
   595                          ; The CHAOS_POTION is a potion that can be picked up or used. When used, it disappears and can randomly affects the PLAYER's SPIRITUAL, HEALTH, or PHYSICAL traits. It removes any other currently active POTION effect. Note all potions use the POTION_T for their tiny view.
   596                          ;
   597                          CHAOS_POTION:
   598  036b  0101010101            db          $01,$01,$01,$01,$01
   599  0370  003f3f01              db          $00,"??",$01
   600  0374  00110f01              db          $00,$11,$0F,$01
   601  0378  00cddd01              db          $00,$CD,$DD,$01
   602  037c  00c7d9ff              db          $00,$C7,$D9,$FF
   603                          CHAOS_POTION_S:
   604  0380  0101                  db          $01,$01
   605  0382  003f01                db          $00,"?",$01
   606  0385  001401                db          $00,$14,$01
   607  0388  00c2ff                db          $00,$C2,$FF
   608                          
   609                          ; =================================
   610                          ; UNKNOWN ITEM -
   611                          ;   OBJECT TYPE:  $1D
   612                          ;   OBJECT INDEX: $74
   613                          ; The purpose of this item is unknown, but maybe used for the text for the PLAYER's death sequence.
   614                          ;
   615                          EXCL_MARK_GFX:
   616  038b  21ff                  db          "!",$FF
   617                          
   618                          
   619                          ; MONSTERS
   620                          ;   - Monsters range from OBJECT INDEX $78 to $9F, and OBJECT TYPE $1E to $27
   621                          ;   - OBJECT TYPE is the OBJECT INDEX bit-shifted RIGHT two times to remove the 2 bits of object level
   622                          ;   - Monsters have two sizes, depending on how far away they are from the PLAYER's position:
   623                          ;       - Small (i.e. SKELETON_S): These monsters are two spaces forward, or one space diagonal left or right forward from the player. These graphics are usually 4x4 characters in size.
   624                          ;       - Regular (i.e. SKELETON): These items are one space forward from the player. These graphics are usually 8x8 characters in size.
   625                          ;
   626                          
   627                          ; =================================
   628                          ; SKELETON -
   629                          ;   OBJECT TYPE:  $1E
   630                          ;   OBJECT INDEX:
   631                          ;       $78 - RED SKELETON
   632                          ;       $79 - YELLOW SKELETON
   633                          ;       $7A - MAGENTA SKELETON
   634                          ;       $7B - WHITE SKELETON
   635                          ; The SKELETON is a basic monster.
   636                          ;
   637                          SKELETON:
   638  038d  04040404              db          $04,$04,$04,$04
   639  0391  028a00eeed01          db          $02,$8A,$00,$EE,$ED,$01
   640  0397  02d600a017a0a701      db          $02,$D6,$00,$A0,$17,$A0,$A7,$01
   641  039f  02d6e0acb9e401        db          $02,$D6,$E0,$AC,$B9,$E4,$01
   642  03a6  0223a6e2e6a2b401      db          $02,"#",$A6,$E2,$E6,$A2,$B4,$01
   643  03ae  02d600f8edb02301      db          $02,$D6,$00,$F8,$ED,$B0,"#",$01
   644  03b6  02d6e8a100e501        db          $02,$D6,$E8,$A1,$00,$E5,$01
   645  03bd  02d6a2e400ba01        db          $02,$D6,$A2,$E4,$00,$BA,$01
   646  03c4  02d600a6a8f1ff        db          $02,$D6,$00,$A6,$A8,$F1,$FF
   647                          SKELETON_S:
   648  03cb  040404                db          $04,$04,$04
   649  03ce  08e2a501              db          "\b",$E2,$A5,$01
   650  03d2  cdb8b7b401            db          $CD,$B8,$B7,$B4,$01
   651  03d7  d6b8a9b001            db          $D6,$B8,$A9,$B0,$01
   652  03dc  d6a2e8b1ff            db          $D6,$A2,$E8,$B1,$FF
   653                          
   654                          ; =================================
   655                          ; SNAKE -
   656                          ;   OBJECT TYPE:  $1F
   657                          ;   OBJECT INDEX:
   658                          ;       $7C - RED SNAKE
   659                          ;       $7D - YELLOW SNAKE
   660                          ;       $7E - MAGENTA SNAKE
   661                          ;       $7F - WHITE SNAKE
   662                          ; The SNAKE is a basic monster.
   663                          ;
   664                          SNAKE:
   665  03e1  040404                db          $04,$04,$04
   666  03e4  02b8bef7bdb001        db          $02,$B8,$BE,$F7,$BD,$B0,$01
   667  03eb  021111e2e9ea01        db          $02,$11,$11,$E2,$E9,$EA,$01
   668  03f2  02d7ade1b7b601        db          $02,$D7,$AD,$E1,$B7,$B6,$01
   669  03f9  028d00b6fae0f001      db          $02,$8D,$00,$B6,$FA,$E0,$F0,$01
   670  0401  0202b8a6fbb2faf1      db          $02,$02,$B8,$A6,$FB,$B2,$FA,$F1,$A4,$E9,$01
              a4e901            
   671  040c  0202b5a2eab2b2b4      db          $02,$02,$B5,$A2,$EA,$B2,$B2,$B4,$E0,$E6,$01
              e0e601            
   672  0417  0202a2aca3e6f2ae      db          $02,$02,$A2,$AC,$A3,$E6,$F2,$AE,$E1,$BB,$FF
              e1bbff            
   673                          SNAKE_S:
   674  0422  040404                db          $04,$04,$04
   675  0425  00fef901              db          $00,$FE,$F9,$01
   676  0429  0022a085a09701        db          $00,"\"",$A0,$85,$A0,$97,$01
   677  0430  b8b6f6e401            db          $B8,$B6,$F6,$E4,$01
   678  0435  e5e7f9e6ff            db          $E5,$E7,$F9,$E6,$FF
   679                          
   680                          ; =================================
   681                          ; SPIDER -
   682                          ;   OBJECT TYPE:  $20
   683                          ;   OBJECT INDEX:
   684                          ;       $80 - RED SPIDER
   685                          ;       $81 - YELLOW SPIDER
   686                          ;       $82 - MAGENTA SPIDER
   687                          ;       $83 - WHITE SPIDER
   688                          ; The SPIDER is a basic monster.
   689                          ;
   690                          SPIDER:
   691  043a  0404                  db          $04,$04
   692  043c  00befd01              db          $00,$BE,$FD,$01
   693  0440  a099a0f7ee9801        db          $A0,$99,$A0,$F7,$EE,$98,$01
   694  0447  02b6b9fbf7e6e901      db          $02,$B6,$B9,$FB,$F7,$E6,$E9,$01
   695  044f  02f7e6eebdb9fb01      db          $02,$F7,$E6,$EE,$BD,$B9,$FB,$01
   696  0457  0212d6a0178ca0d6      db          $02,$12,$D6,$A0,$17,$8C,$A0,$D6,$12,$01
              1201              
   697  0461  02a099a0c76027d9      db          $02,$A0,$99,$A0,$C7,"`'",$D9,$98,$FF
              98ff              
   698                          SPIDER_S:
   699  046b  04040404              db          $04,$04,$04,$04
   700  046f  00d7c901              db          $00,$D7,$C9,$01
   701  0473  d79585c901            db          $D7,$95,$85,$C9,$01
   702  0478  4da0178ca04d01        db          "M",$A0,$17,$8C,$A0,"M",$01
   703  047f  58602758ff            db          "X`'X",$FF
   704                          
   705                          ; =================================
   706                          ; MIMIC -
   707                          ;   OBJECT TYPE:  $21
   708                          ;   OBJECT INDEX:
   709                          ;       $84 - RED MIMIC
   710                          ;       $85 - YELLOW MIMIC
   711                          ;       $86 - MAGENTA MIMIC
   712                          ;       $87 - WHITE MIMIC
   713                          ; The MIMIC is a basic monster.
   714                          ;
   715                          MIMIC:
   716  0484  0402d796000096c9      db          $04,$02,$D7,$96,$00,$00,$96,$C9,$01
              01                
   717  048d  0212f01f1ff01201      db          $02,$12,$F0,$1F,$1F,$F0,$12,$01
   718  0495  02d611a0178ca00f      db          $02,$D6,$11,$A0,$17,$8C,$A0,$0F,$D6,$01
              d601              
   719  049f  02c7a0188d188da0      db          $02,$C7,$A0,$18,$8D,$18,$8D,$A0,$D9,$01
              d901              
   720  04a9  a0819090a09101        db          $A0,$81,$90,$90,$A0,$91,$01
   721  04b0  a0d7fcfcc9a0ff        db          $A0,$D7,$FC,$FC,$C9,$A0,$FF
   722                          MIMIC_S:
   723  04b7  01e01f1fb001          db          $01,$E0,$1F,$1F,$B0,$01
   724  04bd  a099a080809801        db          $A0,$99,$A0,$80,$80,$98,$01
   725  04c4  a20000a1ff            db          $A2,$00,$00,$A1,$FF
   726                          
   727                          ; =================================
   728                          ; MALOCCHIO -
   729                          ;   OBJECT TYPE:  $22
   730                          ;   OBJECT INDEX:
   731                          ;       $88 - RED MIMIC
   732                          ;       $89 - YELLOW MIMIC
   733                          ;       $8A - MAGENTA MIMIC
   734                          ;       $8B - WHITE MIMIC
   735                          ; The MALOCCHIO is a basic monster.
   736                          ;
   737                          MALOCCHIO:
   738  04c9  04040404              db          $04,$04,$04,$04
   739  04cd  02a8b0b600b6b001      db          $02,$A8,$B0,$B6,$00,$B6,$B0,$01
   740  04d5  02b4e5beeeb8e101      db          $02,$B4,$E5,$BE,$EE,$B8,$E1,$01
   741  04dd  02e27ff6f87fb101      db          $02,$E2,$7F,$F6,$F8,$7F,$B1,$01
   742  04e5  02a5a014141414a0      db          $02,$A5,$A0,$14,$14,$14,$14,$A0,$EA,$01
              ea01              
   743  04ef  02e8ab7f7fa7b401      db          $02,$E8,$AB,$7F,$7F,$A7,$B4,$01
   744  04f7  02c7a40000a8d9ff      db          $02,$C7,$A4,$00,$00,$A8,$D9,$FF
   745                          MALOCCHIO_S:
   746  04ff  04040404              db          $04,$04,$04,$04
   747  0503  00b6b8e001            db          $00,$B6,$B8,$E0,$01
   748  0508  e3bee9f101            db          $E3,$BE,$E9,$F1,$01
   749  050d  b9a08484a0e401        db          $B9,$A0,$84,$84,$A0,$E4,$01
   750  0514  a2a6a1a5ff            db          $A2,$A6,$A1,$A5,$FF
   751                          
   752                          ; =================================
   753                          ; DRAGON -
   754                          ;   OBJECT TYPE:  $23
   755                          ;   OBJECT INDEX:
   756                          ;       $8C - RED DRAGON
   757                          ;       $8D - YELLOW DRAGON
   758                          ;       $8E - MAGENTA DRAGON
   759                          ;       $8F - WHITE DRAGON
   760                          ; The DRAGON is an advanced monster.
   761                          ;
   762                          DRAGON:
   763  0519  04040404              db          $04,$04,$04,$04
   764  051d  02b0e000c0a0c2a0      db          $02,$B0,$E0,$00,$C0,$A0,$C2,$A0,$C1,$01
              c101              
   765  0527  0202a099a0c9d798      db          $02,$02,$A0,$99,$A0,$C9,$D7,$98,$A0,$95,$95,$85,$A0,$81,$01
              a0959585a08101    
   766  0536  0202a0c3a4a81285      db          $02,$02,$A0,$C3,$A4,$A8,$12,$85,$86,$85,$A0,$97,$01
              8685a09701        
   767  0543  02a0178ca52094a0      db          $02,$A0,$17,$8C,$A5," ",$94,$A0,$94,$A5,$01
              94a501            
   768  054e  0202d7f6f97f7f7f      db          $02,$02,$D7,$F6,$F9,$7F,$7F,$7F,$7F,$B4,$01
              7fb401            
   769  0559  0202a0b595862084      db          $02,$02,$A0,$B5,$95,$86," ",$84," ",$B0,$A0,$99,$01
              20b0a09901        
   770  0566  0202a0c3d7a094a0      db          $02,$02,$A0,$C3,$D7,$A0,$94,$A0,$C9,$A0,$DB,$18,$A2,$C3,$01
              c9a0db18a2c301    
   771  0575  0218008d0000e899      db          $02,$18,$00,$8D,$00,$00,$E8,$99,$01
              01                
   772  057e  009eec1fbfa1ff        db          $00,$9E,$EC,$1F,$BF,$A1,$FF
   773                          DRAGON_S:
   774  0585  040404c9c9c0c001      db          $04,$04,$04,$C9,$C9,$C0,$C0,$01
   775  058d  eda5a09595a001        db          $ED,$A5,$A0,$95,$95,$A0,$01
   776  0594  a092a0f9a0caa0a7      db          $A0,$92,$A0,$F9,$A0,$CA,$A0,$A7,$01
              01                
   777  059d  babfefe901            db          $BA,$BF,$EF,$E9,$01
   778  05a2  d9d907abff            db          $D9,$D9,"\a",$AB,$FF
   779                          
   780                          ; =================================
   781                          ; MUMMY -
   782                          ;   OBJECT TYPE:  $24
   783                          ;   OBJECT INDEX:
   784                          ;       $90 - RED MUMMY
   785                          ;       $91 - YELLOW MUMMY
   786                          ;       $92 - MAGENTA MUMMY
   787                          ;       $93 - WHITE MUMMY
   788                          ; The MUMMY is an advanced monster.
   789                          ;
   790                          MUMMY:
   791  05a7  04040404              db          $04,$04,$04,$04
   792  05ab  d7fcc901              db          $D7,$FC,$C9,$01
   793  05af  0202d7c995a093a0      db          $02,$02,$D7,$C9,$95,$A0,$93,$A0,$B4,$00,$D7,$C9,$01
              b400d7c901        
   794  05bc  0202a097a084a094      db          $02,$02,$A0,$97,$A0,$84,$A0,$94,$84,$94,$A0,$84,$A0,$D9,$A0,$97,$01
              8494a084a0d9a097  
              01                
   795  05cd  0202a0b5f8c98494      db          $02,$02,$A0,$B5,$F8,$C9,$84,$94,$D2,$D6,$A0,$01
              d2d6a001          
   796  05d9  0202a0c3a00095a0      db          $02,$02,$A0,$C3,$A0,$00,$95,$A0,$84,$94,$7F,$12,$A0,$01
              84947f12a001      
   797  05e7  0202a091bf94e094      db          $02,$02,$A0,$91,$BF,$94,$E0,$94,$AA,$91,$A0,$01
              aa91a001          
   798  05f3  0295a095a00011a0      db          $02,$95,$A0,$95,$A0,$00,$11,$A0,$95,$A0,$01
              95a001            
   799  05fe  02a0d9a0850027a0      db          $02,$A0,$D9,$A0,$85,$00,"'",$A0,$85,$A0,$C9,$FF
              85a0c9ff          
   800                          MUMMY_S:
   801  060a  040404                db          $04,$04,$04
   802  060d  1ceab11a01            db          $1C,$EA,$B1,$1A,$01
   803  0612  11efbf0f01            db          $11,$EF,$BF,$0F,$01
   804  0617  d6a0d9c7a06001        db          $D6,$A0,$D9,$C7,$A0,"`",$01
   805  061e  e0b5eab0ff            db          $E0,$B5,$EA,$B0,$FF
   806                          
   807                          ; =================================
   808                          ; NECROMANCER -
   809                          ;   OBJECT TYPE:  $25
   810                          ;   OBJECT INDEX:
   811                          ;       $94 - RED NECROMANCER
   812                          ;       $95 - YELLOW NECROMANCER
   813                          ;       $96 - MAGENTA NECROMANCER
   814                          ;       $97 - WHITE NECROMANCER
   815                          ; The NECROMANCER is an advanced monster.
   816                          ;
   817                          NECROMANCER:
   818  0623  04040404              db          $04,$04,$04,$04
   819  0627  02d7d0a0110fa0d0      db          $02,$D7,$D0,$A0,$11,$0F,$A0,$D0,$C9,$01
              c901              
   820  0631  0202d78dd1a4a4d1      db          $02,$02,$D7,$8D,$D1,$A4,$A4,$D1,$18,$C9,$01
              18c901            
   821  063c  0202d6e9a0d9a09c      db          $02,$02,$D6,$E9,$A0,$D9,$A0,$9C,$D7,$A0,$C7,$A0,$B6,$D6,$01
              d7a0c7a0b6d601    
   822  064b  020212faefa0c2a0      db          $02,$02,$12,$FA,$EF,$A0,$C2,$A0,$7F,$BF,$F5,$12,$01
              7fbff51201        
   823  0658  0202c7a7e2afedb1      db          $02,$02,$C7,$A7,$E2,$AF,$ED,$B1,$AB,$D9,$01
              abd901            
   824  0663  7fa0d6a07ffd01        db          $7F,$A0,$D6,$A0,$7F,$FD,$01
   825  066a  02a09920192020a0      db          $02,$A0,$99," ",$19,"  ",$A0,$98,$01,$02,$C7,$A0,$88," ",$90,$F0,$A0,$D9,$FF
              980102c7a0882090  
              f0a0d9ff          
   826                          NECROMANCER_S:
   827  067e  040404                db          $04,$04,$04
   828  0681  0be2db0c01            db          "\v",$E2,$DB,"\f",$01
   829  0686  9fa0c9d7a09f01        db          $9F,$A0,$C9,$D7,$A0,$9F,$01
   830  068d  00129901              db          $00,$12,$99,$01
   831  0691  00fd91ff              db          $00,$FD,$91,$FF
   832                          
   833                          ; =================================
   834                          ; GRYPHON -
   835                          ;   OBJECT TYPE:  $26
   836                          ;   OBJECT INDEX:
   837                          ;       $98 - RED GRYPHON
   838                          ;       $99 - YELLOW GRYPHON
   839                          ;       $9A - MAGENTA GRYPHON
   840                          ;       $9B - WHITE GRYPHON
   841                          ; The GRYPHON is an advanced monster.
   842                          ;
   843                          GRYPHON:
   844  0695  04040404              db          $04,$04,$04,$04
   845  0699  02889088f001          db          $02,$88,$90,$88,$F0,$01
   846  069f  0202bea0aca0ed95      db          $02,$02,$BE,$A0,$AC,$A0,$ED,$95,$A0,$85,$A0,$F5,$01
              a085a0f501        
   847  06ac  0202a0959595a0b5      db          $02,$02,$A0,$95,$95,$95,$A0,$B5,$86,$91,$01
              869101            
   848  06b7  0202a0959595a0c3      db          $02,$02,$A0,$95,$95,$95,$A0,$C3,$95,$E5,$A0,$C7,$A0,$B0,$01
              95e5a0c7a0b001    
   849  06c6  0202a09595a0a1ef      db          $02,$02,$A0,$95,$95,$A0,$A1,$EF,$F4,$EF,$F5,$A0,",",$A0,$01
              f4eff5a02ca001    
   850  06d5  020212b97ff57ff5      db          $02,$02,$12,$B9,$7F,$F5,$7F,$F5,"\r",$C7,$01
              0dc701            
   851  06e0  0202b6eaf7e77feb      db          $02,$02,$B6,$EA,$F7,$E7,$7F,$EB,$F5,$01
              f501              
   852  06ea  02028bc7bfb6efed      db          $02,$02,$8B,$C7,$BF,$B6,$EF,$ED,$EB,$E5,$FF
              ebe5ff            
   853                          GRYPHON_S:
   854  06f5  040404b8b8b001        db          $04,$04,$04,$B8,$B8,$B0,$01
   855  06fc  a09595a012c901        db          $A0,$95,$95,$A0,$12,$C9,$01
   856  0703  e1a0d9d9a08d01        db          $E1,$A0,$D9,$D9,$A0,$8D,$01
   857  070a  28e7e7e5ff            db          "(",$E7,$E7,$E5,$FF
   858                          
   859                          ; =================================
   860                          ; MINOTAUR -
   861                          ;   OBJECT TYPE:  $27
   862                          ;   OBJECT INDEX:
   863                          ;       $9C - RED MINOTAUR
   864                          ;       $9D - YELLOW MINOTAUR
   865                          ;       $9E - MAGENTA MINOTAUR
   866                          ;       $9F - WHITE MINOTAUR
   867                          ; The MINOTAUR is an boss level monster. Killing a MINOTAUR completes the game.
   868                          ;
   869                          MINOTAUR:
   870  070f  04040404              db          $04,$04,$04,$04
   871  0713  e8a1e901              db          $E8,$A1,$E9,$01
   872  0717  ebefefa101            db          $EB,$EF,$EF,$A1,$01
   873  071c  0202e0b8b4fbb1e4      db          $02,$02,$E0,$B8,$B4,$FB,$B1,$E4,$F0,$01
              f001              
   874  0726  0202f6e6fef4e8ed      db          $02,$02,$F6,$E6,$FE,$F4,$E8,$ED,$FD,$ED,$01
              fded01            
   875  0731  0202e9b5bfe1eafb      db          $02,$02,$E9,$B5,$BF,$E1,$EA,$FB,$FE,$FB,$01
              fefb01            
   876  073c  0202a1e0fe7ffdb9      db          $02,$02,$A1,$E0,$FE,$7F,$FD,$B9,$AD,$A1,$01
              ada101            
   877  0747  02a27fb4feb70102      db          $02,$A2,$7F,$B4,$FE,$B7,$01,$02,$BE,$B6,$00,$A2,$BE,$B4,$FF
              beb600a2beb4ff    
   878                          MINOTAUR_S:
   879  0756  04040404              db          $04,$04,$04,$04
   880  075a  00edbe01              db          $00,$ED,$BE,$01
   881  075e  d7e6b9d201            db          $D7,$E6,$B9,$D2,$01
   882  0763  0a8eedc201            db          "\n",$8E,$ED,$C2,$01
   883  0768  001683ff              db          $00,$16,$83,$FF
   884                          
   885                          
   886                          ; OTHER GRAPHICS
   887                          
   888                          ; STATS
   889                          ;   Stats labels are shown in the right side of the screen to identify a player's health and other statistics in real-time.
   890                          ;
   891                          STATS_TXT:
   892  076c  50485953d6535052      db          "PHYS",$D6,"SPRT",$FF
              54ff              
   893  0776  d600000000486561      db          $D6,$00,$00,$00,$00,"Health",$01
              6c746801          
   894  0782  d600000000536869      db          $D6,$00,$00,$00,$00,"Shield",$01
              656c6401          
   895  078e  d600000000576561      db          $D6,$00,$00,$00,$00,"Weapon",$FF
              706f6eff          
   896                          
   897                          ; COMPASS
   898                          ;   The compass is the right side of the screen, and points in the direction that the PLAYER is currently facing.
   899                          ;
   900                          COMPASS:
   901  079a  d76ec901              db          $D7,"n",$C9,$01
   902  079e  77086501              db          "w\be",$01
   903  07a2  c773d9ff              db          $C7,"s",$D9,$FF
   904                          
   905                          ; POOF Animation
   906                          ;   The POOF animation is played when a MONSTER or ITEM disappears.
   907                          ;       - For MONSTERS, it is when they are killed by the player. Their graphic is replaced with the POOF Animation, and then the empty maze space is rerendered as blank.
   908                          ;       = For ITEMS, they can disappear if they break or are used up (like a POTION). This occurs in the PLAYER's RIGHT HAND.
   909                          ;
   910                          POOF_1:
   911  07a6  d7c901                db          $D7,$C9,$01
   912  07a9  c7d9ff                db          $C7,$D9,$FF
   913                          POOF_2:
   914  07ac  d1d101                db          $D1,$D1,$01
   915  07af  d1d1ff                db          $D1,$D1,$FF
   916                          POOF_3:
   917  07b2  d1d1d1d101            db          $D1,$D1,$D1,$D1,$01
   918  07b7  d1d0d0d101            db          $D1,$D0,$D0,$D1,$01
   919  07bc  d1d0d0d101            db          $D1,$D0,$D0,$D1,$01
   920  07c1  d1d1d1d1ff            db          $D1,$D1,$D1,$D1,$FF
   921                          POOF_4:
   922  07c6  0100d0d001            db          $01,$00,$D0,$D0,$01
   923  07cb  00d0d0ff              db          $00,$D0,$D0,$FF
   924                          POOF_5:
   925  07cf  d0d0d0d001            db          $D0,$D0,$D0,$D0,$01
   926  07d4  d00000d001            db          $D0,$00,$00,$D0,$01
   927  07d9  d00000d001            db          $D0,$00,$00,$D0,$01
   928  07de  d0d0d0d0ff            db          $D0,$D0,$D0,$D0,$FF
   929                          POOF_6:
   930  07e3  2020202001            db          "    ",$01
   931  07e8  2020202001            db          "    ",$01
   932  07ed  2020202001            db          "    ",$01
   933  07f2  20202020ff            db          "    ",$FF
   934                          
   935                          ; AUTHORS
   936                          ;   The Author's credits can be viewed on the TITLE SCREEN when the A (About) key is pressed on the keyboard.
   937                          ;
   938                          AUTHORS:
   939  07f7  2020204f72696769      db          "   Originally programmed by Tom Loughry ",$01
              6e616c6c79207072  
              6f6772616d6d6564  
              20627920546f6d20  
              4c6f756768727920  
              01                
   940  0820  20204e6577204746      db          "  New GFX & routines by Sean Harrington ",$FF
              58202620726f7574  
              696e657320627920  
              5365616e20486172  
              72696e67746f6e20  
              ff                
   941                          
   942                          ; LEVEL_99_LOOP
   943                          ;   The level 99 overflow text is shown when the player completes maze level 99 without killing the MINOTAUR. Their level is set back to 90, and they continue playing.
   944                          ;
   945                          LEVEL_99_LOOP:
   946  0849  4c6f6f6b73206c69      db          "Looks like this dungeon",$01
              6b65207468697320  
              64756e67656f6e01  
   947  0861  697320746f6f2073      db          "is too small for you",$01
              6d616c6c20666f72  
              20796f7501        
   948  0876  736f207765207769      db          "so we will put you back",$01
              6c6c207075742079  
              6f75206261636b01  
   949  088e  696e746f2061206e      db          "into a new floor #90.",$FF
              657720666c6f6f72  
              202339302eff      
   950                          
   951                          ; THE END
   952                          ;   The end of game text is displayed when you defeat the MINOTAUR.
   953                          ;
   954                          THE_END_PART_A:
   955  08a4  204173746572696f      db          " Asterion, the minotaur ",$FF
              6e2c20746865206d  
              696e6f7461757220  
              ff                
   956                          THE_END_PART_B:
   957  08bd  2069732064656164      db          " is dead. ",$FF
              2e20ff            
   958                          
   959                          ; YOU_DIED
   960                          ;   The end of game text is displayed when the PLAYER dies.
   961                          ;
   962                          YOU_DIED_TXT:
   963  08c8  7fa0596f75206469      DB         $7F,$A0,"You died ",$FF
              656420ff          
   964                          
src/asterion.asm:
     7                          include "asterion_func_low.asm"
src/asterion_func_low.asm:
     1                          SUB_ram_c869:
     2  08d4  112900                LD          DE,$29                                 ;GRN on DKCYN
     3                                                                                  ;(bottom of closed door)
     4                          SUB_ram_c86c:
     5  08d7  77                    LD          (HL),A
     6  08d8  37                    SCF
     7  08d9  3f                    CCF
     8  08da  ed52                  SBC         HL,DE
     9                          SUB_ram_c871:
    10  08dc  77                    LD          (HL),A
    11  08dd  37                    SCF
    12  08de  3f                    CCF
    13  08df  ed52                  SBC         HL,DE
    14  08e1  77                    LD          (HL),A
    15  08e2  ed52                  SBC         HL,DE
    16  08e4  77                    LD          (HL),A
    17  08e5  c9                    RET
    18  08e6  112900                LD          DE,$29                                 ;GRN on DKCYN
    19                                                                                  ;(bottom of closed door)
    20                          SUB_ram_c87e:
    21  08e9  77                    LD          (HL),A
    22  08ea  19                    ADD         HL,DE
    23                          LAB_ram_c880:
    24  08eb  77                    LD          (HL),A
    25  08ec  19                    ADD         HL,DE
    26  08ed  77                    LD          (HL),A
    27  08ee  19                    ADD         HL,DE
    28  08ef  77                    LD          (HL),A
    29  08f0  c9                    RET
    30                          SUB_ram_c886:
    31  08f1  77                    LD          (HL),A
    32  08f2  19                    ADD         HL,DE
    33  08f3  77                    LD          (HL),A
    34  08f4  23                    INC         HL
    35  08f5  77                    LD          (HL),A
    36  08f6  19                    ADD         HL,DE
    37  08f7  23                    INC         HL
    38  08f8  77                    LD          (HL),A
    39  08f9  2b                    DEC         HL
    40  08fa  77                    LD          (HL),A
    41  08fb  2b                    DEC         HL
    42  08fc  77                    LD          (HL),A
    43  08fd  c9                    RET
    44                          SUB_ram_c893:
    45  08fe  77                    LD          (HL),A
    46  08ff  19                    ADD         HL,DE
    47  0900  77                    LD          (HL),A
    48  0901  2b                    DEC         HL
    49  0902  77                    LD          (HL),A
    50  0903  19                    ADD         HL,DE
    51  0904  23                    INC         HL
    52  0905  77                    LD          (HL),A
    53  0906  2b                    DEC         HL
    54  0907  77                    LD          (HL),A
    55  0908  2b                    DEC         HL
    56  0909  77                    LD          (HL),A
    57  090a  c9                    RET
    58                          SUB_ram_c8a0:
    59  090b  77                    LD          (HL),A
    60  090c  23                    INC         HL
    61  090d  77                    LD          (HL),A
    62  090e  23                    INC         HL
    63  090f  77                    LD          (HL),A
    64  0910  19                    ADD         HL,DE
    65  0911  2b                    DEC         HL
    66  0912  77                    LD          (HL),A
    67  0913  2b                    DEC         HL
    68  0914  77                    LD          (HL),A
    69  0915  19                    ADD         HL,DE
    70  0916  77                    LD          (HL),A
    71  0917  c9                    RET
    72                          SUB_ram_c8ad:
    73  0918  77                    LD          (HL),A
    74  0919  23                    INC         HL
    75  091a  77                    LD          (HL),A
    76  091b  23                    INC         HL
    77  091c  77                    LD          (HL),A
    78  091d  19                    ADD         HL,DE
    79  091e  2b                    DEC         HL
    80  091f  77                    LD          (HL),A
    81  0920  23                    INC         HL
    82  0921  77                    LD          (HL),A
    83  0922  19                    ADD         HL,DE
    84  0923  77                    LD          (HL),A
    85  0924  c9                    RET
    86                          DRAW_ROW:
    87  0925  77                    LD          (HL),A
    88  0926  05                    DEC         B
    89  0927  c8                    RET         Z
    90  0928  23                    INC         HL
    91  0929  c32509                JP          DRAW_ROW
    92  092c  112800                LD          DE,$28                                 ;DE = 40 (next line) / $28
    93                          DRAW_CELL:
    94  092f  77                    LD          (HL),A
    95  0930  0d                    DEC         C
    96  0931  c8                    RET         Z
    97  0932  19                    ADD         HL,DE                                   ;Goto next row
    98  0933  c32f09                JP          DRAW_CELL
    99                          FILL_CHRCOL_RECT:
   100  0936  112800                LD          DE,$28                                 ;DE = 40 / $28 (next row)
   101                          DRAW_CHRCOLS:
   102  0939  e5                    PUSH        HL
   103  093a  c5                    PUSH        BC
   104  093b  cd2509                CALL        DRAW_ROW
   105  093e  c1                    POP         BC
   106  093f  e1                    POP         HL
   107  0940  0d                    DEC         C
   108  0941  c8                    RET         Z
   109  0942  19                    ADD         HL,DE
   110  0943  c33909                JP          DRAW_CHRCOLS
   111                          DRAW_F0_WALL:
   112  0946  21cc34                LD          HL,COLRAM_F0_WALL_MAP_IDX               ;= $60    `
   113  0949  011010                LD          BC,$1010                               ;16 x 16 rectangle
   114  094c  3e44                  LD          A,$44                                  ;BLU on BLU
   115  094e  c33609                JP          FILL_CHRCOL_RECT
   116                          DRAW_F0_WALL_AND_CLOSED_DOOR:
   117  0951  cd4609                CALL        DRAW_F0_WALL
   118  0954  3e22                  LD          A,$22                                  ;GRN on GRN
   119                          DRAW_DOOR_F0:
   120  0956  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
   121  0959  010c08                LD          BC,$80c                                ;8 x 12 rectangle
   122  095c  c33609                JP          FILL_CHRCOL_RECT
   123                          DRAW_WALL_F0_AND_OPEN_DOOR:
   124  095f  cd4609                CALL        DRAW_F0_WALL
   125  0962  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
   126                                                                                  ;WAS BLK on DKBLU
   127                                                                                  ;WAS LD A,0xb
   128  0964  c35609                JP          DRAW_DOOR_F0
   129                          DRAW_WALL_F1:
   130  0967  217031                LD          HL,CHRRAM_F1_WALL_IDX                   ;= $20
   131  096a  010808                LD          BC,$808                                ;8 x 8 rectangle
   132  096d  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   133                                                                                  ;WAS d134 / $86 crosshatch char
   134                                                                                  ;WAS LD A, $86
   135  096f  cd3609                CALL        FILL_CHRCOL_RECT
   136  0972  0e08                  LD          C,0x8
   137  0974  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
   138  0977  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   139  0979  c33909                JP          DRAW_CHRCOLS
   140                          DRAW_WALL_F1_AND_CLOSED_DOOR:
   141  097c  cd6709                CALL        DRAW_WALL_F1
   142  097f  3e2d                  LD          A,$2d                                  ;GRN on DKGRN
   143                          DRAW_DOOR_F1_OPEN:
   144  0981  21c235                LD          HL,COLRAM_F1_DOOR_IDX                   ;= $60    `
   145  0984  010604                LD          BC,$406                                ;4 x 6 rectangle
   146  0987  c33609                JP          FILL_CHRCOL_RECT
   147                          DRAW_WALL_F1_AND_OPEN_DOOR:
   148  098a  cd6709                CALL        DRAW_WALL_F1
   149  098d  3e00                  LD          A,0x0                                   ;BLK on BLK
   150  098f  c38109                JP          DRAW_DOOR_F1_OPEN
   151                          DRAW_WALL_F2:
   152  0992  010404                LD          BC,$404                                ;4 x 4 rectangle
   153  0995  21c235                LD          HL,COLRAM_F1_DOOR_IDX                   ;= $60    `
   154  0998  3eff                  LD          A,$ff                                  ;DKGRY on DKGRY
   155                                                                                  ;WAS BLK on DKBLU
   156                                                                                  ;WAS LD A,0xb
   157  099a  c33609                JP          FILL_CHRCOL_RECT
   158                          DRAW_DOOR_F2_OPEN:
   159  099d  21c235                LD          HL,COLRAM_F1_DOOR_IDX                   ;= $60    `
   160  09a0  3e00                  LD          A,0x0                                   ;BLK on BLK
   161                          UPDATE_FO_ITEM:
   162  09a2  010404                LD          BC,$404                                ;4 x 4 rectangle
   163  09a5  c33609                JP          FILL_CHRCOL_RECT
   164                          DRAW_WALL_FL0:
   165  09a8  21a334                LD          HL,COLRAM_FL00_WALL_IDX                 ;= $60    `
   166  09ab  3e40                  LD          A,$40                                  ;BLU on BLK
   167                                                                                  ;WAS BLU on CYN
   168                                                                                  ;WAS LD A,$46
   169  09ad  cdd408                CALL        SUB_ram_c869
   170  09b0  1b                    DEC         DE
   171  09b1  19                    ADD         HL,DE
   172  09b2  3e04                  LD          A,0x4                                   ;BLK on BLU
   173  09b4  cdf108                CALL        SUB_ram_c886
   174  09b7  19                    ADD         HL,DE
   175  09b8  011004                LD          BC,$410                                ;Jump into COLRAM and down one row
   176  09bb  cd3909                CALL        DRAW_CHRCOLS
   177  09be  19                    ADD         HL,DE
   178  09bf  cd0b09                CALL        SUB_ram_c8a0
   179  09c2  19                    ADD         HL,DE
   180  09c3  3ef4                  LD          A,$f4                                  ;DKGRY on BLU
   181                                                                                  ;WAS DKCYN on BLU
   182                                                                                  ;WAS LD A,$94
   183  09c5  1b                    DEC         DE
   184  09c6  cdd708                CALL        SUB_ram_c86c
   185  09c9  3ec0                  LD          A,$c0
   186  09cb  21c033                LD          HL,DAT_ram_33c0                         ;= $20
   187  09ce  cdd708                CALL        SUB_ram_c86c
   188  09d1  212830                LD          HL,IDX_VIEWPORT_CHRRAM                  ;= $20
   189  09d4  3ec1                  LD          A,$c1
   190  09d6  13                    INC         DE
   191  09d7  13                    INC         DE
   192  09d8  c3e908                JP          SUB_ram_c87e
   193  09db  c9                    RET
   194                          DRAW_DOOR_FLO:
   195  09dc  cda809                CALL        DRAW_WALL_FL0
   196  09df  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
   197                                                                                  ;WAS DKCYN on DKBLU
   198                                                                                  ;WAS LD A,$9b
   199  09e1  08                    EX          AF,AF'
   200  09e2  3e04                  LD          A,0x4                                   ;BLK on BLU
   201                                                                                  ;WAS DKBLU on BLU
   202                                                                                  ;LD A,$b4
   203  09e4  c3ef09                JP          LAB_ram_c99e
   204                          SUB_ram_c996:
   205  09e7  cda809                CALL        DRAW_WALL_FL0
   206  09ea  3ef2                  LD          A,$f2                                  ;DKGRY on GRN
   207                                                                                  ;WAS DKCYN on GRN
   208                                                                                  ;WAS LD A,$92
   209  09ec  08                    EX          AF,AF'
   210  09ed  3e24                  LD          A,$24                                  ;GRN on BLU
   211                          LAB_ram_c99e:
   212  09ef  211a35                LD          HL,DAT_ram_351a                         ;= $60    `
   213  09f2  cddc08                CALL        SUB_ram_c871
   214  09f5  1b                    DEC         DE
   215  09f6  19                    ADD         HL,DE
   216  09f7  08                    EX          AF,AF'
   217  09f8  cdf108                CALL        SUB_ram_c886
   218  09fb  19                    ADD         HL,DE
   219  09fc  010c03                LD          BC,$30c
   220  09ff  cd3909                CALL        DRAW_CHRCOLS
   221  0a02  19                    ADD         HL,DE
   222  0a03  cd0b09                CALL        SUB_ram_c8a0
   223  0a06  19                    ADD         HL,DE
   224  0a07  1b                    DEC         DE
   225  0a08  cddc08                CALL        SUB_ram_c871
   226  0a0b  21c830                LD          HL,DAT_ram_30c8                         ;= $20
   227  0a0e  3ec1                  LD          A,$c1
   228  0a10  13                    INC         DE
   229  0a11  13                    INC         DE
   230  0a12  c3eb08                JP          LAB_ram_c880
   231  0a15  c9                    RET
   232                          SUB_ram_c9c5:
   233  0a16  21c834                LD          HL,DAT_ram_34c8                         ;= $60    `
   234  0a19  3e04                  LD          A,0x4                                   ;BLK on BLU
   235  0a1b  011004                LD          BC,$410                                ;4 x 10 rectangle
   236  0a1e  c33609                JP          FILL_CHRCOL_RECT
   237                          SUB_ram_c9d0:
   238  0a21  216831                LD          HL,DAT_ram_3168                         ;= $20
   239  0a24  010804                LD          BC,$408                                ;4 x 8 rectangle
   240  0a27  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   241                                                                                  ;WAS d134 / $86 crosshatch char
   242                                                                                  ;WAS LD A, $86
   243  0a29  cd3609                CALL        FILL_CHRCOL_RECT
   244  0a2c  216835                LD          HL,DAT_ram_3568                         ;= $60
   245  0a2f  0e08                  LD          C,0x8
   246  0a31  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   247  0a33  c33909                JP          DRAW_CHRCOLS
   248                          SUB_ram_c9e5:
   249  0a36  cd210a                CALL        SUB_ram_c9d0
   250  0a39  3edd                  LD          A,$dd                                  ;DKGRN on DKGRN
   251                          LAB_ram_c9ea:
   252  0a3b  21ba35                LD          HL,DAT_ram_35ba                         ;= $60    `
   253  0a3e  010602                LD          BC,$206                                ;2 x 6 rectangle
   254  0a41  c33909                JP          DRAW_CHRCOLS
   255                          SUB_ram_c9f3:
   256  0a44  cd210a                CALL        SUB_ram_c9d0
   257  0a47  af                    XOR         A
   258  0a48  c33b0a                JP          LAB_ram_c9ea
   259                          SUB_ram_c9f9:
   260  0a4b  216831                LD          HL,DAT_ram_3168                         ;= $20
   261  0a4e  3ec1                  LD          A,$c1
   262  0a50  77                    LD          (HL),A                    ;= $20
   263  0a51  112800                LD          DE,$28
   264  0a54  19                    ADD         HL,DE
   265  0a55  23                    INC         HL
   266  0a56  77                    LD          (HL),A                    ;= $20
   267  0a57  215932                LD          HL,DAT_ram_3259                         ;= $20
   268  0a5a  3ec0                  LD          A,$c0
   269  0a5c  77                    LD          (HL),A                    ;= $20
   270  0a5d  19                    ADD         HL,DE
   271  0a5e  2b                    DEC         HL
   272  0a5f  77                    LD          (HL),A                    ;= $20
   273  0a60  216835                LD          HL,DAT_ram_3568                         ;= $60
   274  0a63  3ebf                  LD          A,$bf                                  ;DKBLU on DKGRY
   275                                                                                  ;WAS DKBLU on DKCYN
   276                                                                                  ;WAS LD A,$b9
   277  0a65  77                    LD          (HL),A                    ;= $60
   278  0a66  19                    ADD         HL,DE
   279  0a67  23                    INC         HL
   280  0a68  77                    LD          (HL),A                    ;= $60
   281  0a69  2b                    DEC         HL
   282  0a6a  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   283                                                                                  ;WAS BLK on DKBLU
   284                                                                                  ;WAS LD A,0xb
   285  0a6c  77                    LD          (HL),A                    ;= $60
   286  0a6d  010402                LD          BC,$204                                ;2 x 4 rectangle
   287  0a70  19                    ADD         HL,DE             ;= $60    `
   288  0a71  cd3909                CALL        DRAW_CHRCOLS
   289  0a74  19                    ADD         HL,DE
   290  0a75  77                    LD          (HL),A                    ;= $60
   291  0a76  23                    INC         HL
   292  0a77  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   293                                                                                  ;WAS DKCYN on DKBLU
   294                                                                                  ;WAS LD A,$9b
   295  0a79  77                    LD          (HL),A                    ;= $60
   296  0a7a  19                    ADD         HL,DE
   297  0a7b  2b                    DEC         HL
   298  0a7c  77                    LD          (HL),A                    ;= $60
   299  0a7d  21ba35                LD          HL,DAT_ram_35ba                         ;= $60    `
   300  0a80  0e04                  LD          C,0x4
   301  0a82  3e00                  LD          A,0x0
   302  0a84  c33909                JP          DRAW_CHRCOLS
   303                          DRAW_WALL_FL22:
   304  0a87  21b835                LD          HL,COLRAM_FL22_WALL_IDX                 ;= $60    `
   305  0a8a  010404                LD          BC,$404                                ;4 x 4 rectangle
   306  0a8d  3eff                  LD          A,$ff                                  ;DKGRY on DKGRY
   307  0a8f  c33609                JP          FILL_CHRCOL_RECT
   308                          DRAW_L1_WALL:
   309  0a92  214731                LD          HL,CHRRAM_FL1_WALL_IDX                  ;= $20
   310  0a95  3ec1                  LD          A,$c1                                  ;LEFT angle CHR
   311  0a97  cdd408                CALL        SUB_ram_c869
   312  0a9a  1b                    DEC         DE
   313  0a9b  19                    ADD         HL,DE
   314  0a9c  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   315                                                                                  ;WAS d134 / $86 crosshatch char
   316                                                                                  ;WAS LD A, $86
   317  0a9e  cdf108                CALL        SUB_ram_c886
   318  0aa1  19                    ADD         HL,DE
   319  0aa2  010804                LD          BC,$408                                ;4 x 8 rectangle
   320  0aa5  cd3909                CALL        DRAW_CHRCOLS
   321  0aa8  19                    ADD         HL,DE
   322  0aa9  cd0b09                CALL        SUB_ram_c8a0
   323  0aac  19                    ADD         HL,DE
   324  0aad  3ec0                  LD          A,$c0                                  ;RIGHT angle CHR
   325  0aaf  1b                    DEC         DE
   326  0ab0  cdd708                CALL        SUB_ram_c86c
   327  0ab3  214735                LD          HL,DAT_ram_3547                         ;= $60    `
   328  0ab6  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
   329                                                                                  ;WAS DKBLU on CYN
   330                                                                                  ;WAS LD A,$b6
   331  0ab8  cdd408                CALL        SUB_ram_c869
   332  0abb  1b                    DEC         DE
   333  0abc  19                    ADD         HL,DE
   334  0abd  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   335  0abf  cdf108                CALL        SUB_ram_c886
   336  0ac2  19                    ADD         HL,DE
   337  0ac3  010804                LD          BC,$408                                ;Jump to COLRAM + 32 cells
   338  0ac6  cd3909                CALL        DRAW_CHRCOLS
   339  0ac9  19                    ADD         HL,DE
   340  0aca  cd0b09                CALL        SUB_ram_c8a0
   341  0acd  19                    ADD         HL,DE
   342  0ace  3efb                  LD          A,$fb                                  ;DKGRY on DKBLU
   343                                                                                  ;WAS DKCYN on DKBLU
   344                                                                                  ;WAS LD A,$9b
   345  0ad0  1b                    DEC         DE
   346  0ad1  c3d708                JP          SUB_ram_c86c
   347  0ad4  c9                    RET
   348                          DRAW_FL1_DOOR:
   349  0ad5  cd920a                CALL        DRAW_L1_WALL
   350  0ad8  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
   351                                                                                  ;WAS DKCYN on BLK
   352                                                                                  ;WAS LD A,$90
   353  0ada  f5                    PUSH        AF
   354  0adb  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
   355  0add  f5                    PUSH        AF
   356  0ade  3e0b                  LD          A,0xb                                   ;BLK on DKGRY
   357                                                                                  ;WAS BLK on DKBLU
   358                                                                                  ;WAS LD A,0xb
   359  0ae0  c3ee0a                JP          DRAW_L1_DOOR
   360                          DRAW_L1:
   361  0ae3  cd920a                CALL        DRAW_L1_WALL
   362  0ae6  3efd                  LD          A,$fd                                  ;DKGRY on DKGRN
   363                                                                                  ;WAS DKCYN on DKGRN
   364                                                                                  ;WAS LD A,$9d
   365  0ae8  f5                    PUSH        AF
   366  0ae9  3e2d                  LD          A,$2d                                  ;GRN on DKGRN
   367  0aeb  f5                    PUSH        AF
   368  0aec  3edb                  LD          A,$db                                  ;DKGRN on DKBLU
   369                          DRAW_L1_DOOR:
   370  0aee  216d35                LD          HL,COLRAM_L1_DOOR_IDX                   ;= $60    `
   371  0af1  010702                LD          BC,$207                                ;2 x 7 rectangle
   372  0af4  cd700b                CALL        SUB_ram_cb1c
   373  0af7  216d31                LD          HL,CHRRAM_L1_DOOR_IDX                   ;= $20
   374  0afa  3ec1                  LD          A,$c1                                  ;LEFT ANGLE CHR
   375  0afc  77                    LD          (HL),A              ;= $20
   376  0afd  112900                LD          DE,$29
   377  0b00  19                    ADD         HL,DE
   378  0b01  77                    LD          (HL),A                    ;= $20
   379  0b02  c9                    RET
   380                          SUB_ram_cab0:
   381  0b03  216c35                LD          HL,DAT_ram_356c                         ;= $60    `
   382  0b06  010804                LD          BC,$408                                ;4 x 8 rectangle
   383  0b09  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   384  0b0b  cd3609                CALL        FILL_CHRCOL_RECT
   385  0b0e  216c31                LD          HL,DAT_ram_316c                         ;= $20
   386  0b11  0e08                  LD          C,0x8
   387  0b13  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   388                                                                                  ;WAS d134 / $86 crosshatch char
   389                                                                                  ;WAS LD A, $86
   390  0b15  c33909                JP          DRAW_CHRCOLS
   391                          SUB_ram_cac5:
   392  0b18  cd030b                CALL        SUB_ram_cab0
   393  0b1b  af                    XOR         A
   394  0b1c  c3240b                JP          DRAW_L1_DOOR_2
   395                          DRAW_L1_DOOR_CLOSED:
   396  0b1f  cd030b                CALL        SUB_ram_cab0
   397  0b22  3edd                  LD          A,$dd                                  ;DKGRN on DKGRN
   398                          DRAW_L1_DOOR_2:
   399  0b24  21bc35                LD          HL,COLRAM_FL2_WALL_IDX                  ;= $60    `
   400  0b27  010602                LD          BC,$206                                ;2 x 6 rectangle
   401  0b2a  c33909                JP          DRAW_CHRCOLS
   402                          DRAW_WALL_FL2:
   403  0b2d  21bc35                LD          HL,COLRAM_FL2_WALL_IDX                  ;= $60    `
   404  0b30  010402                LD          BC,$204                                ;2 x 4 rectangle
   405  0b33  3e11                  LD          A,$11                                  ;BLK on DKGRY
   406  0b35  cd3609                CALL        FILL_CHRCOL_RECT
   407  0b38  0e04                  LD          C,0x4
   408  0b3a  21be35                LD          HL,COLRAM_FL2_PLUS_WALL_IDX             ;= $60    `
   409  0b3d  3e22                  LD          A,$22                                  ;BLK on DKGRY
   410                                                                                  ;WAS BLK on DKBLU
   411                                                                                  ;WAS LD A,0xb
   412  0b3f  c33909                JP          DRAW_CHRCOLS
   413                          DRAW_WALL_FL2_EMPTY:
   414  0b42  21bc35                LD          HL,COLRAM_FL2_WALL_IDX                  ;= $60    `
   415  0b45  010404                LD          BC,$404                                ;4 x 4 rectangle
   416  0b48  3e00                  LD          A,0x0                                   ;BLK on BLK
   417  0b4a  c33609                JP          FILL_CHRCOL_RECT
   418                          DRAW_WALL_L2:
   419  0b4d  3eca                  LD          A,$ca                                  ;Right slash char
   420  0b4f  f5                    PUSH        AF
   421  0b50  3e20                  LD          A,$20                                  ;GRN on BLK
   422  0b52  f5                    PUSH        AF
   423  0b53  217031                LD          HL,CHRRAM_F1_WALL_IDX                   ;= $20
   424  0b56  3ec1                  LD          A,$c1                                  ;Left angle char
   425  0b58  010402                LD          BC,$204                                ;2 x 4 rectangle
   426  0b5b  cd700b                CALL        SUB_ram_cb1c
   427  0b5e  3e0f                  LD          A,0xf                                   ;FL2 Bottom Color
   428                                                                                  ;BLK on DKGRY
   429                                                                                  ;WAS DKCYN on DKBLU
   430                                                                                  ;WAS LD A,$9b
   431  0b60  f5                    PUSH        AF
   432  0b61  3e0f                  LD          A,0xf                                   ;FL2 Wall Color
   433                                                                                  ;BLK on DKGRY
   434                                                                                  ;WAS BLK on DKBLU
   435                                                                                  ;WAS LD A,0xb
   436  0b63  f5                    PUSH        AF
   437  0b64  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
   438  0b67  3ef0                  LD          A,$f0                                  ;FL2 Top Color
   439                                                                                  ;DKGRY on BLK
   440                                                                                  ;WAS DKBLU on CYN
   441                                                                                  ;WAS LD A,$b6
   442  0b69  010402                LD          BC,$204                                ;2 x 4 rectangle
   443  0b6c  cd700b                CALL        SUB_ram_cb1c
   444  0b6f  c9                    RET
   445                          SUB_ram_cb1c:
   446  0b70  dde1                  POP         IX
   447  0b72  77                    LD          (HL),A
   448  0b73  112900                LD          DE,$29                                 ;EDIT MEdb?
   449  0b76  19                    ADD         HL,DE
   450  0b77  77                    LD          (HL),A
   451  0b78  2b                    DEC         HL
   452  0b79  1b                    DEC         DE
   453  0b7a  f1                    POP         AF
   454  0b7b  77                    LD          (HL),A
   455  0b7c  19                    ADD         HL,DE
   456  0b7d  cd3909                CALL        DRAW_CHRCOLS
   457  0b80  19                    ADD         HL,DE
   458  0b81  77                    LD          (HL),A
   459  0b82  19                    ADD         HL,DE
   460  0b83  f1                    POP         AF
   461  0b84  77                    LD          (HL),A
   462  0b85  37                    SCF
   463  0b86  3f                    CCF
   464  0b87  ed52                  SBC         HL,DE
   465  0b89  23                    INC         HL
   466  0b8a  77                    LD          (HL),A
   467  0b8b  dde9                  JP          (IX)
   468                          DRAW_WALL_L2_C:
   469  0b8d  21c035                LD          HL,DAT_ram_35c0                         ;= $60    `
   470  0b90  010402                LD          BC,$204                                ;2 x 4 rectangle
   471  0b93  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   472                                                                                  ;WAS BLK on DKBLU
   473                                                                                  ;WAS LD A,0xb
   474  0b95  c33609                JP          FILL_CHRCOL_RECT
   475                          DRAW_WALL_L2_C_EMPTY:
   476  0b98  21c035                LD          HL,DAT_ram_35c0                         ;= $60    `
   477  0b9b  010402                LD          BC,$204                                ;2 x 4 rectangle
   478  0b9e  3e00                  LD          A,0x0                                   ;BLK on BLK
   479  0ba0  c33609                JP          FILL_CHRCOL_RECT
   480                          SUB_ram_cb4f:
   481  0ba3  3ef4                  LD          A,$f4                                  ;DKGRY on BLU
   482                                                                                  ;WAS DKCYN on BLU
   483                                                                                  ;WAS LD A,$94
   484  0ba5  f5                    PUSH        AF
   485  0ba6  011004                LD          BC,$410
   486  0ba9  3e04                  LD          A,0x4                                   ;BLK on BLU
   487  0bab  f5                    PUSH        AF
   488  0bac  3e40                  LD          A,$40                                  ;BLU on BLK
   489                                                                                  ;WAS BLU on CYN
   490                                                                                  ;WAS LD A, $46
   491  0bae  21b434                LD          HL,DAT_ram_34b4                         ;= $60    `
   492  0bb1  cda30c                CALL        SUB_ram_cc4d
   493  0bb4  213f30                LD          HL,DAT_ram_303f                         ;= $20
   494  0bb7  3ec0                  LD          A,$c0                                  ;Right angle char
   495  0bb9  112700                LD          DE,$27
   496  0bbc  cde908                CALL        SUB_ram_c87e
   497  0bbf  215c33                LD          HL,DAT_ram_335c                         ;= $20
   498  0bc2  3c                    INC         A
   499  0bc3  13                    INC         DE
   500  0bc4  13                    INC         DE
   501  0bc5  c3e908                JP          SUB_ram_c87e
   502                          DRAW_FRO_DOOR:
   503  0bc8  cda30b                CALL        SUB_ram_cb4f
   504  0bcb  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
   505                                                                                  ;WAS DKCYN on DKBLU
   506                                                                                  ;WAS LD A,$9b
   507  0bcd  08                    EX          AF,AF'
   508  0bce  3e04                  LD          A,0x4                                   ;BLK on BLU
   509                                                                                  ;WAS DKBLU on BLU
   510                                                                                  ;WAS LDA A,$b4
   511  0bd0  c3db0b                JP          LAB_ram_cb86
   512                          SUB_ram_cb7e:
   513  0bd3  cda30b                CALL        SUB_ram_cb4f
   514  0bd6  3ef2                  LD          A,$f2                                  ;DKGRY on GRN
   515                                                                                  ;WAS DKCYN on GRN
   516                                                                                  ;WAS LD A,$92
   517  0bd8  08                    EX          AF,AF'
   518  0bd9  3e24                  LD          A,$24                                  ;GRN on BLU
   519                          LAB_ram_cb86:
   520  0bdb  212d35                LD          HL,DAT_ram_352d                         ;= $60    `
   521  0bde  1b                    DEC         DE
   522  0bdf  1b                    DEC         DE
   523  0be0  cddc08                CALL        SUB_ram_c871
   524  0be3  13                    INC         DE
   525  0be4  19                    ADD         HL,DE
   526  0be5  08                    EX          AF,AF'
   527  0be6  cdfe08                CALL        SUB_ram_c893
   528  0be9  19                    ADD         HL,DE
   529  0bea  010c03                LD          BC,$30c
   530  0bed  cd3909                CALL        DRAW_CHRCOLS
   531  0bf0  19                    ADD         HL,DE
   532  0bf1  cd1809                CALL        SUB_ram_c8ad
   533  0bf4  19                    ADD         HL,DE
   534  0bf5  13                    INC         DE
   535  0bf6  cddc08                CALL        SUB_ram_c871
   536  0bf9  21df30                LD          HL,DAT_ram_30df                         ;= $20
   537  0bfc  3ec0                  LD          A,$c0                                  ;Right angle char
   538  0bfe  1b                    DEC         DE
   539  0bff  1b                    DEC         DE
   540  0c00  c3eb08                JP          LAB_ram_c880
   541                          SUB_ram_cbae:
   542  0c03  21dc34                LD          HL,DAT_ram_34dc                         ;= $60    `
   543  0c06  3e04                  LD          A,0x4                                   ;BLK on BLU
   544  0c08  011004                LD          BC,$410                                ;4 x 10 rectangle
   545  0c0b  c33609                JP          FILL_CHRCOL_RECT
   546                          SUB_ram_cbb9:
   547  0c0e  217c31                LD          HL,DAT_ram_317c                         ;= $20
   548  0c11  010804                LD          BC,$408
   549  0c14  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   550                                                                                  ;WAS d134 / $86 crosshatch char
   551                                                                                  ;WAS LD A, $86
   552  0c16  cd3609                CALL        FILL_CHRCOL_RECT
   553  0c19  217c35                LD          HL,DAT_ram_357c                         ;= $60    `
   554  0c1c  0e08                  LD          C,0x8
   555  0c1e  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   556  0c20  c33909                JP          DRAW_CHRCOLS
   557                          SUB_ram_cbce:
   558  0c23  cd0e0c                CALL        SUB_ram_cbb9
   559  0c26  af                    XOR         A
   560  0c27  c32f0c                JP          LAB_ram_cbd9
   561                          SUB_ram_cbd4:
   562  0c2a  cd0e0c                CALL        SUB_ram_cbb9
   563  0c2d  3edd                  LD          A,$dd                                  ;DKGRN on DKGRNdb?
   564                          LAB_ram_cbd9:
   565  0c2f  21cc35                LD          HL,DAT_ram_35cc                         ;= $60    `
   566  0c32  010602                LD          BC,$206                                ;2 x 6 rectangledb?
   567  0c35  c33909                JP          DRAW_CHRCOLS
   568                          SUB_ram_cbe2:
   569  0c38  217f31                LD          HL,DAT_ram_317f                         ;= $20
   570  0c3b  3ec0                  LD          A,$c0                                  ;Right angle char
   571  0c3d  77                    LD          (HL),A                    ;= $20
   572  0c3e  112800                LD          DE,$28
   573  0c41  19                    ADD         HL,DE
   574  0c42  2b                    DEC         HL
   575  0c43  77                    LD          (HL),A                    ;= $20
   576  0c44  216e32                LD          HL,DAT_ram_326e                         ;= $20
   577  0c47  3ec1                  LD          A,$c1                                  ;Left angle char
   578  0c49  77                    LD          (HL),A                    ;= $20
   579  0c4a  19                    ADD         HL,DE
   580  0c4b  23                    INC         HL
   581  0c4c  77                    LD          (HL),A                    ;= $20
   582  0c4d  217f35                LD          HL,DAT_ram_357f                         ;= $60
   583  0c50  3ebf                  LD          A,$bf                                  ;DKBLU on DKGRY
   584                                                                                  ;WAS DKBLU on DKCYN
   585                                                                                  ;WAS LD A,$b9
   586  0c52  77                    LD          (HL),A                    ;= $60
   587  0c53  19                    ADD         HL,DE
   588  0c54  2b                    DEC         HL
   589  0c55  77                    LD          (HL),A                    ;= $60
   590  0c56  23                    INC         HL
   591  0c57  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   592                                                                                  ;WAS BLK on DKBLU
   593                                                                                  ;WAS LD A,0xb
   594  0c59  77                    LD          (HL),A                    ;= $60
   595  0c5a  010402                LD          BC,$204                                ;2 x 4 rectangle
   596  0c5d  19                    ADD         HL,DE
   597  0c5e  2b                    DEC         HL                        ;= $60    `
   598  0c5f  cd3909                CALL        DRAW_CHRCOLS
   599  0c62  19                    ADD         HL,DE
   600  0c63  23                    INC         HL
   601  0c64  77                    LD          (HL),A                    ;= $60
   602  0c65  2b                    DEC         HL
   603  0c66  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   604                                                                                  ;WAS DKCYN on DKBLU
   605                                                                                  ;WAS LD A,$9b
   606  0c68  77                    LD          (HL),A                    ;= $60
   607  0c69  19                    ADD         HL,DE
   608  0c6a  23                    INC         HL
   609  0c6b  77                    LD          (HL),A                    ;= $60
   610  0c6c  21cc35                LD          HL,DAT_ram_35cc                         ;= $60    `
   611  0c6f  0e04                  LD          C,0x4
   612  0c71  3e00                  LD          A,0x0
   613  0c73  c33909                JP          DRAW_CHRCOLS
   614                          DRAW_WALL_FR222_EMPTY:
   615  0c76  21cc35                LD          HL,DAT_ram_35cc                         ;= $60    `
   616  0c79  010404                LD          BC,$404                                ;4 x 4 rectangle
   617  0c7c  3e00                  LD          A,0x0                                   ;BLK on BLK
   618  0c7e  c33609                JP          FILL_CHRCOL_RECT
   619                          DRAW_WALL_FR1:
   620  0c81  3ec1                  LD          A,$c1
   621  0c83  f5                    PUSH        AF
   622  0c84  010804                LD          BC,$408                                ;4 x 8 rectangle
   623  0c87  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   624                                                                                  ;WAS d134 / $86 crosshatch char
   625                                                                                  ;WAS LD A, $86
   626  0c89  f5                    PUSH        AF
   627  0c8a  3ec0                  LD          A,$c0                                  ;Right angle char
   628  0c8c  215031                LD          HL,DAT_ram_3150                         ;= $20
   629  0c8f  cda30c                CALL        SUB_ram_cc4d
   630  0c92  3efb                  LD          A,$fb                                  ;DKGRY on DKBLU
   631                                                                                  ;WAS DKCYN on DKBLU
   632                                                                                  ;WAS LD $9b
   633  0c94  f5                    PUSH        AF
   634  0c95  0e08                  LD          C,0x8
   635  0c97  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   636  0c99  f5                    PUSH        AF
   637  0c9a  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
   638                                                                                  ;WAS DKBLU on CYN
   639                                                                                  ;WAS LD A,$b6
   640  0c9c  215035                LD          HL,DAT_ram_3550                         ;= $60    `
   641  0c9f  cda30c                CALL        SUB_ram_cc4d
   642  0ca2  c9                    RET
   643                          SUB_ram_cc4d:
   644  0ca3  dde1                  POP         IX
   645  0ca5  112700                LD          DE,$27
   646  0ca8  cdd708                CALL        SUB_ram_c86c
   647  0cab  13                    INC         DE
   648  0cac  19                    ADD         HL,DE
   649  0cad  f1                    POP         AF
   650  0cae  cdfe08                CALL        SUB_ram_c893
   651  0cb1  19                    ADD         HL,DE
   652  0cb2  2b                    DEC         HL
   653  0cb3  cd3909                CALL        DRAW_CHRCOLS
   654  0cb6  19                    ADD         HL,DE
   655  0cb7  23                    INC         HL
   656  0cb8  cd1809                CALL        SUB_ram_c8ad
   657  0cbb  19                    ADD         HL,DE
   658  0cbc  f1                    POP         AF
   659  0cbd  13                    INC         DE
   660  0cbe  cdd708                CALL        SUB_ram_c86c
   661  0cc1  dde9                  JP          (IX)
   662                          SUB_ram_cc6d:
   663  0cc3  cd810c                CALL        DRAW_WALL_FR1
   664  0cc6  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
   665                                                                                  ;WAS DKCYN on BLK
   666                                                                                  ;WAS LD A,$90
   667  0cc8  f5                    PUSH        AF
   668  0cc9  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
   669  0ccb  f5                    PUSH        AF
   670  0ccc  3e0b                  LD          A,0xb                                   ;BLK on DKBLU
   671  0cce  c3dc0c                JP          LAB_ram_cc85
   672                          SUB_ram_cc7a:
   673  0cd1  cd810c                CALL        DRAW_WALL_FR1
   674  0cd4  3efd                  LD          A,$fd                                  ;DKGRY on DKGRN
   675                                                                                  ;WAS DKCYN on DKGRN
   676                                                                                  ;WAS LD A,$9d
   677  0cd6  f5                    PUSH        AF
   678  0cd7  3e2d                  LD          A,$2d                                  ;GRN on DKGRN
   679  0cd9  f5                    PUSH        AF
   680  0cda  3edb                  LD          A,$db                                  ;DKGRN on DKBLU
   681                          LAB_ram_cc85:
   682  0cdc  217a35                LD          HL,DAT_ram_357a                         ;= $60    `
   683  0cdf  010702                LD          BC,$207                                ;2 x 7 rectangle
   684  0ce2  cd5f0d                CALL        SUB_ram_cd07
   685  0ce5  217a31                LD          HL,DAT_ram_317a                         ;= $20
   686  0ce8  3ec0                  LD          A,$c0                                  ;Right angle char
   687  0cea  77                    LD          (HL),A                    ;= $20
   688  0ceb  112700                LD          DE,$27
   689  0cee  19                    ADD         HL,DE
   690  0cef  77                    LD          (HL),A                    ;= $20
   691  0cf0  c9                    RET
   692                          SUB_ram_cc9a:
   693  0cf1  217835                LD          HL,DAT_ram_3578                         ;= $60    `
   694  0cf4  010804                LD          BC,$408                                ;4 x 8 rectangle
   695  0cf7  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   696  0cf9  cd3609                CALL        FILL_CHRCOL_RECT
   697  0cfc  217831                LD          HL,DAT_ram_3178                         ;= $20
   698  0cff  0e08                  LD          C,0x8
   699  0d01  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   700                                                                                  ;WAS d134 / $86 crosshatch char
   701                                                                                  ;WAS LD A, $86
   702  0d03  c33909                JP          DRAW_CHRCOLS
   703                          SUB_ram_ccaf:
   704  0d06  cdf10c                CALL        SUB_ram_cc9a
   705  0d09  af                    XOR         A
   706  0d0a  c3120d                JP          LAB_ram_ccba
   707                          SUB_ram_ccb5:
   708  0d0d  cdf10c                CALL        SUB_ram_cc9a
   709  0d10  3edd                  LD          A,$dd                                  ;DKGRN on DKGRN
   710                          LAB_ram_ccba:
   711  0d12  21ca35                LD          HL,DAT_ram_35ca                         ;= $60    `
   712  0d15  010602                LD          BC,$206                                ;2 x 6 rectangle
   713  0d18  c33909                JP          DRAW_CHRCOLS
   714                          SUB_ram_ccc3:
   715  0d1b  21ca35                LD          HL,DAT_ram_35ca                         ;= $60    `
   716  0d1e  010402                LD          BC,$204                                ;2 x 4 rectangle
   717  0d21  3e00                  LD          A,0x0                                   ;BLK on BLK
   718  0d23  cd3609                CALL        FILL_CHRCOL_RECT
   719  0d26  0e04                  LD          C,0x4
   720  0d28  21c835                LD          HL,DAT_ram_35c8                         ;= $60    `
   721  0d2b  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   722                                                                                  ;WAS BLK on DKBLU
   723                                                                                  ;WAS LD A, 0xb
   724  0d2d  c33909                JP          DRAW_CHRCOLS
   725                          DRAW_WALL_FR2_EMPTY:
   726  0d30  21c835                LD          HL,DAT_ram_35c8                         ;= $60    `
   727  0d33  010404                LD          BC,$404                                ;4 x 4 rectangle
   728  0d36  3e00                  LD          A,0x0                                   ;BLK on BLK
   729  0d38  c33609                JP          FILL_CHRCOL_RECT
   730                          DRAW_WALL_FR2:
   731  0d3b  3e0f                  LD          A,0xf                                   ;FR2 Bottom
   732                                                                                  ;BLK on DKGRY
   733                                                                                  ;WAS DKCYN on DKBLU
   734                                                                                  ;WAS LD A,$9b
   735  0d3d  f5                    PUSH        AF
   736  0d3e  3e0f                  LD          A,0xf                                   ;FR2 Wall
   737                                                                                  ;BLK on DKGRY
   738                                                                                  ;WAS BLK on DKBLU
   739                                                                                  ;WAS LD A,0xb
   740  0d40  f5                    PUSH        AF
   741  0d41  3ef0                  LD          A,$f0                                  ;FR2 Top
   742                                                                                  ;DKGRY on BLK
   743                                                                                  ;WAS DKBLU on CYN
   744                                                                                  ;WAS LD A,$b6
   745  0d43  217735                LD          HL,DAT_ram_3577                         ;= $60    `
   746  0d46  010402                LD          BC,$204                                ;2 x 4 rectangle
   747  0d49  cd5f0d                CALL        SUB_ram_cd07
   748  0d4c  216632                LD          HL,DAT_ram_3266                         ;= $20
   749  0d4f  3eda                  LD          A,$da                                  ;Left slash char
   750  0d51  77                    LD          (HL),A                    ;= $20
   751  0d52  19                    ADD         HL,DE
   752  0d53  77                    LD          (HL),A                    ;= $20
   753  0d54  217731                LD          HL,DAT_ram_3177                         ;= $20
   754  0d57  3ec0                  LD          A,$c0                                  ;Right angle char
   755  0d59  77                    LD          (HL),A                    ;= $20
   756  0d5a  1b                    DEC         DE
   757  0d5b  1b                    DEC         DE
   758  0d5c  19                    ADD         HL,DE
   759  0d5d  77                    LD          (HL),A                    ;= $20
   760  0d5e  c9                    RET
   761                          SUB_ram_cd07:
   762  0d5f  dde1                  POP         IX
   763  0d61  77                    LD          (HL),A
   764  0d62  112700                LD          DE,$27
   765  0d65  19                    ADD         HL,DE
   766  0d66  77                    LD          (HL),A
   767  0d67  23                    INC         HL
   768  0d68  f1                    POP         AF
   769  0d69  77                    LD          (HL),A
   770  0d6a  19                    ADD         HL,DE
   771  0d6b  13                    INC         DE
   772  0d6c  cd3909                CALL        DRAW_CHRCOLS
   773  0d6f  13                    INC         DE
   774  0d70  19                    ADD         HL,DE
   775  0d71  77                    LD          (HL),A
   776  0d72  2b                    DEC         HL
   777  0d73  f1                    POP         AF
   778  0d74  77                    LD          (HL),A
   779  0d75  19                    ADD         HL,DE
   780  0d76  77                    LD          (HL),A
   781  0d77  dde9                  JP          (IX)
   782                          SUB_ram_cd21:
   783  0d79  21c635                LD          HL,DAT_ram_35c6                         ;= $60    `
   784  0d7c  010402                LD          BC,$204                                ;2 x 4 rectangle
   785  0d7f  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   786                                                                                  ;WAS BLK on DKBLU
   787                                                                                  ;WAS LD A,0xb
   788  0d81  c33609                JP          FILL_CHRCOL_RECT
   789                          SUB_ram_cd2c:
   790  0d84  21c635                LD          HL,DAT_ram_35c6                         ;= $60    `
   791  0d87  010402                LD          BC,$204                                ;2 x 4 rectangle
   792  0d8a  3e00                  LD          A,0x0                                   ;BLK on BLK
   793  0d8c  c33609                JP          FILL_CHRCOL_RECT
   794  0d8f  3e08                  LD          A,0x8
   795  0d91  32b83a                LD          (SOUND_REPEAT_COUNT),A
   796  0d94  47                    LD          B,A
   797                          LAB_ram_cd3d:
   798  0d95  c5                    PUSH        BC
   799  0d96  cdb50e                CALL        SOUND_04
   800  0d99  cd400e                CALL        SUB_ram_cde7
   801  0d9c  cd8d0e                CALL        SOUND_02
   802  0d9f  cd790e                CALL        SOUND_01
   803  0da2  c1                    POP         BC
   804  0da3  10f0                  DJNZ        LAB_ram_cd3d
   805  0da5  c9                    RET
   806  0da6  3e07                  LD          A,0x7
   807  0da8  32b83a                LD          (SOUND_REPEAT_COUNT),A
   808  0dab  47                    LD          B,A
   809                          LAB_ram_cd54:
   810  0dac  c5                    PUSH        BC
   811  0dad  cd8d0e                CALL        SOUND_02
   812  0db0  cda10e                CALL        SOUND_03
   813  0db3  c1                    POP         BC
   814  0db4  10f6                  DJNZ        LAB_ram_cd54
   815  0db6  c9                    RET
   816                          SUB_ram_cd5f:
   817  0db7  3e0a                  LD          A,0xa
   818  0db9  32b83a                LD          (SOUND_REPEAT_COUNT),A
   819  0dbc  47                    LD          B,A
   820                          LAB_ram_cd65:
   821  0dbd  c5                    PUSH        BC
   822  0dbe  cdb50e                CALL        SOUND_04
   823  0dc1  cdc90e                CALL        SOUND_05
   824  0dc4  c1                    POP         BC
   825  0dc5  10f6                  DJNZ        LAB_ram_cd65
   826  0dc7  c3180e                JP          SUB_ram_cdbf
   827                          POOF_SOUND:
   828  0dca  3e07                  LD          A,0x7
   829  0dcc  32b83a                LD          (SOUND_REPEAT_COUNT),A
   830  0dcf  0601                  LD          B,0x1
   831  0dd1  c3da0d                JP          DOINK_SOUND
   832                          END_OF_GAME_SOUND:
   833  0dd4  3e04                  LD          A,0x4                                   ;Was LD A,0x7
   834  0dd6  32b83a                LD          (SOUND_REPEAT_COUNT),A
   835  0dd9  47                    LD          B,A
   836                          DOINK_SOUND:
   837  0dda  c5                    PUSH        BC
   838  0ddb  cd8d0e                CALL        SOUND_02
   839  0dde  cd400e                CALL        SUB_ram_cde7
   840  0de1  cda10e                CALL        SOUND_03
   841  0de4  c1                    POP         BC
   842  0de5  10f3                  DJNZ        DOINK_SOUND
   843  0de7  c9                    RET
   844  0de8  cd400e                CALL        SUB_ram_cde7
   845  0deb  cd400e                CALL        SUB_ram_cde7
   846  0dee  cd400e                CALL        SUB_ram_cde7
   847  0df1  cd400e                CALL        SUB_ram_cde7
   848  0df4  cd400e                CALL        SUB_ram_cde7
   849  0df7  cd400e                CALL        SUB_ram_cde7
   850  0dfa  cd400e                CALL        SUB_ram_cde7
   851  0dfd  cd400e                CALL        SUB_ram_cde7
   852  0e00  cd400e                CALL        SUB_ram_cde7
   853  0e03  cd400e                CALL        SUB_ram_cde7
   854  0e06  cd400e                CALL        SUB_ram_cde7
   855  0e09  cdc90e                CALL        SOUND_05
   856  0e0c  cdc90e                CALL        SOUND_05
   857  0e0f  cdc90e                CALL        SOUND_05
   858  0e12  cdc90e                CALL        SOUND_05
   859  0e15  c3c90e                JP          SOUND_05
   860                          SUB_ram_cdbf:
   861  0e18  3e00                  LD          A,0x0
   862  0e1a  f5                    PUSH        AF
   863  0e1b  014000                LD          BC,$40
   864  0e1e  111500                LD          DE,$15
   865  0e21  210004                LD          HL,$400
   866  0e24  3e00                  LD          A,0x0
   867  0e26  32b53a                LD          (PITCH_UP_BOOL),A
   868  0e29  c3dd0e                JP          PLAY_PITCH_CHANGE
   869                          SUB_ram_cdd3:
   870  0e2c  3e00                  LD          A,0x0
   871  0e2e  f5                    PUSH        AF
   872  0e2f  01a000                LD          BC,$a0
   873  0e32  110800                LD          DE,0x8
   874  0e35  210008                LD          HL,$800
   875  0e38  3e00                  LD          A,0x0
   876  0e3a  32b53a                LD          (PITCH_UP_BOOL),A
   877  0e3d  c3dd0e                JP          PLAY_PITCH_CHANGE
   878                          SUB_ram_cde7:
   879  0e40  3e00                  LD          A,0x0
   880  0e42  f5                    PUSH        AF
   881  0e43  01a000                LD          BC,$a0
   882  0e46  110100                LD          DE,0x1
   883  0e49  210200                LD          HL,0x2
   884  0e4c  3e00                  LD          A,0x0
   885  0e4e  32b53a                LD          (PITCH_UP_BOOL),A
   886  0e51  c3dd0e                JP          PLAY_PITCH_CHANGE
   887                          SETUP_OPEN_DOOR_SOUND:
   888  0e54  110f00                LD          DE,0xf
   889  0e57  218005                LD          HL,$580
   890                          LO_HI_PITCH_SOUND:
   891  0e5a  010800                LD          BC,0x8
   892  0e5d  3e00                  LD          A,0x0
   893  0e5f  f5                    PUSH        AF
   894  0e60  3e01                  LD          A,0x1
   895  0e62  32b53a                LD          (PITCH_UP_BOOL),A
   896  0e65  c3dd0e                JP          PLAY_PITCH_CHANGE
   897                          SETUP_CLOSE_DOOR_SOUND:
   898  0e68  210500                LD          HL,0x5
   899  0e6b  110c00                LD          DE,0xc
   900                          HI_LO_PITCH_SOUND:
   901  0e6e  010e00                LD          BC,0xe                                  ;H
   902  0e71  af                    XOR         A
   903  0e72  f5                    PUSH        AF
   904  0e73  32b53a                LD          (PITCH_UP_BOOL),A
   905  0e76  c3dd0e                JP          PLAY_PITCH_CHANGE
   906                          SOUND_01:
   907  0e79  3e00                  LD          A,0x0
   908  0e7b  f5                    PUSH        AF
   909  0e7c  013000                LD          BC,$30
   910  0e7f  110200                LD          DE,0x2
   911  0e82  210001                LD          HL,$100
   912  0e85  3e01                  LD          A,0x1
   913  0e87  32b53a                LD          (PITCH_UP_BOOL),A
   914  0e8a  c3dd0e                JP          PLAY_PITCH_CHANGE
   915                          SOUND_02:
   916  0e8d  3e00                  LD          A,0x0
   917  0e8f  f5                    PUSH        AF
   918  0e90  011a00                LD          BC,$1a
   919  0e93  111000                LD          DE,$10
   920  0e96  210003                LD          HL,$300
   921  0e99  3e01                  LD          A,0x1
   922  0e9b  32b53a                LD          (PITCH_UP_BOOL),A
   923  0e9e  c3dd0e                JP          PLAY_PITCH_CHANGE
   924                          SOUND_03:
   925  0ea1  3e00                  LD          A,0x0
   926  0ea3  f5                    PUSH        AF
   927  0ea4  012a00                LD          BC,$2a
   928  0ea7  110a00                LD          DE,0xa
   929  0eaa  210400                LD          HL,0x4
   930  0ead  3e00                  LD          A,0x0
   931  0eaf  32b53a                LD          (PITCH_UP_BOOL),A
   932  0eb2  c3dd0e                JP          PLAY_PITCH_CHANGE
   933                          SOUND_04:
   934  0eb5  3e00                  LD          A,0x0
   935  0eb7  f5                    PUSH        AF
   936  0eb8  012000                LD          BC,$20
   937  0ebb  110200                LD          DE,0x2
   938  0ebe  215500                LD          HL,$55
   939  0ec1  3e01                  LD          A,0x1
   940  0ec3  32b53a                LD          (PITCH_UP_BOOL),A
   941  0ec6  c3dd0e                JP          PLAY_PITCH_CHANGE
   942                          SOUND_05:
   943  0ec9  3e00                  LD          A,0x0
   944  0ecb  f5                    PUSH        AF
   945  0ecc  013000                LD          BC,$30
   946  0ecf  110100                LD          DE,0x1
   947  0ed2  210100                LD          HL,0x1
   948  0ed5  3e00                  LD          A,0x0
   949  0ed7  32b53a                LD          (PITCH_UP_BOOL),A
   950  0eda  c3dd0e                JP          PLAY_PITCH_CHANGE
   951                          PLAY_PITCH_CHANGE:
   952  0edd  22b33a                LD          (SND_CYCLE_HOLDER),HL
   953                          PLAY_PITCH_CHANGE_LOOP:
   954  0ee0  2b                    DEC         HL
   955  0ee1  7c                    LD          A,H
   956  0ee2  b5                    OR          L                                       ;Clear flags
   957  0ee3  c2e00e                JP          NZ,PLAY_PITCH_CHANGE_LOOP
   958  0ee6  f1                    POP         AF
   959  0ee7  d3fc                  OUT         (SPEAKER),A                             ;= db
   960  0ee9  ee01                  XOR         0x1
   961  0eeb  f5                    PUSH        AF
   962  0eec  0b                    DEC         BC
   963  0eed  78                    LD          A,B
   964  0eee  b1                    OR          C
   965  0eef  c2f70e                JP          NZ,INCREASE_PITCH
   966  0ef2  f1                    POP         AF
   967  0ef3  2ab33a                LD          HL,(SND_CYCLE_HOLDER)
   968  0ef6  c9                    RET
   969                          INCREASE_PITCH:
   970  0ef7  21b53a                LD          HL,PITCH_UP_BOOL
   971  0efa  cb46                  BIT         0x0,(HL)
   972  0efc  ca070f                JP          Z,DECREASE_PITCH
   973  0eff  2ab33a                LD          HL,(SND_CYCLE_HOLDER)
   974  0f02  ed52                  SBC         HL,DE
   975  0f04  c3dd0e                JP          PLAY_PITCH_CHANGE
   976                          DECREASE_PITCH:
   977  0f07  2ab33a                LD          HL,(SND_CYCLE_HOLDER)
   978  0f0a  19                    ADD         HL,DE
   979  0f0b  c3dd0e                JP          PLAY_PITCH_CHANGE
   980                          HC_JOY_INPUT_COMPARE:
   981  0f0e  3a663a                LD          A,(RAM_AE)
   982  0f11  fe31                  CP          $31                                    ;Compare to "1" db?
   983  0f13  c20d2a                JP          NZ,WAIT_FOR_INPUT
   984  0f16  2afe37                LD          HL,(HC_INPUT_HOLDER)                    ;= $6060
   985  0f19  3ef3                  LD          A,$f3                                  ;Compare to JOY disc UUL
   986  0f1b  bd                    CP          L
   987  0f1c  ca1221                JP          Z,DO_MOVE_FW_CHK_WALLS
   988  0f1f  bc                    CP          H
   989  0f20  ca1221                JP          Z,DO_MOVE_FW_CHK_WALLS
   990  0f23  3efb                  LD          A,$fb                                  ;Compare to JOY disc UP
   991  0f25  bd                    CP          L
   992  0f26  ca1221                JP          Z,DO_MOVE_FW_CHK_WALLS
   993  0f29  bc                    CP          H
   994  0f2a  ca1221                JP          Z,DO_MOVE_FW_CHK_WALLS
   995  0f2d  3eeb                  LD          A,$eb                                  ;Compare to JOY disc UUR
   996  0f2f  bc                    CP          H
   997  0f30  ca1221                JP          Z,DO_MOVE_FW_CHK_WALLS
   998  0f33  bd                    CP          L
   999  0f34  ca1221                JP          Z,DO_MOVE_FW_CHK_WALLS
  1000  0f37  3ee9                  LD          A,$e9                                  ;Compare to JOY disc UR
  1001  0f39  bd                    CP          L
  1002  0f3a  cab22d                JP          Z,DO_TURN_RIGHT
  1003  0f3d  bc                    CP          H
  1004  0f3e  cab22d                JP          Z,DO_TURN_RIGHT
  1005  0f41  3ef9                  LD          A,$f9                                  ;Compare to JOY disc RUR
  1006  0f43  bd                    CP          L
  1007  0f44  cab22d                JP          Z,DO_TURN_RIGHT
  1008  0f47  bc                    CP          H
  1009  0f48  cab22d                JP          Z,DO_TURN_RIGHT
  1010  0f4b  3efd                  LD          A,$fd                                  ;Compare to JOY disc RIGHT
  1011  0f4d  bd                    CP          L
  1012  0f4e  cab22d                JP          Z,DO_TURN_RIGHT
  1013  0f51  bc                    CP          H
  1014  0f52  cab22d                JP          Z,DO_TURN_RIGHT
  1015  0f55  3ee7                  LD          A,$e7                                  ;Compare to JOY disc LUL
  1016  0f57  bd                    CP          L
  1017  0f58  ca9a2d                JP          Z,DO_TURN_LEFT
  1018  0f5b  bc                    CP          H
  1019  0f5c  ca9a2d                JP          Z,DO_TURN_LEFT
  1020  0f5f  3ee3                  LD          A,$e3                                  ;Compare to JOY disc UL
  1021  0f61  bd                    CP          L
  1022  0f62  ca9a2d                JP          Z,DO_TURN_LEFT
  1023  0f65  bc                    CP          H
  1024  0f66  ca9a2d                JP          Z,DO_TURN_LEFT
  1025  0f69  3ef7                  LD          A,$f7                                  ;Compare to JOY disc LEFT
  1026  0f6b  bd                    CP          L
  1027  0f6c  ca9a2d                JP          Z,DO_TURN_LEFT
  1028  0f6f  bc                    CP          H
  1029  0f70  ca9a2d                JP          Z,DO_TURN_LEFT
  1030  0f73  3ef6                  LD          A,$f6                                  ;Compare to JOY disc LDL
  1031  0f75  bd                    CP          L
  1032  0f76  cae22d                JP          Z,DO_GLANCE_LEFT
  1033  0f79  bc                    CP          H
  1034  0f7a  cae22d                JP          Z,DO_GLANCE_LEFT
  1035  0f7d  3ee6                  LD          A,$e6                                  ;Compare to JOY disc DL
  1036  0f7f  bd                    CP          L
  1037  0f80  cae22d                JP          Z,DO_GLANCE_LEFT
  1038  0f83  bc                    CP          H
  1039  0f84  cae22d                JP          Z,DO_GLANCE_LEFT
  1040  0f87  3eed                  LD          A,$ed                                  ;Compare to JOY disc RDR
  1041  0f89  bd                    CP          L
  1042  0f8a  cacc2d                JP          Z,DO_GLANCE_RIGHT
  1043  0f8d  bc                    CP          H
  1044  0f8e  cacc2d                JP          Z,DO_GLANCE_RIGHT
  1045  0f91  3eec                  LD          A,$ec                                  ;Compare to JOY disc DR
  1046  0f93  bd                    CP          L
  1047  0f94  cacc2d                JP          Z,DO_GLANCE_RIGHT
  1048  0f97  bc                    CP          H
  1049  0f98  cacc2d                JP          Z,DO_GLANCE_RIGHT
  1050  0f9b  3efc                  LD          A,$fc                                  ;Compare to JOY disc DDR
  1051  0f9d  bd                    CP          L
  1052  0f9e  ca4421                JP          Z,DO_JUMP_BACK
  1053  0fa1  bc                    CP          H
  1054  0fa2  ca4421                JP          Z,DO_JUMP_BACK
  1055  0fa5  3efe                  LD          A,$fe                                  ;Compare to JOY disc DOWN
  1056  0fa7  bd                    CP          L
  1057  0fa8  ca4421                JP          Z,DO_JUMP_BACK
  1058  0fab  bc                    CP          H
  1059  0fac  ca4421                JP          Z,DO_JUMP_BACK
  1060  0faf  3eee                  LD          A,$ee                                  ;Compare to JOY disc DDL
  1061  0fb1  bd                    CP          L
  1062  0fb2  ca4421                JP          Z,DO_JUMP_BACK
  1063  0fb5  bc                    CP          H
  1064  0fb6  ca4421                JP          Z,DO_JUMP_BACK
  1065  0fb9  3edf                  LD          A,$df                                  ;Compare to JOY K4
  1066  0fbb  bd                    CP          L
  1067  0fbc  ca1c11                JP          Z,TOGGLE_SHIFT_MODE
  1068  0fbf  bc                    CP          H
  1069  0fc0  ca1c11                JP          Z,TOGGLE_SHIFT_MODE
  1070  0fc3  3ab93a                LD          A,(GAME_BOOLEANS)
  1071  0fc6  cb4f                  BIT         0x1,A
  1072  0fc8  c20010                JP          NZ,DO_HC_SHIFT_ACTIONS
  1073                          DO_HC_BUTTON_ACTIONS:
  1074  0fcb  3ebf                  LD          A,$bf                                  ;Compare to JOY K1
  1075  0fcd  bd                    CP          L
  1076  0fce  caf82d                JP          Z,DO_USE_ATTACK
  1077  0fd1  bc                    CP          H
  1078  0fd2  caf82d                JP          Z,DO_USE_ATTACK
  1079  0fd5  3e7b                  LD          A,$7b                                  ;Compare to JOY K2
  1080  0fd7  bd                    CP          L
  1081  0fd8  ca692c                JP          Z,DO_OPEN_CLOSE
  1082  0fdb  bc                    CP          H
  1083  0fdc  ca692c                JP          Z,DO_OPEN_CLOSE
  1084  0fdf  3e5f                  LD          A,$5f                                  ;Compare to JOY K3
  1085  0fe1  bd                    CP          L
  1086  0fe2  ca2827                JP          Z,DO_PICK_UP
  1087  0fe5  bc                    CP          H
  1088  0fe6  ca2827                JP          Z,DO_PICK_UP
  1089  0fe9  3e7d                  LD          A,$7d                                  ;Compare to JOY K5
  1090  0feb  bd                    CP          L
  1091  0fec  cad629                JP          Z,DO_SWAP_PACK
  1092  0fef  bc                    CP          H
  1093  0ff0  cad629                JP          Z,DO_SWAP_PACK
  1094  0ff3  3e7e                  LD          A,$7e                                  ;Compare to JOY K6
  1095  0ff5  bd                    CP          L
  1096  0ff6  ca6629                JP          Z,DO_ROTATE_PACK
  1097  0ff9  bc                    CP          H
  1098  0ffa  ca6629                JP          Z,DO_ROTATE_PACK
  1099  0ffd  c3a621                JP          NO_ACTION_TAKEN
  1100                          DO_HC_SHIFT_ACTIONS:
  1101  1000  3ebf                  LD          A,$bf                                  ;Compare to JOY K1
  1102  1002  bd                    CP          L
  1103  1003  ca7932                JP          Z,DO_USE_LADDER
  1104  1006  bc                    CP          H
  1105  1007  ca7932                JP          Z,DO_USE_LADDER
  1106  100a  3e7b                  LD          A,$7b                                  ;Compare to JOY K2
  1107  100c  bd                    CP          L
  1108  100d  ca8821                JP          Z,DO_COUNT_FOOD
  1109  1010  bc                    CP          H
  1110  1011  ca8821                JP          Z,DO_COUNT_FOOD
  1111  1014  3e5f                  LD          A,$5f                                  ;Compare to JOY K3
  1112  1016  bd                    CP          L
  1113  1017  caa021                JP          Z,DO_COUNT_ARROWS
  1114  101a  bc                    CP          H
  1115  101b  caa021                JP          Z,DO_COUNT_ARROWS
  1116  101e  3e7d                  LD          A,$7d                                  ;Compare to JOY K5
  1117  1020  bd                    CP          L
  1118  1021  ca1726                JP          Z,DO_SWAP_HANDS
  1119  1024  bc                    CP          H
  1120  1025  ca1726                JP          Z,DO_SWAP_HANDS
  1121  1028  3e7e                  LD          A,$7e                                  ;Compare to JOY K6
  1122  102a  bd                    CP          L
  1123  102b  ca363b                JP          Z,DO_REST
  1124  102e  bc                    CP          H
  1125  102f  ca363b                JP          Z,DO_REST
  1126  1032  3ecc                  LD          A,$cc                                  ;Compare to K4 + DR chord
  1127  1034  bd                    CP          L
  1128  1035  cab33c                JP          Z,MAX_HEALTH_ARROWS_FOOD
  1129  1038  bc                    CP          H
  1130  1039  cab33c                JP          Z,MAX_HEALTH_ARROWS_FOOD
  1131  103c  3ec6                  LD          A,$c6                                  ;Compare to K4 + DL chord
  1132  103e  bd                    CP          L
  1133  103f  cad23c                JP          Z,DO_TELEPORT
  1134  1042  bc                    CP          H
  1135  1043  cad23c                JP          Z,DO_TELEPORT
  1136  1046  c3a621                JP          NO_ACTION_TAKEN
  1137                          DRAW_BKGD:
  1138  1049  3e20                  LD          A,$20                                  ;Set VIEWPORT fill chars to SPACE
  1139  104b  212830                LD          HL,$3028
  1140  104e  011818                LD          BC,$1818                               ;24 x 24 cells
  1141  1051  cd3609                CALL        FILL_CHRCOL_RECT
  1142  1054  0e08                  LD          C,0x8                                   ;8 rows of ceiling
  1143  1056  212834                LD          HL,$3428
  1144  1059  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
  1145  105b  cd3909                CALL        DRAW_CHRCOLS
  1146  105e  0e06                  LD          C,0x6                                   ;6 more rows of ceiling
  1147  1060  19                    ADD         HL,DE
  1148  1061  3e00                  LD          A,0x0                                   ;BLK on BLK
  1149  1063  cd3909                CALL        DRAW_CHRCOLS
  1150  1066  0e0a                  LD          C,0xa                                   ;10 rows of floor
  1151  1068  19                    ADD         HL,DE
  1152  1069  3edf                  LD          A,$df                                  ;DKGRN on DKGRY
  1153  106b  cd3909                CALL        DRAW_CHRCOLS
  1154  106e  3aa33a                LD          A,(CURR_MONSTER_PHYS)
  1155  1071  fe00                  CP          0x0
  1156  1073  ca8210                JP          Z,NOT_IN_BATTLE
  1157  1076  3aa23a                LD          A,(CURR_MONSTER_SPRT)
  1158  1079  fe00                  CP          0x0
  1159  107b  ca8210                JP          Z,NOT_IN_BATTLE
  1160  107e  cd3d32                CALL        REDRAW_MONSTER_HEALTH
  1161  1081  c9                    RET
  1162                          NOT_IN_BATTLE:
  1163  1082  c9                    RET
  1164                          WIPE_VARIABLE_SPACE:
  1165  1083  3e00                  LD          A,0x0
  1166  1085  210039                LD          HL,$3900
  1167  1088  06ff                  LD          B,$ff
  1168                          CLEAR_MAP_SPACE:
  1169  108a  77                    LD          (HL),A
  1170  108b  23                    INC         HL
  1171  108c  77                    LD          (HL),A
  1172  108d  23                    INC         HL
  1173  108e  77                    LD          (HL),A
  1174  108f  23                    INC         HL
  1175  1090  10f8                  DJNZ        CLEAR_MAP_SPACE
  1176  1092  21623a                LD          HL,$3a62
  1177  1095  22ba3a                LD          (NEXT_BLINK_CHECK),HL
  1178  1098  c9                    RET
  1179                          DRAW_WHITE_MAP:
  1180  1099  217400                LD          HL,$74
  1181  109c  cd8f22                CALL        MAP_ITEM_MONSTER
  1182                          UPDATE_ITEM_CELLS:
  1183  109f  ca0322                JP          Z,DRAW_PURPLE_MAP
  1184  10a2  0a                    LD          A,(BC)
  1185  10a3  0c                    INC         C
  1186  10a4  0c                    INC         C
  1187  10a5  d9                    EXX
  1188  10a6  16b6                  LD          D,$b6
  1189  10a8  cda322                CALL        UPDATE_COLRAM_FROM_OFFSET
  1190  10ab  d9                    EXX
  1191  10ac  cd9222                CALL        FIND_NEXT_ITEM_MONSTER_LOOP
  1192  10af  c39f10                JP          UPDATE_ITEM_CELLS
  1193  10b2  c30322                JP          DRAW_PURPLE_MAP
  1194                          PLAY_POOF_ANIM:
  1195  10b5  e5                    PUSH        HL                                      ;Save HL register value
  1196  10b6  11a607                LD          DE,POOF_1                               ;DE = Start of POOF animation graphic
  1197  10b9  0670                  LD          B,$70                                  ;Set color to WHT on BLK
  1198  10bb  d9                    EXX                                                 ;Swap BC DE HL with BC' DE' HL'
  1199  10bc  cdca0d                CALL        POOF_SOUND
  1200  10bf  d9                    EXX                                                 ;Swap BC DE HL with BC' DE' HL'
  1201  10c0  cd0f33                CALL        GFX_DRAW
  1202  10c3  e1                    POP         HL                  ;Restore DE register value
  1203  10c4  cdf410                CALL        TOGGLE_ITEM_POOF_AND_WAIT
  1204  10c7  e5                    PUSH        HL
  1205  10c8  cd0f33                CALL        GFX_DRAW
  1206  10cb  e1                    POP         HL
  1207  10cc  d5                    PUSH        DE
  1208  10cd  112900                LD          DE,$29
  1209  10d0  ed52                  SBC         HL,DE
  1210  10d2  d1                    POP         DE                              ;= $D7,$C9,$01
  1211  10d3  cdf410                CALL        TOGGLE_ITEM_POOF_AND_WAIT
  1212  10d6  e5                    PUSH        HL
  1213  10d7  cd0f33                CALL        GFX_DRAW
  1214  10da  e1                    POP         HL
  1215  10db  e5                    PUSH        HL
  1216  10dc  0680                  LD          B,$80
  1217  10de  cd0f33                CALL        GFX_DRAW
  1218  10e1  cdf410                CALL        TOGGLE_ITEM_POOF_AND_WAIT
  1219  10e4  e1                    POP         HL
  1220  10e5  e5                    PUSH        HL
  1221  10e6  cd0f33                CALL        GFX_DRAW
  1222  10e9  cdf410                CALL        TOGGLE_ITEM_POOF_AND_WAIT
  1223  10ec  06d0                  LD          B,$d0
  1224  10ee  e1                    POP         HL
  1225  10ef  cd0f33                CALL        GFX_DRAW
  1226  10f2  08                    EX          AF,AF'
  1227  10f3  c9                    RET
  1228                          TOGGLE_ITEM_POOF_AND_WAIT:
  1229  10f4  d9                    EXX
  1230  10f5  010032                LD          BC,DAT_ram_3200                         ;= $20
  1231  10f8  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  1232  10fb  d9                    EXX
  1233  10fc  c9                    RET
  1234                          MONSTER_KILLED:
  1235  10fd  213b32                LD          HL,CHRRAM_MONSTER_POOF_IDX              ;= $20
  1236  1100  cdb510                CALL        PLAY_POOF_ANIM
  1237  1103  3a793a                LD          A,(PLAYER_MAP_POS)                      ;A  = Player position in map
  1238  1106  2a603a                LD          HL,(DIR_FACING_FW)                      ;HL = FW adjustment value
  1239  1109  84                    ADD         A,H                                     ;A  = Player position in map
  1240                                                                                  ;one step forward
  1241  110a  cdec37                CALL        ITEM_MAP_CHECK                          ;Upon return,
  1242                                                                                  ;A  = itemNum one step forward
  1243                                                                                  ;BC = itemMapRAMLocation
  1244  110d  fe9f                  CP          $9f                                    ;Check to see if it is
  1245                                                                                  ;the Minotaur ($9f)
  1246  110f  caf03a                JP          Z,MINOTAUR_DEAD
  1247  1112  3efe                  LD          A,$fe                                  ;A  = $fe (empty item space)
  1248  1114  02                    LD          (BC),A                                  ;itemMapLocRAM = $fe (empty)
  1249  1115  cdef24                CALL        CLEAR_MONSTER_STATS
  1250  1118  e1                    POP         HL
  1251  1119  c3042a                JP          UPDATE_VIEWPORT
  1252                          TOGGLE_SHIFT_MODE:
  1253  111c  3ab93a                LD          A,(GAME_BOOLEANS)
  1254  111f  cb4f                  BIT         0x1,A                                   ;NZ if SHIFT MODE
  1255  1121  c23111                JP          NZ,RESET_SHIFT_MODE
  1256                          SET_SHIFT_MODE:
  1257  1124  cbcf                  SET         0x1,A                                   ;Set SHIFT MODE boolean
  1258  1126  32b93a                LD          (GAME_BOOLEANS),A
  1259  1129  3ed0                  LD          A,$d0                                  ;DKGRN on BLK
  1260  112b  320534                LD          (COLRAM_SHIFT_MODE_IDX),A               ;= $60    `
  1261  112e  c30a2a                JP          INPUT_DEBOUNCE
  1262                          RESET_SHIFT_MODE:
  1263  1131  3ab93a                LD          A,(GAME_BOOLEANS)                       ;Reset SHIFT MODE boolean
  1264  1134  cb8f                  RES         0x1,A
  1265  1136  32b93a                LD          (GAME_BOOLEANS),A
  1266  1139  3ef0                  LD          A,$f0
  1267  113b  320534                LD          (COLRAM_SHIFT_MODE_IDX),A               ;= $60    `
  1268  113e  c30a2a                JP          INPUT_DEBOUNCE
  1269                          SHOW_AUTHOR:
  1270  1141  214833                LD          HL,CHRRAM_AUTHORS_IDX                   ;= $20
  1271  1144  11f707                LD          DE,AUTHORS                              ;= "   Originally programmed by Tom L...
  1272  1147  0620                  LD          B,$20
  1273  1149  cd0f33                CALL        GFX_DRAW
  1274  114c  3eff                  LD          A,$ff
  1275  114e  c30d2a                JP          WAIT_FOR_INPUT
  1276                          TIMER_UPDATE:
  1277  1151  2a693a                LD          HL,(TIMER_A)
  1278  1154  010100                LD          BC,0x1
  1279  1157  09                    ADD         HL,BC
  1280  1158  22693a                LD          (TIMER_A),HL
  1281  115b  c9                    RET
  1282                          BLINK_ROUTINE:
  1283  115c  f5                    PUSH        AF
  1284  115d  3ab93a                LD          A,(GAME_BOOLEANS)
  1285  1160  cb47                  BIT         0x0,A
  1286  1162  ca6d11                JP          Z,STILL_ON_TITLE
  1287  1165  c36b11                JP          BLINK_EXIT_AF
  1288                          BLINK_EXIT_ALL:
  1289  1168  d1                    POP         DE
  1290  1169  e1                    POP         HL
  1291                          BLINK_EXIT_BCAF:
  1292  116a  c1                    POP         BC
  1293                          BLINK_EXIT_AF:
  1294  116b  f1                    POP         AF
  1295  116c  c9                    RET
  1296                          STILL_ON_TITLE:
  1297  116d  c5                    PUSH        BC
  1298  116e  3a6a3a                LD          A,(TIMER_B)
  1299  1171  47                    LD          B,A
  1300  1172  3aba3a                LD          A,(NEXT_BLINK_CHECK)
  1301  1175  b8                    CP          B
  1302  1176  c26a11                JP          NZ,BLINK_EXIT_BCAF
  1303  1179  ed5f                  LD          A,R
  1304  117b  32ba3a                LD          (NEXT_BLINK_CHECK),A
  1305  117e  e5                    PUSH        HL
  1306  117f  d5                    PUSH        DE
  1307  1180  cda611                CALL        DO_CLOSE_EYES
  1308  1183  010080                LD          BC,$8000
  1309  1186  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  1310  1189  cd8f11                CALL        DO_OPEN_EYES
  1311  118c  c36811                JP          BLINK_EXIT_ALL
  1312                          DO_OPEN_EYES:
  1313  118f  11d632                LD          DE,$32d6
  1314  1192  210000                LD          HL,TS_EYES_OPEN_CHR                    ; Pinned to TITLE_SCREEN (0xD800) + 726; WAS 0xdad6
  1315  1195  014400                LD          BC,$44
  1316  1198  edb0                  LDIR
  1317  119a  11d636                LD          DE,$36d6
  1318  119d  210000                LD          HL,TS_EYES_OPTN_COL                    ; Pinned to TITLE_SCREEN (0XD800) + 1750; WAS 0xded6
  1319  11a0  014400                LD          BC,$44
  1320  11a3  edb0                  LDIR
  1321  11a5  c9                    RET
  1322                          DO_CLOSE_EYES:
  1323  11a6  21d632                LD          HL,$32d6
  1324  11a9  01d0d1                LD          BC,$d1d0                    ; Value, not an address
  1325  11ac  70                    LD          (HL),B
  1326  11ad  23                    INC         HL
  1327  11ae  70                    LD          (HL),B
  1328  11af  111a00                LD          DE,$1a
  1329  11b2  19                    ADD         HL,DE
  1330  11b3  70                    LD          (HL),B
  1331  11b4  2b                    DEC         HL
  1332  11b5  70                    LD          (HL),B
  1333  11b6  21fe32                LD          HL,$32fe
  1334  11b9  71                    LD          (HL),C
  1335  11ba  23                    INC         HL
  1336  11bb  70                    LD          (HL),B
  1337  11bc  19                    ADD         HL,DE
  1338  11bd  70                    LD          (HL),B
  1339  11be  2b                    DEC         HL
  1340  11bf  71                    LD          (HL),C
  1341  11c0  21d636                LD          HL,$36d6
  1342  11c3  010ff0                LD          BC,$f00f                    ; Value, not an address
  1343  11c6  70                    LD          (HL),B
  1344  11c7  23                    INC         HL
  1345  11c8  71                    LD          (HL),C
  1346  11c9  19                    ADD         HL,DE
  1347  11ca  71                    LD          (HL),C
  1348  11cb  2b                    DEC         HL
  1349  11cc  70                    LD          (HL),B
  1350  11cd  21fe36                LD          HL,$36fe
  1351  11d0  70                    LD          (HL),B
  1352  11d1  23                    INC         HL
  1353  11d2  70                    LD          (HL),B
  1354  11d3  19                    ADD         HL,DE
  1355  11d4  70                    LD          (HL),B
  1356  11d5  2b                    DEC         HL
  1357  11d6  70                    LD          (HL),B
  1358  11d7  c9                    RET
  1359                          DRAW_ICON_BAR:
  1360  11d8  f5                    PUSH        AF
  1361  11d9  e5                    PUSH        HL
  1362  11da  210130                LD          HL,CHRRAM_LEVEL_IND_L                   ;= $20
  1363  11dd  3685                  LD          (HL),$85           ;Right side halftone CHR
  1364  11df  23                    INC         HL
  1365  11e0  23                    INC         HL
  1366  11e1  23                    INC         HL
  1367  11e2  3695                  LD          (HL),$95           ;Left side halftone CHR
  1368  11e4  23                    INC         HL
  1369  11e5  3608                  LD          (HL),0x8         ;Up arrow CHR
  1370  11e7  23                    INC         HL
  1371  11e8  23                    INC         HL
  1372  11e9  3648                  LD          (HL),$48            ;Ladder (H) CHR
  1373  11eb  23                    INC         HL
  1374  11ec  23                    INC         HL
  1375  11ed  36d3                  LD          (HL),$d3              ;Item CHR
  1376  11ef  23                    INC         HL
  1377  11f0  23                    INC         HL
  1378  11f1  3693                  LD          (HL),$93           ;Monster CHR
  1379  11f3  23                    INC         HL
  1380  11f4  23                    INC         HL
  1381  11f5  3685                  LD          (HL),$85              ;Right side halftone CHR
  1382  11f7  23                    INC         HL
  1383  11f8  23                    INC         HL
  1384  11f9  23                    INC         HL
  1385  11fa  23                    INC         HL                                      ;Map CHR
  1386  11fb  36d1                  LD          (HL),$d1               ;= $20
  1387  11fd  23                    INC         HL
  1388  11fe  23                    INC         HL                                      ;Armor CHR
  1389  11ff  369d                  LD          (HL),$9d             ;= $20
  1390  1201  23                    INC         HL
  1391  1202  23                    INC         HL                                      ;Helmet CHR
  1392  1203  360e                  LD          (HL),0xe             ;= $20
  1393  1205  23                    INC         HL
  1394  1206  23                    INC         HL                                      ;Ring (o) CHR
  1395  1207  366f                  LD          (HL),$6f              ;= $20
  1396  1209  e1                    POP         HL
  1397  120a  f1                    POP         AF
  1398  120b  c9                    RET
  1399                          DRAW_COMPASS:
  1400  120c  f5                    PUSH        AF                                      ;DKBLU on BLK
  1401  120d  c5                    PUSH        BC
  1402  120e  e5                    PUSH        HL
  1403  120f  d5                    PUSH        DE
  1404  1210  06b0                  LD          B,$b0
  1405  1212  21af31                LD          HL,DAT_ram_31af                         ;= $20
  1406  1215  119a07                LD          DE,COMPASS                              ;= $D7,"n",$C9,$01
  1407  1218  cd0f33                CALL        GFX_DRAW
  1408  121b  21d835                LD          HL,DAT_ram_35d8                         ;= $60
  1409  121e  3610                  LD          (HL),$10                 ;= $60
  1410  1220  d1                    POP         DE
  1411  1221  e1                    POP         HL
  1412  1222  c1                    POP         BC
  1413  1223  f1                    POP         AF
  1414  1224  c9                    RET
  1415                          WIPE_WALLS:
  1416  1225  f5                    PUSH        AF
  1417  1226  c5                    PUSH        BC
  1418  1227  e5                    PUSH        HL
  1419  1228  210038                LD          HL,$3800
  1420  122b  010000                LD          BC,0x0
  1421  122e  3e00                  LD          A,0x0
  1422                          WIPE_WALLS_LOOP:
  1423  1230  77                    LD          (HL),A
  1424  1231  23                    INC         HL
  1425  1232  10fc                  DJNZ        WIPE_WALLS_LOOP
  1426  1234  e1                    POP         HL
  1427  1235  c1                    POP         BC
  1428  1236  f1                    POP         AF
  1429  1237  cd042a                CALL        UPDATE_VIEWPORT
  1430  123a  c30a2a                JP          INPUT_DEBOUNCE
  1431                          DRAW_WALL_FL22_EMPTY:
  1432  123d  21b835                LD          HL,COLRAM_FL22_WALL_IDX                 ;= $60    `
  1433  1240  010404                LD          BC,$404                                ;4 x 4 rectangle
  1434  1243  3e00                  LD          A,0x0                                   ;BLK on BLK
  1435  1245  cd3609                CALL        FILL_CHRCOL_RECT
  1436  1248  213032                LD          HL,DAT_ram_3230                         ;= $20
  1437  124b  010104                LD          BC,$401                                ;4 x 1 rectangle
  1438  124e  3e20                  LD          A,$20                                  ;SPACE char
  1439  1250  c33609                JP          FILL_CHRCOL_RECT
  1440                          DRAW_WALL_FL2_NEW:
  1441  1253  213432                LD          HL,$3234                               ;Bottom CHARRAM IDX of FL2
  1442  1256  010104                LD          BC,$401                                ;4 x 1 rectangle
  1443  1259  3e90                  LD          A,$90                                  ;Thin base line char
  1444  125b  cd3609                CALL        FILL_CHRCOL_RECT
  1445  125e  21bc35                LD          HL,$35bc
  1446  1261  010402                LD          BC,$204                                ;2 x 4 rectangle
  1447  1264  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
  1448  1266  cd3609                CALL        FILL_CHRCOL_RECT
  1449  1269  0e04                  LD          C,0x4
  1450  126b  21be35                LD          HL,$35be
  1451  126e  3e0f                  LD          A,0xf
  1452  1270  c33909                JP          DRAW_CHRCOLS
  1453                          FIX_ICON_COLORS:
  1454  1273  210134                LD          HL,COLRAM_LEVEL_IDX_L                   ;= $60
  1455  1276  3a6c3a                LD          A,(INPUT_HOLDER)
  1456  1279  87                    ADD         A,A
  1457  127a  d601                  SUB         0x1
  1458  127c  77                    LD          (HL),A              ;= $60
  1459  127d  2c                    INC         L
  1460  127e  77                    LD          (HL),A             ;= $60
  1461  127f  2c                    INC         L
  1462  1280  77                    LD          (HL),A              ;= $60
  1463  1281  2c                    INC         L
  1464  1282  77                    LD          (HL),A              ;= $60
  1465  1283  210534                LD          HL,COLRAM_SHIFT_MODE_IDX                ;= $60    `
  1466  1286  010013                LD          BC,$1300
  1467  1289  2b                    DEC         HL
  1468                          ICON_GREY_FILL_LOOP:
  1469  128a  23                    INC         HL
  1470  128b  36f0                  LD          (HL),$f0
  1471  128d  10fb                  DJNZ        ICON_GREY_FILL_LOOP
  1472  128f  c9                    RET
  1473                          
src/asterion.asm:
     8  1290  0000000000000000     defs         $1800 - $, $00
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
     9                          
    10                          TITLE_SCREEN:
    11  1800  2020202020202020  INCBIN "asterion_title.scr"
              2020e0fcfcb02020  
              2020202020202020  
              2020202020202020  
              e0f0202020202020  
              20202020202020e8  
              fffcbfa3a3efb4ff  
              20eab5e8ffb4eaff  
              80b4ffeab520ffe8  
              bfabb5c420202020  
              20202020202020fe  
              8ffff5f5fdffffff  
              20eab5fe8ffdeab5  
              dbc3ffeab520ffaa  
              fd1fb02020202020  
              d02020202020e8ff  
              ffffb0ebb4f5ffff  
              b0eaffffffffffff  
              ffa1ffeaf520ffe0  
              a2abfd20202020d0  
              d1d1d0202020fea5  
              20aafdf0f0fef7aa  
              ffffffa520aaffb5  
              ebf5ffa2efffffea  
              fdfebf2020d0d1d1  
              20d0d0d1d0202020  
              d020a2afafa3effd  
              b0436f6d70757465  
              722053797374656d  
              a2a320d0d1d0d020  
              d1d1d1d0d0d0d1d0  
              d0d0d020d0d0d0d0  
              d020d0d0d0d0d0d0  
              20d0d020d0d0d0d0  
              d0d1d0d0d1d0d1d1  
              d0d1d020d1d1d020  
              d0d1d0d1d0d1d0d0  
              d0d1d0d1d1d0d1d1  
              d1d0d1d0d020d0d0  
              20d0d1d020d0d1d0  
              2020d0d1d020d0d1  
              d0d0d0d1d1d0d1d1  
              d1d1d0d1d1d0d1d1  
              d1d1d0d1d1d0d0d0  
              d1d020d0d1d12020  
              202020d0d1d0d0d0  
              d1d1d0d0d1d1d1d0  
              d0d1d0d0d1d0d0d1  
              d1d1d1d1d1d1d0d1  
              d020d0d1d0202020  
              eafffcffb0feffb0  
              fefdb5fdffb4d0d0  
              e8fff5e0fffffcff  
              fffdfdffb4fffdff  
              eab5faffb0ffffb4  
              e0b5ffeab5faebb5  
              a1fae5bfd0a1d0d0  
              e0b7ffeaf5d0a1ea  
              b5e0bfd0a1fae0ff  
              eaf5ffeaf5faeab5  
              eab5ffeab5fffeb5  
              e8bfeaffffd04f46  
              eafdffaaffffb4ea  
              b5eaffffd0ffffa5  
              eaffb5d0ffffeab5  
              eab5ffeab5ffebb5  
              ffa5b2fdd0b0d0d0  
              eab7ffe0d0ebb5ea  
              b5a2fd20b0ffeab5  
              eab7ffeab7ffeab5  
              eab5ffeab5ffeab5  
              bfffa5bfffa5d0d0  
              eab5ffaaffffa1ea  
              b5d0bfffa5ffa2ff  
              eab5ebffa1ffeab5  
              d0d0d1d1d1d1d1d0  
              d0d1d1d0d0d0d0d0  
              d1d1d0d0d0d0d0d0  
              d0d0d0d0d0d0d0d0  
              d1d1d1d1d1d1d120  
              d12020d0d0d1d1d1  
              d1d0d0d0d0d0d0d0  
              d0d0d0d0d0d0d0d0  
              d0d0d0d0d0d0d1d1  
              d1d1d0d0d020d0d0  
              20d02020d0d1d0d1  
              d1d1d15072657373  
              d133d1666f72d145  
              415359d1d1d1d1d1  
              d0d1d1d020202020  
              d020202020d020c6  
              d0d1d15072657373  
              d132d1666f72d14d  
              454449554dd1d1d1  
              20c6d020202020d0  
              2020202020d02020  
              d0d1d15072657373  
              d131d1666f72d148  
              415244d1d1d1d1d0  
              2020d02020202020  
              202020d02020d0d0  
              d1d0d15072657373  
              d134d1666f72d148  
              415244455354d0d1  
              d0d0202020202020  
              20202020202020d0  
              d0d0d0d1d1d1d0d1  
              d1d1d1d1d1d1d1d0  
              d1d1d1d1d1d1d020  
              202020d020202020  
              20202020d0202020  
              d0d0d1d0d1d0d1d0  
              d0d1d0d0d0d1d0d1  
              d0d0d0d1d0d120d0  
              2020d02020202020  
              2043616e20796f75  
              20636f6e71756572  
              20746865206d696e  
              6f746175722cd041  
              73746572696f6e3f  
              2020202020202020  
              2020202020202020  
              2020202020202020  
              2020202020202020  
              2020202020202020  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              7030303030303030  
              3030404040403030  
              3030303030303030  
              3030303030303030  
              4040303030303030  
              3030303030303040  
              404041434d4d4040  
              3040404040404040  
              4040404040304040  
              4040404030303030  
              3030303030303040  
              0440e1133dd34040  
              3040404004404040  
              0440404040304040  
              4040403030303030  
              b030303030304040  
              40404e1e133d4040  
              4040404040404040  
              4040404040304040  
              40404030303030b0  
              0ff0b03030304040  
              30404e4e41434040  
              4040404030404040  
              4040404040404040  
              4040403030b0f00f  
              0fbf0f0fb0303030  
              f030404040404040  
              4080808080808080  
              8030808080808080  
              404030b00f0fbf0f  
              0f0fbfbfbf0ff0f0  
              f0f0f030f0f0f0f0  
              f030f0f0f0f0f0f0  
              30f0f030f0f0f0f0  
              f00f0fbfbfbf0f0f  
              f0f00f0fbfbfbf0f  
              b0f0f0f0f0f0f0f0  
              f0f0b0f0f0f0f0f0  
              f0b0f0f0f030b00f  
              0fbfbfbf0f0ff0f0  
              3030f0f00f0fbfbf  
              bf0f0ff0f0f0f0f0  
              f00f0f0f0f0f0ff0  
              f0f0f0f0f0b00fbf  
              bfbf0f0f0ff03030  
              303030f0f00f0fbf  
              bfbf0f0f0ff00f0f  
              0f0f0f0f0f0f0f0f  
              0ff0f0f00f0fbfbf  
              bf0f0f0ff0303030  
              303f3030303f303f  
              3f3f3f3f303f0f0f  
              3f303f3f30303f30  
              303f3f303f303f30  
              3f3f3f3f303f3f30  
              30303f303030303f  
              3f3f3f300f3f0f0f  
              3f3f3f3f3f0f3f3f  
              3f3f3f0f3f3f3f3f  
              30303f3030303030  
              30303f30303f303f  
              3f3f3f303f0f3f3f  
              3f3f303f3f3f3f3f  
              3f3f3f3f0f303f3f  
              3f3f30f030303030  
              30303f30303f303f  
              303f3f300f3f0f0f  
              3f3f303f0f3f3f3f  
              3f3f3f3f3f303f3f  
              3f303f3030303030  
              303030303030303f  
              30303f30303f0f0f  
              3f3f303f303f3f3f  
              3f0f30303f303f3f  
              3f3f3f3f303f3030  
              f0f0f0f00f0f0f0f  
              0ff00f0f0f0f0f0f  
              0f0f0f0f0f0f0f0f  
              0f0f0f0f0f0f0f0f  
              0ff0f0f0f00ff030  
              f03030f0f0f0f0f0  
              0f0f0f0f0f0f0f0f  
              0f0f0f0f0f0f0f0f  
              0f0f0f0f0f0f0ff0  
              f0f0f0f0f030f0b0  
              30f03030f0f0bfbf  
              f00f0f1f1f1f1f1f  
              0f010f1f1f1f0f1f  
              1f1f1f0f0f0f0ff0  
              bfbff0f030303030  
              f030303030f03040  
              bf0f0f3f3f3f3f3f  
              0ff30f3f3f3f0f3f  
              3f3f3f3f3f0f0f0f  
              3040b030303030f0  
              3030303030f03030  
              0ff00f5f5f5f5f5f  
              0ff50f5f5f5f0f5f  
              5f5f5f0f0f0ff00f  
              3030f03030303030  
              303030f03030f0f0  
              f0f0f07f7f7f7f7f  
              0ff70f7f7f7f0f7f  
              7f7f7f7f7f7ff0f0  
              f0f0303030303030  
              30303030303030f0  
              f0f0f0f0f0f0f0f0  
              f0f0f0f0f0f0f0f0  
              f0f0f0f0f0f0f030  
              303030f030303030  
              30303030f0303030  
              f0f0f0f0f0f0f0f0  
              f0f0f0f0f0f0f0f0  
              f0f0f0f0f0f030f0  
              3030f03030303030  
              30d0d0d030d0d0d0  
              30d0d0d0d0d0d0d0  
              30d0d0d030d0d0d0  
              d0d0d0d0d0d0f020  
              20202020202020d0  
              3030303030303030  
              3030303030303030  
              3030303030303030  
              3030303030303030  
              3030303030303030  
              0000000000000000  
              0000000000000000  
              0000000000000000  
    12                          
    13                          TS_EYES_OPEN_CHR EQU TITLE_SCREEN + 726
    14                          TITLE_SCREEN_COL EQU TITLE_SCREEN + 1024
    15                          TS_EYES_OPTN_COL EQU TITLE_SCREEN + 1750
    16                          
    17                          include "scramblecode.asm"
src/scramblecode.asm:
     1                          ; Aquarius SCRAMBLECODE include file
     2                          SCRAMBLECODE:
     3  2000  3e5b5e00              DB 0x3e,0x5b,0x5e,0x00
     4  2004  009c00b0              DB 0x00,0x9c,0x00,0xb0
     5  2008  006c0064              DB 0x00,0x6c,0x00,0x64
     6  200c  00a85e70              DB 0x00,0xa8,0x5e,0x70
     7                          
src/asterion.asm:
    18                          
    19                          include "asterion_high_rom.asm"
src/asterion_high_rom.asm:
     1                          GAMEINIT:
     2  2010  31ff3f                LD          SP,$3fff                      ;Set SP to top of BANK0 RAM
     3  2013  cd8310                CALL        WIPE_VARIABLE_SPACE                     ;Wipe variable space first...
     4  2016  3602                  LD          (HL),0x2              ;($3a62) = 0x2
     5  2018  2c                    INC         L                                       ;HL = $3a63
     6  2019  3e32                  LD          A,$32                                  ;A = $32
     7  201b  77                    LD          (HL),A                          ;($3a63) = $32
     8  201c  2c                    INC         L                                       ;HL = $3a64
     9  201d  77                    LD          (HL),A                          ;($3a64) = $32
    10  201e  2c                    INC         L                                       ;HL = $3a65
    11  201f  77                    LD          (HL),A                          ;($3a65) = $32
    12  2020  2c                    INC         L                                       ;HL = $3a66
    13  2021  3d                    DEC         A                                       ;A = $31
    14  2022  77                    LD          (HL),A                          ;($3a66) = $31
    15  2023  2c                    INC         L                                       ;HL = $3a67
    16  2024  77                    LD          (HL),A                          ;($3a67) = $31
    17  2025  2c                    INC         L                                       ;HL = $3a68
    18  2026  0612                  LD          B,$12                                  ;B = $12
    19  2028  af                    XOR         A                                       ;A = 0x0, F = $44 (Z and P set)
    20                          LAB_ram_e029:
    21  2029  77                    LD          (HL),A                   ;($3a68) = $00
    22  202a  2c                    INC         L                                       ;HL = $3a69 to $3a7a,
    23                                                                                  ;A = 0x0, F = $28
    24  202b  10fc                  DJNZ        LAB_ram_e029                            ;Loop if Not Z (B is decremented)
    25  202d  3e18                  LD          A,$18                                  ;A = $18 (HL = $3a7a, B = 0x0)
    26  202f  77                    LD          (HL),A                         ;($3a7a) = $18
    27  2030  23                    INC         HL                                      ;HL = $3a7b
    28  2031  3efe                  LD          A,$fe                                  ;A = $fe
    29  2033  0610                  LD          B,$10                                  ;B = $10
    30                          LAB_ram_e035:
    31  2035  77                    LD          (HL),A                         ;= $60
    32  2036  23                    INC         HL
    33  2037  10fc                  DJNZ        LAB_ram_e035                            ;Loop if Not Z (B is decremented)
    34  2039  0620                  LD          B,$20                                  ;Set fill CHR to SPACE 32/$20
    35  203b  210030                LD          HL,CHRRAM                               ;HL = $3000 (Start of CHRRAM)
    36  203e  cd591e                CALL        FILL_FULL_1024                          ;byte FILL_FULL_1024(word chrColValue...
    37  2041  215e00                LD          HL,$5e                                 ;HL = $005e
    38  2044  229c3a                LD          (TIMER_E),HL                            ;($3a9c) = $0053
    39  2047  ed5f                  LD          A,R                                     ;Semi-random number into A
    40  2049  67                    LD          H,A
    41  204a  22913a                LD          (RNDHOLD_AA),HL
    42  204d  017f00                LD          BC,$7f
    43  2050  3e07                  LD          A,0x7
    44  2052  ed79                  OUT         (C),A                          ;= db
    45  2054  0d                    DEC         C
    46  2055  3e3f                  LD          A,$3f
    47  2057  ed79                  OUT         (C),A                          ;= db
    48  2059  0606                  LD          B,0x6                                   ;BLK on CYN
    49  205b  210034                LD          HL,COLRAM                               ;= $60
    50  205e  cd591e                CALL        FILL_FULL_1024                          ;byte FILL_FULL_1024(word chrColValue...
    51  2061  cd3a2c                CALL        CHK_ITEM
    52  2064  cd6b20                CALL        DRAW_TITLE
    53  2067  c30a2a                JP          INPUT_DEBOUNCE
    54  206a  00                    NOP
    55                          DRAW_TITLE:
    56  206b  110030                LD          DE,CHRRAM                               ;= $20
    57  206e  210018                LD          HL,TITLE_SCREEN                    ; Pinned to TITLE_SCREEN ; WAS 0xD800
    58  2071  01e803                LD          BC,$3e8
    59  2074  edb0                  LDIR                                                ;= $20
    60  2076  110034                LD          DE,COLRAM                               ;= $60
    61  2079  210000                LD          HL,TITLE_SCREEN_COL                    ; Pinned to TITLE_SCREEN ; WAS 0xD800 + 1024
    62  207c  01e803                LD          BC,$3e8
    63  207f  edb0                  LDIR                                                ;= $60
    64                                                                                  ;= $70
    65  2081  c9                    RET
    66                          BLANK_SCRN:
    67  2082  210030                LD          HL,CHRRAM                               ;= $20
    68  2085  0620                  LD          B,$20                                  ;SPACE char
    69  2087  cd591e                CALL        FILL_FULL_1024                          ;byte FILL_FULL_1024(word chrColValue...
    70  208a  210034                LD          HL,COLRAM                               ;= $60
    71  208d  06d0                  LD          B,$d0                                  ;DKGRN on BLK
    72  208f  cd591e                CALL        FILL_FULL_1024                          ;byte FILL_FULL_1024(word chrColValue...
    73  2092  116c07                LD          DE,STATS_TXT                            ;DE = STATS_TXT
    74  2095  211930                LD          HL,CHRRAM_STATS_TOP                     ;HL = CHRRAM_STATS_TOP
    75  2098  06d0                  LD          B,$d0                                  ;DKGRN on BLK
    76  209a  cd0f33                CALL        GFX_DRAW
    77  209d  214530                LD          HL,IDX_HEALTH_SPACER                    ;= $20
    78  20a0  cd0f33                CALL        GFX_DRAW
    79  20a3  213000                LD          HL,$30                                 ;Set starting PHYS HEALTH = 30
    80  20a6  1e15                  LD          E,$15                                  ;Set starting SPRT HEALTH = 15
    81  20a8  22933a                LD          (PLAYER_PHYS_HEALTH),HL
    82  20ab  22953a                LD          (PLAYER_PHYS_HEALTH_MAX),HL
    83  20ae  7b                    LD          A,E
    84  20af  32973a                LD          (PLAYER_SPRT_HEALTH),A
    85  20b2  32983a                LD          (PLAYER_SPRT_HEALTH_MAX),A
    86  20b5  cdde3c                CALL        REDRAW_STATS
    87  20b8  212000                LD          HL,$20
    88  20bb  22a93a                LD          (BYTE_ram_3aa9),HL
    89  20be  3e14                  LD          A,$14
    90  20c0  32ab3a                LD          (FOOD_INV),A                            ;Set starting FOOD_INV  = 14
    91  20c3  32ac3a                LD          (ARROW_INV),A                           ;Set starting ARROW INV = 14
    92  20c6  0610                  LD          B,$10                                  ;RED on BLK
    93  20c8  217132                LD          HL,CHRRAM_LEFT_HAND_ITEM_IDX            ;= $20
    94  20cb  11b200                LD          DE,BOW                                  ;= $01,$01,$01,$01,$01
    95  20ce  cd0f33                CALL        GFX_DRAW
    96  20d1  cd7312                CALL        FIX_ICON_COLORS
    97  20d4  cd0c12                CALL        DRAW_COMPASS
    98  20d7  3d                    DEC         A
    99  20d8  47                    LD          B,A
   100  20d9  3e03                  LD          A,0x3
   101  20db  90                    SUB         B
   102  20dc  327a3a                LD          (RIGHT_HAND_ITEM),A
   103  20df  0f                    RRCA
   104  20e0  dae820                JP          C,LAB_ram_e103
   105  20e3  0610                  LD          B,$10                                  ;Right hand RED SHIELD_L
   106  20e5  c3ea20                JP          ADJUST_SHIELD_LEVEL
   107                          LAB_ram_e103:
   108  20e8  0630                  LD          B,$30
   109                          ADJUST_SHIELD_LEVEL:
   110  20ea  0f                    RRCA
   111  20eb  d2f220                JP          NC,LAB_ram_e10c
   112  20ee  3e40                  LD          A,$40
   113  20f0  80                    ADD         A,B
   114  20f1  47                    LD          B,A
   115                          LAB_ram_e10c:
   116  20f2  3e18                  LD          A,$18                                  ;Left hand RED BOW
   117  20f4  327b3a                LD          (LEFT_HAND_ITEM),A
   118  20f7  217b32                LD          HL,CHRRAM_RIGHT_HAND_ITEM_IDX           ;= $20
   119  20fa  110100                LD          DE,BUCKLER                              ;= $01,$01,$01,$01,$01
   120  20fd  cd0f33                CALL        GFX_DRAW
   121  2100  cd8d33                CALL        BUILD_MAP
   122  2103  cd180e                CALL        SUB_ram_cdbf
   123  2106  cd9a32                CALL        SUB_ram_f2c4
   124  2109  cdef34                CALL        REDRAW_START
   125  210c  cdff37                CALL        REDRAW_VIEWPORT
   126  210f  c31726                JP          DO_SWAP_HANDS
   127                          
   128                          DO_MOVE_FW_CHK_WALLS:
   129  2112  3ae833                LD          A,(WALL_F0_STATE)                       ;= $20
   130  2115  fe00                  CP          0x0                                     ;Check for no wall in F0
   131  2117  ca1f21                JP          Z,FW_WALLS_CLEAR_CHK_MONSTER
   132  211a  cb57                  BIT         0x2,A                                   ;Check for closed door
   133  211c  caa621                JP          Z,NO_ACTION_TAKEN
   134                          FW_WALLS_CLEAR_CHK_MONSTER:
   135  211f  3ae937                LD          A,(ITEM_F1)                             ;= $60
   136  2122  3c                    INC         A
   137  2123  3c                    INC         A
   138  2124  fe7a                  CP          $7a                                    ;Check for monster in F1
   139  2126  d2a621                JP          NC,NO_ACTION_TAKEN                      ;Monster in your way!
   140                                                                                  ;Do nothing.
   141  2129  ed4b603a              LD          BC,(DIR_FACING_FW)                      ;Way is clear!
   142                                                                                  ;Move forward.
   143  212d  ed439e3a              LD          (BYTE_ram_3a9e),BC
   144  2131  3a623a                LD          A,(DIR_FACING_SHORT)
   145  2134  32a03a                LD          (BYTE_ram_3aa0),A
   146  2137  3a793a                LD          A,(PLAYER_MAP_POS)
   147  213a  32773a                LD          (PLAYER_PREV_MAP_LOC),A
   148  213d  80                    ADD         A,B
   149  213e  32793a                LD          (PLAYER_MAP_POS),A
   150  2141  c3042a                JP          UPDATE_VIEWPORT
   151                          DO_JUMP_BACK:
   152  2144  21793a                LD          HL,PLAYER_MAP_POS
   153  2147  3a773a                LD          A,(PLAYER_PREV_MAP_LOC)
   154  214a  be                    CP          (HL)
   155  214b  ca7521                JP          Z,LAB_ram_e201
   156  214e  08                    EX          AF,AF'
   157  214f  2a9e3a                LD          HL,(BYTE_ram_3a9e)
   158  2152  3a613a                LD          A,(DIR_FACING_BW)
   159  2155  ed44                  NEG                                                 ;Negate A
   160  2157  bc                    CP          H
   161  2158  caa621                JP          Z,NO_ACTION_TAKEN
   162  215b  08                    EX          AF,AF'
   163  215c  32793a                LD          (PLAYER_MAP_POS),A
   164  215f  22603a                LD          (DIR_FACING_FW),HL
   165  2162  3aa03a                LD          A,(BYTE_ram_3aa0)
   166  2165  32623a                LD          (DIR_FACING_SHORT),A
   167  2168  3a783a                LD          A,(LAST_ITEM_HELD)
   168  216b  a7                    AND         A
   169  216c  ca042a                JP          Z,UPDATE_VIEWPORT
   170  216f  cdef24                CALL        CLEAR_MONSTER_STATS
   171  2172  c32232                JP          INIT_MELEE_ANIM
   172                          LAB_ram_e201:
   173  2175  010005                LD          BC,$500
   174  2178  112000                LD          DE,$20
   175  217b  cdb221                CALL        PLAY_SOUND_LOOP
   176  217e  3a783a                LD          A,(LAST_ITEM_HELD)
   177  2181  a7                    AND         A
   178  2182  ca0d2a                JP          Z,WAIT_FOR_INPUT
   179  2185  c32232                JP          INIT_MELEE_ANIM
   180                          DO_COUNT_FOOD:
   181  2188  3aab3a                LD          A,(FOOD_INV)
   182                          COUNT_INV:
   183  218b  57                    LD          D,A
   184  218c  14                    INC         D
   185  218d  af                    XOR         A
   186                          PLAY_INV_COUNT_BLIPS:
   187  218e  15                    DEC         D
   188  218f  ca0a2a                JP          Z,INPUT_DEBOUNCE
   189  2192  08                    EX          AF,AF'
   190  2193  010024                LD          BC,BYTE_ram_2400                        ;= $FF
   191  2196  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
   192  2199  08                    EX          AF,AF'
   193  219a  d3fc                  OUT         (SPEAKER),A                             ;= db
   194  219c  3d                    DEC         A
   195  219d  c38e21                JP          PLAY_INV_COUNT_BLIPS
   196                          DO_COUNT_ARROWS:
   197  21a0  3aac3a                LD          A,(ARROW_INV)
   198  21a3  c38b21                JP          COUNT_INV
   199                          NO_ACTION_TAKEN:
   200  21a6  010005                LD          BC,$500
   201  21a9  112000                LD          DE,$20
   202  21ac  cdb221                CALL        PLAY_SOUND_LOOP
   203  21af  c30d2a                JP          WAIT_FOR_INPUT
   204                          PLAY_SOUND_LOOP:
   205  21b2  1b                    DEC         DE
   206  21b3  7b                    LD          A,E
   207  21b4  b2                    OR          D
   208  21b5  c8                    RET         Z
   209  21b6  d3fc                  OUT         (SPEAKER),A                             ;Send sound to speaker
   210  21b8  60                    LD          H,B
   211  21b9  69                    LD          L,C
   212                          LAB_ram_e244:
   213  21ba  2b                    DEC         HL
   214  21bb  7d                    LD          A,L
   215  21bc  b4                    OR          H
   216  21bd  c2ba21                JP          NZ,LAB_ram_e244
   217  21c0  c3b221                JP          PLAY_SOUND_LOOP
   218                          USE_MAP:
   219  21c3  3ab93a                LD          A,(GAME_BOOLEANS)
   220  21c6  cb57                  BIT         0x2,A                                   ;See if HAVE MAP bit is set
   221  21c8  caa621                JP          Z,NO_ACTION_TAKEN
   222  21cb  3aad3a                LD          A,(MAP_INV_SLOT)
   223  21ce  a7                    AND         A
   224  21cf  ca2232                JP          Z,INIT_MELEE_ANIM
   225  21d2  d9                    EXX                                                 ;Swap BC  DE  HL
   226                                                                                  ;with BC' DE' HL'
   227  21d3  011818                LD          BC,$1818                               ;24 x 24
   228  21d6  212830                LD          HL,IDX_VIEWPORT_CHRRAM                  ;= $20
   229  21d9  3e20                  LD          A,$20                                  ;SPACE character fill
   230  21db  cd3609                CALL        FILL_CHRCOL_RECT                        ;Fill map CHARs with SPACES
   231  21de  cda10e                CALL        SOUND_03
   232  21e1  011818                LD          BC,$1818                               ;24 x 24
   233  21e4  212834                LD          HL,COLRAM_VIEWPORT_IDX                  ;= $60    `
   234  21e7  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
   235                                                                                  ;Was DKGN on BLK
   236  21e9  cd3609                CALL        FILL_CHRCOL_RECT                        ;Fill map colors
   237  21ec  d9                    EXX                                                 ;Swap BC  DE  HL
   238                                                                                  ;with BC' DE' HL'
   239  21ed  f5                    PUSH        AF
   240  21ee  3aad3a                LD          A,(MAP_INV_SLOT)
   241  21f1  47                    LD          B,A
   242  21f2  f1                    POP         AF
   243  21f3  00                    NOP                                                 ;Reset N flag
   244  21f4  05                    DEC         B
   245  21f5  ca2422                JP          Z,DRAW_RED_MAP                          ;Walls and player
   246  21f8  05                    DEC         B
   247  21f9  ca1c22                JP          Z,DRAW_YELLOW_MAP                       ;Walls, player, and ladder
   248  21fc  05                    DEC         B
   249  21fd  ca0322                JP          Z,DRAW_PURPLE_MAP                       ;Walls, player, ladder,
   250                                                                                  ;and monsters
   251  2200  c39910                JP          DRAW_WHITE_MAP                          ;Walls, player, ladder,
   252                                                                                  ;monsters, and items
   253                          DRAW_PURPLE_MAP:
   254  2203  21a878                LD          HL,$78a8                               ;Item range for monsters:
   255                                                                                  ;78 - skeleton
   256                                                                                  ;a8 - db?
   257  2206  cd8f22                CALL        MAP_ITEM_MONSTER
   258                          UPDATE_MONSTER_CELLS:
   259  2209  ca1c22                JP          Z,DRAW_YELLOW_MAP
   260  220c  0a                    LD          A,(BC)
   261  220d  0c                    INC         C
   262  220e  0c                    INC         C
   263  220f  d9                    EXX                                                 ;Swap BC  DE  HL
   264                                                                                  ;with BC' DE' HL'
   265  2210  16b1                  LD          D,$b1                                  ;Set current map position color
   266                                                                                  ;to $b1 DKBLU on RED
   267                                                                                  ;was DKGRN on YEL
   268  2212  cda322                CALL        UPDATE_COLRAM_FROM_OFFSET
   269  2215  d9                    EXX                                                 ;Swap BC  DE  HL
   270                                                                                  ;with BC' DE' HL'
   271  2216  cd9222                CALL        FIND_NEXT_ITEM_MONSTER_LOOP
   272  2219  c30922                JP          UPDATE_MONSTER_CELLS
   273                          DRAW_YELLOW_MAP:
   274  221c  16b5                  LD          D,$b5                                  ;Set current map position color
   275                                                                                  ;to $b5, DKBLU on PUR
   276                                                                                  ;was DKGRN on PUR
   277  221e  3aa13a                LD          A,(ITEM_HOLDER)
   278  2221  cda322                CALL        UPDATE_COLRAM_FROM_OFFSET
   279                          DRAW_RED_MAP:
   280  2224  011810                LD          BC,$1018                               ;16 x 20
   281  2227  11ff37                LD          DE,HC_LAST_INPUT
   282  222a  21cc30                LD          HL,CHRRAM_WALL_F0_IDX                   ;= $20
   283                          CALC_MINIMAP_WALL:
   284  222d  13                    INC         DE
   285  222e  7a                    LD          A,D
   286  222f  fe39                  CP          $39
   287  2231  ca5f22                JP          Z,SET_MINIMAP_PLAYER_LOC
   288  2234  1a                    LD          A,(DE)
   289  2235  b7                    OR          A
   290  2236  ca4322                JP          Z,SET_MINIMAP_NO_WALLS
   291  2239  e60f                  AND         0xf
   292  223b  c24d22                JP          NZ,LAB_ram_e2d6
   293                          SET_MINIMAP_N_WALL:
   294  223e  3ea3                  LD          A,$a3                                  ;A = $a3, map CHAR N wall
   295  2240  c35522                JP          DRAW_MINIMAP_WALL
   296                          SET_MINIMAP_NO_WALLS:
   297  2243  3ea0                  LD          A,$a0                                  ;A = $a0, map CHAR no walls
   298  2245  c35522                JP          DRAW_MINIMAP_WALL
   299                          SET_MINIMAP_NW_WALLS:
   300  2248  3eb7                  LD          A,$b7                                  ;A = $b7, map CHAR N and W walls
   301  224a  c35522                JP          DRAW_MINIMAP_WALL
   302                          LAB_ram_e2d6:
   303  224d  1a                    LD          A,(DE)
   304  224e  e6f0                  AND         $f0
   305  2250  c24822                JP          NZ,SET_MINIMAP_NW_WALLS
   306                          SET_MINIMAP_W_WALL:
   307  2253  3eb5                  LD          A,$b5                                  ;A = $b5, map CHAR W wall
   308                          DRAW_MINIMAP_WALL:
   309  2255  77                    LD          (HL),A              ;= $20
   310  2256  23                    INC         HL
   311  2257  10d4                  DJNZ        CALC_MINIMAP_WALL
   312  2259  09                    ADD         HL,BC
   313  225a  0610                  LD          B,$10
   314  225c  c32d22                JP          CALC_MINIMAP_WALL
   315                          SET_MINIMAP_PLAYER_LOC:
   316  225f  3a793a                LD          A,(PLAYER_MAP_POS)
   317  2262  16b7                  LD          D,$b7                                  ;Set player position color
   318                                                                                  ;to $b7 DKBLU on WHT
   319                                                                                  ;was DKGRN on WHT
   320  2264  cda322                CALL        UPDATE_COLRAM_FROM_OFFSET
   321  2267  cda428                CALL        WAIT_A_TICK
   322                          READ_KEY:
   323  226a  01ff00                LD          BC,$ff
   324  226d  ed78                  IN          A,(C)
   325  226f  3c                    INC         A
   326  2270  c26a22                JP          NZ,READ_KEY
   327                          ENABLE_HC:
   328  2273  0ef7                  LD          C,$f7
   329  2275  3e0f                  LD          A,0xf
   330  2277  ed79                  OUT         (C),A                              ;= db
   331  2279  0d                    DEC         C
   332                          READ_HC:
   333  227a  ed78                  IN          A,(C)                     ;= db
   334  227c  3c                    INC         A
   335  227d  c26a22                JP          NZ,READ_KEY
   336  2280  0c                    INC         C
   337  2281  3e0e                  LD          A,0xe
   338                          DISABLE_HC:
   339  2283  ed79                  OUT         (C),A                              ;= db
   340  2285  0d                    DEC         C
   341  2286  ed78                  IN          A,(C)                     ;= db
   342  2288  3c                    INC         A
   343  2289  c26a22                JP          NZ,READ_KEY
   344  228c  c3042a                JP          UPDATE_VIEWPORT
   345                          MAP_ITEM_MONSTER:
   346  228f  010039                LD          BC,MAP_LADDER_OFFSET
   347                          FIND_NEXT_ITEM_MONSTER_LOOP:
   348  2292  0a                    LD          A,(BC)
   349  2293  03                    INC         BC
   350  2294  3c                    INC         A
   351  2295  c8                    RET         Z
   352  2296  0a                    LD          A,(BC)
   353  2297  bc                    CP          H                                       ;CP A to H (low end of itemRange)
   354  2298  03                    INC         BC
   355  2299  da9222                JP          C,FIND_NEXT_ITEM_MONSTER_LOOP
   356  229c  bd                    CP          L                                       ;CP A to L (high end of itemRange)
   357  229d  d29222                JP          NC,FIND_NEXT_ITEM_MONSTER_LOOP
   358  22a0  0d                    DEC         C
   359  22a1  0b                    DEC         BC
   360  22a2  c9                    RET
   361                          UPDATE_COLRAM_FROM_OFFSET:
   362  22a3  f5                    PUSH        AF
   363  22a4  e60f                  AND         0xf
   364  22a6  21cc34                LD          HL,COLRAM_F0_WALL_MAP_IDX               ;= $60    `
   365  22a9  4f                    LD          C,A
   366  22aa  0600                  LD          B,0x0
   367  22ac  09                    ADD         HL,BC
   368  22ad  f1                    POP         AF
   369  22ae  e6f0                  AND         $f0
   370  22b0  1f                    RRA
   371  22b1  4f                    LD          C,A
   372  22b2  09                    ADD         HL,BC
   373  22b3  17                    RLA
   374  22b4  17                    RLA
   375  22b5  cb10                  RL          B
   376  22b7  4f                    LD          C,A
   377  22b8  09                    ADD         HL,BC
   378  22b9  72                    LD          (HL),D                                  ;LD (HL),D
   379  22ba  c9                    RET
   380                          CHK_ITEM_BREAK:
   381  22bb  78                    LD          A,B                                     ;A  = itemLevel (0-3)
   382  22bc  07                    RLCA                                                ;A  = A * 2
   383  22bd  07                    RLCA                                                ;A  = A * 2
   384  22be  07                    RLCA                                                ;A  = A * 2
   385  22bf  4f                    LD          C,A                                     ;B  = A
   386  22c0  cda73a                CALL        MAKE_RANDOM_BYTE                        ;A  = Random Byte
   387  22c3  81                    ADD         A,C                                     ;A  = A + B (orig A * 8)
   388  22c4  daca22                JP          C,ITEM_POOFS_RH                         ;If A > 255, item breaks
   389  22c7  c605                  ADD         A,0x5                                   ;A  = A + 5
   390  22c9  d0                    RET         NC                                      ;If A < 255, item doesn't break
   391                          ITEM_POOFS_RH:
   392  22ca  37                    SCF                                                 ;Set C
   393  22cb  08                    EX          AF,AF'
   394  22cc  216c33                LD          HL,CHRRAM_RH_POOF_IDX                   ;= $20
   395  22cf  cdb510                CALL        PLAY_POOF_ANIM
   396                          FIX_RH_COLORS:
   397  22d2  f5                    PUSH        AF
   398  22d3  c5                    PUSH        BC
   399  22d4  e5                    PUSH        HL
   400  22d5  3ef0                  LD          A,$f0                                  ;DKGRN on BLK
   401  22d7  010404                LD          BC,$404                                ; 4 x 4 rectangle
   402  22da  214337                LD          HL,COLRAM_RH_ITEM_IDX                   ;= $60    `
   403  22dd  cd3609                CALL        FILL_CHRCOL_RECT
   404  22e0  e1                    POP         HL
   405  22e1  c1                    POP         BC
   406  22e2  f1                    POP         AF
   407  22e3  37                    SCF
   408  22e4  c9                    RET
   409                          SUB_ram_e39a:
   410  22e5  cdc90e                CALL        SOUND_05
   411  22e8  3a873a                LD          A,(BYTE_ram_3a87)
   412  22eb  2a853a                LD          HL,(BYTE_ram_3a85)
   413  22ee  3d                    DEC         A
   414  22ef  c21823                JP          NZ,LAB_ram_e3cd
   415  22f2  2d                    DEC         L
   416  22f3  c20123                JP          NZ,LAB_ram_e3b6
   417  22f6  25                    DEC         H
   418  22f7  caa823                JP          Z,LAB_ram_e45a
   419  22fa  3e31                  LD          A,$31
   420  22fc  32643a                LD          (RAM_AC),A
   421  22ff  2e04                  LD          L,0x4
   422                          LAB_ram_e3b6:
   423  2301  3e04                  LD          A,0x4
   424  2303  32873a                LD          (BYTE_ram_3a87),A
   425  2306  22853a                LD          (BYTE_ram_3a85),HL
   426  2309  2a833a                LD          HL,(BYTE_ram_3a83)
   427  230c  012900                LD          BC,$29
   428  230f  af                    XOR         A
   429  2310  ed42                  SBC         HL,BC
   430  2312  22833a                LD          (BYTE_ram_3a83),HL
   431  2315  c32223                JP          LAB_ram_e3d7
   432                          LAB_ram_e3cd:
   433  2318  32873a                LD          (BYTE_ram_3a87),A
   434  231b  2a833a                LD          HL,(BYTE_ram_3a83)
   435  231e  2b                    DEC         HL
   436  231f  22833a                LD          (BYTE_ram_3a83),HL
   437                          LAB_ram_e3d7:
   438  2322  01c800                LD          BC,$c8
   439  2325  af                    XOR         A
   440  2326  ed42                  SBC         HL,BC
   441  2328  e5                    PUSH        HL
   442  2329  09                    ADD         HL,BC
   443  232a  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
   444  232d  cdc928                CALL        UPDATE_MELEE_OBJECTS
   445  2330  e1                    POP         HL
   446  2331  4d                    LD          C,L
   447  2332  3a643a                LD          A,(RAM_AC)
   448  2335  32633a                LD          (MON_FS),A
   449  2338  3a823a                LD          A,(BYTE_ram_3a82)
   450  233b  cd3a2c                CALL        CHK_ITEM
   451  233e  3e32                  LD          A,$32
   452  2340  32633a                LD          (MON_FS),A
   453  2343  3a693a                LD          A,(TIMER_A)
   454  2346  c6ff                  ADD         A,$ff
   455  2348  32893a                LD          (BYTE_ram_3a89),A
   456  234b  c9                    RET
   457                          SUB_ram_e401:
   458  234c  7d                    LD          A,L
   459  234d  e60f                  AND         0xf
   460  234f  47                    LD          B,A
   461  2350  04                    INC         B
   462  2351  cd6823                CALL        SUB_ram_e41d
   463  2354  4f                    LD          C,A
   464  2355  7d                    LD          A,L
   465  2356  e6f0                  AND         $f0
   466  2358  07                    RLCA
   467  2359  07                    RLCA
   468  235a  07                    RLCA
   469  235b  07                    RLCA
   470  235c  47                    LD          B,A
   471  235d  04                    INC         B
   472  235e  cd6823                CALL        SUB_ram_e41d
   473  2361  07                    RLCA
   474  2362  07                    RLCA
   475  2363  07                    RLCA
   476  2364  07                    RLCA
   477  2365  81                    ADD         A,C
   478  2366  6f                    LD          L,A
   479  2367  c9                    RET
   480                          SUB_ram_e41d:
   481  2368  cdc63a                CALL        UPDATE_SCR_SAVER_TIMER
   482  236b  e60f                  AND         0xf
   483                          LAB_ram_e422:
   484  236d  90                    SUB         B
   485  236e  d26d23                JP          NC,LAB_ram_e422
   486  2371  80                    ADD         A,B
   487  2372  c9                    RET
   488                          SUB_ram_e427:
   489  2373  7d                    LD          A,L
   490  2374  83                    ADD         A,E
   491  2375  27                    DAA
   492  2376  6f                    LD          L,A
   493  2377  7a                    LD          A,D
   494  2378  8c                    ADC         A,H
   495  2379  27                    DAA
   496  237a  67                    LD          H,A
   497  237b  c9                    RET
   498                          RECALC_PHYS_HEALTH:
   499  237c  7d                    LD          A,L
   500  237d  93                    SUB         E
   501  237e  27                    DAA                                                 ;Normalize BCD
   502  237f  6f                    LD          L,A
   503  2380  7c                    LD          A,H
   504  2381  9a                    SBC         A,D
   505  2382  27                    DAA                                                 ;Normalize BCD
   506  2383  67                    LD          H,A
   507  2384  c9                    RET
   508                          SUB_ram_e439:
   509  2385  af                    XOR         A
   510  2386  cb1c                  RR          H
   511  2388  d29423                JP          NC,LAB_ram_e446
   512  238b  cb1d                  RR          L
   513  238d  7d                    LD          A,L
   514  238e  d630                  SUB         $30
   515  2390  6f                    LD          L,A
   516  2391  c39623                JP          LAB_ram_e448
   517                          LAB_ram_e446:
   518  2394  cb1d                  RR          L
   519                          LAB_ram_e448:
   520  2396  cb5d                  BIT         0x3,L
   521  2398  c8                    RET         Z
   522  2399  7d                    LD          A,L
   523  239a  d603                  SUB         0x3
   524  239c  6f                    LD          L,A
   525  239d  c9                    RET
   526                          SUB_ram_e450:
   527  239e  ed5b833a              LD          DE,(BYTE_ram_3a83)
   528  23a2  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
   529  23a5  c3e628                JP          SUB_ram_e97d
   530                          LAB_ram_e45a:
   531  23a8  cd9e23                CALL        SUB_ram_e450
   532  23ab  3e32                  LD          A,$32
   533  23ad  32643a                LD          (RAM_AC),A
   534  23b0  32653a                LD          (RAM_AD),A
   535  23b3  3a9b3a                LD          A,(WEAPON_SPRT)
   536  23b6  5f                    LD          E,A
   537  23b7  1600                  LD          D,0x0
   538  23b9  fe00                  CP          0x0
   539  23bb  c26424                JP          NZ,LAB_ram_e50f
   540  23be  ed5b993a              LD          DE,(WEAPON_PHYS)
   541  23c2  d9                    EXX
   542  23c3  cd8e26                CALL        NEW_RIGHT_HAND_ITEM
   543  23c6  d9                    EXX
   544  23c7  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
   545  23ca  cd8523                CALL        SUB_ram_e439
   546  23cd  cd7c23                CALL        RECALC_PHYS_HEALTH
   547  23d0  d2d623                JP          NC,LAB_ram_e487
   548  23d3  210000                LD          HL,0x0
   549                          LAB_ram_e487:
   550  23d6  cd4c23                CALL        SUB_ram_e401
   551  23d9  6c                    LD          L,H
   552  23da  67                    LD          H,A
   553  23db  cd4c23                CALL        SUB_ram_e401
   554  23de  6c                    LD          L,H
   555  23df  67                    LD          H,A
   556  23e0  eb                    EX          DE,HL
   557  23e1  cd8523                CALL        SUB_ram_e439
   558  23e4  eb                    EX          DE,HL
   559  23e5  cd7323                CALL        SUB_ram_e427
   560  23e8  eb                    EX          DE,HL
   561  23e9  cd4c23                CALL        SUB_ram_e401
   562  23ec  cd7323                CALL        SUB_ram_e427
   563  23ef  ed5ba63a              LD          DE,(NEW_DAMAGE)
   564  23f3  cd7c23                CALL        RECALC_PHYS_HEALTH
   565  23f6  da0d24                JP          C,LAB_ram_e4bb
   566                          LAB_ram_e4a9:
   567  23f9  eb                    EX          DE,HL
   568  23fa  2aa33a                LD          HL,(CURR_MONSTER_PHYS)
   569  23fd  cd7c23                CALL        RECALC_PHYS_HEALTH
   570  2400  da1624                JP          C,LAB_ram_e4c3
   571  2403  b5                    OR          L
   572  2404  ca1624                JP          Z,LAB_ram_e4c3
   573  2407  22a33a                LD          (CURR_MONSTER_PHYS),HL
   574  240a  c33d32                JP          REDRAW_MONSTER_HEALTH
   575                          LAB_ram_e4bb:
   576  240d  210600                LD          HL,0x6
   577  2410  cd4c23                CALL        SUB_ram_e401
   578  2413  c3f923                JP          LAB_ram_e4a9
   579                          LAB_ram_e4c3:
   580  2416  d9                    EXX
   581  2417  210000                LD          HL,0x0
   582  241a  22a33a                LD          (CURR_MONSTER_PHYS),HL
   583  241d  cd3d32                CALL        REDRAW_MONSTER_HEALTH
   584  2420  d9                    EXX
   585  2421  2c                    INC         L
   586  2422  3e99                  LD          A,$99
   587  2424  bc                    CP          H
   588  2425  c2fd10                JP          NZ,MONSTER_KILLED
   589  2428  3e61                  LD          A,$61
   590  242a  bd                    CP          L
   591  242b  d2fd10                JP          NC,MONSTER_KILLED
   592  242e  3a4134                LD          A,(COLRAM_PHYS_STATS_1000)              ;= $60
   593  2431  cdfe24                CALL        SUB_ram_e5ba
   594  2434  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
   595  2437  cd8523                CALL        SUB_ram_e439
   596  243a  7d                    LD          A,L
   597  243b  b8                    CP          B
   598  243c  d2fd10                JP          NC,MONSTER_KILLED
   599                          LAB_ram_e4ec:
   600  243f  cdc63a                CALL        UPDATE_SCR_SAVER_TIMER
   601  2442  d640                  SUB         $40
   602  2444  da4b24                JP          C,INCREASE_MAX_PHYS_HEALTH
   603  2447  b9                    CP          C
   604  2448  d2fd10                JP          NC,MONSTER_KILLED
   605                          INCREASE_MAX_PHYS_HEALTH:
   606  244b  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
   607  244e  7d                    LD          A,L
   608  244f  c601                  ADD         A,0x1
   609  2451  27                    DAA                                                 ;Correct for BCD
   610  2452  6f                    LD          L,A
   611  2453  7c                    LD          A,H
   612  2454  ce00                  ADC         A,0x0
   613  2456  67                    LD          H,A
   614  2457  22953a                LD          (PLAYER_PHYS_HEALTH_MAX),HL
   615  245a  79                    LD          A,C
   616  245b  d610                  SUB         $10
   617  245d  dafd10                JP          C,MONSTER_KILLED
   618  2460  4f                    LD          C,A
   619  2461  c33f24                JP          LAB_ram_e4ec
   620                          LAB_ram_e50f:
   621  2464  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
   622  2467  2600                  LD          H,0x0
   623  2469  6f                    LD          L,A
   624  246a  d9                    EXX
   625  246b  cd8e26                CALL        NEW_RIGHT_HAND_ITEM
   626  246e  d9                    EXX
   627  246f  cd8523                CALL        SUB_ram_e439
   628  2472  7d                    LD          A,L
   629  2473  93                    SUB         E
   630  2474  27                    DAA
   631  2475  6f                    LD          L,A
   632  2476  d27b24                JP          NC,LAB_ram_e525
   633  2479  2e00                  LD          L,0x0
   634                          LAB_ram_e525:
   635  247b  cd4c23                CALL        SUB_ram_e401
   636  247e  eb                    EX          DE,HL
   637  247f  cd8523                CALL        SUB_ram_e439
   638  2482  7d                    LD          A,L
   639  2483  83                    ADD         A,E
   640  2484  27                    DAA
   641  2485  5f                    LD          E,A
   642  2486  cd4c23                CALL        SUB_ram_e401
   643  2489  83                    ADD         A,E
   644  248a  27                    DAA
   645  248b  6f                    LD          L,A
   646  248c  3aa53a                LD          A,(BYTE_ram_3aa5)
   647  248f  5f                    LD          E,A
   648  2490  7d                    LD          A,L
   649  2491  93                    SUB         E
   650  2492  27                    DAA
   651  2493  daa824                JP          C,LAB_ram_e54f
   652  2496  6f                    LD          L,A
   653                          MONSTER_TAKES_SPRT_DAMAGE:
   654  2497  3aa23a                LD          A,(CURR_MONSTER_SPRT)
   655  249a  95                    SUB         L
   656  249b  27                    DAA
   657  249c  dab124                JP          C,LAB_ram_e557
   658  249f  cab124                JP          Z,LAB_ram_e557
   659  24a2  32a23a                LD          (CURR_MONSTER_SPRT),A
   660  24a5  c33d32                JP          REDRAW_MONSTER_HEALTH
   661                          LAB_ram_e54f:
   662  24a8  210300                LD          HL,0x3
   663  24ab  cd4c23                CALL        SUB_ram_e401
   664  24ae  c39724                JP          MONSTER_TAKES_SPRT_DAMAGE
   665                          LAB_ram_e557:
   666  24b1  f5                    PUSH        AF
   667  24b2  af                    XOR         A
   668  24b3  32a23a                LD          (CURR_MONSTER_SPRT),A
   669  24b6  cd3d32                CALL        REDRAW_MONSTER_HEALTH
   670  24b9  f1                    POP         AF
   671  24ba  3d                    DEC         A
   672  24bb  fe86                  CP          $86
   673  24bd  daec24                JP          C,ITEM_USED_UP
   674  24c0  3a4634                LD          A,(COLRAM_SPRT_STATS_10)                ;= $60
   675  24c3  cdfe24                CALL        SUB_ram_e5ba
   676  24c6  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
   677  24c9  b8                    CP          B
   678  24ca  d2ec24                JP          NC,ITEM_USED_UP
   679                          REDUCE_ITEM_BY_30:
   680  24cd  cdc63a                CALL        UPDATE_SCR_SAVER_TIMER
   681  24d0  d630                  SUB         $30
   682  24d2  dad924                JP          C,INCREASE_MAX_SPRT_HEALTH
   683  24d5  b9                    CP          C
   684  24d6  d2ec24                JP          NC,ITEM_USED_UP
   685                          INCREASE_MAX_SPRT_HEALTH:
   686  24d9  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
   687  24dc  c601                  ADD         A,0x1
   688  24de  27                    DAA                                                 ;Correct for BCD
   689  24df  32983a                LD          (PLAYER_SPRT_HEALTH_MAX),A
   690  24e2  79                    LD          A,C
   691  24e3  d610                  SUB         $10
   692  24e5  daec24                JP          C,ITEM_USED_UP
   693  24e8  4f                    LD          C,A
   694  24e9  c3cd24                JP          REDUCE_ITEM_BY_30
   695                          ITEM_USED_UP:
   696  24ec  c3fd10                JP          MONSTER_KILLED
   697                          CLEAR_MONSTER_STATS:
   698  24ef  af                    XOR         A                                       ;A  = $fe on entry (usually)
   699                                                                                  ;A  = $00 after
   700                                                                                  ;Reset C & N, Set Z
   701                                                                                  ;
   702  24f0  32783a                LD          (LAST_ITEM_HELD),A                   ;ItemHolder = $00
   703  24f3  010304                LD          BC,$403
   704  24f6  213d33                LD          HL,CHRRAM_LEVEL_IDX                     ;= $20
   705  24f9  3e20                  LD          A,$20
   706  24fb  c33609                JP          FILL_CHRCOL_RECT
   707                          SUB_ram_e5ba:
   708  24fe  e60f                  AND         0xf
   709  2500  3c                    INC         A
   710  2501  3c                    INC         A
   711  2502  47                    LD          B,A
   712  2503  07                    RLCA
   713  2504  07                    RLCA
   714  2505  07                    RLCA
   715  2506  07                    RLCA
   716  2507  4f                    LD          C,A
   717  2508  78                    LD          A,B
   718  2509  87                    ADD         A,A
   719  250a  27                    DAA
   720  250b  87                    ADD         A,A
   721  250c  27                    DAA
   722  250d  87                    ADD         A,A
   723  250e  27                    DAA
   724  250f  87                    ADD         A,A
   725  2510  27                    DAA
   726  2511  47                    LD          B,A
   727  2512  c9                    RET
   728                          MELEE_ANIM_LOOP:
   729  2513  cdc90e                CALL        SOUND_05
   730  2516  3a8b3a                LD          A,(MELEE_ANIM_STATE)
   731  2519  2a8d3a                LD          HL,(MONSTER_ATT_POS_COUNT)
   732  251c  3d                    DEC         A
   733  251d  c24425                JP          NZ,LAB_ram_e600
   734  2520  2d                    DEC         L
   735  2521  c22f25                JP          NZ,LAB_ram_e5eb
   736  2524  25                    DEC         H
   737  2525  ca8325                JP          Z,LAB_ram_e63f
   738  2528  3e32                  LD          A,$32
   739  252a  32673a                LD          (RAM_AF),A
   740  252d  2e02                  LD          L,0x2
   741                          LAB_ram_e5eb:
   742  252f  3e03                  LD          A,0x3
   743  2531  328b3a                LD          (MELEE_ANIM_STATE),A
   744  2534  228d3a                LD          (MONSTER_ATT_POS_COUNT),HL
   745  2537  2a8f3a                LD          HL,(MONSTER_ATT_POS_OFFSET)
   746  253a  012900                LD          BC,$29
   747  253d  09                    ADD         HL,BC
   748  253e  228f3a                LD          (MONSTER_ATT_POS_OFFSET),HL
   749  2541  c34e25                JP          ANIMATE_MELEE_ROUND
   750                          LAB_ram_e600:
   751  2544  328b3a                LD          (MELEE_ANIM_STATE),A
   752  2547  2a8f3a                LD          HL,(MONSTER_ATT_POS_OFFSET)
   753  254a  23                    INC         HL
   754  254b  228f3a                LD          (MONSTER_ATT_POS_OFFSET),HL
   755                          ANIMATE_MELEE_ROUND:
   756  254e  01c800                LD          BC,$c8
   757  2551  af                    XOR         A
   758  2552  ed42                  SBC         HL,BC
   759  2554  e5                    PUSH        HL
   760  2555  09                    ADD         HL,BC
   761  2556  11203a                LD          DE,BYTE_ram_3a20
   762  2559  cdc928                CALL        UPDATE_MELEE_OBJECTS
   763  255c  c1                    POP         BC
   764  255d  0600                  LD          B,0x0
   765  255f  3a673a                LD          A,(RAM_AF)
   766  2562  32633a                LD          (MON_FS),A
   767  2565  3a8a3a                LD          A,(BYTE_ram_3a8a)
   768  2568  cd3a2c                CALL        CHK_ITEM
   769  256b  3e32                  LD          A,$32
   770  256d  32633a                LD          (MON_FS),A
   771  2570  3a693a                LD          A,(TIMER_A)
   772  2573  c6ff                  ADD         A,$ff
   773  2575  328c3a                LD          (BYTE_ram_3a8c),A
   774  2578  c9                    RET
   775                          SUB_ram_e635:
   776  2579  ed5b8f3a              LD          DE,(MONSTER_ATT_POS_OFFSET)
   777  257d  21203a                LD          HL,BYTE_ram_3a20
   778  2580  c3e628                JP          SUB_ram_e97d
   779                          LAB_ram_e63f:
   780  2583  cd7925                CALL        SUB_ram_e635
   781  2586  3e31                  LD          A,$31
   782  2588  32673a                LD          (RAM_AF),A
   783  258b  32663a                LD          (RAM_AE),A
   784  258e  3a6c3a                LD          A,(INPUT_HOLDER)
   785  2591  47                    LD          B,A
   786  2592  2600                  LD          H,0x0
   787  2594  3aa83a                LD          A,(WEAPON_VALUE_HOLDER)
   788  2597  6f                    LD          L,A
   789  2598  c39d25                JP          LAB_ram_e658
   790                          LAB_ram_e656:
   791  259b  85                    ADD         A,L
   792  259c  27                    DAA
   793                          LAB_ram_e658:
   794  259d  10fc                  DJNZ        LAB_ram_e656
   795  259f  6f                    LD          L,A
   796  25a0  3a8a3a                LD          A,(BYTE_ram_3a8a)
   797  25a3  e6fc                  AND         $fc
   798  25a5  fe24                  CP          $24
   799  25a7  c2dc25                JP          NZ,LAB_ram_e693
   800  25aa  3a733a                LD          A,(SHIELD_SPRT)
   801  25ad  5f                    LD          E,A
   802  25ae  cd8523                CALL        SUB_ram_e439
   803  25b1  55                    LD          D,L
   804  25b2  cd4c23                CALL        SUB_ram_e401
   805  25b5  7d                    LD          A,L
   806  25b6  82                    ADD         A,D
   807  25b7  27                    DAA
   808  25b8  93                    SUB         E
   809  25b9  27                    DAA
   810  25ba  dad225                JP          C,LAB_ram_e68a
   811  25bd  5f                    LD          E,A
   812                          LAB_ram_e677:
   813  25be  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
   814  25c1  93                    SUB         E
   815  25c2  27                    DAA
   816  25c3  da562f                JP          C,PLAYER_DIES
   817  25c6  ca562f                JP          Z,PLAYER_DIES
   818  25c9  32973a                LD          (PLAYER_SPRT_HEALTH),A
   819  25cc  cdde3c                CALL        REDRAW_STATS
   820  25cf  c30826                JP          LAB_ram_e6be
   821                          LAB_ram_e68a:
   822  25d2  210200                LD          HL,0x2
   823  25d5  cd4c23                CALL        SUB_ram_e401
   824  25d8  5d                    LD          E,L
   825  25d9  c3be25                JP          LAB_ram_e677
   826                          LAB_ram_e693:
   827  25dc  cd4c23                CALL        SUB_ram_e401
   828  25df  3aa83a                LD          A,(WEAPON_VALUE_HOLDER)
   829  25e2  85                    ADD         A,L
   830  25e3  27                    DAA
   831  25e4  6f                    LD          L,A
   832  25e5  7c                    LD          A,H
   833  25e6  ce00                  ADC         A,0x0
   834  25e8  27                    DAA
   835  25e9  67                    LD          H,A
   836  25ea  ed5b713a              LD          DE,(SHIELD_PHYS)
   837  25ee  cd7c23                CALL        RECALC_PHYS_HEALTH
   838  25f1  da0e26                JP          C,LAB_ram_e6c4
   839                          LAB_ram_e6aa:
   840  25f4  eb                    EX          DE,HL
   841  25f5  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
   842  25f8  cd7c23                CALL        RECALC_PHYS_HEALTH
   843  25fb  da562f                JP          C,PLAYER_DIES
   844  25fe  b5                    OR          L
   845  25ff  ca562f                JP          Z,PLAYER_DIES
   846  2602  22933a                LD          (PLAYER_PHYS_HEALTH),HL
   847  2605  cdde3c                CALL        REDRAW_STATS
   848                          LAB_ram_e6be:
   849  2608  cdef34                CALL        REDRAW_START
   850  260b  c3ff37                JP          REDRAW_VIEWPORT
   851                          LAB_ram_e6c4:
   852  260e  210300                LD          HL,0x3
   853  2611  cd4c23                CALL        SUB_ram_e401
   854  2614  c3f425                JP          LAB_ram_e6aa
   855                          DO_SWAP_HANDS:
   856  2617  217a3a                LD          HL,RIGHT_HAND_ITEM
   857  261a  017b3a                LD          BC,LEFT_HAND_ITEM
   858  261d  cdd029                CALL        SUB_ram_ea62
   859  2620  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
   860  2623  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
   861  2626  cdc928                CALL        UPDATE_MELEE_OBJECTS
   862  2629  213933                LD          HL,CHRRAM_LEFT_HD_GFX_IDX               ;= $20
   863  262c  114333                LD          DE,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
   864  262f  cd0729                CALL        SUB_ram_e99e
   865  2632  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
   866  2635  113933                LD          DE,CHRRAM_LEFT_HD_GFX_IDX               ;= $20
   867  2638  cde628                CALL        SUB_ram_e97d
   868  263b  cd8e26                CALL        NEW_RIGHT_HAND_ITEM
   869  263e  010000                LD          BC,0x0
   870  2641  217a3a                LD          HL,RIGHT_HAND_ITEM
   871  2644  cd6b26                CALL        SUB_ram_e720
   872  2647  3a733a                LD          A,(SHIELD_SPRT)
   873  264a  91                    SUB         C
   874  264b  27                    DAA
   875  264c  32733a                LD          (SHIELD_SPRT),A
   876  264f  3a713a                LD          A,(SHIELD_PHYS)
   877  2652  90                    SUB         B
   878  2653  27                    DAA
   879  2654  32713a                LD          (SHIELD_PHYS),A
   880  2657  3a723a                LD          A,(SHIELD_PHYS+1)
   881  265a  de00                  SBC         A,0x0
   882  265c  32723a                LD          (SHIELD_PHYS+1),A
   883  265f  010000                LD          BC,0x0
   884  2662  217b3a                LD          HL,LEFT_HAND_ITEM
   885  2665  cd6b26                CALL        SUB_ram_e720
   886  2668  c37327                JP          LAB_ram_e812
   887                          SUB_ram_e720:
   888  266b  7e                    LD          A,(HL)
   889  266c  fe14                  CP          $14
   890  266e  d0                    RET         NC
   891  266f  fe10                  CP          $10
   892  2671  d27726                JP          NC,LAB_ram_e72b
   893  2674  fe04                  CP          0x4
   894  2676  d0                    RET         NC
   895                          LAB_ram_e72b:
   896  2677  e603                  AND         0x3
   897  2679  3c                    INC         A
   898  267a  cd2a29                CALL        SUB_ram_e9c1
   899  267d  7e                    LD          A,(HL)
   900  267e  e6fc                  AND         $fc
   901  2680  c0                    RET         NZ
   902  2681  2600                  LD          H,0x0
   903  2683  68                    LD          L,B
   904  2684  cd8523                CALL        SUB_ram_e439
   905  2687  45                    LD          B,L
   906  2688  69                    LD          L,C
   907  2689  cd8523                CALL        SUB_ram_e439
   908  268c  4d                    LD          C,L
   909  268d  c9                    RET
   910                          NEW_RIGHT_HAND_ITEM:
   911  268e  3a7a3a                LD          A,(RIGHT_HAND_ITEM)
   912  2691  fe18                  CP          $18                                    ;Less than RED Bow
   913  2693  da1b27                JP          C,LAB_ram_e7c0
   914  2696  fe34                  CP          $34                                    ;Greater than WHITE Crossbow
   915  2698  d21b27                JP          NC,LAB_ram_e7c0
   916  269b  010000                LD          BC,0x0                                  ;C = 0
   917  269e  1e00                  LD          E,0x0                                   ;E = 0
   918  26a0  cb3f                  SRL         A                                       ;Div A by 2
   919  26a2  cb18                  RR          B
   920  26a4  1f                    RRA
   921  26a5  cb10                  RL          B
   922  26a7  cb10                  RL          B
   923  26a9  d606                  SUB         0x6
   924  26ab  c2b326                JP          NZ,LAB_ram_e763
   925  26ae  1606                  LD          D,0x6
   926  26b0  c3e526                JP          LAB_ram_e78b
   927                          LAB_ram_e763:
   928  26b3  3d                    DEC         A
   929  26b4  c2bc26                JP          NZ,LAB_ram_e76a
   930  26b7  1606                  LD          D,0x6
   931  26b9  c3f926                JP          LAB_ram_e79e
   932                          LAB_ram_e76a:
   933  26bc  3d                    DEC         A
   934  26bd  c2c526                JP          NZ,LAB_ram_e771
   935  26c0  1616                  LD          D,$16
   936  26c2  c3e526                JP          LAB_ram_e78b
   937                          LAB_ram_e771:
   938  26c5  3d                    DEC         A
   939  26c6  c2ce26                JP          NZ,LAB_ram_e778
   940  26c9  1620                  LD          D,$20
   941  26cb  c3f926                JP          LAB_ram_e79e
   942                          LAB_ram_e778:
   943  26ce  3d                    DEC         A
   944  26cf  c2d726                JP          NZ,LAB_ram_e77f
   945  26d2  1624                  LD          D,$24
   946  26d4  c3e526                JP          LAB_ram_e78b
   947                          LAB_ram_e77f:
   948  26d7  3d                    DEC         A
   949  26d8  c2e026                JP          NZ,LAB_ram_e786
   950  26db  1615                  LD          D,$15
   951  26dd  c3f926                JP          LAB_ram_e79e
   952                          LAB_ram_e786:
   953  26e0  3d                    DEC         A
   954  26e1  1618                  LD          D,$18
   955  26e3  00                    NOP
   956  26e4  00                    NOP
   957                          LAB_ram_e78b:
   958  26e5  cd5932                CALL        CALC_WEAPON_VALUE
   959  26e8  87                    ADD         A,A
   960  26e9  27                    DAA                                                 ;BCD Correction
   961  26ea  6f                    LD          L,A
   962  26eb  3e00                  LD          A,0x0
   963  26ed  17                    RLA
   964  26ee  67                    LD          H,A
   965  26ef  22993a                LD          (WEAPON_PHYS),HL
   966  26f2  af                    XOR         A
   967  26f3  329b3a                LD          (WEAPON_SPRT),A
   968  26f6  c30527                JP          LAB_ram_e7aa
   969                          LAB_ram_e79e:
   970  26f9  cd5932                CALL        CALC_WEAPON_VALUE
   971  26fc  329b3a                LD          (WEAPON_SPRT),A
   972  26ff  210000                LD          HL,0x0
   973  2702  22993a                LD          (WEAPON_PHYS),HL
   974                          LAB_ram_e7aa:
   975  2705  119130                LD          DE,CHRRAM_PHYS_WEAPON_IDX               ;= $20
   976  2708  21993a                LD          HL,WEAPON_PHYS
   977  270b  0602                  LD          B,0x2
   978  270d  cdd532                CALL        RECALC_AND_REDRAW_BCD
   979  2710  119730                LD          DE,CHRRAM_SPRT_WEAPON_IDX               ;= $20
   980  2713  219b3a                LD          HL,WEAPON_SPRT
   981  2716  0601                  LD          B,0x1
   982  2718  c3d532                JP          RECALC_AND_REDRAW_BCD
   983                          LAB_ram_e7c0:
   984  271b  210000                LD          HL,0x0                                  ;HL = 0
   985  271e  af                    XOR         A                                       ;A  = 0
   986  271f  22993a                LD          (WEAPON_PHYS),HL
   987  2722  329b3a                LD          (WEAPON_SPRT),A
   988  2725  c30527                JP          LAB_ram_e7aa
   989                          DO_PICK_UP:
   990  2728  3aa13a                LD          A,(ITEM_HOLDER)
   991  272b  47                    LD          B,A
   992  272c  3a793a                LD          A,(PLAYER_MAP_POS)
   993  272f  b8                    CP          B                                       ;Check difference between
   994                                                                                  ;item and item location
   995  2730  caa621                JP          Z,NO_ACTION_TAKEN
   996  2733  3c                    INC         A
   997  2734  caa621                JP          Z,NO_ACTION_TAKEN
   998  2737  3d                    DEC         A
   999  2738  cdec37                CALL        ITEM_MAP_CHECK
  1000  273b  caa527                JP          Z,LAB_ram_e844
  1001  273e  fe04                  CP          0x4                                     ;Compare to RING (0x4)
  1002  2740  daa827                JP          C,CHECK_FOOD_ARROWS                     ;Jump if less than RING (C)
  1003  2743  fe10                  CP          $10                                    ;Compare to PAVICE ($10)
  1004  2745  d2a827                JP          NC,CHECK_FOOD_ARROWS                    ;Jump if PAVICE or greater (NC)
  1005                          PROCESS_RHA:
  1006  2748  cdaa28                CALL        PICK_UP_F0_ITEM
  1007  274b  21743a                LD          HL,ARMOR_INV_SLOT                       ;Start with ARMOR slot
  1008  274e  3d                    DEC         A                                       ;Subtract 1 from A:
  1009                                                                                  ;- Armor
  1010  274f  c25427                JP          NZ,NOT_ARMOR                            ;Treat as NOT ARMOR
  1011  2752  23                    INC         HL                                      ;HL = HELMET_INV_SLOT
  1012  2753  23                    INC         HL                                      ;HL = RING_INV_SLOT
  1013                          NOT_ARMOR:
  1014  2754  3d                    DEC         A
  1015  2755  c25927                JP          NZ,NOT_HELMET
  1016  2758  23                    INC         HL
  1017                          NOT_HELMET:
  1018  2759  7e                    LD          A,(HL)
  1019  275a  14                    INC         D
  1020  275b  ba                    CP          D
  1021  275c  d20a2a                JP          NC,INPUT_DEBOUNCE
  1022  275f  08                    EX          AF,AF'
  1023  2760  7a                    LD          A,D
  1024  2761  77                    LD          (HL),A
  1025  2762  cd2a29                CALL        SUB_ram_e9c1
  1026  2765  59                    LD          E,C
  1027  2766  50                    LD          D,B
  1028  2767  08                    EX          AF,AF'
  1029  2768  cd2a29                CALL        SUB_ram_e9c1
  1030  276b  7b                    LD          A,E
  1031  276c  91                    SUB         C
  1032  276d  27                    DAA                                                 ;BCD Correction
  1033  276e  4f                    LD          C,A
  1034  276f  7a                    LD          A,D
  1035  2770  90                    SUB         B
  1036  2771  27                    DAA                                                 ;BCD Correction
  1037  2772  47                    LD          B,A
  1038                          LAB_ram_e812:
  1039  2773  3a733a                LD          A,(SHIELD_SPRT)
  1040  2776  81                    ADD         A,C
  1041  2777  27                    DAA                                                 ;BCD Correction
  1042  2778  32733a                LD          (SHIELD_SPRT),A
  1043  277b  3a713a                LD          A,(SHIELD_PHYS)
  1044  277e  80                    ADD         A,B
  1045  277f  27                    DAA                                                 ;BCD Correction
  1046  2780  32713a                LD          (SHIELD_PHYS),A
  1047  2783  3a723a                LD          A,(SHIELD_PHYS+1)
  1048  2786  ce00                  ADC         A,0x0
  1049  2788  27                    DAA                                                 ;BCD Correction
  1050  2789  32723a                LD          (SHIELD_PHYS+1),A
  1051  278c  21713a                LD          HL,SHIELD_PHYS
  1052  278f  116930                LD          DE,CHRRAM_PHYS_SHIELD_IDX               ;= $20
  1053  2792  0602                  LD          B,0x2
  1054  2794  cdd532                CALL        RECALC_AND_REDRAW_BCD
  1055  2797  21733a                LD          HL,SHIELD_SPRT
  1056  279a  116f30                LD          DE,CHRRAM_SPRT_SHIELD_IDX               ;= $20
  1057  279d  0601                  LD          B,0x1
  1058  279f  cdd532                CALL        RECALC_AND_REDRAW_BCD
  1059  27a2  c3273d                JP          RHA_REDRAW                              ;Was JP AWAITING_INPUT
  1060                                                                                  ;(c3 9c ea)
  1061                          LAB_ram_e844:
  1062  27a5  cc4e29                CALL        Z,SUB_ram_e9e1
  1063                          CHECK_FOOD_ARROWS:
  1064  27a8  fe48                  CP          $48
  1065  27aa  dafc27                JP          C,CHECK_MAP_NECKLACE_CHARMS             ;CHEST or lower
  1066  27ad  fe50                  CP          $50
  1067  27af  d2fc27                JP          NC,CHECK_MAP_NECKLACE_CHARMS            ;LOCKED CHEST or higher
  1068  27b2  cdaa28                CALL        PICK_UP_F0_ITEM
  1069  27b5  14                    INC         D
  1070  27b6  cb12                  RL          D
  1071  27b8  14                    INC         D
  1072  27b9  fe12                  CP          $12
  1073  27bb  c2eb27                JP          NZ,PICK_UP_ARROWS
  1074  27be  d5                    PUSH        DE
  1075  27bf  cdc927                CALL        PICK_UP_FOOD
  1076  27c2  d1                    POP         DE
  1077  27c3  cdc927                CALL        PICK_UP_FOOD
  1078  27c6  c30a2a                JP          INPUT_DEBOUNCE
  1079                          PICK_UP_FOOD:
  1080  27c9  3aab3a                LD          A,(FOOD_INV)
  1081  27cc  82                    ADD         A,D
  1082  27cd  d2d827                JP          NC,LAB_ram_e872
  1083  27d0  3c                    INC         A
  1084  27d1  4f                    LD          C,A
  1085  27d2  7a                    LD          A,D
  1086  27d3  91                    SUB         C
  1087  27d4  57                    LD          D,A
  1088  27d5  c3c927                JP          PICK_UP_FOOD
  1089                          LAB_ram_e872:
  1090  27d8  32ab3a                LD          (FOOD_INV),A
  1091  27db  2aa93a                LD          HL,(BYTE_ram_3aa9)
  1092  27de  7a                    LD          A,D
  1093  27df  85                    ADD         A,L
  1094  27e0  27                    DAA                                                 ;BCD correct
  1095  27e1  6f                    LD          L,A
  1096  27e2  7c                    LD          A,H
  1097  27e3  ce00                  ADC         A,0x0
  1098  27e5  27                    DAA                                                 ;BCD correct
  1099  27e6  67                    LD          H,A
  1100  27e7  22a93a                LD          (BYTE_ram_3aa9),HL
  1101  27ea  c9                    RET
  1102                          PICK_UP_ARROWS:
  1103  27eb  3aac3a                LD          A,(ARROW_INV)
  1104  27ee  82                    ADD         A,D
  1105  27ef  fe33                  CP          $33
  1106  27f1  daf627                JP          C,ADD_ARROWS_TO_INV
  1107  27f4  3e32                  LD          A,$32
  1108                          ADD_ARROWS_TO_INV:
  1109  27f6  32ac3a                LD          (ARROW_INV),A
  1110  27f9  c30a2a                JP          INPUT_DEBOUNCE
  1111                          CHECK_MAP_NECKLACE_CHARMS:
  1112  27fc  fe6c                  CP          $6c                                    ;Red MAP
  1113  27fe  ca2028                JP          Z,PROCESS_MAP
  1114  2801  fe6d                  CP          $6d                                    ;Yellow MAP
  1115  2803  ca2028                JP          Z,PROCESS_MAP
  1116  2806  fede                  CP          $de                                    ;Purple MAP
  1117  2808  ca2028                JP          Z,PROCESS_MAP
  1118  280b  fedf                  CP          $df                                    ;White MAP
  1119  280d  ca2028                JP          Z,PROCESS_MAP
  1120  2810  fe5c                  CP          $5c                                    ;WHITE KEY or lower
  1121  2812  da3f28                JP          C,PICK_UP_NON_TREASURE
  1122  2815  fe64                  CP          $64
  1123  2817  d23f28                JP          NC,PICK_UP_NON_TREASURE                 ;WARRIOR POTION or higher
  1124  281a  cdaa28                CALL        PICK_UP_F0_ITEM
  1125  281d  c30a2a                JP          INPUT_DEBOUNCE
  1126                          PROCESS_MAP:
  1127  2820  f5                    PUSH        AF
  1128  2821  3ab93a                LD          A,(GAME_BOOLEANS)
  1129  2824  cbd7                  SET         0x2,A
  1130  2826  32b93a                LD          (GAME_BOOLEANS),A
  1131  2829  f1                    POP         AF
  1132  282a  cdaa28                CALL        PICK_UP_F0_ITEM
  1133  282d  ed53ad3a              LD          (MAP_INV_SLOT),DE
  1134  2831  f5                    PUSH        AF
  1135  2832  3aad3a                LD          A,(MAP_INV_SLOT)
  1136  2835  cd1b3d                CALL        LEVEL_TO_COLRAM_FIX
  1137  2838  321134                LD          (COLRAM_MAP_IDX),A                      ;= $60    `
  1138  283b  f1                    POP         AF
  1139  283c  c30a2a                JP          INPUT_DEBOUNCE
  1140                          PICK_UP_NON_TREASURE:
  1141  283f  217a3a                LD          HL,RIGHT_HAND_ITEM
  1142  2842  7e                    LD          A,(HL)
  1143  2843  32ea37                LD          (ITEM_F0),A                             ;= $60
  1144  2846  cdd029                CALL        SUB_ram_ea62
  1145  2849  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1146  284c  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
  1147  284f  cdc928                CALL        UPDATE_MELEE_OBJECTS
  1148  2852  215233                LD          HL,CHRRAM_FO_ITEM_IDX                   ;= $20
  1149  2855  114333                LD          DE,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1150  2858  cd0729                CALL        SUB_ram_e99e
  1151  285b  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
  1152  285e  115233                LD          DE,CHRRAM_FO_ITEM_IDX                   ;= $20
  1153  2861  cde628                CALL        SUB_ram_e97d
  1154  2864  215237                LD          HL,COLRAM_FO_ITEM_IDX                   ;= $60    `
  1155  2867  11000f                LD          DE,$f00                                ;BLK on DKGY /
  1156                                                                                  ;BLK on BLK
  1157                                                                                  ;WAS BLK on DKCYN /
  1158                                                                                  ;    BLK on BLK
  1159                                                                                  ;WAS LD DE,$0900
  1160  286a  0ef0                  LD          C,$f0                                  ;Floor color (for compare)
  1161                                                                                  ;DKGRY on BLK
  1162                                                                                  ;WAS DKCYN on BLK
  1163  286c  cd8028                CALL        RECOLOR_ITEM
  1164  286f  214337                LD          HL,COLRAM_RH_ITEM_IDX                   ;= $60    `
  1165  2872  11f000                LD          DE,$f0                                 ;Floor color (for fill)
  1166                                                                                  ;DKGRY on BLK
  1167                                                                                  ;WAS DKCYN on BLK
  1168  2875  0e00                  LD          C,0x0
  1169  2877  cd8028                CALL        RECOLOR_ITEM
  1170  287a  cd8e26                CALL        NEW_RIGHT_HAND_ITEM
  1171  287d  c30a2a                JP          INPUT_DEBOUNCE
  1172                          RECOLOR_ITEM:
  1173  2880  3e04                  LD          A,0x4
  1174                          LAB_ram_e91c:
  1175  2882  08                    EX          AF,AF'
  1176  2883  0604                  LD          B,0x4
  1177                          LAB_ram_e91f:
  1178  2885  7e                    LD          A,(HL)
  1179  2886  e6f0                  AND         $f0
  1180  2888  bb                    CP          E
  1181  2889  ca9d28                JP          Z,LAB_ram_e935
  1182  288c  b2                    OR          D
  1183                          LAB_ram_e926:
  1184  288d  77                    LD          (HL),A
  1185  288e  23                    INC         HL
  1186  288f  10f4                  DJNZ        LAB_ram_e91f
  1187  2891  d5                    PUSH        DE
  1188  2892  112400                LD          DE,$24                                 ;Jump ahead 36 cells
  1189                                                                                  ;(40 - 4)
  1190  2895  19                    ADD         HL,DE
  1191  2896  d1                    POP         DE
  1192  2897  08                    EX          AF,AF'
  1193  2898  3d                    DEC         A
  1194  2899  c28228                JP          NZ,LAB_ram_e91c
  1195  289c  c9                    RET
  1196                          LAB_ram_e935:
  1197  289d  7e                    LD          A,(HL)
  1198  289e  e60f                  AND         0xf
  1199  28a0  b1                    OR          C
  1200  28a1  c38d28                JP          LAB_ram_e926
  1201                          WAIT_A_TICK:
  1202  28a4  010086                LD          BC,$8600                               ;Sleep for 134 "cycles"
  1203  28a7  c34b1d                JP          SLEEP                                   ;byte SLEEP(short cycleCount)
  1204                          PICK_UP_F0_ITEM:
  1205  28aa  a7                    AND         A                                       ;Reset flags
  1206  28ab  08                    EX          AF,AF'                                  ;Save item
  1207  28ac  3efe                  LD          A,$fe                                  ;Empty item
  1208  28ae  02                    LD          (BC),A
  1209  28af  215233                LD          HL,CHRRAM_FO_ITEM_IDX                   ;= $20
  1210  28b2  3e20                  LD          A,$20                                  ;SPACE char
  1211  28b4  cda209                CALL        UPDATE_FO_ITEM
  1212  28b7  215237                LD          HL,COLRAM_FO_ITEM_IDX                   ;= $60    `
  1213  28ba  3edf                  LD          A,$df                                  ;DKGRN on DKGRY
  1214  28bc  cda209                CALL        UPDATE_FO_ITEM
  1215  28bf  08                    EX          AF,AF'                                  ;Restore item
  1216  28c0  1f                    RRA                                                 ;Rotate A right, A:0 to carry
  1217  28c1  cb1a                  RR          D                                       ;Rotate D right
  1218                                                                                  ;Carry (from A:0) to D:7
  1219  28c3  1f                    RRA                                                 ;Rotate A right, A:0 (was A:1) to carry
  1220  28c4  cb12                  RL          D                                       ;Rotate D left, carry to D:0
  1221                                                                                  ;D:7 to carry
  1222  28c6  cb12                  RL          D                                       ;Rotate D left, carry to D;0
  1223                                                                                  ;D:7 to carry
  1224                                                                                  ;D  = item level
  1225  28c8  c9                    RET
  1226                          UPDATE_MELEE_OBJECTS:
  1227  28c9  3e04                  LD          A,0x4
  1228                          LAB_ram_e962:
  1229  28cb  010400                LD          BC,0x4
  1230  28ce  edb0                  LDIR                                                ;= "OM"
  1231  28d0  3d                    DEC         A
  1232  28d1  cadb28                JP          Z,LAB_ram_e972
  1233  28d4  012400                LD          BC,$24
  1234  28d7  09                    ADD         HL,BC
  1235  28d8  c3cb28                JP          LAB_ram_e962
  1236                          LAB_ram_e972:
  1237  28db  7c                    LD          A,H
  1238  28dc  fe34                  CP          $34
  1239  28de  d0                    RET         NC
  1240  28df  018403                LD          BC,$384
  1241  28e2  09                    ADD         HL,BC
  1242  28e3  c3c928                JP          UPDATE_MELEE_OBJECTS
  1243                          SUB_ram_e97d:
  1244  28e6  3e04                  LD          A,0x4
  1245                          LAB_ram_e97f:
  1246  28e8  010400                LD          BC,0x4
  1247  28eb  edb0                  LDIR                                                ;= "OM"
  1248  28ed  3d                    DEC         A
  1249  28ee  cafa28                JP          Z,LAB_ram_e991
  1250  28f1  eb                    EX          DE,HL
  1251  28f2  012400                LD          BC,$24
  1252  28f5  09                    ADD         HL,BC
  1253  28f6  eb                    EX          DE,HL
  1254  28f7  c3e828                JP          LAB_ram_e97f
  1255                          LAB_ram_e991:
  1256  28fa  7a                    LD          A,D
  1257  28fb  fe34                  CP          $34
  1258  28fd  d0                    RET         NC
  1259  28fe  018403                LD          BC,$384
  1260  2901  eb                    EX          DE,HL
  1261  2902  09                    ADD         HL,BC
  1262  2903  eb                    EX          DE,HL
  1263  2904  c3e628                JP          SUB_ram_e97d
  1264                          SUB_ram_e99e:
  1265  2907  3e04                  LD          A,0x4
  1266                          LAB_ram_e9a0:
  1267  2909  010400                LD          BC,0x4
  1268  290c  edb0                  LDIR                                                ;= "OM"
  1269  290e  3d                    DEC         A
  1270  290f  ca1c29                JP          Z,LAB_ram_e9b3
  1271  2912  012400                LD          BC,$24
  1272  2915  09                    ADD         HL,BC
  1273  2916  eb                    EX          DE,HL
  1274  2917  09                    ADD         HL,BC
  1275  2918  eb                    EX          DE,HL
  1276  2919  c30929                JP          LAB_ram_e9a0
  1277                          LAB_ram_e9b3:
  1278  291c  7c                    LD          A,H
  1279  291d  fe34                  CP          $34
  1280  291f  d0                    RET         NC
  1281  2920  018403                LD          BC,$384
  1282  2923  09                    ADD         HL,BC
  1283  2924  eb                    EX          DE,HL
  1284  2925  09                    ADD         HL,BC
  1285  2926  eb                    EX          DE,HL
  1286  2927  c30729                JP          SUB_ram_e99e
  1287                          SUB_ram_e9c1:
  1288  292a  3d                    DEC         A
  1289  292b  c23229                JP          NZ,LAB_ram_e9c8
  1290  292e  010105                LD          BC,$501                                ;PHYS = 5
  1291                                                                                  ;SPRT = 1
  1292  2931  c9                    RET
  1293                          LAB_ram_e9c8:
  1294  2932  3d                    DEC         A
  1295  2933  c23a29                JP          NZ,LAB_ram_e9cf
  1296  2936  010408                LD          BC,$804
  1297  2939  c9                    RET
  1298                          LAB_ram_e9cf:
  1299  293a  3d                    DEC         A
  1300  293b  c24229                JP          NZ,LAB_ram_e9d6
  1301  293e  010812                LD          BC,LAB_ram_1208
  1302  2941  c9                    RET
  1303                          LAB_ram_e9d6:
  1304  2942  3d                    DEC         A
  1305  2943  c24a29                JP          NZ,LAB_ram_e9dd
  1306  2946  011326                LD          BC,BYTE_ram_2613                        ;= $FF
  1307  2949  c9                    RET
  1308                          LAB_ram_e9dd:
  1309  294a  010000                LD          BC,0x0
  1310  294d  c9                    RET
  1311                          SUB_ram_e9e1:
  1312  294e  3a7a3a                LD          A,(RIGHT_HAND_ITEM)
  1313  2951  fefe                  CP          $fe
  1314  2953  c25a29                JP          NZ,LAB_ram_e9ec
  1315  2956  e1                    POP         HL
  1316  2957  c3a621                JP          NO_ACTION_TAKEN
  1317                          LAB_ram_e9ec:
  1318  295a  3eff                  LD          A,$ff
  1319  295c  02                    LD          (BC),A
  1320  295d  0d                    DEC         C
  1321  295e  0d                    DEC         C
  1322  295f  7c                    LD          A,H
  1323  2960  02                    LD          (BC),A
  1324  2961  0c                    INC         C
  1325  2962  3efe                  LD          A,$fe
  1326  2964  02                    LD          (BC),A
  1327  2965  c9                    RET
  1328                          DO_ROTATE_PACK:
  1329  2966  217c3a                LD          HL,INV_ITEM_SLOT_1
  1330  2969  01103a                LD          BC,ITEM_MOVE_COL_BUFFER
  1331  296c  af                    XOR         A
  1332  296d  02                    LD          (BC),A
  1333  296e  cdd029                CALL        SUB_ram_ea62
  1334  2971  23                    INC         HL
  1335  2972  017c3a                LD          BC,INV_ITEM_SLOT_1
  1336  2975  cdd029                CALL        SUB_ram_ea62
  1337  2978  1e04                  LD          E,0x4
  1338                          LAB_ram_ea0c:
  1339  297a  23                    INC         HL
  1340  297b  03                    INC         BC
  1341  297c  cdd029                CALL        SUB_ram_ea62
  1342  297f  1d                    DEC         E
  1343  2980  c27a29                JP          NZ,LAB_ram_ea0c
  1344  2983  21103a                LD          HL,ITEM_MOVE_COL_BUFFER
  1345  2986  03                    INC         BC
  1346  2987  cdd029                CALL        SUB_ram_ea62
  1347  298a  21b431                LD          HL,DAT_ram_31b4                         ;= $20
  1348  298d  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
  1349  2990  cdc928                CALL        UPDATE_MELEE_OBJECTS
  1350  2993  211131                LD          HL,DAT_ram_3111                         ;= $20
  1351  2996  11b431                LD          DE,DAT_ram_31b4                         ;= $20
  1352  2999  cd0729                CALL        SUB_ram_e99e
  1353  299c  210c31                LD          HL,DAT_ram_310c                         ;= $20
  1354  299f  111131                LD          DE,DAT_ram_3111                         ;= $20
  1355  29a2  cd0729                CALL        SUB_ram_e99e
  1356  29a5  21a931                LD          HL,CHHRAM_INV_4_IDX                     ;= $20
  1357  29a8  110c31                LD          DE,DAT_ram_310c                         ;= $20
  1358  29ab  cd0729                CALL        SUB_ram_e99e
  1359  29ae  214c32                LD          HL,DAT_ram_324c                         ;= $20
  1360  29b1  11a931                LD          DE,CHHRAM_INV_4_IDX                     ;= $20
  1361  29b4  cd0729                CALL        SUB_ram_e99e
  1362  29b7  215132                LD          HL,CHHRAM_INV_6_IDX                     ;= $20
  1363  29ba  114c32                LD          DE,DAT_ram_324c                         ;= $20
  1364  29bd  cd0729                CALL        SUB_ram_e99e
  1365  29c0  210d2a                LD          HL,WAIT_FOR_INPUT                    ; WAIT FOR INPUT label --- UNDO???
  1366  29c3  e5                    PUSH        HL
  1367  29c4  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
  1368  29c7  115132                LD          DE,CHHRAM_INV_6_IDX                     ;= $20
  1369  29ca  cde628                CALL        SUB_ram_e97d
  1370  29cd  c3a428                JP          WAIT_A_TICK
  1371                          SUB_ram_ea62:
  1372  29d0  56                    LD          D,(HL)
  1373  29d1  0a                    LD          A,(BC)
  1374  29d2  77                    LD          (HL),A
  1375  29d3  7a                    LD          A,D
  1376  29d4  02                    LD          (BC),A
  1377  29d5  c9                    RET
  1378                          DO_SWAP_PACK:
  1379  29d6  217c3a                LD          HL,INV_ITEM_SLOT_1
  1380  29d9  017a3a                LD          BC,RIGHT_HAND_ITEM
  1381  29dc  cdd029                CALL        SUB_ram_ea62
  1382  29df  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1383  29e2  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
  1384  29e5  cdc928                CALL        UPDATE_MELEE_OBJECTS
  1385  29e8  21b431                LD          HL,DAT_ram_31b4                         ;= $20
  1386  29eb  114333                LD          DE,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1387  29ee  cd0729                CALL        SUB_ram_e99e
  1388  29f1  210d2a                LD          HL,WAIT_FOR_INPUT                    ; WAIT FOR INPUT label --- UNDO???
  1389  29f4  e5                    PUSH        HL
  1390  29f5  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
  1391  29f8  11b431                LD          DE,DAT_ram_31b4                         ;= $20
  1392  29fb  cde628                CALL        SUB_ram_e97d
  1393  29fe  cd8e26                CALL        NEW_RIGHT_HAND_ITEM
  1394  2a01  c3a428                JP          WAIT_A_TICK
  1395                          UPDATE_VIEWPORT:
  1396  2a04  cdef34                CALL        REDRAW_START
  1397  2a07  cdff37                CALL        REDRAW_VIEWPORT
  1398                          INPUT_DEBOUNCE:
  1399  2a0a  cda428                CALL        WAIT_A_TICK
  1400                          WAIT_FOR_INPUT:
  1401  2a0d  cd5111                CALL        TIMER_UPDATE
  1402  2a10  cd5c11                CALL        BLINK_ROUTINE
  1403  2a13  d2772a                JP          NC,TIMER_UPDATED_CHECK_INPUT
  1404  2a16  216b3a                LD          HL,TIMER_C
  1405  2a19  34                    INC         (HL)
  1406  2a1a  7e                    LD          A,(HL)
  1407  2a1b  fe15                  CP          $15
  1408  2a1d  da772a                JP          C,TIMER_UPDATED_CHECK_INPUT
  1409  2a20  af                    XOR         A
  1410  2a21  77                    LD          (HL),A
  1411                          SCREEN_SAVER_FULL_SCREEN:
  1412  2a22  210008                LD          HL,$800
  1413                          SCREEN_SAVER_REDRAW_LOOP:
  1414  2a25  110034                LD          DE,COLRAM                               ;= $60
  1415                          RECALC_SCREEN_SAVER_COLORS:
  1416  2a28  1a                    LD          A,(DE)                          ;= $60
  1417  2a29  0f                    RRCA
  1418  2a2a  12                    LD          (DE),A                          ;= $60
  1419  2a2b  13                    INC         DE
  1420  2a2c  3e38                  LD          A,$38
  1421  2a2e  ba                    CP          D
  1422  2a2f  c2282a                JP          NZ,RECALC_SCREEN_SAVER_COLORS
  1423  2a32  25                    DEC         H
  1424  2a33  c2382a                JP          NZ,CHECK_INPUT_DURING_SCREEN_SAVER
  1425  2a36  2608                  LD          H,0x8
  1426                          CHECK_INPUT_DURING_SCREEN_SAVER:
  1427  2a38  2d                    DEC         L
  1428  2a39  ca252a                JP          Z,SCREEN_SAVER_REDRAW_LOOP
  1429  2a3c  014001                LD          BC,$140
  1430  2a3f  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  1431  2a42  01ff00                LD          BC,$ff
  1432  2a45  ed78                  IN          A,(C)
  1433  2a47  3c                    INC         A
  1434  2a48  c2642a                JP          NZ,LAB_ram_eaf5
  1435  2a4b  0ef7                  LD          C,$f7
  1436  2a4d  3e0f                  LD          A,0xf
  1437  2a4f  ed79                  OUT         (C),A                              ;= db
  1438  2a51  0d                    DEC         C
  1439  2a52  ed78                  IN          A,(C)                     ;= db
  1440  2a54  3c                    INC         A
  1441  2a55  c2642a                JP          NZ,LAB_ram_eaf5
  1442  2a58  0c                    INC         C
  1443  2a59  3e0e                  LD          A,0xe
  1444  2a5b  ed79                  OUT         (C),A                              ;= db
  1445  2a5d  0d                    DEC         C
  1446  2a5e  ed78                  IN          A,(C)                     ;= db
  1447  2a60  3c                    INC         A
  1448  2a61  ca382a                JP          Z,CHECK_INPUT_DURING_SCREEN_SAVER
  1449                          LAB_ram_eaf5:
  1450  2a64  110034                LD          DE,COLRAM                               ;= $60
  1451                          LAB_ram_eaf8:
  1452  2a67  44                    LD          B,H
  1453  2a68  1a                    LD          A,(DE)                          ;= $60
  1454                          LAB_ram_eafa:
  1455  2a69  0f                    RRCA
  1456  2a6a  10fd                  DJNZ        LAB_ram_eafa
  1457  2a6c  12                    LD          (DE),A                          ;= $60
  1458  2a6d  13                    INC         DE                  ;= $60
  1459  2a6e  3e38                  LD          A,$38
  1460  2a70  ba                    CP          D
  1461  2a71  c2672a                JP          NZ,LAB_ram_eaf8
  1462  2a74  c30a2a                JP          INPUT_DEBOUNCE
  1463                          TIMER_UPDATED_CHECK_INPUT:
  1464  2a77  3a653a                LD          A,(RAM_AD)
  1465  2a7a  fe32                  CP          $32
  1466  2a7c  cac62a                JP          Z,LAB_ram_eb53
  1467  2a7f  3a663a                LD          A,(RAM_AE)
  1468  2a82  fe31                  CP          $31
  1469  2a84  c29a2a                JP          NZ,LAB_ram_eb27
  1470  2a87  21693a                LD          HL,TIMER_A
  1471  2a8a  3a893a                LD          A,(BYTE_ram_3a89)
  1472  2a8d  be                    CP          (HL)
  1473  2a8e  c20d2a                JP          NZ,WAIT_FOR_INPUT
  1474  2a91  cd9e23                CALL        SUB_ram_e450
  1475  2a94  cde522                CALL        SUB_ram_e39a
  1476  2a97  c30d2a                JP          WAIT_FOR_INPUT
  1477                          LAB_ram_eb27:
  1478  2a9a  21693a                LD          HL,TIMER_A
  1479  2a9d  3a8c3a                LD          A,(BYTE_ram_3a8c)
  1480  2aa0  be                    CP          (HL)
  1481  2aa1  c20d2a                JP          NZ,WAIT_FOR_INPUT
  1482  2aa4  cd7925                CALL        SUB_ram_e635
  1483  2aa7  cd9e23                CALL        SUB_ram_e450
  1484  2aaa  cde522                CALL        SUB_ram_e39a
  1485  2aad  cd1325                CALL        MELEE_ANIM_LOOP
  1486  2ab0  c30d2a                JP          WAIT_FOR_INPUT
  1487                          LAB_ram_eb40:
  1488  2ab3  21693a                LD          HL,TIMER_A
  1489  2ab6  3a8c3a                LD          A,(BYTE_ram_3a8c)
  1490  2ab9  be                    CP          (HL)
  1491  2aba  c20d2a                JP          NZ,WAIT_FOR_INPUT
  1492  2abd  cd7925                CALL        SUB_ram_e635
  1493  2ac0  cd1325                CALL        MELEE_ANIM_LOOP
  1494  2ac3  c30d2a                JP          WAIT_FOR_INPUT
  1495                          LAB_ram_eb53:
  1496  2ac6  3a663a                LD          A,(RAM_AE)
  1497  2ac9  fe31                  CP          $31
  1498  2acb  c2b32a                JP          NZ,LAB_ram_eb40
  1499  2ace  cdc63a                CALL        UPDATE_SCR_SAVER_TIMER
  1500  2ad1  3a783a                LD          A,(LAST_ITEM_HELD)
  1501  2ad4  a7                    AND         A
  1502  2ad5  c25b2b                JP          NZ,LAB_ram_ebd6
  1503  2ad8  0604                  LD          B,0x4
  1504  2ada  21e937                LD          HL,ITEM_F1                              ;= $60
  1505  2add  7e                    LD          A,(HL)                         ;= $60
  1506  2ade  3c                    INC         A
  1507  2adf  3c                    INC         A
  1508  2ae0  21ec37                LD          HL,ITEM_FR1                             ;= $60
  1509                          LAB_ram_eb6f:
  1510  2ae3  fe7a                  CP          $7a
  1511  2ae5  d2f12a                JP          NC,LAB_ram_eb7b
  1512  2ae8  23                    INC         HL
  1513  2ae9  7e                    LD          A,(HL)                         ;= $60
  1514  2aea  3c                    INC         A
  1515  2aeb  3c                    INC         A
  1516  2aec  10f5                  DJNZ        LAB_ram_eb6f
  1517  2aee  c35b2b                JP          LAB_ram_ebd6
  1518                          LAB_ram_eb7b:
  1519  2af1  3a883a                LD          A,(TIMER_D)
  1520  2af4  fe05                  CP          0x5
  1521  2af6  d25b2b                JP          NC,LAB_ram_ebd6
  1522  2af9  cda73a                CALL        MAKE_RANDOM_BYTE
  1523  2afc  c608                  ADD         A,0x8
  1524  2afe  d25b2b                JP          NC,LAB_ram_ebd6
  1525  2b01  05                    DEC         B
  1526  2b02  c21a2b                JP          NZ,LAB_ram_eb9e
  1527  2b05  3afd33                LD          A,(DAT_ram_33fd)                        ;= $20
  1528  2b08  cb57                  BIT         0x2,A
  1529  2b0a  c2112b                JP          NZ,LAB_ram_eb96
  1530  2b0d  a7                    AND         A
  1531  2b0e  c25b2b                JP          NZ,LAB_ram_ebd6
  1532                          LAB_ram_eb96:
  1533  2b11  cdbd2d                CALL        SUB_ram_ee23
  1534  2b14  cdbd2d                CALL        SUB_ram_ee23
  1535  2b17  c3432b                JP          LAB_ram_ebc0
  1536                          LAB_ram_eb9e:
  1537  2b1a  05                    DEC         B
  1538  2b1b  c2302b                JP          NZ,LAB_ram_ebb0
  1539  2b1e  3af533                LD          A,(DAT_ram_33f5)                        ;= $20
  1540  2b21  cb57                  BIT         0x2,A
  1541  2b23  c22a2b                JP          NZ,LAB_ram_ebab
  1542  2b26  a7                    AND         A
  1543  2b27  c25b2b                JP          NZ,LAB_ram_ebd6
  1544                          LAB_ram_ebab:
  1545  2b2a  cda52d                CALL        SUB_ram_ee0b
  1546  2b2d  c3432b                JP          LAB_ram_ebc0
  1547                          LAB_ram_ebb0:
  1548  2b30  05                    DEC         B
  1549  2b31  c24f2b                JP          NZ,LAB_ram_ebcc
  1550  2b34  3af933                LD          A,(DAT_ram_33f9)                        ;= $20
  1551  2b37  cb57                  BIT         0x2,A
  1552  2b39  c2402b                JP          NZ,LAB_ram_ebbd
  1553  2b3c  a7                    AND         A
  1554  2b3d  c25b2b                JP          NZ,LAB_ram_ebd6
  1555                          LAB_ram_ebbd:
  1556  2b40  cdbd2d                CALL        SUB_ram_ee23
  1557                          LAB_ram_ebc0:
  1558  2b43  cdef34                CALL        REDRAW_START
  1559  2b46  cdff37                CALL        REDRAW_VIEWPORT
  1560                          LAB_ram_ebc6:
  1561  2b49  cdb70d                CALL        SUB_ram_cd5f
  1562  2b4c  c3f130                JP          SUB_ram_f130
  1563                          LAB_ram_ebcc:
  1564  2b4f  3ae833                LD          A,(WALL_F0_STATE)                       ;= $20
  1565  2b52  cb57                  BIT         0x2,A
  1566  2b54  c2492b                JP          NZ,LAB_ram_ebc6
  1567  2b57  a7                    AND         A
  1568  2b58  ca492b                JP          Z,LAB_ram_ebc6
  1569                          LAB_ram_ebd6:
  1570  2b5b  01ff00                LD          BC,$ff
  1571  2b5e  ed78                  IN          A,(C)
  1572  2b60  3c                    INC         A
  1573  2b61  c2de2b                JP          NZ,LAB_ram_ec52
  1574  2b64  0ef7                  LD          C,$f7
  1575  2b66  3e0f                  LD          A,0xf
  1576  2b68  ed79                  OUT         (C),A                              ;= db
  1577  2b6a  0d                    DEC         C
  1578  2b6b  ed78                  IN          A,(C)                     ;= db
  1579  2b6d  3c                    INC         A
  1580  2b6e  c27d2b                JP          NZ,LAB_ram_ebf7
  1581  2b71  0c                    INC         C
  1582  2b72  3e0e                  LD          A,0xe
  1583  2b74  ed79                  OUT         (C),A                              ;= db
  1584  2b76  0d                    DEC         C
  1585  2b77  ed78                  IN          A,(C)                     ;= db
  1586  2b79  3c                    INC         A
  1587  2b7a  ca0d2a                JP          Z,WAIT_FOR_INPUT
  1588                          LAB_ram_ebf7:
  1589  2b7d  cdc22b                CALL        PLAY_DESCENDING_SOUND
  1590  2b80  21fe37                LD          HL,HC_INPUT_HOLDER                      ;= $6060
  1591                          DISABLE_JOY_04:
  1592  2b83  0ef7                  LD          C,$f7
  1593  2b85  3e0f                  LD          A,0xf
  1594  2b87  ed79                  OUT         (C),A                              ;= db
  1595  2b89  0d                    DEC         C
  1596  2b8a  ed78                  IN          A,(C)                     ;= db
  1597  2b8c  77                    LD          (HL),A                 ;= $6060
  1598  2b8d  23                    INC         HL
  1599  2b8e  0c                    INC         C
  1600                          ENABLE_JOY_04:
  1601  2b8f  3e0e                  LD          A,0xe
  1602  2b91  ed79                  OUT         (C),A                              ;= db
  1603  2b93  0d                    DEC         C
  1604  2b94  ed78                  IN          A,(C)                     ;= db
  1605  2b96  77                    LD          (HL),A
  1606  2b97  3a6c3a                LD          A,(INPUT_HOLDER)
  1607  2b9a  a7                    AND         A
  1608  2b9b  c20e0f                JP          NZ,HC_JOY_INPUT_COMPARE
  1609  2b9e  3a683a                LD          A,(DUNGEON_LEVEL)
  1610  2ba1  a7                    AND         A
  1611  2ba2  c21020                JP          NZ,GAMEINIT
  1612  2ba5  7e                    LD          A,(HL)
  1613  2ba6  3c                    INC         A
  1614  2ba7  cabc2b                JP          Z,TITLE_CHK_FOR_HC_INPUT
  1615                          HC_LEVEL_SELECT_LOOP:
  1616  2baa  fe60                  CP          $60                                    ;K3 pressed on title screen
  1617  2bac  ca2b2c                JP          Z,SET_DIFFICULTY_1
  1618  2baf  fe7c                  CP          $7c
  1619  2bb1  ca302c                JP          Z,SET_DIFFICULTY_2
  1620  2bb4  fec0                  CP          $c0
  1621  2bb6  ca352c                JP          Z,SET_DIFFICULTY_3
  1622  2bb9  c31b2c                JP          SET_DIFFICULTY_4
  1623                          TITLE_CHK_FOR_HC_INPUT:
  1624  2bbc  2b                    DEC         HL
  1625  2bbd  7e                    LD          A,(HL)                 ;= $6060
  1626  2bbe  3c                    INC         A
  1627  2bbf  c3aa2b                JP          HC_LEVEL_SELECT_LOOP
  1628                          PLAY_DESCENDING_SOUND:
  1629  2bc2  af                    XOR         A
  1630  2bc3  32693a                LD          (TIMER_A),A
  1631  2bc6  326a3a                LD          (TIMER_B),A
  1632  2bc9  326b3a                LD          (TIMER_C),A
  1633  2bcc  d3fc                  OUT         (SPEAKER),A                             ;= db
  1634  2bce  01f000                LD          BC,$f0
  1635  2bd1  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  1636  2bd4  3c                    INC         A
  1637  2bd5  d3fc                  OUT         (SPEAKER),A                             ;= db
  1638  2bd7  01c004                LD          BC,$4c0
  1639  2bda  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  1640  2bdd  c9                    RET
  1641                          LAB_ram_ec52:
  1642  2bde  cdc22b                CALL        PLAY_DESCENDING_SOUND
  1643  2be1  21f637                LD          HL,KEY_INPUT_COL0                       ;= $60
  1644  2be4  01fffe                LD          BC,0xfeff                               ; Was LD, BC, GFX_POINTERS
  1645  2be7  1608                  LD          D,0x8
  1646                          SELECT_DIFFICULTY_LOOP:
  1647  2be9  ed78                  IN          A,(C)
  1648  2beb  77                    LD          (HL),A                  ;= $20
  1649                                                                                  ;= $60
  1650  2bec  2c                    INC         L
  1651  2bed  cb00                  RLC         B
  1652  2bef  15                    DEC         D
  1653  2bf0  c2e92b                JP          NZ,SELECT_DIFFICULTY_LOOP
  1654  2bf3  3a6c3a                LD          A,(INPUT_HOLDER)
  1655  2bf6  a7                    AND         A
  1656  2bf7  c2a53b                JP          NZ,KEY_COMPARE                          ;OLD = e12c ; NEW = fbe0
  1657  2bfa  3a683a                LD          A,(DUNGEON_LEVEL)
  1658  2bfd  a7                    AND         A
  1659  2bfe  c21020                JP          NZ,GAMEINIT
  1660  2c01  3afc37                LD          A,(KEY_INPUT_COL6)                      ;= $60
  1661  2c04  fefe                  CP          $fe
  1662  2c06  ca2b2c                JP          Z,SET_DIFFICULTY_1                      ;Key 3 pressed on Title Screen
  1663  2c09  fedf                  CP          $df
  1664  2c0b  ca4111                JP          Z,SHOW_AUTHOR                           ;Key A pressed (and held)
  1665                                                                                  ;on title screen
  1666  2c0e  3afd37                LD          A,(KEY_INPUT_COL7)                      ;= $60
  1667  2c11  fefe                  CP          $fe
  1668  2c13  ca302c                JP          Z,SET_DIFFICULTY_2                      ;Key 2 pressed on Title Screen
  1669  2c16  fefb                  CP          $fb
  1670  2c18  ca352c                JP          Z,SET_DIFFICULTY_3                      ;Key 1 pressed on Title Screen
  1671                          SET_DIFFICULTY_4:
  1672  2c1b  3e00                  LD          A,0x0                                   ;Some other key pressed on Title Screen
  1673                          GOTO_GAME_START:
  1674  2c1d  326c3a                LD          (INPUT_HOLDER),A
  1675  2c20  3ab93a                LD          A,(GAME_BOOLEANS)
  1676  2c23  cbc7                  SET         0x0,A
  1677  2c25  32b93a                LD          (GAME_BOOLEANS),A
  1678  2c28  c38220                JP          BLANK_SCRN
  1679                          SET_DIFFICULTY_1:
  1680  2c2b  3e01                  LD          A,0x1
  1681  2c2d  c31d2c                JP          GOTO_GAME_START
  1682                          SET_DIFFICULTY_2:
  1683  2c30  3e02                  LD          A,0x2
  1684  2c32  c31d2c                JP          GOTO_GAME_START
  1685                          SET_DIFFICULTY_3:
  1686  2c35  3e03                  LD          A,0x3
  1687  2c37  c31d2c                JP          GOTO_GAME_START
  1688                          CHK_ITEM:
  1689  2c3a  fefe                  CP          $fe                             ; Compare A to $FE
  1690  2c3c  c8                    RET         Z                               ; If A == Z, exit ($FE = no item)
  1691  2c3d  cb3f                  SRL         A                               ; Shift A right logical, Bit 0 to C
  1692  2c3f  5f                    LD          E,A                             ; New value A into E
  1693  2c40  da482c                JP          C,ITEM_WAS_YL_WH                ; If C (ITEM was YEL or WHT), jump ahead
  1694  2c43  1610                  LD          D,$10                           ; (ITEM was RED or MAG) D = $10
  1695  2c45  c34a2c                JP          ITEM_WAS_RD_MG                  ; Jump ahead
  1696                          ITEM_WAS_YL_WH:
  1697  2c48  1630                  LD          D,$30                           ; (ITEM was YEL or WHTD D = $30
  1698                          ITEM_WAS_RD_MG:
  1699  2c4a  cb3f                  SRL         A                               ; Shift A right logical, Bit 0 to C
  1700  2c4c  d2532c                JP          NC,ITEM_NOT_RD_YL               ; If not C (ITEM was not RED or YEL), jump ahead
  1701  2c4f  3e40                  LD          A,$40                           ; A = $40
  1702  2c51  82                    ADD         A,D                             ; Add D to A
  1703  2c52  57                    LD          D,A                             ; D = $40 + $10 (RD MG) or D = $40 + $30 (YL WH)
  1704                          ITEM_NOT_RD_YL:
  1705  2c53  cb83                  RES         0x0,E                           ; Set Bit 0 of E (old ITEM SRL)
  1706  2c55  7b                    LD          A,E                             ; Save E back into A
  1707  2c56  cb27                  SLA         A                               ; Shift A right logical
  1708  2c58  83                    ADD         A,E                             ; Add E () to A
  1709  2c59  80                    ADD         A,B                             ; Add B (color?) to A
  1710  2c5a  42                    LD          B,D                             ; Put D ($10, $30, or $40) into B
  1711  2c5b  6f                    LD          L,A                             ; Put A into L
  1712  2c5c  26ff                  LD          H,$ff                           ; Put $FF into H
  1713  2c5e  5e                    LD          E,(HL)                          ; ITEM/MONSTER GFX_PTR, E = low byte
  1714  2c5f  23                    INC         HL                              ; Increment HL
  1715  2c60  56                    LD          D,(HL)                          ; ITEM/MONSTER GFX_PTR, D = high byte
  1716  2c61  3a633a                LD          A,(MON_FS)
  1717  2c64  67                    LD          H,A
  1718  2c65  69                    LD          L,C
  1719  2c66  c30f33                JP          GFX_DRAW
  1720                          DO_OPEN_CLOSE:
  1721  2c69  3aea37                LD          A,(ITEM_F0)                             ;= $60
  1722  2c6c  0e00                  LD          C,0x0                                   ;C  = 0
  1723  2c6e  cb3f                  SRL         A                                       ;Move item LEVEL
  1724                                                                                  ;into C
  1725  2c70  cb19                  RR          C
  1726  2c72  cb3f                  SRL         A
  1727  2c74  cb11                  RL          C
  1728  2c76  cb11                  RL          C
  1729  2c78  fe11                  CP          $11                                    ;Compare to BOX
  1730                                                                                  ;44,45,46,47 2 @ SRL = 11
  1731  2c7a  c2ad2c                JP          NZ,LAB_ram_ed1b
  1732  2c7d  79                    LD          A,C                                     ;A = C (item level)
  1733  2c7e  a7                    AND         A
  1734  2c7f  ca8c2c                JP          Z,DO_OPEN_BOX
  1735  2c82  cdc63a                CALL        UPDATE_SCR_SAVER_TIMER
  1736  2c85  0c                    INC         C
  1737                          LAB_ram_ecf6:
  1738  2c86  91                    SUB         C
  1739  2c87  d2862c                JP          NC,LAB_ram_ecf6
  1740  2c8a  81                    ADD         A,C
  1741  2c8b  4f                    LD          C,A
  1742                          DO_OPEN_BOX:
  1743  2c8c  ed5f                  LD          A,R                                     ;Semi-random number into A
  1744  2c8e  e607                  AND         0x7
  1745                          PICK_RANDOM_ITEM:
  1746  2c90  d607                  SUB         0x7
  1747  2c92  d2902c                JP          NC,PICK_RANDOM_ITEM
  1748  2c95  c61d                  ADD         A,$1d                                  ;$1d is +1 above range
  1749  2c97  cb19                  RR          C
  1750  2c99  cb18                  RR          B
  1751  2c9b  cb19                  RR          C                                       ;C = C/8
  1752  2c9d  17                    RLA
  1753  2c9e  cb10                  RL          B
  1754  2ca0  17                    RLA
  1755  2ca1  08                    EX          AF,AF'
  1756  2ca2  3a793a                LD          A,(PLAYER_MAP_POS)
  1757  2ca5  cdec37                CALL        ITEM_MAP_CHECK
  1758  2ca8  08                    EX          AF,AF'
  1759  2ca9  02                    LD          (BC),A
  1760  2caa  c3042a                JP          UPDATE_VIEWPORT
  1761                          LAB_ram_ed1b:
  1762  2cad  3a793a                LD          A,(PLAYER_MAP_POS)
  1763  2cb0  2638                  LD          H,$38
  1764  2cb2  6f                    LD          L,A
  1765  2cb3  3a623a                LD          A,(DIR_FACING_SHORT)
  1766  2cb6  3d                    DEC         A
  1767  2cb7  cac62c                JP          Z,NORTH_OPEN_CLOSE_DOOR                 ;Is facing NORTH
  1768  2cba  3d                    DEC         A
  1769  2cbb  cae12c                JP          Z,SHIFT_EAST_OPEN_CLOSE_DOOR            ;Is facing EAST
  1770  2cbe  3d                    DEC         A
  1771  2cbf  c2e22c                JP          NZ,LAB_ram_ed4b                         ;Is facing WEST
  1772  2cc2  7d                    LD          A,L                                     ;Is facing SOUTH
  1773  2cc3  c610                  ADD         A,$10
  1774  2cc5  6f                    LD          L,A                                     ;Shift SOUTH and process as NORTH
  1775                          NORTH_OPEN_CLOSE_DOOR:
  1776  2cc6  cb76                  BIT         0x6,(HL)                                ;N WALL check
  1777  2cc8  caa621                JP          Z,NO_ACTION_TAKEN                       ;...if no N WALL
  1778  2ccb  cb6e                  BIT         0x5,(HL)                                ;N hidden DOOR check
  1779  2ccd  cad52c                JP          Z,SET_N_DOOR_MASK                       ;...if no N hidden DOOR
  1780  2cd0  3e44                  LD          A,$44                                  ;WALL mask
  1781  2cd2  c3d72c                JP          OPEN_N_CHECK
  1782                          SET_N_DOOR_MASK:
  1783  2cd5  3e22                  LD          A,$22                                  ;DOOR mask
  1784                          OPEN_N_CHECK:
  1785  2cd7  cb7e                  BIT         0x7,(HL)                                ;N DOOR-OPEN check
  1786  2cd9  c25b2d                JP          NZ,CLOSE_N_DOOR                         ;...if N DOOR not OPEN
  1787  2cdc  cbfe                  SET         0x7,(HL)                                ;Set N door closed on wall map
  1788  2cde  c3fa2c                JP          SET_F0_DOOR_OPEN
  1789                          SHIFT_EAST_OPEN_CLOSE_DOOR:
  1790  2ce1  2c                    INC         L                                       ;Shift EAST and process as WEST
  1791                          LAB_ram_ed4b:
  1792  2ce2  cb4e                  BIT         0x1,(HL)                                ;W WALL check
  1793  2ce4  caa621                JP          Z,NO_ACTION_TAKEN                       ;...if no W WALL
  1794  2ce7  cb46                  BIT         0x0,(HL)                                ;W DOOR check
  1795  2ce9  caf12c                JP          Z,SET_W_DOOR_MASK                       ;...if no W DOOR
  1796  2cec  3e44                  LD          A,$44                                  ;WALL mask
  1797  2cee  c3f32c                JP          LAB_ram_ed5c
  1798                          SET_W_DOOR_MASK:
  1799  2cf1  3e22                  LD          A,$22
  1800                          LAB_ram_ed5c:
  1801  2cf3  cb56                  BIT         0x2,(HL)                                ;DOOR-OPEN check
  1802  2cf5  c2602d                JP          NZ,CLOSE_W_DOOR                         ;...if DOOR-OPEN
  1803  2cf8  cbd6                  SET         0x2,(HL)                                ;Set W door closed on wall map
  1804                          SET_F0_DOOR_OPEN:
  1805  2cfa  21e833                LD          HL,WALL_F0_STATE                        ;= $20
  1806  2cfd  cbd6                  SET         0x2,(HL)                 ;= $20
  1807  2cff  08                    EX          AF,AF'                                  ;Save MASK state from A
  1808                          WAIT_TO_REDRAW_F0_DOOR:
  1809  2d00  dbfd                  IN          A,(VSYNC)                               ;= db
  1810  2d02  3c                    INC         A
  1811  2d03  ca002d                JP          Z,WAIT_TO_REDRAW_F0_DOOR
  1812  2d06  3e00                  LD          A,0x0                                   ;BLK on BLK
  1813                                                                                  ;WAS BLU on BLU
  1814                                                                                  ;WAS LD A,$bb
  1815  2d08  cd5609                CALL        DRAW_DOOR_F0
  1816  2d0b  3ae937                LD          A,(ITEM_F1)                             ;= $60
  1817  2d0e  018a02                LD          BC,$28a
  1818  2d11  cd3a2c                CALL        CHK_ITEM
  1819  2d14  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
  1820  2d17  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
  1821  2d1a  cd482d                CALL        SUB_ram_edaf
  1822  2d1d  cd540e                CALL        SETUP_OPEN_DOOR_SOUND
  1823  2d20  d9                    EXX
  1824  2d21  21583a                LD          HL,BYTE_ram_3a58
  1825  2d24  112837                LD          DE,DAT_ram_3728                         ;= $60
  1826  2d27  3e0c                  LD          A,0xc
  1827                          LAB_ram_ed91:
  1828  2d29  08                    EX          AF,AF'
  1829  2d2a  d9                    EXX
  1830  2d2b  cd5a0e                CALL        LO_HI_PITCH_SOUND
  1831  2d2e  d9                    EXX
  1832  2d2f  010800                LD          BC,0x8
  1833  2d32  edb0                  LDIR                                                ;= $60
  1834  2d34  011000                LD          BC,$10
  1835  2d37  ed42                  SBC         HL,BC
  1836  2d39  eb                    EX          DE,HL
  1837  2d3a  013000                LD          BC,$30
  1838  2d3d  ed42                  SBC         HL,BC
  1839  2d3f  eb                    EX          DE,HL
  1840  2d40  08                    EX          AF,AF'
  1841  2d41  3d                    DEC         A
  1842  2d42  ca0d2a                JP          Z,WAIT_FOR_INPUT
  1843  2d45  c3292d                JP          LAB_ram_ed91
  1844                          SUB_ram_edaf:
  1845  2d48  3e0c                  LD          A,0xc
  1846                          LAB_ram_edb1:
  1847  2d4a  010800                LD          BC,0x8
  1848  2d4d  edb0                  LDIR
  1849  2d4f  012000                LD          BC,$20
  1850  2d52  09                    ADD         HL,BC
  1851  2d53  3d                    DEC         A
  1852  2d54  c24a2d                JP          NZ,LAB_ram_edb1
  1853  2d57  08                    EX          AF,AF'
  1854  2d58  c35609                JP          DRAW_DOOR_F0
  1855                          CLOSE_N_DOOR:
  1856  2d5b  cbbe                  RES         0x7,(HL)                                ;Set N Door map flag to closed
  1857  2d5d  c3622d                JP          START_DOOR_CLOSE_ANIM
  1858                          CLOSE_W_DOOR:
  1859  2d60  cb96                  RES         0x2,(HL)                                ;Set W Door map flag to closed
  1860                          START_DOOR_CLOSE_ANIM:
  1861  2d62  21e833                LD          HL,WALL_F0_STATE                        ;= $20
  1862  2d65  cb96                  RES         0x2,(HL)                 ;= $20
  1863  2d67  08                    EX          AF,AF'
  1864  2d68  3a793a                LD          A,(PLAYER_MAP_POS)
  1865  2d6b  32773a                LD          (PLAYER_PREV_MAP_LOC),A
  1866  2d6e  cd680e                CALL        SETUP_CLOSE_DOOR_SOUND
  1867  2d71  d9                    EXX
  1868  2d72  08                    EX          AF,AF'
  1869  2d73  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
  1870  2d76  112000                LD          DE,$20
  1871  2d79  01080c                LD          BC,$c08
  1872                          DOOR_CLOSE_ANIM_LOOP:
  1873  2d7c  77                    LD          (HL),A              ;= $60
  1874  2d7d  2c                    INC         L
  1875  2d7e  0d                    DEC         C
  1876  2d7f  c27c2d                JP          NZ,DOOR_CLOSE_ANIM_LOOP
  1877  2d82  d9                    EXX
  1878  2d83  08                    EX          AF,AF'
  1879  2d84  cd6e0e                CALL        HI_LO_PITCH_SOUND
  1880  2d87  08                    EX          AF,AF'
  1881  2d88  d9                    EXX
  1882  2d89  0e08                  LD          C,0x8
  1883  2d8b  19                    ADD         HL,DE
  1884  2d8c  10ee                  DJNZ        DOOR_CLOSE_ANIM_LOOP
  1885  2d8e  cdef24                CALL        CLEAR_MONSTER_STATS
  1886  2d91  c30d2a                JP          WAIT_FOR_INPUT
  1887  2d94  010016                LD          BC,$1600
  1888  2d97  c34b1d                JP          SLEEP                                   ;byte SLEEP(short cycleCount)
  1889                          DO_TURN_LEFT:
  1890  2d9a  3a783a                LD          A,(LAST_ITEM_HELD)
  1891  2d9d  a7                    AND         A
  1892  2d9e  c2a621                JP          NZ,NO_ACTION_TAKEN
  1893  2da1  21042a                LD          HL,UPDATE_VIEWPORT
  1894  2da4  e5                    PUSH        HL
  1895                          SUB_ram_ee0b:
  1896  2da5  3a623a                LD          A,(DIR_FACING_SHORT)
  1897  2da8  3d                    DEC         A
  1898  2da9  c2ae2d                JP          NZ,LAB_ram_ee14
  1899  2dac  3e04                  LD          A,0x4
  1900                          LAB_ram_ee14:
  1901  2dae  32623a                LD          (DIR_FACING_SHORT),A
  1902  2db1  c9                    RET
  1903                          DO_TURN_RIGHT:
  1904  2db2  3a783a                LD          A,(LAST_ITEM_HELD)
  1905  2db5  a7                    AND         A
  1906  2db6  c2a621                JP          NZ,NO_ACTION_TAKEN
  1907  2db9  21042a                LD          HL,UPDATE_VIEWPORT
  1908  2dbc  e5                    PUSH        HL
  1909                          SUB_ram_ee23:
  1910  2dbd  3a623a                LD          A,(DIR_FACING_SHORT)
  1911  2dc0  3c                    INC         A
  1912  2dc1  fe05                  CP          0x5
  1913  2dc3  c2c82d                JP          NZ,LAB_ram_ee2e
  1914  2dc6  3e01                  LD          A,0x1
  1915                          LAB_ram_ee2e:
  1916  2dc8  32623a                LD          (DIR_FACING_SHORT),A
  1917  2dcb  c9                    RET
  1918                          DO_GLANCE_RIGHT:
  1919  2dcc  3a783a                LD          A,(LAST_ITEM_HELD)
  1920  2dcf  a7                    AND         A
  1921  2dd0  c2a621                JP          NZ,NO_ACTION_TAKEN
  1922  2dd3  cdbd2d                CALL        SUB_ram_ee23
  1923  2dd6  cdef34                CALL        REDRAW_START
  1924  2dd9  cdff37                CALL        REDRAW_VIEWPORT
  1925  2ddc  cd481d                CALL        SLEEP_ZERO                              ;byte SLEEP_ZERO(void)
  1926  2ddf  c39a2d                JP          DO_TURN_LEFT
  1927                          DO_GLANCE_LEFT:
  1928  2de2  3a783a                LD          A,(LAST_ITEM_HELD)
  1929  2de5  a7                    AND         A
  1930  2de6  c2a621                JP          NZ,NO_ACTION_TAKEN
  1931  2de9  cda52d                CALL        SUB_ram_ee0b
  1932  2dec  cdef34                CALL        REDRAW_START
  1933  2def  cdff37                CALL        REDRAW_VIEWPORT
  1934  2df2  cd481d                CALL        SLEEP_ZERO                              ;byte SLEEP_ZERO(void)
  1935  2df5  c3b22d                JP          DO_TURN_RIGHT
  1936                          DO_USE_ATTACK:
  1937  2df8  3a7a3a                LD          A,(RIGHT_HAND_ITEM)
  1938  2dfb  0600                  LD          B,0x0
  1939  2dfd  cb3f                  SRL         A                                       ;Remove "color/level" in bit 0
  1940                                                                                  ;to compare item type, below.
  1941  2dff  cb18                  RR          B                                       ;Push bit 0 from A
  1942                                                                                  ;(via Carry Flag) to B
  1943  2e01  cb3f                  SRL         A                                       ;Remove second "color/level" in bit 1
  1944                                                                                  ;to compare item type, below
  1945  2e03  cb10                  RL          B                                       ;Move bits 0 & 1
  1946                                                                                  ;from A to B...
  1947  2e05  cb10                  RL          B                                       ;B now has the LEVEL value (0-3)
  1948  2e07  00                    NOP                                                 ;Was USE_MAP
  1949  2e08  00                    NOP
  1950  2e09  00                    NOP
  1951  2e0a  00                    NOP
  1952  2e0b  00                    NOP
  1953  2e0c  fe16                  CP          $16                                    ;Compare to KEY
  1954                                                                                  ;58,59,5A,5B 2 @ SRL = 16
  1955  2e0e  cace2f                JP          Z,DO_USE_KEY
  1956  2e11  fe19                  CP          $19                                    ;Compare to PHYS POTION
  1957                                                                                  ;64,65,66,67 2 @ SRL = 19
  1958  2e13  ca9e2f                JP          Z,DO_USE_PHYS_POTION
  1959  2e16  fe1a                  CP          $1a                                    ;Compare to SPRT POTION
  1960                                                                                  ;68,69,6A,6B 2 @ SRL = 1A
  1961  2e18  cab62f                JP          Z,DO_USE_SPRT_POTION
  1962  2e1b  fe1c                  CP          $1c                                    ;Compare to CHAOS POTION
  1963                                                                                  ;70,71,72,73 2 @ SRL = 1c
  1964  2e1d  c23530                JP          NZ,USE_SOMETHING_ELSE
  1965                          DO_USE_CHAOS_POTION:
  1966  2e20  cd382e                CALL        PLAY_USE_PHYS_POTION_SOUND
  1967  2e23  04                    INC         B
  1968  2e24  05                    DEC         B
  1969  2e25  c27b2e                JP          NZ,CHECK_YELLOW_L_POTION                ;If NZ, handle other colors
  1970                                                                                  ;of LARGE POTION
  1971  2e28  cd582e                CALL        TOTAL_HEAL                              ;LARGE Potion is RED
  1972                                                                                  ;so do TOTAL HEAL
  1973                          PROCESS_POTION_UPDATES:
  1974  2e2b  cdde3c                CALL        REDRAW_STATS
  1975  2e2e  3a783a                LD          A,(LAST_ITEM_HELD)
  1976  2e31  a7                    AND         A
  1977  2e32  c22232                JP          NZ,INIT_MELEE_ANIM
  1978  2e35  c30a2a                JP          INPUT_DEBOUNCE
  1979                          PLAY_USE_PHYS_POTION_SOUND:
  1980  2e38  d9                    EXX
  1981  2e39  cda10e                CALL        SOUND_03
  1982  2e3c  cda10e                CALL        SOUND_03
  1983  2e3f  cda10e                CALL        SOUND_03
  1984  2e42  c3462e                JP          CLEAR_RIGHT_HAND
  1985                          SUB_ram_eea9:
  1986  2e45  d9                    EXX
  1987                          CLEAR_RIGHT_HAND:
  1988  2e46  3efe                  LD          A,$fe
  1989  2e48  327a3a                LD          (RIGHT_HAND_ITEM),A
  1990  2e4b  11e307                LD          DE,POOF_6                               ;= "    ",$01
  1991  2e4e  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1992  2e51  06d0                  LD          B,$d0
  1993  2e53  cd0f33                CALL        GFX_DRAW
  1994  2e56  d9                    EXX
  1995  2e57  c9                    RET
  1996                          TOTAL_HEAL:
  1997  2e58  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
  1998  2e5b  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  1999  2e5e  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
  2000  2e61  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2001  2e64  c9                    RET
  2002                          REDRAW_STATS_OLD:
  2003  2e65  21933a                LD          HL,PLAYER_PHYS_HEALTH
  2004  2e68  114130                LD          DE,CHRRAM_PHYS_HEALTH_1000              ;= $20
  2005  2e6b  0602                  LD          B,0x2
  2006  2e6d  cdd532                CALL        RECALC_AND_REDRAW_BCD
  2007  2e70  21973a                LD          HL,PLAYER_SPRT_HEALTH
  2008  2e73  114730                LD          DE,CHRRAM_SPRT_HEALTH_10                ;= $20
  2009  2e76  0601                  LD          B,0x1
  2010  2e78  c3d532                JP          RECALC_AND_REDRAW_BCD                   ;Waz JP FUN_ram_f2fd
  2011                                                                                  ;(c3 fd f2)
  2012                          CHECK_YELLOW_L_POTION:
  2013  2e7b  05                    DEC         B
  2014  2e7c  c28d2e                JP          NZ,CHECK_PURPLE_L_POTION
  2015  2e7f  011000                LD          BC,$10                                 ;Set PHYS increase to 10
  2016  2e82  1e00                  LD          E,0x0                                   ;Set SPRT increase to 0
  2017                          PROCESS_LARGE_POTION:
  2018  2e84  cdd82e                CALL        CALC_CURR_PHYS_HEALTH
  2019  2e87  cdfe2e                CALL        CALC_MAX_PHYS_HEALTH
  2020  2e8a  c32b2e                JP          PROCESS_POTION_UPDATES
  2021                          CHECK_PURPLE_L_POTION:
  2022  2e8d  05                    DEC         B
  2023  2e8e  c2992e                JP          NZ,CHECK_WHITE_L_POTION
  2024  2e91  010000                LD          BC,0x0                                  ;Set PHYS increase to 0
  2025  2e94  1e06                  LD          E,0x6                    ;Set SPRT increase to 6
  2026  2e96  c3842e                JP          PROCESS_LARGE_POTION
  2027                          CHECK_WHITE_L_POTION:
  2028  2e99  cda73a                CALL        MAKE_RANDOM_BYTE                        ;Get RANDOM BYTE
  2029                                                                                  ;and put into A
  2030  2e9c  e603                  AND         0x3                                     ;Range it to 0-3
  2031  2e9e  3d                    DEC         A
  2032  2e9f  c2aa2e                JP          NZ,LAB_ram_ef08                         ;If NZ, check for case 1
  2033  2ea2  1e00                  LD          E,0x0                    ;Case 0: set SPRT increase to 0
  2034  2ea4  012000                LD          BC,$20                                 ;Set PHYS increase to 20
  2035  2ea7  c3842e                JP          PROCESS_LARGE_POTION                    ;...and reprocess
  2036                          LAB_ram_ef08:
  2037  2eaa  3d                    DEC         A
  2038  2eab  c2b62e                JP          NZ,LAB_ram_ef12
  2039  2eae  010000                LD          BC,0x0                                  ;Set PHYS increase to 0
  2040  2eb1  1e12                  LD          E,$12                ;Set SPRT increase to 12
  2041  2eb3  c3842e                JP          PROCESS_LARGE_POTION
  2042                          LAB_ram_ef12:
  2043  2eb6  3d                    DEC         A
  2044  2eb7  c2c52e                JP          NZ,CHECK_CASE_3_WL_POTION
  2045  2eba  cd582e                CALL        TOTAL_HEAL                              ;Fill up PHYS and SPRT
  2046  2ebd  011000                LD          BC,$10                                 ;Set PHYS increase to 10
  2047  2ec0  1e06                  LD          E,0x6                    ;Set SPRT increase to 6
  2048  2ec2  c3842e                JP          PROCESS_LARGE_POTION
  2049                          CHECK_CASE_3_WL_POTION:
  2050  2ec5  013000                LD          BC,$30                                 ;Set PHYS decrease to 30
  2051  2ec8  1e15                  LD          E,$15                                  ;Set SPRT decrease to 15
  2052  2eca  cd1c2f                CALL        REDUCE_HEALTH_BIG
  2053  2ecd  011500                LD          BC,$15
  2054  2ed0  1e07                  LD          E,0x7
  2055  2ed2  cd392f                CALL        REDUCE_HEALTH_SMALL
  2056  2ed5  c32b2e                JP          PROCESS_POTION_UPDATES
  2057                          CALC_CURR_PHYS_HEALTH:
  2058  2ed8  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)                 ;Load current PHYS Health
  2059                                                                                  ;into HL
  2060  2edb  7d                    LD          A,L
  2061  2edc  81                    ADD         A,C
  2062  2edd  27                    DAA                                                 ;Correct 1000s & 100s
  2063                                                                                  ;for BCD
  2064  2ede  6f                    LD          L,A
  2065  2edf  7c                    LD          A,H
  2066  2ee0  88                    ADC         A,B
  2067  2ee1  27                    DAA                                                 ;Correct 10s & 1s
  2068                                                                                  ;for BCD
  2069  2ee2  fe02                  CP          0x2
  2070  2ee4  67                    LD          H,A
  2071  2ee5  c2ec2e                JP          NZ,UPDATE_HEALTH_VALUES
  2072  2ee8  2601                  LD          H,0x1
  2073  2eea  2e99                  LD          L,$99                                  ;Max PHYS Health of 199
  2074                          UPDATE_HEALTH_VALUES:
  2075  2eec  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  2076  2eef  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  2077  2ef2  83                    ADD         A,E
  2078  2ef3  27                    DAA                                                 ;Correct for BCD
  2079  2ef4  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2080  2ef7  d0                    RET         NC
  2081  2ef8  3e99                  LD          A,$99                                  ;Max SPRT Health of 99
  2082  2efa  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2083  2efd  c9                    RET
  2084                          CALC_MAX_PHYS_HEALTH:
  2085  2efe  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
  2086  2f01  ed4b953a              LD          BC,(PLAYER_PHYS_HEALTH_MAX)
  2087  2f05  7c                    LD          A,H
  2088  2f06  b8                    CP          B
  2089  2f07  da122f                JP          C,CALC_MAX_SPRT_HEALTH
  2090  2f0a  7d                    LD          A,L
  2091  2f0b  b9                    CP          C
  2092  2f0c  da122f                JP          C,CALC_MAX_SPRT_HEALTH
  2093  2f0f  22953a                LD          (PLAYER_PHYS_HEALTH_MAX),HL
  2094                          CALC_MAX_SPRT_HEALTH:
  2095  2f12  21983a                LD          HL,PLAYER_SPRT_HEALTH_MAX
  2096  2f15  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  2097  2f18  be                    CP          (HL)
  2098  2f19  d8                    RET         C
  2099  2f1a  77                    LD          (HL),A
  2100  2f1b  c9                    RET
  2101                          REDUCE_HEALTH_BIG:
  2102  2f1c  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
  2103  2f1f  7d                    LD          A,L
  2104  2f20  91                    SUB         C
  2105  2f21  27                    DAA
  2106  2f22  6f                    LD          L,A
  2107  2f23  7c                    LD          A,H
  2108  2f24  98                    SBC         A,B
  2109  2f25  27                    DAA
  2110  2f26  67                    LD          H,A
  2111  2f27  da562f                JP          C,PLAYER_DIES
  2112  2f2a  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  2113  2f2d  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  2114  2f30  93                    SUB         E
  2115  2f31  27                    DAA
  2116  2f32  da562f                JP          C,PLAYER_DIES
  2117  2f35  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2118  2f38  c9                    RET
  2119                          REDUCE_HEALTH_SMALL:
  2120  2f39  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
  2121  2f3c  7d                    LD          A,L
  2122  2f3d  91                    SUB         C
  2123  2f3e  27                    DAA
  2124  2f3f  6f                    LD          L,A
  2125  2f40  7c                    LD          A,H
  2126  2f41  98                    SBC         A,B
  2127  2f42  27                    DAA
  2128  2f43  67                    LD          H,A
  2129  2f44  da562f                JP          C,PLAYER_DIES
  2130  2f47  22953a                LD          (PLAYER_PHYS_HEALTH_MAX),HL
  2131  2f4a  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
  2132  2f4d  93                    SUB         E
  2133  2f4e  27                    DAA
  2134  2f4f  da562f                JP          C,PLAYER_DIES
  2135  2f52  32983a                LD          (PLAYER_SPRT_HEALTH_MAX),A
  2136  2f55  c9                    RET
  2137                          PLAYER_DIES:
  2138  2f56  212834                LD          HL,COLRAM_VIEWPORT_IDX                  ;= $60    `
  2139  2f59  011818                LD          BC,$1818                               ;18 x 18 rectangle
  2140  2f5c  af                    XOR         A
  2141  2f5d  cd3609                CALL        FILL_CHRCOL_RECT
  2142  2f60  21e731                LD          HL,CHRRAM_YOU_DIED_IDX                  ;= $20
  2143  2f63  11c808                LD          DE,YOU_DIED_TXT
  2144  2f66  3a6c3a                LD          A,(INPUT_HOLDER)
  2145  2f69  32783a                LD          (LAST_ITEM_HELD),A
  2146  2f6c  07                    RLCA
  2147  2f6d  07                    RLCA
  2148  2f6e  07                    RLCA
  2149  2f6f  07                    RLCA
  2150  2f70  47                    LD          B,A
  2151  2f71  cd0f33                CALL        GFX_DRAW
  2152  2f74  210000                LD          HL,0x0
  2153  2f77  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  2154  2f7a  af                    XOR         A
  2155  2f7b  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2156  2f7e  326c3a                LD          (INPUT_HOLDER),A
  2157  2f81  cdde3c                CALL        REDRAW_STATS
  2158  2f84  3e32                  LD          A,$32
  2159  2f86  32653a                LD          (RAM_AD),A
  2160  2f89  cd2c0e                CALL        SUB_ram_cdd3
  2161  2f8c  cd481d                CALL        SLEEP_ZERO                              ;byte SLEEP_ZERO(void)
  2162  2f8f  c3222a                JP          SCREEN_SAVER_FULL_SCREEN
  2163                          
  2164                          ; Delete next during high rom reshuffle
  2165                          YOU_DIED_TXT_OLD:
  2166  2f92  7fa0596f75206469      DB          $7F,$A0,"You died ",$FF
              656420ff          
  2167                          
  2168                          DO_USE_PHYS_POTION:
  2169  2f9e  cd382e                CALL        PLAY_USE_PHYS_POTION_SOUND
  2170  2fa1  04                    INC         B                                       ;Change from LEVEL to
  2171                                                                                  ;COLOR value (Level + 1)
  2172  2fa2  60                    LD          H,B
  2173  2fa3  68                    LD          L,B
  2174  2fa4  224134                LD          (COLRAM_PHYS_STATS_1000),HL             ;Update PHYS color (1000s & 100s)
  2175                                                                                  ;to potion level on BLK
  2176  2fa7  224334                LD          (COLRAM_PHYS_STATS_10),HL               ;Update PHYS color (10s & 1s)
  2177                                                                                  ;to potion level on BLK
  2178  2faa  26d0                  LD          H,$d0                                  ;DKGRN on BLK
  2179  2fac  6c                    LD          L,H
  2180  2fad  224634                LD          (COLRAM_SPRT_STATS_10),HL               ;Update SPRT color (10s)
  2181                                                                                  ;to DKGRN on BLACK
  2182  2fb0  224734                LD          (COLRAM_SPRT_STATS_1),HL                ;Update SPRT color (1s)
  2183                                                                                  ;to DKGRN on BLACK
  2184  2fb3  c32b2e                JP          PROCESS_POTION_UPDATES
  2185                          DO_USE_SPRT_POTION:
  2186  2fb6  cd382e                CALL        PLAY_USE_PHYS_POTION_SOUND
  2187  2fb9  04                    INC         B                                       ;Change from LEVEL to
  2188                                                                                  ;COLOR value (Level + 1)
  2189  2fba  60                    LD          H,B
  2190  2fbb  68                    LD          L,B
  2191  2fbc  224634                LD          (COLRAM_SPRT_STATS_10),HL               ;Update SPRT color (10s)
  2192                                                                                  ;to potion level on BLK
  2193  2fbf  224734                LD          (COLRAM_SPRT_STATS_1),HL                ;Update SPRT color (1s)
  2194                                                                                  ;to potion level on BLK
  2195  2fc2  26d0                  LD          H,$d0                                  ;DKGRN on BLK
  2196  2fc4  6c                    LD          L,H
  2197  2fc5  224134                LD          (COLRAM_PHYS_STATS_1000),HL             ;Update PHYS color (1000s & 100s)
  2198                                                                                  ;to DKGRN on BLK
  2199  2fc8  224334                LD          (COLRAM_PHYS_STATS_10),HL               ;Update PHYS color (10s & 1s)
  2200                                                                                  ;to DKGRN on BLK
  2201  2fcb  c32b2e                JP          PROCESS_POTION_UPDATES
  2202                          DO_USE_KEY:
  2203  2fce  3aea37                LD          A,(ITEM_F0)                             ;= $60
  2204  2fd1  0e00                  LD          C,0x0
  2205  2fd3  cb3f                  SRL         A
  2206  2fd5  cb19                  RR          C
  2207  2fd7  cb3f                  SRL         A
  2208  2fd9  cb11                  RL          C
  2209  2fdb  cb11                  RL          C
  2210  2fdd  fe14                  CP          $14
  2211  2fdf  c2a621                JP          NZ,NO_ACTION_TAKEN
  2212  2fe2  78                    LD          A,B
  2213  2fe3  b9                    CP          C
  2214  2fe4  daa621                JP          C,NO_ACTION_TAKEN
  2215  2fe7  79                    LD          A,C
  2216  2fe8  47                    LD          B,A
  2217  2fe9  a7                    AND         A
  2218  2fea  caf72f                JP          Z,LAB_ram_f048
  2219  2fed  cdc63a                CALL        UPDATE_SCR_SAVER_TIMER
  2220  2ff0  0c                    INC         C
  2221                          LAB_ram_f043:
  2222  2ff1  91                    SUB         C
  2223  2ff2  d2f12f                JP          NC,LAB_ram_f043
  2224  2ff5  81                    ADD         A,C
  2225  2ff6  47                    LD          B,A
  2226                          LAB_ram_f048:
  2227  2ff7  ed5f                  LD          A,R                                     ;Semi-random number into A
  2228  2ff9  e607                  AND         0x7
  2229                          LAB_ram_f04c:
  2230  2ffb  ca2230                JP          Z,LAB_ram_f071
  2231  2ffe  d607                  SUB         0x7
  2232                          LAB_ram_f050:
  2233  3000  d2fb2f                JP          NC,LAB_ram_f04c
  2234  3003  c61d                  ADD         A,$1d
  2235                          LAB_ram_f054:
  2236  3005  cb18                  RR          B
  2237  3007  cb19                  RR          C
  2238  3009  cb18                  RR          B
  2239  300b  17                    RLA
  2240  300c  cb11                  RL          C
  2241  300e  17                    RLA
  2242  300f  08                    EX          AF,AF'
  2243  3010  3a793a                LD          A,(PLAYER_MAP_POS)
  2244  3013  cdec37                CALL        ITEM_MAP_CHECK
  2245  3016  08                    EX          AF,AF'
  2246  3017  02                    LD          (BC),A
  2247  3018  3a783a                LD          A,(LAST_ITEM_HELD)
  2248  301b  a7                    AND         A
  2249  301c  c22232                JP          NZ,INIT_MELEE_ANIM
  2250  301f  c3042a                JP          UPDATE_VIEWPORT
  2251                          LAB_ram_f071:
  2252  3022  79                    LD          A,C
  2253  3023  fe04                  CP          0x4
  2254  3025  ca2e30                JP          Z,LAB_ram_f07c
  2255  3028  47                    LD          B,A
  2256  3029  3e16                  LD          A,$16
  2257  302b  c30530                JP          LAB_ram_f054
  2258                          LAB_ram_f07c:
  2259  302e  0603                  LD          B,0x3
  2260  3030  3e1c                  LD          A,$1c
  2261  3032  c30530                JP          LAB_ram_f054
  2262                          USE_SOMETHING_ELSE:
  2263  3035  08                    EX          AF,AF'
  2264  3036  3ae833                LD          A,(WALL_F0_STATE)                       ;= $20
  2265  3039  a7                    AND         A
  2266  303a  ca4230                JP          Z,CHECK_FOR_NON_ITEMS
  2267  303d  cb57                  BIT         0x2,A
  2268  303f  ca4f30                JP          Z,CHECK_FOR_END_ITEM
  2269                          CHECK_FOR_NON_ITEMS:
  2270  3042  3ae937                LD          A,(ITEM_F1)                             ;= $60
  2271  3045  fefe                  CP          $fe                                    ;Compare to EMPTY
  2272  3047  ca4f30                JP          Z,CHECK_FOR_END_ITEM
  2273  304a  fe78                  CP          $78                                    ;Compare to MONSTERS
  2274  304c  d25630                JP          NC,CHECK_IF_BOW_XBOW
  2275                          CHECK_FOR_END_ITEM:
  2276  304f  08                    EX          AF,AF'
  2277  3050  feff                  CP          $ff                                    ;Compare to EMPTY-END
  2278  3052  c2a621                JP          NZ,NO_ACTION_TAKEN
  2279  3055  08                    EX          AF,AF'
  2280                          CHECK_IF_BOW_XBOW:
  2281  3056  08                    EX          AF,AF'
  2282  3057  fe06                  CP          0x6                                     ;Compare to BOW
  2283  3059  c27930                JP          NZ,CHECK_IF_SCROLL_STAFF
  2284                          USE_BOW_XBOW:
  2285  305c  c5                    PUSH        BC                                      ;Save BC
  2286  305d  3aac3a                LD          A,(ARROW_INV)                           ;Get Arrow Inventory
  2287  3060  d601                  SUB         0x1                                     ;Decrease by 1
  2288  3062  daa621                JP          C,NO_ACTION_TAKEN                       ;If Arrow Inv <1, end
  2289  3065  32ac3a                LD          (ARROW_INV),A
  2290  3068  cdbb22                CALL        CHK_ITEM_BREAK
  2291  306b  c1                    POP         BC
  2292  306c  d27430                JP          NC,BOW_XBOW_NO_BREAK
  2293  306f  3efe                  LD          A,$fe                                  ;$fe = EMPTY ITEM
  2294  3071  327a3a                LD          (RIGHT_HAND_ITEM),A                     ;Put EMPTY ITEM into Right Hand
  2295                          BOW_XBOW_NO_BREAK:
  2296  3074  1605                  LD          D,0x5
  2297  3076  c3a830                JP          LAB_ram_f0e9
  2298                          CHECK_IF_SCROLL_STAFF:
  2299  3079  fe07                  CP          0x7                                     ;Compare to SCROLL
  2300  307b  c29030                JP          NZ,CHECK_OTHERS
  2301                          USE_SCROLL_STAFF:
  2302  307e  c5                    PUSH        BC
  2303  307f  cdbb22                CALL        CHK_ITEM_BREAK
  2304  3082  c1                    POP         BC
  2305  3083  d28b30                JP          NC,SCROLL_STAFF_NO_BREAK
  2306  3086  3efe                  LD          A,$fe
  2307  3088  327a3a                LD          (RIGHT_HAND_ITEM),A
  2308                          SCROLL_STAFF_NO_BREAK:
  2309  308b  1609                  LD          D,0x9                                   ;Use FIREBALL ammo
  2310  308d  c3a830                JP          LAB_ram_f0e9
  2311                          CHECK_OTHERS:
  2312  3090  fe0b                  CP          0xb                                     ;Compare to STAFF
  2313  3092  ca7e30                JP          Z,USE_SCROLL_STAFF
  2314  3095  fe0c                  CP          0xc                                     ;Compare to XBOW
  2315  3097  ca5c30                JP          Z,USE_BOW_XBOW
  2316  309a  fe06                  CP          0x6                                     ;Compare to BOW
  2317  309c  daa621                JP          C,NO_ACTION_TAKEN
  2318  309f  fe10                  CP          $10                                    ;Compare to LADDER
  2319  30a1  d2d230                JP          NC,LAB_ram_f113
  2320  30a4  57                    LD          D,A
  2321  30a5  cd452e                CALL        SUB_ram_eea9
  2322                          LAB_ram_f0e9:
  2323  30a8  cdb130                CALL        SUB_ram_f0f2
  2324  30ab  c3f130                JP          SUB_ram_f130
  2325                          SUB_ram_f0ef:
  2326  30ae  cd452e                CALL        SUB_ram_eea9
  2327                          SUB_ram_f0f2:
  2328  30b1  3e03                  LD          A,0x3
  2329  30b3  32873a                LD          (BYTE_ram_3a87),A
  2330  30b6  7a                    LD          A,D
  2331  30b7  cb27                  SLA         A
  2332  30b9  cb27                  SLA         A
  2333  30bb  b0                    OR          B
  2334  30bc  32823a                LD          (BYTE_ram_3a82),A
  2335  30bf  210302                LD          HL,$203
  2336  30c2  22853a                LD          (BYTE_ram_3a85),HL
  2337  30c5  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  2338  30c8  22833a                LD          (BYTE_ram_3a83),HL
  2339  30cb  7d                    LD          A,L
  2340  30cc  32653a                LD          (RAM_AD),A
  2341  30cf  c32223                JP          LAB_ram_e3d7
  2342                          LAB_ram_f113:
  2343  30d2  fe11                  CP          $11
  2344  30d4  c2da30                JP          NZ,LAB_ram_f119
  2345  30d7  c3df30                JP          LAB_ram_f11e
  2346                          LAB_ram_f119:
  2347  30da  fe14                  CP          $14
  2348  30dc  c2a621                JP          NZ,NO_ACTION_TAKEN
  2349                          LAB_ram_f11e:
  2350  30df  57                    LD          D,A
  2351  30e0  3a783a                LD          A,(LAST_ITEM_HELD)
  2352  30e3  a7                    AND         A
  2353  30e4  caa621                JP          Z,NO_ACTION_TAKEN
  2354  30e7  af                    XOR         A                                       ;A  = $00
  2355                                                                                  ;Reset C & N, Set Z
  2356  30e8  32783a                LD          (LAST_ITEM_HELD),A
  2357  30eb  cdae30                CALL        SUB_ram_f0ef
  2358  30ee  c30d2a                JP          WAIT_FOR_INPUT
  2359                          SUB_ram_f130:
  2360  30f1  3a783a                LD          A,(LAST_ITEM_HELD)
  2361  30f4  a7                    AND         A
  2362  30f5  c22232                JP          NZ,INIT_MELEE_ANIM
  2363  30f8  3c                    INC         A
  2364  30f9  32783a                LD          (LAST_ITEM_HELD),A
  2365  30fc  3ae937                LD          A,(ITEM_F1)                             ;= $60
  2366  30ff  0600                  LD          B,0x0
  2367  3101  cb3f                  SRL         A
  2368  3103  cb18                  RR          B
  2369  3105  1f                    RRA
  2370  3106  cb10                  RL          B
  2371  3108  cb10                  RL          B
  2372  310a  08                    EX          AF,AF'
  2373  310b  af                    XOR         A
  2374  310c  21683a                LD          HL,DUNGEON_LEVEL
  2375  310f  ed6f                  RLD
  2376  3111  57                    LD          D,A
  2377  3112  cb3f                  SRL         A
  2378  3114  d21931                JP          NC,LAB_ram_f157
  2379  3117  c650                  ADD         A,$50
  2380                          LAB_ram_f157:
  2381  3119  07                    RLCA
  2382  311a  07                    RLCA
  2383  311b  07                    RLCA
  2384  311c  07                    RLCA
  2385  311d  5f                    LD          E,A
  2386  311e  7a                    LD          A,D
  2387  311f  ed6f                  RLD
  2388  3121  57                    LD          D,A
  2389  3122  cb3f                  SRL         A
  2390  3124  83                    ADD         A,E
  2391  3125  c603                  ADD         A,0x3
  2392  3127  27                    DAA
  2393  3128  4f                    LD          C,A
  2394  3129  7a                    LD          A,D
  2395  312a  ed6f                  RLD
  2396  312c  08                    EX          AF,AF'
  2397  312d  d61e                  SUB         $1e
  2398  312f  c24031                JP          NZ,LAB_ram_f17d
  2399  3132  1607                  LD          D,0x7
  2400  3134  210403                LD          HL,$304
  2401  3137  3e3c                  LD          A,$3c
  2402  3139  80                    ADD         A,B
  2403  313a  328a3a                LD          (BYTE_ram_3a8a),A
  2404  313d  c3ff31                JP          LAB_ram_f22b
  2405                          LAB_ram_f17d:
  2406  3140  3d                    DEC         A
  2407  3141  c25231                JP          NZ,LAB_ram_f18e
  2408  3144  1603                  LD          D,0x3
  2409  3146  210101                LD          HL,$101
  2410  3149  3e3c                  LD          A,$3c
  2411  314b  80                    ADD         A,B
  2412  314c  328a3a                LD          (BYTE_ram_3a8a),A
  2413  314f  c3ff31                JP          LAB_ram_f22b
  2414                          LAB_ram_f18e:
  2415  3152  3d                    DEC         A
  2416  3153  c26431                JP          NZ,LAB_ram_f19f
  2417  3156  1604                  LD          D,0x4
  2418  3158  210200                LD          HL,0x2
  2419  315b  3e24                  LD          A,$24
  2420  315d  80                    ADD         A,B
  2421  315e  328a3a                LD          (BYTE_ram_3a8a),A
  2422  3161  c3ff31                JP          LAB_ram_f22b
  2423                          LAB_ram_f19f:
  2424  3164  3d                    DEC         A
  2425  3165  c27631                JP          NZ,LAB_ram_f1af
  2426  3168  1605                  LD          D,0x5
  2427  316a  210302                LD          HL,$203
  2428  316d  3e3c                  LD          A,$3c
  2429  316f  80                    ADD         A,B
  2430  3170  328a3a                LD          (BYTE_ram_3a8a),A
  2431  3173  c3ff31                JP          LAB_ram_f22b
  2432                          LAB_ram_f1af:
  2433  3176  3d                    DEC         A
  2434  3177  c28831                JP          NZ,LAB_ram_f1bf
  2435  317a  1603                  LD          D,0x3
  2436  317c  210203                LD          HL,$302
  2437  317f  3e24                  LD          A,$24
  2438  3181  80                    ADD         A,B
  2439  3182  328a3a                LD          (BYTE_ram_3a8a),A
  2440  3185  c3ff31                JP          LAB_ram_f22b
  2441                          LAB_ram_f1bf:
  2442  3188  3d                    DEC         A
  2443  3189  c29a31                JP          NZ,LAB_ram_f1cf
  2444  318c  1608                  LD          D,0x8
  2445  318e  210504                LD          HL,$405
  2446  3191  3e24                  LD          A,$24
  2447  3193  80                    ADD         A,B
  2448  3194  328a3a                LD          (BYTE_ram_3a8a),A
  2449  3197  c3ff31                JP          LAB_ram_f22b
  2450                          LAB_ram_f1cf:
  2451  319a  3d                    DEC         A
  2452  319b  c2ac31                JP          NZ,LAB_ram_f1e0
  2453  319e  1606                  LD          D,0x6
  2454  31a0  210402                LD          HL,$204
  2455  31a3  3e3c                  LD          A,$3c
  2456  31a5  80                    ADD         A,B
  2457  31a6  328a3a                LD          (BYTE_ram_3a8a),A
  2458  31a9  c3ff31                JP          LAB_ram_f22b
  2459                          LAB_ram_f1e0:
  2460  31ac  3d                    DEC         A
  2461  31ad  c2be31                JP          NZ,LAB_ram_f1f0
  2462  31b0  1613                  LD          D,$13
  2463  31b2  210505                LD          HL,$505
  2464  31b5  3e24                  LD          A,$24
  2465  31b7  80                    ADD         A,B
  2466  31b8  328a3a                LD          (BYTE_ram_3a8a),A
  2467  31bb  c3ff31                JP          LAB_ram_f22b
  2468                          LAB_ram_f1f0:
  2469  31be  3d                    DEC         A
  2470  31bf  c2d031                JP          NZ,LAB_ram_f200
  2471  31c2  1604                  LD          D,0x4
  2472  31c4  210504                LD          HL,$405
  2473  31c7  3e3c                  LD          A,$3c
  2474  31c9  80                    ADD         A,B
  2475  31ca  328a3a                LD          (BYTE_ram_3a8a),A
  2476  31cd  c3ff31                JP          LAB_ram_f22b
  2477                          LAB_ram_f200:
  2478  31d0  3d                    DEC         A
  2479  31d1  c2fc31                JP          NZ,LAB_ram_f228
  2480  31d4  1611                  LD          D,$11
  2481  31d6  210504                LD          HL,$405
  2482  31d9  d9                    EXX
  2483  31da  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
  2484  31dd  cd8523                CALL        SUB_ram_e439
  2485  31e0  eb                    EX          DE,HL
  2486  31e1  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  2487  31e4  6f                    LD          L,A
  2488  31e5  2600                  LD          H,0x0
  2489  31e7  cd7c23                CALL        RECALC_PHYS_HEALTH
  2490  31ea  d9                    EXX
  2491  31eb  d2f731                JP          NC,LAB_ram_f224
  2492  31ee  3e24                  LD          A,$24
  2493                          LAB_ram_f21e:
  2494  31f0  80                    ADD         A,B
  2495  31f1  328a3a                LD          (BYTE_ram_3a8a),A
  2496  31f4  c3ff31                JP          LAB_ram_f22b
  2497                          LAB_ram_f224:
  2498  31f7  3e3c                  LD          A,$3c
  2499  31f9  c3f031                JP          LAB_ram_f21e
  2500                          LAB_ram_f228:
  2501  31fc  c3a621                JP          NO_ACTION_TAKEN
  2502                          LAB_ram_f22b:
  2503  31ff  cd5332                CALL        SUB_ram_f27f
  2504  3202  e5                    PUSH        HL
  2505  3203  21a23a                LD          HL,CURR_MONSTER_SPRT
  2506  3206  cd6e32                CALL        SUB_ram_f298
  2507  3209  e1                    POP         HL
  2508  320a  54                    LD          D,H
  2509  320b  cd5332                CALL        SUB_ram_f27f
  2510  320e  e5                    PUSH        HL
  2511  320f  21a53a                LD          HL,BYTE_ram_3aa5
  2512  3212  cd6e32                CALL        SUB_ram_f298
  2513  3215  e1                    POP         HL
  2514  3216  55                    LD          D,L
  2515  3217  1e00                  LD          E,0x0
  2516  3219  cd5932                CALL        CALC_WEAPON_VALUE
  2517  321c  32a83a                LD          (WEAPON_VALUE_HOLDER),A
  2518  321f  cd3d32                CALL        REDRAW_MONSTER_HEALTH
  2519                          INIT_MELEE_ANIM:
  2520  3222  3e03                  LD          A,0x3                                   ;A  = $03
  2521  3224  328b3a                LD          (MELEE_ANIM_STATE),A
  2522  3227  210602                LD          HL,$206                                ;HL = $ce
  2523  322a  228d3a                LD          (MONSTER_ATT_POS_COUNT),HL
  2524  322d  21ea31                LD          HL,$31ea                               ;HL = $0020 db?
  2525                                                                                  ;Always $20 (SPACE char)?
  2526  3230  228f3a                LD          (MONSTER_ATT_POS_OFFSET),HL
  2527  3233  7d                    LD          A,L
  2528  3234  32663a                LD          (RAM_AE),A
  2529  3237  cd4e25                CALL        ANIMATE_MELEE_ROUND
  2530  323a  c30d2a                JP          WAIT_FOR_INPUT
  2531                          REDRAW_MONSTER_HEALTH:
  2532  323d  118930                LD          DE,CHRRAM_MONSTER_PHYS                  ;WAS LD DE,$333d
  2533  3240  21a33a                LD          HL,CURR_MONSTER_PHYS
  2534  3243  0602                  LD          B,0x2
  2535  3245  cdd532                CALL        RECALC_AND_REDRAW_BCD
  2536  3248  116330                LD          DE,CHRRAM_MONSTER_SPRT                  ;WAS LD DE,$338f
  2537  324b  21a23a                LD          HL,CURR_MONSTER_SPRT
  2538  324e  0601                  LD          B,0x1
  2539  3250  c3d532                JP          RECALC_AND_REDRAW_BCD
  2540                          SUB_ram_f27f:
  2541  3253  cdc63a                CALL        UPDATE_SCR_SAVER_TIMER
  2542  3256  e607                  AND         0x7
  2543  3258  5f                    LD          E,A
  2544                          CALC_WEAPON_VALUE:
  2545  3259  c5                    PUSH        BC                                      ;Save original weaponLevel
  2546  325a  04                    INC         B                                       ;B = B + 1
  2547  325b  7a                    LD          A,D                                     ;A = D
  2548  325c  c36132                JP          LAB_ram_f28c
  2549                          LAB_ram_f28a:
  2550  325f  82                    ADD         A,D                                     ;A = A + D
  2551  3260  27                    DAA                                                 ;Normalize for BCD
  2552                          LAB_ram_f28c:
  2553  3261  10fc                  DJNZ        LAB_ram_f28a                            ;B = B - 1
  2554  3263  93                    SUB         E                                       ;A = A - E
  2555  3264  27                    DAA                                                 ;Normalize for BCD
  2556  3265  d26a32                JP          NC,LAB_ram_f294
  2557  3268  8b                    ADC         A,E                                     ;A = A + E (and CARRY)
  2558  3269  27                    DAA                                                 ;Normalize for BCD
  2559                          LAB_ram_f294:
  2560  326a  81                    ADD         A,C                                     ;A = A + C
  2561  326b  27                    DAA                                                 ;Normalize for BCD
  2562  326c  c1                    POP         BC                                      ;BC = Original weaponLevel
  2563  326d  c9                    RET                                                 ;A = new weaponValue
  2564                          SUB_ram_f298:
  2565  326e  77                    LD          (HL),A
  2566  326f  23                    INC         HL
  2567  3270  87                    ADD         A,A
  2568  3271  27                    DAA
  2569  3272  77                    LD          (HL),A
  2570  3273  23                    INC         HL
  2571  3274  3e00                  LD          A,0x0
  2572  3276  17                    RLA
  2573  3277  77                    LD          (HL),A
  2574  3278  c9                    RET
  2575                          DO_USE_LADDER:
  2576  3279  3a783a                LD          A,(LAST_ITEM_HELD)
  2577  327c  a7                    AND         A
  2578  327d  c2a621                JP          NZ,NO_ACTION_TAKEN
  2579  3280  3aea37                LD          A,(ITEM_F0)                             ;= $60
  2580  3283  fe42                  CP          $42
  2581  3285  c2a621                JP          NZ,NO_ACTION_TAKEN
  2582  3288  3a793a                LD          A,(PLAYER_MAP_POS)
  2583  328b  32773a                LD          (PLAYER_PREV_MAP_LOC),A
  2584  328e  cd8d33                CALL        BUILD_MAP
  2585  3291  cd180e                CALL        SUB_ram_cdbf
  2586  3294  cd9a32                CALL        SUB_ram_f2c4
  2587  3297  c33111                JP          RESET_SHIFT_MODE
  2588                          SUB_ram_f2c4:
  2589  329a  110230                LD          DE,$3002                               ;WAS $33df
  2590  329d  21683a                LD          HL,DUNGEON_LEVEL
  2591  32a0  3e01                  LD          A,0x1
  2592  32a2  86                    ADD         A,(HL)
  2593  32a3  27                    DAA
  2594  32a4  dab332                JP          C,LAB_ram_f2dc
  2595                          LAB_ram_f2d0:
  2596  32a7  77                    LD          (HL),A
  2597  32a8  0601                  LD          B,0x1
  2598  32aa  cdd532                CALL        RECALC_AND_REDRAW_BCD
  2599  32ad  cdef34                CALL        REDRAW_START
  2600  32b0  c3ff37                JP          REDRAW_VIEWPORT
  2601                          LAB_ram_f2dc:
  2602  32b3  cd4910                CALL        DRAW_BKGD
  2603  32b6  215130                LD          HL,DAT_ram_3051                         ;= $20
  2604  32b9  114908                LD          DE,LEVEL_99_LOOP                        ;= "Looks like this dungeon",$01
  2605  32bc  06f0                  LD          B,$f0
  2606  32be  cd0f33                CALL        GFX_DRAW
  2607  32c1  061e                  LD          B,$1e
  2608                          LAB_ram_f2ec:
  2609  32c3  d9                    EXX
  2610  32c4  cd481d                CALL        SLEEP_ZERO                              ;byte SLEEP_ZERO(void)
  2611  32c7  d9                    EXX
  2612  32c8  10f9                  DJNZ        LAB_ram_f2ec
  2613  32ca  3e90                  LD          A,$90
  2614  32cc  21683a                LD          HL,DUNGEON_LEVEL
  2615  32cf  11df33                LD          DE,CHHRAM_LVL_IDX                       ;= $20
  2616  32d2  c3a732                JP          LAB_ram_f2d0
  2617                          RECALC_AND_REDRAW_BCD:
  2618  32d5  d5                    PUSH        DE
  2619  32d6  11503a                LD          DE,$3a50
  2620  32d9  78                    LD          A,B
  2621  32da  cb27                  SLA         A
  2622  32dc  3d                    DEC         A
  2623  32dd  08                    EX          AF,AF'
  2624                          LAB_ram_f306:
  2625  32de  7e                    LD          A,(HL)
  2626  32df  e60f                  AND         0xf                                     ;Wipe upper nybble
  2627  32e1  c630                  ADD         A,$30                                  ;Numeric char offset
  2628  32e3  12                    LD          (DE),A
  2629  32e4  7e                    LD          A,(HL)
  2630  32e5  e6f0                  AND         $f0                                    ;Wipe lower nybble
  2631  32e7  0f                    RRCA                                                ;Move upper
  2632  32e8  0f                    RRCA                                                ;nybble to
  2633  32e9  0f                    RRCA                                                ;lower
  2634  32ea  0f                    RRCA                                                ;nybble
  2635  32eb  c630                  ADD         A,$30                                  ;Numeric char offset
  2636  32ed  13                    INC         DE
  2637  32ee  12                    LD          (DE),A
  2638  32ef  13                    INC         DE
  2639  32f0  23                    INC         HL
  2640  32f1  10eb                  DJNZ        LAB_ram_f306
  2641  32f3  1b                    DEC         DE
  2642  32f4  e1                    POP         HL
  2643  32f5  08                    EX          AF,AF'
  2644  32f6  47                    LD          B,A
  2645                          LAB_ram_f31f:
  2646  32f7  1a                    LD          A,(DE)
  2647  32f8  fe30                  CP          $30                                    ;Numeric char offset
  2648  32fa  c20733                JP          NZ,LAB_ram_f32d
  2649  32fd  3620                  LD          (HL),$20                               ;SPACE char for ZERO
  2650  32ff  23                    INC         HL                                      ;Move forward one cell
  2651  3300  1b                    DEC         DE                                      ;Move backwards one byte
  2652                                                                                  ;(big endian)
  2653  3301  10f4                  DJNZ        LAB_ram_f31f
  2654  3303  1a                    LD          A,(DE)
  2655  3304  c30d33                JP          LAB_ram_f333
  2656                          LAB_ram_f32d:
  2657  3307  77                    LD          (HL),A
  2658  3308  23                    INC         HL                                      ;Move forward one cell
  2659  3309  1b                    DEC         DE                                      ;Move backwards one byte
  2660                                                                                  ;(big endian)
  2661  330a  1a                    LD          A,(DE)
  2662  330b  10fa                  DJNZ        LAB_ram_f32d
  2663                          LAB_ram_f333:
  2664  330d  77                    LD          (HL),A
  2665  330e  c9                    RET
  2666                          GFX_DRAW:
  2667  330f  e5                    PUSH        HL
  2668  3310  0e28                  LD          C,$28                                  ;$28 = +40, down one row
  2669                          LAB_ram_f338:
  2670  3312  1a                    LD          A,(DE)                       ;= "\b",$FF
  2671                                                                                  ;= $FF
  2672  3313  13                    INC         DE
  2673  3314  3c                    INC         A
  2674  3315  c21a33                JP          NZ,LAB_ram_f33f                         ;Check for $ff end of graphic char
  2675  3318  e1                    POP         HL
  2676  3319  c9                    RET
  2677                          LAB_ram_f33f:
  2678  331a  3d                    DEC         A                                       ;$00 = no char, move right one column...
  2679  331b  c22233                JP          NZ,LAB_ram_f345
  2680  331e  23                    INC         HL
  2681  331f  c31233                JP          LAB_ram_f338
  2682                          LAB_ram_f345:
  2683  3322  fe01                  CP          0x1                                     ;$01 = down one row, back to index
  2684  3324  c23133                JP          NZ,LAB_ram_f352
  2685  3327  78                    LD          A,B
  2686  3328  0600                  LD          B,0x0
  2687  332a  e1                    POP         HL
  2688  332b  09                    ADD         HL,BC
  2689  332c  e5                    PUSH        HL
  2690  332d  47                    LD          B,A
  2691  332e  c31233                JP          LAB_ram_f338
  2692                          LAB_ram_f352:
  2693  3331  fe02                  CP          0x2                                     ;$02 = back up one column
  2694  3333  c23a33                JP          NZ,LAB_ram_f359
  2695  3336  2b                    DEC         HL
  2696  3337  c31233                JP          LAB_ram_f338
  2697                          LAB_ram_f359:
  2698  333a  fe03                  CP          0x3                                     ;$03 = down one row, same column
  2699  333c  c24a33                JP          NZ,LAB_ram_f367
  2700  333f  78                    LD          A,B
  2701  3340  0600                  LD          B,0x0
  2702  3342  09                    ADD         HL,BC
  2703  3343  e3                    EX          (SP),HL
  2704  3344  09                    ADD         HL,BC
  2705  3345  e3                    EX          (SP),HL
  2706  3346  47                    LD          B,A
  2707  3347  c31233                JP          LAB_ram_f338
  2708                          LAB_ram_f367:
  2709  334a  fe04                  CP          0x4                                     ;$04 = up one row, same column
  2710  334c  c25c33                JP          NZ,LAB_ram_f377
  2711  334f  78                    LD          A,B
  2712  3350  0600                  LD          B,0x0
  2713  3352  ed42                  SBC         HL,BC
  2714  3354  e3                    EX          (SP),HL
  2715  3355  ed42                  SBC         HL,BC
  2716  3357  e3                    EX          (SP),HL
  2717  3358  47                    LD          B,A
  2718  3359  c31233                JP          LAB_ram_f338
  2719                          LAB_ram_f377:
  2720  335c  fea0                  CP          $a0                                    ;$a0 = reverse FG & BG colors
  2721  335e  c26c33                JP          NZ,LAB_ram_f385
  2722  3361  cb08                  RRC         B                                       ;Swap hi and lo nybbles (FG & BG colo...
  2723  3363  cb08                  RRC         B
  2724  3365  cb08                  RRC         B
  2725  3367  cb08                  RRC         B
  2726  3369  c31233                JP          LAB_ram_f338
  2727                          LAB_ram_f385:
  2728  336c  77                    LD          (HL),A              ;= $20
  2729  336d  24                    INC         H
  2730  336e  24                    INC         H
  2731  336f  24                    INC         H
  2732  3370  24                    INC         H
  2733  3371  3e0f                  LD          A,0xf
  2734  3373  b8                    CP          B
  2735  3374  7e                    LD          A,(HL)                    ;= $60
  2736  3375  da8133                JP          C,LAB_ram_f398
  2737  3378  07                    RLCA
  2738  3379  07                    RLCA
  2739  337a  07                    RLCA
  2740  337b  07                    RLCA
  2741  337c  e6f0                  AND         $f0
  2742  337e  c38333                JP          LAB_ram_f39a
  2743                          LAB_ram_f398:
  2744  3381  e60f                  AND         0xf
  2745                          LAB_ram_f39a:
  2746  3383  b0                    OR          B
  2747  3384  77                    LD          (HL),A                    ;= $60
  2748  3385  25                    DEC         H
  2749  3386  25                    DEC         H
  2750  3387  25                    DEC         H
  2751  3388  25                    DEC         H
  2752  3389  23                    INC         HL
  2753  338a  c31233                JP          LAB_ram_f338
  2754                          BUILD_MAP:
  2755  338d  210038                LD          HL,MAPSPACE_WALLS
  2756  3390  0600                  LD          B,0x0
  2757                          GENERATE_MAPWALLS_LOOP:
  2758  3392  cda73a                CALL        MAKE_RANDOM_BYTE
  2759  3395  5f                    LD          E,A
  2760  3396  cda73a                CALL        MAKE_RANDOM_BYTE
  2761  3399  a3                    AND         E
  2762  339a  e663                  AND         $63
  2763  339c  77                    LD          (HL),A
  2764  339d  2c                    INC         L
  2765  339e  10f2                  DJNZ        GENERATE_MAPWALLS_LOOP
  2766  33a0  3a793a                LD          A,(PLAYER_MAP_POS)
  2767  33a3  6f                    LD          L,A
  2768  33a4  3642                  LD          (HL),$42
  2769                          GEN_MAP_NW_WALL_LOOP:
  2770  33a6  cdc63a                CALL        UPDATE_SCR_SAVER_TIMER
  2771  33a9  3c                    INC         A
  2772  33aa  caa633                JP          Z,GEN_MAP_NW_WALL_LOOP
  2773  33ad  3d                    DEC         A
  2774  33ae  32a13a                LD          (ITEM_HOLDER),A
  2775  33b1  6f                    LD          L,A
  2776  33b2  3663                  LD          (HL),$63
  2777  33b4  210039                LD          HL,MAP_LADDER_OFFSET
  2778  33b7  77                    LD          (HL),A
  2779  33b8  2c                    INC         L
  2780  33b9  3642                  LD          (HL),$42                   ;Put ladder object into map
  2781                                                                                  ;(always 1st item after offset)
  2782  33bb  2c                    INC         L
  2783  33bc  3a6c3a                LD          A,(INPUT_HOLDER)
  2784  33bf  47                    LD          B,A
  2785  33c0  3e02                  LD          A,0x2
  2786  33c2  c3c733                JP          LAB_ram_f3db
  2787                          LAB_ram_f3d9:
  2788  33c5  87                    ADD         A,A
  2789  33c6  27                    DAA
  2790                          LAB_ram_f3db:
  2791  33c7  10fc                  DJNZ        LAB_ram_f3d9
  2792  33c9  4f                    LD          C,A
  2793  33ca  3a683a                LD          A,(DUNGEON_LEVEL)
  2794  33cd  b9                    CP          C
  2795  33ce  daed33                JP          C,LAB_ram_f3fd
  2796                          GEN_ITEM_MAP:
  2797  33d1  cdc63a                CALL        UPDATE_SCR_SAVER_TIMER
  2798  33d4  3c                    INC         A
  2799  33d5  cad133                JP          Z,GEN_ITEM_MAP
  2800  33d8  3d                    DEC         A
  2801  33d9  4f                    LD          C,A
  2802  33da  3aa13a                LD          A,(ITEM_HOLDER)
  2803  33dd  b9                    CP          C
  2804  33de  cad133                JP          Z,GEN_ITEM_MAP
  2805  33e1  3a793a                LD          A,(PLAYER_MAP_POS)
  2806  33e4  b9                    CP          C
  2807  33e5  cad133                JP          Z,GEN_ITEM_MAP
  2808  33e8  71                    LD          (HL),C
  2809  33e9  23                    INC         HL
  2810  33ea  369f                  LD          (HL),$9f                ;Full ITEM_monster range $009f
  2811  33ec  23                    INC         HL
  2812                          LAB_ram_f3fd:
  2813  33ed  0650                  LD          B,$50                                  ;Max 50 items+monstersdb?
  2814                          GEN_RND_ITEM:
  2815  33ef  cda73a                CALL        MAKE_RANDOM_BYTE
  2816  33f2  3c                    INC         A
  2817  33f3  caef33                JP          Z,GEN_RND_ITEM
  2818  33f6  3d                    DEC         A
  2819  33f7  08                    EX          AF,AF'
  2820  33f8  3a683a                LD          A,(DUNGEON_LEVEL)
  2821  33fb  a7                    AND         A
  2822  33fc  c20b34                JP          NZ,LAB_ram_f417
  2823  33ff  08                    EX          AF,AF'
  2824  3400  fe01                  CP          0x1
  2825  3402  caef33                JP          Z,GEN_RND_ITEM
  2826  3405  fe10                  CP          $10
  2827  3407  caef33                JP          Z,GEN_RND_ITEM
  2828  340a  08                    EX          AF,AF'
  2829                          LAB_ram_f417:
  2830  340b  08                    EX          AF,AF'
  2831  340c  5f                    LD          E,A
  2832  340d  3a793a                LD          A,(PLAYER_MAP_POS)
  2833  3410  bb                    CP          E
  2834  3411  caef33                JP          Z,GEN_RND_ITEM
  2835  3414  3aa13a                LD          A,(ITEM_HOLDER)
  2836  3417  bb                    CP          E
  2837  3418  caef33                JP          Z,GEN_RND_ITEM
  2838  341b  73                    LD          (HL),E
  2839  341c  2c                    INC         L
  2840  341d  cdc63a                CALL        UPDATE_SCR_SAVER_TIMER
  2841  3420  e6c0                  AND         $c0
  2842  3422  07                    RLCA
  2843  3423  07                    RLCA
  2844  3424  3d                    DEC         A
  2845  3425  c22f34                JP          NZ,LAB_ram_f437
  2846  3428  0e05                  LD          C,0x5
  2847  342a  1600                  LD          D,0x0
  2848  342c  c36434                JP          LAB_ram_f465
  2849                          LAB_ram_f437:
  2850  342f  3d                    DEC         A
  2851  3430  c24434                JP          NZ,LAB_ram_f449
  2852  3433  0e05                  LD          C,0x5
  2853  3435  1606                  LD          D,0x6
  2854  3437  3a683a                LD          A,(DUNGEON_LEVEL)
  2855  343a  fe06                  CP          0x6
  2856  343c  da6434                JP          C,LAB_ram_f465
  2857  343f  0e07                  LD          C,0x7
  2858  3441  c36434                JP          LAB_ram_f465
  2859                          LAB_ram_f449:
  2860  3444  3d                    DEC         A
  2861  3445  c24f34                JP          NZ,LAB_ram_f452
  2862  3448  0e04                  LD          C,0x4
  2863  344a  1611                  LD          D,$11
  2864  344c  c36434                JP          LAB_ram_f465
  2865                          LAB_ram_f452:
  2866  344f  161e                  LD          D,$1e
  2867  3451  0e05                  LD          C,0x5
  2868  3453  3a683a                LD          A,(DUNGEON_LEVEL)
  2869  3456  fe06                  CP          0x6
  2870  3458  da6434                JP          C,LAB_ram_f465
  2871  345b  0e07                  LD          C,0x7
  2872  345d  fe16                  CP          $16
  2873  345f  da6434                JP          C,LAB_ram_f465
  2874  3462  0e09                  LD          C,0x9
  2875                          LAB_ram_f465:
  2876  3464  cda73a                CALL        MAKE_RANDOM_BYTE
  2877  3467  e60f                  AND         0xf
  2878                          LAB_ram_f46a:
  2879  3469  91                    SUB         C
  2880  346a  d26934                JP          NC,LAB_ram_f46a
  2881  346d  81                    ADD         A,C
  2882  346e  82                    ADD         A,D
  2883  346f  4f                    LD          C,A
  2884  3470  3a683a                LD          A,(DUNGEON_LEVEL)
  2885  3473  3c                    INC         A
  2886  3474  3c                    INC         A
  2887  3475  cb3f                  SRL         A
  2888  3477  57                    LD          D,A
  2889  3478  cdc63a                CALL        UPDATE_SCR_SAVER_TIMER
  2890  347b  5f                    LD          E,A
  2891  347c  cda73a                CALL        MAKE_RANDOM_BYTE
  2892  347f  a3                    AND         E
  2893  3480  e603                  AND         0x3
  2894                          LAB_ram_f482:
  2895  3482  92                    SUB         D
  2896  3483  d28234                JP          NC,LAB_ram_f482
  2897  3486  82                    ADD         A,D
  2898  3487  1f                    RRA
  2899  3488  1f                    RRA
  2900  3489  cb11                  RL          C
  2901  348b  17                    RLA
  2902  348c  cb11                  RL          C
  2903  348e  71                    LD          (HL),C
  2904  348f  2c                    INC         L
  2905  3490  05                    DEC         B
  2906  3491  c2ef33                JP          NZ,GEN_RND_ITEM
  2907  3494  36ff                  LD          (HL),$ff
  2908  3496  11003b                LD          DE,TEMP_MAP
  2909  3499  210039                LD          HL,MAP_LADDER_OFFSET
  2910  349c  0600                  LD          B,0x0
  2911                          LAB_ram_f49d:
  2912  349e  7e                    LD          A,(HL)
  2913  349f  feff                  CP          $ff
  2914  34a1  cac834                JP          Z,SETUP_MAP_COPY
  2915  34a4  04                    INC         B
  2916  34a5  cddc34                CALL        SUB_ram_f4d4
  2917  34a8  d9                    EXX
  2918  34a9  cabc34                JP          Z,LAB_ram_f4b7
  2919  34ac  12                    LD          (DE),A
  2920  34ad  13                    INC         DE
  2921  34ae  23                    INC         HL
  2922  34af  7e                    LD          A,(HL)
  2923  34b0  fefe                  CP          $fe
  2924  34b2  cac234                JP          Z,LAB_ram_f4bc
  2925  34b5  04                    INC         B
  2926  34b6  12                    LD          (DE),A
  2927  34b7  13                    INC         DE
  2928  34b8  23                    INC         HL
  2929  34b9  c39e34                JP          LAB_ram_f49d
  2930                          LAB_ram_f4b7:
  2931  34bc  23                    INC         HL
  2932  34bd  23                    INC         HL
  2933  34be  05                    DEC         B
  2934  34bf  c39e34                JP          LAB_ram_f49d
  2935                          LAB_ram_f4bc:
  2936  34c2  23                    INC         HL
  2937  34c3  1b                    DEC         DE
  2938  34c4  05                    DEC         B
  2939  34c5  c39e34                JP          LAB_ram_f49d
  2940                          SETUP_MAP_COPY:
  2941  34c8  11003b                LD          DE,TEMP_MAP                             ;DE = Temp Map
  2942  34cb  210039                LD          HL,MAP_LADDER_OFFSET                    ;HL = Real Map
  2943  34ce  04                    INC         B
  2944  34cf  05                    DEC         B
  2945  34d0  cad934                JP          Z,MAP_DONE
  2946                          COPY_TEMP_MAP_TO_REAL_MAP:
  2947  34d3  1a                    LD          A,(DE)
  2948  34d4  77                    LD          (HL),A
  2949  34d5  23                    INC         HL
  2950  34d6  13                    INC         DE
  2951  34d7  10fa                  DJNZ        COPY_TEMP_MAP_TO_REAL_MAP               ;Loop while B is not zero
  2952                          MAP_DONE:
  2953  34d9  36ff                  LD          (HL),$ff
  2954  34db  c9                    RET
  2955                          SUB_ram_f4d4:
  2956  34dc  c5                    PUSH        BC
  2957  34dd  d9                    EXX
  2958  34de  c1                    POP         BC
  2959  34df  05                    DEC         B
  2960  34e0  caed34                JP          Z,LAB_ram_f4e4
  2961  34e3  21003b                LD          HL,TEMP_MAP
  2962                          LAB_ram_f4dd:
  2963  34e6  be                    CP          (HL)
  2964  34e7  c8                    RET         Z
  2965  34e8  05                    DEC         B
  2966  34e9  23                    INC         HL
  2967  34ea  23                    INC         HL
  2968  34eb  10f9                  DJNZ        LAB_ram_f4dd
  2969                          LAB_ram_f4e4:
  2970  34ed  05                    DEC         B
  2971  34ee  c9                    RET
  2972                          REDRAW_START:
  2973  34ef  219a37                LD          HL,CALC_WEST_REDRAW_2                            ; CALC_WEST_REDRAW (0xF79B) + 7... UNDO? was 0xF7A1
  2974  34f2  e5                    PUSH        HL
  2975  34f3  21793a                LD          HL,PLAYER_MAP_POS
  2976  34f6  5e                    LD          E,(HL)
  2977  34f7  1638                  LD          D,$38                                  ;DE = Player map position in RAM
  2978  34f9  21e833                LD          HL,WALL_F0_STATE                        ;= $20
  2979  34fc  0e05                  LD          C,0x5
  2980  34fe  3a623a                LD          A,(DIR_FACING_SHORT)
  2981  3501  3d                    DEC         A
  2982  3502  cab935                JP          Z,FACING_NORTH
  2983  3505  3d                    DEC         A
  2984  3506  cafc36                JP          Z,FACING_EAST
  2985  3509  3d                    DEC         A
  2986  350a  ca4a36                JP          Z,FACING_SOUTH
  2987  350d  1a                    LD          A,(DE)
  2988  350e  e607                  AND         0x7                                     ;Keep low 3 bits, reset top 5 bits
  2989  3510  77                    LD          (HL),A                   ;= $20
  2990  3511  1d                    DEC         E
  2991  3512  cd9437                CALL        CALC_WEST_REDRAW
  2992  3515  1d                    DEC         E
  2993  3516  cd9437                CALL        CALC_WEST_REDRAW
  2994  3519  7b                    LD          A,E
  2995  351a  c610                  ADD         A,$10
  2996  351c  5f                    LD          E,A
  2997  351d  cda535                CALL        REDRAW_VIEW
  2998  3520  2c                    INC         L
  2999  3521  77                    LD          (HL),A                   ;= $20
  3000  3522  1a                    LD          A,(DE)
  3001  3523  e607                  AND         0x7
  3002  3525  cdac35                CALL        REDRAW_NORTH
  3003  3528  7b                    LD          A,E
  3004  3529  d610                  SUB         $10
  3005  352b  5f                    LD          E,A
  3006  352c  cda535                CALL        REDRAW_VIEW
  3007  352f  77                    LD          (HL),A                   ;= $20
  3008  3530  7b                    LD          A,E
  3009  3531  d610                  SUB         $10
  3010  3533  5f                    LD          E,A
  3011  3534  1a                    LD          A,(DE)
  3012  3535  e607                  AND         0x7
  3013  3537  cdac35                CALL        REDRAW_NORTH
  3014  353a  7b                    LD          A,E
  3015  353b  c621                  ADD         A,$21
  3016  353d  5f                    LD          E,A
  3017  353e  cda535                CALL        REDRAW_VIEW
  3018  3541  77                    LD          (HL),A                   ;= $20
  3019  3542  1a                    LD          A,(DE)
  3020  3543  e607                  AND         0x7
  3021  3545  cdac35                CALL        REDRAW_NORTH
  3022  3548  7b                    LD          A,E
  3023  3549  d610                  SUB         $10
  3024  354b  5f                    LD          E,A
  3025  354c  cda535                CALL        REDRAW_VIEW
  3026  354f  2c                    INC         L
  3027  3550  77                    LD          (HL),A                   ;= $20
  3028  3551  7b                    LD          A,E
  3029  3552  d610                  SUB         $10
  3030  3554  5f                    LD          E,A
  3031  3555  1a                    LD          A,(DE)
  3032  3556  e607                  AND         0x7
  3033  3558  cdac35                CALL        REDRAW_NORTH
  3034  355b  7b                    LD          A,E
  3035  355c  c621                  ADD         A,$21
  3036  355e  5f                    LD          E,A
  3037  355f  cda535                CALL        REDRAW_VIEW
  3038  3562  2c                    INC         L
  3039  3563  77                    LD          (HL),A                   ;= $20
  3040  3564  cd9437                CALL        CALC_WEST_REDRAW
  3041  3567  7b                    LD          A,E
  3042  3568  c60e                  ADD         A,0xe
  3043  356a  5f                    LD          E,A
  3044  356b  cda535                CALL        REDRAW_VIEW
  3045  356e  2c                    INC         L
  3046  356f  2c                    INC         L
  3047  3570  77                    LD          (HL),A                    ;= $20
  3048  3571  7b                    LD          A,E
  3049  3572  d61e                  SUB         $1e
  3050  3574  5f                    LD          E,A
  3051  3575  cda535                CALL        REDRAW_VIEW
  3052  3578  2c                    INC         L
  3053  3579  77                    LD          (HL),A                    ;= $20
  3054  357a  7b                    LD          A,E
  3055  357b  d610                  SUB         $10
  3056  357d  5f                    LD          E,A
  3057  357e  cd9437                CALL        CALC_WEST_REDRAW
  3058  3581  1d                    DEC         E
  3059  3582  1d                    DEC         E
  3060  3583  cda535                CALL        REDRAW_VIEW
  3061  3586  2c                    INC         L
  3062  3587  2c                    INC         L
  3063  3588  77                    LD          (HL),A                    ;= $20
  3064  3589  7b                    LD          A,E
  3065  358a  c613                  ADD         A,$13
  3066  358c  5f                    LD          E,A
  3067  358d  cd9437                CALL        CALC_WEST_REDRAW
  3068  3590  16ff                  LD          D,$ff
  3069  3592  1ef0                  LD          E,$f0
  3070  3594  ed53603a              LD          (DIR_FACING_FW),DE                      ;DE = 0xFFF0 (WEST)
  3071  3598  0610                  LD          B,$10                                  ;RED on BLK
  3072  359a  21d831                LD          HL,CHRRAM_POINTER_IDX                   ;WAS $31d6
  3073  359d  11a335                LD          DE,WEST_TXT                             ;= "\a",$FF
  3074  35a0  c30f33                JP          GFX_DRAW
  3075                          WEST_TXT:
  3076  35a3  07ff                  db          "\a",$FF
  3077                          REDRAW_VIEW:
  3078  35a5  1a                    LD          A,(DE)
  3079  35a6  e6e0                  AND         $e0
  3080  35a8  07                    RLCA
  3081  35a9  07                    RLCA
  3082  35aa  07                    RLCA
  3083  35ab  c9                    RET
  3084                          REDRAW_NORTH:
  3085  35ac  2c                    INC         L
  3086  35ad  77                    LD          (HL),A
  3087  35ae  47                    LD          B,A
  3088  35af  7d                    LD          A,L
  3089  35b0  81                    ADD         A,C
  3090  35b1  6f                    LD          L,A
  3091  35b2  70                    LD          (HL),B
  3092  35b3  7d                    LD          A,L
  3093  35b4  91                    SUB         C
  3094  35b5  6f                    LD          L,A
  3095  35b6  2c                    INC         L
  3096  35b7  0c                    INC         C
  3097  35b8  c9                    RET
  3098                          FACING_NORTH:
  3099  35b9  cda535                CALL        REDRAW_VIEW
  3100  35bc  77                    LD          (HL),A
  3101  35bd  7b                    LD          A,E
  3102  35be  d610                  SUB         $10
  3103  35c0  5f                    LD          E,A
  3104  35c1  cda535                CALL        REDRAW_VIEW
  3105  35c4  2c                    INC         L
  3106  35c5  77                    LD          (HL),A
  3107  35c6  7b                    LD          A,E
  3108  35c7  d610                  SUB         $10
  3109  35c9  5f                    LD          E,A
  3110  35ca  cda535                CALL        REDRAW_VIEW
  3111  35cd  2c                    INC         L
  3112  35ce  77                    LD          (HL),A
  3113  35cf  cd9437                CALL        CALC_WEST_REDRAW
  3114  35d2  1d                    DEC         E
  3115  35d3  cda535                CALL        REDRAW_VIEW
  3116  35d6  cdac35                CALL        REDRAW_NORTH
  3117  35d9  1c                    INC         E
  3118  35da  1c                    INC         E
  3119  35db  1a                    LD          A,(DE)
  3120  35dc  e607                  AND         0x7
  3121  35de  77                    LD          (HL),A
  3122  35df  cda535                CALL        REDRAW_VIEW
  3123  35e2  cdac35                CALL        REDRAW_NORTH
  3124  35e5  7b                    LD          A,E
  3125  35e6  c60f                  ADD         A,0xf
  3126  35e8  5f                    LD          E,A
  3127  35e9  1a                    LD          A,(DE)
  3128  35ea  e607                  AND         0x7
  3129  35ec  77                    LD          (HL),A
  3130  35ed  1d                    DEC         E
  3131  35ee  cda535                CALL        REDRAW_VIEW
  3132  35f1  cdac35                CALL        REDRAW_NORTH
  3133  35f4  1c                    INC         E
  3134  35f5  1c                    INC         E
  3135  35f6  cd9437                CALL        CALC_WEST_REDRAW
  3136  35f9  cda535                CALL        REDRAW_VIEW
  3137  35fc  cdac35                CALL        REDRAW_NORTH
  3138  35ff  7b                    LD          A,E
  3139  3600  c60f                  ADD         A,0xf
  3140  3602  5f                    LD          E,A
  3141  3603  cd9437                CALL        CALC_WEST_REDRAW
  3142  3606  1d                    DEC         E
  3143  3607  cda535                CALL        REDRAW_VIEW
  3144  360a  2c                    INC         L
  3145  360b  77                    LD          (HL),A
  3146  360c  7b                    LD          A,E
  3147  360d  d620                  SUB         $20
  3148  360f  5f                    LD          E,A
  3149  3610  1a                    LD          A,(DE)
  3150  3611  e607                  AND         0x7
  3151  3613  2c                    INC         L
  3152  3614  2c                    INC         L
  3153  3615  77                    LD          (HL),A
  3154  3616  7b                    LD          A,E
  3155  3617  c622                  ADD         A,$22
  3156  3619  5f                    LD          E,A
  3157  361a  cd9437                CALL        CALC_WEST_REDRAW
  3158  361d  cda535                CALL        REDRAW_VIEW
  3159  3620  2c                    INC         L
  3160  3621  77                    LD          (HL),A
  3161  3622  7b                    LD          A,E
  3162  3623  d61f                  SUB         $1f
  3163  3625  5f                    LD          E,A
  3164  3626  1a                    LD          A,(DE)
  3165  3627  e607                  AND         0x7
  3166  3629  2c                    INC         L
  3167  362a  2c                    INC         L
  3168  362b  77                    LD          (HL),A
  3169  362c  7b                    LD          A,E
  3170  362d  c62e                  ADD         A,$2e
  3171  362f  5f                    LD          E,A
  3172  3630  cda535                CALL        REDRAW_VIEW
  3173  3633  2c                    INC         L
  3174  3634  77                    LD          (HL),A
  3175  3635  16f0                  LD          D,$f0
  3176  3637  1e01                  LD          E,0x1
  3177  3639  ed53603a              LD          (DIR_FACING_FW),DE
  3178  363d  0610                  LD          B,$10                                  ;RED on BLK
  3179  363f  21d831                LD          HL,CHRRAM_POINTER_IDX                   ;WAS $31d6
  3180  3642  114836                LD          DE,NORTH_TXT                            ;= "\b",$FF
  3181  3645  c30f33                JP          GFX_DRAW
  3182                          NORTH_TXT:
  3183  3648  08ff                  db          "\b",$FF
  3184                          FACING_SOUTH:
  3185  364a  7b                    LD          A,E
  3186  364b  c610                  ADD         A,$10
  3187  364d  5f                    LD          E,A
  3188  364e  cda535                CALL        REDRAW_VIEW
  3189  3651  77                    LD          (HL),A                   ;= $20
  3190  3652  7b                    LD          A,E
  3191  3653  c610                  ADD         A,$10
  3192  3655  5f                    LD          E,A
  3193  3656  cda535                CALL        REDRAW_VIEW
  3194  3659  2c                    INC         L
  3195  365a  77                    LD          (HL),A                   ;= $20
  3196  365b  7b                    LD          A,E
  3197  365c  c610                  ADD         A,$10
  3198  365e  5f                    LD          E,A
  3199  365f  cda535                CALL        REDRAW_VIEW
  3200  3662  2c                    INC         L
  3201  3663  77                    LD          (HL),A                   ;= $20
  3202  3664  7b                    LD          A,E
  3203  3665  d60f                  SUB         0xf
  3204  3667  5f                    LD          E,A
  3205  3668  cd9437                CALL        CALC_WEST_REDRAW
  3206  366b  7b                    LD          A,E
  3207  366c  c610                  ADD         A,$10
  3208  366e  5f                    LD          E,A
  3209  366f  cda535                CALL        REDRAW_VIEW
  3210  3672  cdac35                CALL        REDRAW_NORTH
  3211  3675  7b                    LD          A,E
  3212  3676  d611                  SUB         $11
  3213  3678  5f                    LD          E,A
  3214  3679  1a                    LD          A,(DE)
  3215  367a  e607                  AND         0x7
  3216  367c  77                    LD          (HL),A                   ;= $20
  3217  367d  7b                    LD          A,E
  3218  367e  c60f                  ADD         A,0xf
  3219  3680  5f                    LD          E,A
  3220  3681  cda535                CALL        REDRAW_VIEW
  3221  3684  cdac35                CALL        REDRAW_NORTH
  3222  3687  7b                    LD          A,E
  3223  3688  d61e                  SUB         $1e
  3224  368a  5f                    LD          E,A
  3225  368b  1a                    LD          A,(DE)
  3226  368c  e607                  AND         0x7
  3227  368e  77                    LD          (HL),A                   ;= $20
  3228  368f  7b                    LD          A,E
  3229  3690  c610                  ADD         A,$10
  3230  3692  5f                    LD          E,A
  3231  3693  cda535                CALL        REDRAW_VIEW
  3232  3696  cdac35                CALL        REDRAW_NORTH
  3233  3699  7b                    LD          A,E
  3234  369a  d611                  SUB         $11
  3235  369c  5f                    LD          E,A
  3236  369d  cd9437                CALL        CALC_WEST_REDRAW
  3237  36a0  7b                    LD          A,E
  3238  36a1  c60f                  ADD         A,0xf
  3239  36a3  5f                    LD          E,A
  3240  36a4  cda535                CALL        REDRAW_VIEW
  3241  36a7  cdac35                CALL        REDRAW_NORTH
  3242  36aa  7b                    LD          A,E
  3243  36ab  d61e                  SUB         $1e
  3244  36ad  5f                    LD          E,A
  3245  36ae  cd9437                CALL        CALC_WEST_REDRAW
  3246  36b1  7b                    LD          A,E
  3247  36b2  c610                  ADD         A,$10
  3248  36b4  5f                    LD          E,A
  3249  36b5  cda535                CALL        REDRAW_VIEW
  3250  36b8  2c                    INC         L
  3251  36b9  77                    LD          (HL),A                   ;= $20
  3252  36ba  7b                    LD          A,E
  3253  36bb  c611                  ADD         A,$11
  3254  36bd  5f                    LD          E,A
  3255  36be  1a                    LD          A,(DE)
  3256  36bf  e607                  AND         0x7
  3257  36c1  2c                    INC         L
  3258  36c2  2c                    INC         L
  3259  36c3  77                    LD          (HL),A                    ;= $20
  3260  36c4  7b                    LD          A,E
  3261  36c5  d622                  SUB         $22
  3262  36c7  5f                    LD          E,A
  3263  36c8  cd9437                CALL        CALC_WEST_REDRAW
  3264  36cb  7b                    LD          A,E
  3265  36cc  c60f                  ADD         A,0xf
  3266  36ce  5f                    LD          E,A
  3267  36cf  cda535                CALL        REDRAW_VIEW
  3268  36d2  2c                    INC         L
  3269  36d3  77                    LD          (HL),A                    ;= $20
  3270  36d4  7b                    LD          A,E
  3271  36d5  c610                  ADD         A,$10
  3272  36d7  5f                    LD          E,A
  3273  36d8  1a                    LD          A,(DE)
  3274  36d9  e607                  AND         0x7
  3275  36db  2c                    INC         L
  3276  36dc  2c                    INC         L
  3277  36dd  77                    LD          (HL),A                    ;= $20
  3278  36de  7b                    LD          A,E
  3279  36df  d61f                  SUB         $1f
  3280  36e1  5f                    LD          E,A
  3281  36e2  cda535                CALL        REDRAW_VIEW
  3282  36e5  2c                    INC         L
  3283  36e6  77                    LD          (HL),A                    ;= $20
  3284  36e7  1610                  LD          D,$10
  3285  36e9  1eff                  LD          E,$ff
  3286  36eb  ed53603a              LD          (DIR_FACING_FW),DE
  3287  36ef  0610                  LD          B,$10                                  ;RED on BLK
  3288  36f1  21d831                LD          HL,CHRRAM_POINTER_IDX                   ;WAS $31d6
  3289  36f4  11fa36                LD          DE,SOUTH_TXT                            ;= "\t",$FF
  3290  36f7  c30f33                JP          GFX_DRAW
  3291                          SOUTH_TXT:
  3292  36fa  09ff                  db          "\t",$FF
  3293                          FACING_EAST:
  3294  36fc  1c                    INC         E
  3295  36fd  1a                    LD          A,(DE)
  3296  36fe  e607                  AND         0x7
  3297  3700  77                    LD          (HL),A                   ;= $20
  3298  3701  1c                    INC         E
  3299  3702  cd9437                CALL        CALC_WEST_REDRAW
  3300  3705  1c                    INC         E
  3301  3706  cd9437                CALL        CALC_WEST_REDRAW
  3302  3709  1d                    DEC         E
  3303  370a  cda535                CALL        REDRAW_VIEW
  3304  370d  2c                    INC         L
  3305  370e  77                    LD          (HL),A                   ;= $20
  3306  370f  7b                    LD          A,E
  3307  3710  d60f                  SUB         0xf
  3308  3712  5f                    LD          E,A
  3309  3713  1a                    LD          A,(DE)
  3310  3714  e607                  AND         0x7
  3311  3716  cdac35                CALL        REDRAW_NORTH
  3312  3719  7b                    LD          A,E
  3313  371a  c61f                  ADD         A,$1f
  3314  371c  5f                    LD          E,A
  3315  371d  cda535                CALL        REDRAW_VIEW
  3316  3720  77                    LD          (HL),A                   ;= $20
  3317  3721  1c                    INC         E
  3318  3722  1a                    LD          A,(DE)
  3319  3723  e607                  AND         0x7
  3320  3725  cdac35                CALL        REDRAW_NORTH
  3321  3728  7b                    LD          A,E
  3322  3729  d612                  SUB         $12
  3323  372b  5f                    LD          E,A
  3324  372c  cda535                CALL        REDRAW_VIEW
  3325  372f  77                    LD          (HL),A                   ;= $20
  3326  3730  7b                    LD          A,E
  3327  3731  d60f                  SUB         0xf
  3328  3733  5f                    LD          E,A
  3329  3734  1a                    LD          A,(DE)
  3330  3735  e607                  AND         0x7
  3331  3737  cdac35                CALL        REDRAW_NORTH
  3332  373a  7b                    LD          A,E
  3333  373b  c61f                  ADD         A,$1f
  3334  373d  5f                    LD          E,A
  3335  373e  cda535                CALL        REDRAW_VIEW
  3336  3741  2c                    INC         L
  3337  3742  77                    LD          (HL),A                   ;= $20
  3338  3743  1c                    INC         E
  3339  3744  1a                    LD          A,(DE)
  3340  3745  e607                  AND         0x7
  3341  3747  cdac35                CALL        REDRAW_NORTH
  3342  374a  7b                    LD          A,E
  3343  374b  d612                  SUB         $12
  3344  374d  5f                    LD          E,A
  3345  374e  cda535                CALL        REDRAW_VIEW
  3346  3751  2c                    INC         L
  3347  3752  77                    LD          (HL),A                   ;= $20
  3348  3753  7b                    LD          A,E
  3349  3754  d60f                  SUB         0xf
  3350  3756  5f                    LD          E,A
  3351  3757  cd9437                CALL        CALC_WEST_REDRAW
  3352  375a  1c                    INC         E
  3353  375b  cda535                CALL        REDRAW_VIEW
  3354  375e  2c                    INC         L
  3355  375f  2c                    INC         L
  3356  3760  77                    LD          (HL),A                    ;= $20
  3357  3761  7b                    LD          A,E
  3358  3762  c61e                  ADD         A,$1e
  3359  3764  5f                    LD          E,A
  3360  3765  cda535                CALL        REDRAW_VIEW
  3361  3768  2c                    INC         L
  3362  3769  77                    LD          (HL),A                    ;= $20
  3363  376a  1c                    INC         E
  3364  376b  cd9437                CALL        CALC_WEST_REDRAW
  3365  376e  7b                    LD          A,E
  3366  376f  c611                  ADD         A,$11
  3367  3771  5f                    LD          E,A
  3368  3772  cda535                CALL        REDRAW_VIEW
  3369  3775  2c                    INC         L
  3370  3776  2c                    INC         L
  3371  3777  77                    LD          (HL),A                    ;= $20
  3372  3778  7b                    LD          A,E
  3373  3779  d622                  SUB         $22
  3374  377b  5f                    LD          E,A
  3375  377c  cd9437                CALL        CALC_WEST_REDRAW
  3376  377f  1601                  LD          D,0x1
  3377  3781  1e10                  LD          E,$10
  3378  3783  ed53603a              LD          (DIR_FACING_FW),DE
  3379  3787  0610                  LD          B,$10                                  ;RED on BLK
  3380  3789  21d831                LD          HL,CHRRAM_POINTER_IDX                   ;WAS $31d6
  3381  378c  119237                LD          DE,EAST_TXT                             ;= $06,$FF
  3382  378f  c30f33                JP          GFX_DRAW
  3383                          EAST_TXT:
  3384  3792  06ff                  db          $06,$FF
  3385                          CALC_WEST_REDRAW:
  3386  3794  1a                    LD          A,(DE)
  3387  3795  e607                  AND         0x7
  3388  3797  2c                    INC         L
  3389  3798  77                    LD          (HL),A
  3390  3799  c9                    RET
  3391                          CALC_WEST_REDRAW_2:
  3392  379a  dd21e837              LD          IX,ITEM_F2                              ;= $60
  3393  379e  ed5b603a              LD          DE,(DIR_FACING_FW)
  3394  37a2  3a793a                LD          A,(PLAYER_MAP_POS)
  3395  37a5  82                    ADD         A,D
  3396  37a6  82                    ADD         A,D
  3397  37a7  cdec37                CALL        ITEM_MAP_CHECK
  3398  37aa  dd7700                LD          (IX+0),A                     ;= $60
  3399  37ad  7c                    LD          A,H
  3400  37ae  92                    SUB         D
  3401  37af  cdec37                CALL        ITEM_MAP_CHECK
  3402  37b2  dd7701                LD          (IX+1),A                     ;= $60
  3403  37b5  7c                    LD          A,H
  3404  37b6  92                    SUB         D
  3405  37b7  cdec37                CALL        ITEM_MAP_CHECK
  3406  37ba  dd7702                LD          (IX+2),A                     ;= $60
  3407  37bd  7c                    LD          A,H
  3408  37be  82                    ADD         A,D
  3409  37bf  93                    SUB         E
  3410  37c0  cdec37                CALL        ITEM_MAP_CHECK
  3411  37c3  dd7703                LD          (IX+3),A                    ;= $60
  3412  37c6  7c                    LD          A,H
  3413  37c7  83                    ADD         A,E
  3414  37c8  83                    ADD         A,E
  3415  37c9  cdec37                CALL        ITEM_MAP_CHECK
  3416  37cc  dd7704                LD          (IX+4),A                    ;= $60
  3417  37cf  7c                    LD          A,H
  3418  37d0  92                    SUB         D
  3419  37d1  cdec37                CALL        ITEM_MAP_CHECK
  3420  37d4  dd7705                LD          (IX+5),A                     ;= $60
  3421  37d7  7c                    LD          A,H
  3422  37d8  93                    SUB         E
  3423  37d9  93                    SUB         E
  3424  37da  cdec37                CALL        ITEM_MAP_CHECK
  3425  37dd  dd7706                LD          (IX+6),A                     ;= $60
  3426  37e0  7c                    LD          A,H
  3427  37e1  92                    SUB         D
  3428  37e2  83                    ADD         A,E
  3429  37e3  cdec37                CALL        ITEM_MAP_CHECK
  3430  37e6  dd7707                LD          (IX+7),A                     ;= $60
  3431                          LAB_ram_f7f0:
  3432  37e9  3efe                  LD          A,$fe
  3433  37eb  c9                    RET
  3434                          ITEM_MAP_CHECK:
  3435  37ec  67                    LD          H,A
  3436  37ed  010039                LD          BC,MAP_LADDER_OFFSET
  3437                          LAB_ram_f7f7:
  3438  37f0  0a                    LD          A,(BC)
  3439  37f1  03                    INC         BC
  3440  37f2  03                    INC         BC
  3441  37f3  3c                    INC         A
  3442  37f4  cae937                JP          Z,LAB_ram_f7f0
  3443  37f7  3d                    DEC         A
  3444  37f8  bc                    CP          H
  3445  37f9  c2f037                JP          NZ,LAB_ram_f7f7
  3446  37fc  0d                    DEC         C
  3447  37fd  0a                    LD          A,(BC)
  3448  37fe  c9                    RET
  3449                          REDRAW_VIEWPORT:
  3450  37ff  cd4910                CALL        DRAW_BKGD
  3451  3802  01e837                LD          BC,ITEM_F2                              ;BC = ITEM_F2
  3452  3805  11e833                LD          DE,WALL_F0_STATE                        ;DE = wallAheadTemp
  3453  3808  1a                    LD          A,(DE)                   ;A = (wallAheadTemp)
  3454  3809  0f                    RRCA
  3455  380a  d22038                JP          NC,F0_NO_HD                             ;Jump if no hidden door
  3456  380d  08                    EX          AF,AF'
  3457  380e  cd4609                CALL        DRAW_F0_WALL
  3458  3811  08                    EX          AF,AF'
  3459  3812  0f                    RRCA
  3460  3813  d28a39                JP          NC,F0_HD_NO_WALL                        ;Jump if no wall
  3461  3816  0f                    RRCA
  3462  3817  d28a39                JP          NC,F0_HD_NO_WALL                        ;Jump if door closed
  3463                          F0_NO_HD_WALL_OPEN:
  3464  381a  cd5f09                CALL        DRAW_WALL_F0_AND_OPEN_DOOR
  3465  381d  c38139                JP          LAB_ram_f986
  3466                          F0_NO_HD:
  3467  3820  0f                    RRCA
  3468  3821  d22e38                JP          NC,F0_NO_HD_NO_WALL                     ;Jump if no wall
  3469  3824  0f                    RRCA
  3470  3825  da1a38                JP          C,F0_NO_HD_WALL_OPEN                    ;Jump if door open
  3471  3828  cd5109                CALL        DRAW_F0_WALL_AND_CLOSED_DOOR
  3472  382b  c38a39                JP          F0_HD_NO_WALL
  3473                          F0_NO_HD_NO_WALL:
  3474  382e  13                    INC         DE
  3475  382f  1a                    LD          A,(DE)                   ;= $20
  3476  3830  0f                    RRCA
  3477  3831  d24738                JP          NC,F1_NO_HD                             ;Jump if no hidden door
  3478  3834  08                    EX          AF,AF'
  3479  3835  cd6709                CALL        DRAW_WALL_F1
  3480  3838  08                    EX          AF,AF'
  3481  3839  0f                    RRCA
  3482  383a  d2bb38                JP          NC,F1_HD_NO_WALL                        ;Jump if no wall
  3483  383d  0f                    RRCA
  3484  383e  d2bb38                JP          NC,F1_HD_NO_WALL                        ;Jump if door closed
  3485                          F1_NO_HD_WALL_OPEN:
  3486  3841  cd8a09                CALL        DRAW_WALL_F1_AND_OPEN_DOOR
  3487  3844  c3b238                JP          LAB_ram_f8b7
  3488                          F1_NO_HD:
  3489  3847  0f                    RRCA
  3490  3848  d25538                JP          NC,LAB_ram_f85a
  3491  384b  0f                    RRCA
  3492  384c  da4138                JP          C,F1_NO_HD_WALL_OPEN
  3493  384f  cd7c09                CALL        DRAW_WALL_F1_AND_CLOSED_DOOR
  3494  3852  c3bb38                JP          F1_HD_NO_WALL
  3495                          LAB_ram_f85a:
  3496  3855  13                    INC         DE
  3497  3856  1a                    LD          A,(DE)                   ;= $20
  3498  3857  0f                    RRCA
  3499  3858  d26138                JP          NC,CHECK_WALL_F2
  3500                          F2_WALL:
  3501  385b  cd9209                CALL        DRAW_WALL_F2
  3502  385e  c36838                JP          LAB_ram_f86d
  3503                          CHECK_WALL_F2:
  3504  3861  0f                    RRCA
  3505  3862  da5b38                JP          C,F2_WALL
  3506  3865  cd9d09                CALL        DRAW_DOOR_F2_OPEN
  3507                          LAB_ram_f86d:
  3508  3868  11eb33                LD          DE,WALL_F3_STATE                        ;= $20
  3509  386b  1a                    LD          A,(DE)                   ;= $20
  3510  386c  0f                    RRCA
  3511  386d  d27638                JP          NC,LAB_ram_f87b
  3512                          LAB_ram_f875:
  3513  3870  cd420b                CALL        DRAW_WALL_FL2_EMPTY
  3514  3873  c38d38                JP          LAB_ram_f892
  3515                          LAB_ram_f87b:
  3516  3876  0f                    RRCA
  3517  3877  da7038                JP          C,LAB_ram_f875
  3518  387a  13                    INC         DE
  3519  387b  1a                    LD          A,(DE)                    ;= $20
  3520  387c  0f                    RRCA
  3521  387d  d28638                JP          NC,LAB_ram_f88b
  3522                          LAB_ram_f885:
  3523  3880  cd8d0b                CALL        DRAW_WALL_L2_C
  3524  3883  c38d38                JP          LAB_ram_f892
  3525                          LAB_ram_f88b:
  3526  3886  0f                    RRCA
  3527  3887  da8038                JP          C,LAB_ram_f885
  3528  388a  cd980b                CALL        DRAW_WALL_L2_C_EMPTY
  3529                          LAB_ram_f892:
  3530  388d  11ed33                LD          DE,DAT_ram_33ed                         ;= $20
  3531  3890  1a                    LD          A,(DE)                    ;= $20
  3532  3891  0f                    RRCA
  3533  3892  d29b38                JP          NC,LAB_ram_f8a0
  3534                          LAB_ram_f89a:
  3535  3895  cd3b0d                CALL        DRAW_WALL_FR2
  3536  3898  c3b238                JP          LAB_ram_f8b7
  3537                          LAB_ram_f8a0:
  3538  389b  0f                    RRCA
  3539  389c  da9538                JP          C,LAB_ram_f89a
  3540  389f  13                    INC         DE
  3541  38a0  1a                    LD          A,(DE)                    ;= $20
  3542  38a1  0f                    RRCA
  3543  38a2  d2ab38                JP          NC,LAB_ram_f8b0
  3544                          LAB_ram_f8aa:
  3545  38a5  cd790d                CALL        SUB_ram_cd21
  3546  38a8  c3b238                JP          LAB_ram_f8b7
  3547                          LAB_ram_f8b0:
  3548  38ab  0f                    RRCA
  3549  38ac  daa538                JP          C,LAB_ram_f8aa
  3550  38af  cd840d                CALL        SUB_ram_cd2c
  3551                          LAB_ram_f8b7:
  3552  38b2  3ae837                LD          A,(ITEM_F2)                             ;= $60
  3553  38b5  018a04                LD          BC,$48a
  3554  38b8  cd3a2c                CALL        CHK_ITEM
  3555                          F1_HD_NO_WALL:
  3556  38bb  11ef33                LD          DE,DAT_ram_33ef                         ;= $20
  3557  38be  1a                    LD          A,(DE)                    ;= $20
  3558  38bf  0f                    RRCA
  3559  38c0  d2d638                JP          NC,LAB_ram_f8db
  3560  38c3  08                    EX          AF,AF'
  3561  38c4  cd920a                CALL        DRAW_L1_WALL
  3562  38c7  08                    EX          AF,AF'
  3563  38c8  0f                    RRCA
  3564  38c9  d21e39                JP          NC,LAB_ram_f923
  3565  38cc  0f                    RRCA
  3566  38cd  d21e39                JP          NC,LAB_ram_f923
  3567                          LAB_ram_f8d5:
  3568  38d0  cdd50a                CALL        DRAW_FL1_DOOR
  3569  38d3  c31e39                JP          LAB_ram_f923
  3570                          LAB_ram_f8db:
  3571  38d6  0f                    RRCA
  3572  38d7  d2e438                JP          NC,LAB_ram_f8e9
  3573  38da  0f                    RRCA
  3574  38db  dad038                JP          C,LAB_ram_f8d5
  3575  38de  cde30a                CALL        DRAW_L1
  3576  38e1  c31e39                JP          LAB_ram_f923
  3577                          LAB_ram_f8e9:
  3578  38e4  1c                    INC         E
  3579  38e5  1a                    LD          A,(DE)                    ;= $20
  3580  38e6  0f                    RRCA
  3581  38e7  d2fd38                JP          NC,LAB_ram_f902
  3582  38ea  08                    EX          AF,AF'
  3583  38eb  cd030b                CALL        SUB_ram_cab0
  3584  38ee  08                    EX          AF,AF'
  3585  38ef  0f                    RRCA
  3586  38f0  d21e39                JP          NC,LAB_ram_f923
  3587  38f3  0f                    RRCA
  3588  38f4  d21e39                JP          NC,LAB_ram_f923
  3589                          LAB_ram_f8fc:
  3590  38f7  cd180b                CALL        SUB_ram_cac5
  3591  38fa  c31e39                JP          LAB_ram_f923
  3592                          LAB_ram_f902:
  3593  38fd  0f                    RRCA
  3594  38fe  d20b39                JP          NC,LAB_ram_f910
  3595  3901  0f                    RRCA
  3596  3902  daf738                JP          C,LAB_ram_f8fc
  3597  3905  cd1f0b                CALL        DRAW_L1_DOOR_CLOSED
  3598  3908  c31e39                JP          LAB_ram_f923
  3599                          LAB_ram_f910:
  3600  390b  1c                    INC         E
  3601  390c  1a                    LD          A,(DE)                    ;= $20
  3602  390d  0f                    RRCA
  3603  390e  d21739                JP          NC,LAB_ram_f91c
  3604                          LAB_ram_f916:
  3605  3911  cd5312                CALL        DRAW_WALL_FL2_NEW
  3606  3914  c31e39                JP          LAB_ram_f923
  3607                          LAB_ram_f91c:
  3608  3917  0f                    RRCA
  3609  3918  da1139                JP          C,LAB_ram_f916
  3610  391b  cd420b                CALL        DRAW_WALL_FL2_EMPTY
  3611                          LAB_ram_f923:
  3612  391e  11f233                LD          DE,DAT_ram_33f2                         ;= $20
  3613  3921  1a                    LD          A,(DE)                    ;= $20
  3614  3922  0f                    RRCA
  3615  3923  d23939                JP          NC,LAB_ram_f93e
  3616  3926  08                    EX          AF,AF'
  3617  3927  cd810c                CALL        DRAW_WALL_FR1
  3618  392a  08                    EX          AF,AF'
  3619  392b  0f                    RRCA
  3620  392c  d28139                JP          NC,LAB_ram_f986
  3621  392f  0f                    RRCA
  3622  3930  d28139                JP          NC,LAB_ram_f986
  3623                          LAB_ram_f938:
  3624  3933  cdc30c                CALL        SUB_ram_cc6d
  3625  3936  c38139                JP          LAB_ram_f986
  3626                          LAB_ram_f93e:
  3627  3939  0f                    RRCA
  3628  393a  d24739                JP          NC,LAB_ram_f94c
  3629  393d  0f                    RRCA
  3630  393e  da3339                JP          C,LAB_ram_f938
  3631  3941  cdd10c                CALL        SUB_ram_cc7a
  3632  3944  c38139                JP          LAB_ram_f986
  3633                          LAB_ram_f94c:
  3634  3947  1c                    INC         E
  3635  3948  1a                    LD          A,(DE)                    ;= $20
  3636  3949  0f                    RRCA
  3637  394a  d26039                JP          NC,LAB_ram_f965
  3638  394d  08                    EX          AF,AF'
  3639  394e  cdf10c                CALL        SUB_ram_cc9a
  3640  3951  08                    EX          AF,AF'
  3641  3952  0f                    RRCA
  3642  3953  d28139                JP          NC,LAB_ram_f986
  3643  3956  0f                    RRCA
  3644  3957  d28139                JP          NC,LAB_ram_f986
  3645                          LAB_ram_f95f:
  3646  395a  cd060d                CALL        SUB_ram_ccaf
  3647  395d  c38139                JP          LAB_ram_f986
  3648                          LAB_ram_f965:
  3649  3960  0f                    RRCA
  3650  3961  d26e39                JP          NC,LAB_ram_f973
  3651  3964  0f                    RRCA
  3652  3965  da5a39                JP          C,LAB_ram_f95f
  3653  3968  cd0d0d                CALL        SUB_ram_ccb5
  3654  396b  c38139                JP          LAB_ram_f986
  3655                          LAB_ram_f973:
  3656  396e  1c                    INC         E
  3657  396f  1a                    LD          A,(DE)                    ;= $20
  3658  3970  0f                    RRCA
  3659  3971  d27a39                JP          NC,LAB_ram_f97f
  3660                          LAB_ram_f979:
  3661  3974  cd1b0d                CALL        SUB_ram_ccc3
  3662  3977  c38139                JP          LAB_ram_f986
  3663                          LAB_ram_f97f:
  3664  397a  0f                    RRCA
  3665  397b  da7439                JP          C,LAB_ram_f979
  3666  397e  cd300d                CALL        DRAW_WALL_FR2_EMPTY
  3667                          LAB_ram_f986:
  3668  3981  3ae937                LD          A,(ITEM_F1)                             ;= $60
  3669  3984  018a02                LD          BC,$28a
  3670  3987  cd3a2c                CALL        CHK_ITEM
  3671                          F0_HD_NO_WALL:
  3672  398a  11f533                LD          DE,DAT_ram_33f5                         ;= $20
  3673  398d  1a                    LD          A,(DE)                    ;= $20
  3674  398e  0f                    RRCA
  3675  398f  d2a539                JP          NC,LAB_ram_f9aa
  3676  3992  08                    EX          AF,AF'
  3677  3993  cda809                CALL        DRAW_WALL_FL0
  3678  3996  08                    EX          AF,AF'
  3679  3997  0f                    RRCA
  3680  3998  d2143a                JP          NC,LAB_ram_fa19
  3681  399b  0f                    RRCA
  3682  399c  d2143a                JP          NC,LAB_ram_fa19
  3683                          LAB_ram_f9a4:
  3684  399f  cddc09                CALL        DRAW_DOOR_FLO
  3685  39a2  c3143a                JP          LAB_ram_fa19
  3686                          LAB_ram_f9aa:
  3687  39a5  0f                    RRCA
  3688  39a6  d2b339                JP          NC,LAB_ram_f9b8
  3689  39a9  0f                    RRCA
  3690  39aa  da9f39                JP          C,LAB_ram_f9a4
  3691  39ad  cde709                CALL        SUB_ram_c996
  3692  39b0  c3143a                JP          LAB_ram_fa19
  3693                          LAB_ram_f9b8:
  3694  39b3  1c                    INC         E
  3695  39b4  1a                    LD          A,(DE)                    ;= $20
  3696  39b5  0f                    RRCA
  3697  39b6  d2bf39                JP          NC,LAB_ram_f9c4
  3698                          LAB_ram_f9be:
  3699  39b9  cd160a                CALL        SUB_ram_c9c5
  3700  39bc  c3143a                JP          LAB_ram_fa19
  3701                          LAB_ram_f9c4:
  3702  39bf  0f                    RRCA
  3703  39c0  dab939                JP          C,LAB_ram_f9be
  3704  39c3  1c                    INC         E
  3705  39c4  1a                    LD          A,(DE)                    ;= $20
  3706  39c5  0f                    RRCA
  3707  39c6  d2eb39                JP          NC,LAB_ram_f9f0
  3708  39c9  08                    EX          AF,AF'
  3709  39ca  cd210a                CALL        SUB_ram_c9d0
  3710  39cd  cde239                CALL        SUB_ram_f9e7
  3711  39d0  08                    EX          AF,AF'
  3712  39d1  0f                    RRCA
  3713  39d2  d2143a                JP          NC,LAB_ram_fa19
  3714  39d5  0f                    RRCA
  3715  39d6  d2143a                JP          NC,LAB_ram_fa19
  3716                          LAB_ram_f9de:
  3717  39d9  cd440a                CALL        SUB_ram_c9f3
  3718  39dc  cde239                CALL        SUB_ram_f9e7
  3719  39df  c3143a                JP          LAB_ram_fa19
  3720                          SUB_ram_f9e7:
  3721  39e2  3aeb37                LD          A,(ITEM_FL1)                            ;= $60
  3722  39e5  01d004                LD          BC,$4d0
  3723  39e8  c33a2c                JP          CHK_ITEM
  3724                          LAB_ram_f9f0:
  3725  39eb  0f                    RRCA
  3726  39ec  d2fc39                JP          NC,LAB_ram_fa01
  3727  39ef  0f                    RRCA
  3728  39f0  dad939                JP          C,LAB_ram_f9de
  3729  39f3  cd360a                CALL        SUB_ram_c9e5
  3730  39f6  cde239                CALL        SUB_ram_f9e7
  3731  39f9  c3143a                JP          LAB_ram_fa19
  3732                          LAB_ram_fa01:
  3733  39fc  1c                    INC         E
  3734  39fd  0f                    RRCA
  3735  39fe  d20a3a                JP          NC,LAB_ram_fa0f
  3736                          LAB_ram_fa06:
  3737  3a01  cd4b0a                CALL        SUB_ram_c9f9
  3738  3a04  cde239                CALL        SUB_ram_f9e7
  3739  3a07  c3143a                JP          LAB_ram_fa19
  3740                          LAB_ram_fa0f:
  3741  3a0a  0f                    RRCA
  3742  3a0b  da013a                JP          C,LAB_ram_fa06
  3743  3a0e  cd3d12                CALL        DRAW_WALL_FL22_EMPTY
  3744  3a11  cde239                CALL        SUB_ram_f9e7
  3745                          LAB_ram_fa19:
  3746  3a14  11f933                LD          DE,DAT_ram_33f9                         ;= $20
  3747  3a17  1a                    LD          A,(DE)                    ;= $20
  3748  3a18  0f                    RRCA
  3749  3a19  d22f3a                JP          NC,LAB_ram_fa34
  3750  3a1c  08                    EX          AF,AF'
  3751  3a1d  cda30b                CALL        SUB_ram_cb4f
  3752  3a20  08                    EX          AF,AF'
  3753  3a21  0f                    RRCA
  3754  3a22  d29e3a                JP          NC,LAB_ram_faa3
  3755  3a25  0f                    RRCA
  3756  3a26  d29e3a                JP          NC,LAB_ram_faa3
  3757                          LAB_ram_fa2e:
  3758  3a29  cdc80b                CALL        DRAW_FRO_DOOR
  3759  3a2c  c39e3a                JP          LAB_ram_faa3
  3760                          LAB_ram_fa34:
  3761  3a2f  0f                    RRCA
  3762  3a30  d23d3a                JP          NC,LAB_ram_fa42
  3763  3a33  0f                    RRCA
  3764  3a34  da293a                JP          C,LAB_ram_fa2e
  3765  3a37  cdd30b                CALL        SUB_ram_cb7e
  3766  3a3a  c39e3a                JP          LAB_ram_faa3
  3767                          LAB_ram_fa42:
  3768  3a3d  1c                    INC         E
  3769  3a3e  1a                    LD          A,(DE)                    ;= $20
  3770  3a3f  0f                    RRCA
  3771  3a40  d2523a                JP          NC,LAB_ram_fa57
  3772                          LAB_ram_fa48:
  3773  3a43  cd030c                CALL        SUB_ram_cbae
  3774  3a46  c39e3a                JP          LAB_ram_faa3
  3775                          SUB_ram_fa4e:
  3776  3a49  3aec37                LD          A,(ITEM_FR1)                            ;= $60
  3777  3a4c  01e404                LD          BC,$4e4
  3778  3a4f  c33a2c                JP          CHK_ITEM
  3779                          LAB_ram_fa57:
  3780  3a52  0f                    RRCA
  3781  3a53  da433a                JP          C,LAB_ram_fa48
  3782  3a56  1c                    INC         E
  3783  3a57  1a                    LD          A,(DE)                    ;= $20
  3784  3a58  0f                    RRCA
  3785  3a59  d2753a                JP          NC,LAB_ram_fa7a
  3786  3a5c  08                    EX          AF,AF'
  3787  3a5d  cd0e0c                CALL        SUB_ram_cbb9
  3788  3a60  cd493a                CALL        SUB_ram_fa4e
  3789  3a63  08                    EX          AF,AF'
  3790  3a64  0f                    RRCA
  3791  3a65  d29e3a                JP          NC,LAB_ram_faa3
  3792  3a68  0f                    RRCA
  3793  3a69  d29e3a                JP          NC,LAB_ram_faa3
  3794                          LAB_ram_fa71:
  3795  3a6c  cd230c                CALL        SUB_ram_cbce
  3796  3a6f  cd493a                CALL        SUB_ram_fa4e
  3797  3a72  c39e3a                JP          LAB_ram_faa3
  3798                          LAB_ram_fa7a:
  3799  3a75  0f                    RRCA
  3800  3a76  d2863a                JP          NC,LAB_ram_fa8b
  3801  3a79  0f                    RRCA
  3802  3a7a  da6c3a                JP          C,LAB_ram_fa71
  3803  3a7d  cd2a0c                CALL        SUB_ram_cbd4
  3804  3a80  cd493a                CALL        SUB_ram_fa4e
  3805  3a83  c39e3a                JP          LAB_ram_faa3
  3806                          LAB_ram_fa8b:
  3807  3a86  1c                    INC         E
  3808  3a87  0f                    RRCA
  3809  3a88  d2943a                JP          NC,LAB_ram_fa99
  3810                          LAB_ram_fa90:
  3811  3a8b  cd380c                CALL        SUB_ram_cbe2
  3812  3a8e  cd493a                CALL        SUB_ram_fa4e
  3813  3a91  c39e3a                JP          LAB_ram_faa3
  3814                          LAB_ram_fa99:
  3815  3a94  0f                    RRCA
  3816  3a95  da8b3a                JP          C,LAB_ram_fa90
  3817  3a98  cd760c                CALL        DRAW_WALL_FR222_EMPTY
  3818  3a9b  cd493a                CALL        SUB_ram_fa4e
  3819                          LAB_ram_faa3:
  3820  3a9e  3aea37                LD          A,(ITEM_F0)                             ;= $60
  3821  3aa1  018a00                LD          BC,$8a
  3822  3aa4  c33a2c                JP          CHK_ITEM
  3823                          MAKE_RANDOM_BYTE:
  3824  3aa7  c5                    PUSH        BC
  3825  3aa8  e5                    PUSH        HL
  3826  3aa9  0605                  LD          B,0x5                                   ;Run data randomizer 5x
  3827  3aab  2a913a                LD          HL,(RNDHOLD_AA)
  3828                          RANDOM_BYTE_LOOP:
  3829  3aae  cb25                  SLA         L                                       ;L x 2
  3830  3ab0  cb14                  RL          H
  3831  3ab2  dabd3a                JP          C,FINISH_BYTE_LOOP
  3832  3ab5  3e87                  LD          A,$87
  3833  3ab7  ad                    XOR         L
  3834  3ab8  6f                    LD          L,A
  3835  3ab9  3e1d                  LD          A,$1d
  3836  3abb  ac                    XOR         H
  3837  3abc  67                    LD          H,A
  3838                          FINISH_BYTE_LOOP:
  3839  3abd  10ef                  DJNZ        RANDOM_BYTE_LOOP
  3840  3abf  22913a                LD          (RNDHOLD_AA),HL
  3841  3ac2  7c                    LD          A,H
  3842  3ac3  e1                    POP         HL
  3843  3ac4  c1                    POP         BC
  3844  3ac5  c9                    RET
  3845                          UPDATE_SCR_SAVER_TIMER:
  3846  3ac6  c5                    PUSH        BC
  3847  3ac7  e5                    PUSH        HL
  3848  3ac8  2a9c3a                LD          HL,(TIMER_E)
  3849  3acb  44                    LD          B,H
  3850  3acc  4d                    LD          C,L
  3851  3acd  cb21                  SLA         C
  3852  3acf  cb10                  RL          B
  3853  3ad1  cb21                  SLA         C
  3854  3ad3  cb10                  RL          B
  3855  3ad5  09                    ADD         HL,BC
  3856  3ad6  7c                    LD          A,H
  3857  3ad7  ad                    XOR         L
  3858  3ad8  32883a                LD          (TIMER_D),A
  3859  3adb  44                    LD          B,H
  3860  3adc  4d                    LD          C,L
  3861  3add  cb21                  SLA         C
  3862  3adf  cb10                  RL          B
  3863  3ae1  cb21                  SLA         C
  3864  3ae3  cb10                  RL          B
  3865  3ae5  09                    ADD         HL,BC
  3866  3ae6  011300                LD          BC,$13
  3867  3ae9  09                    ADD         HL,BC
  3868  3aea  229c3a                LD          (TIMER_E),HL
  3869  3aed  e1                    POP         HL
  3870  3aee  c1                    POP         BC
  3871  3aef  c9                    RET
  3872                          MINOTAUR_DEAD:
  3873  3af0  cd4910                CALL        DRAW_BKGD
  3874  3af3  215030                LD          HL,DAT_ram_3050                         ;= $20
  3875  3af6  11a408                LD          DE,THE_END_PART_A                       ;WAS LD DE, 0xC25D
  3876  3af9  0610                  LD          B,$10                                  ;RED on BLK
  3877  3afb  cd0f33                CALL        GFX_DRAW
  3878  3afe  21a030                LD          HL,DAT_ram_30a0                         ;= $20
  3879  3b01  cd0f33                CALL        GFX_DRAW
  3880  3b04  cda73a                CALL        MAKE_RANDOM_BYTE
  3881  3b07  e603                  AND         0x3
  3882  3b09  c60a                  ADD         A,0xa
  3883  3b0b  47                    LD          B,A
  3884  3b0c  3a6c3a                LD          A,(INPUT_HOLDER)
  3885  3b0f  07                    RLCA
  3886  3b10  07                    RLCA
  3887  3b11  07                    RLCA
  3888  3b12  07                    RLCA
  3889  3b13  47                    LD          B,A
  3890  3b14  af                    XOR         A
  3891  3b15  326c3a                LD          (INPUT_HOLDER),A
  3892  3b18  110f07                LD          DE,MINOTAUR                             ;= $04,$04,$04,$04
  3893  3b1b  21da32                LD          HL,DAT_ram_32da                         ;= $20
  3894  3b1e  cd0f33                CALL        GFX_DRAW
  3895  3b21  cd582e                CALL        TOTAL_HEAL
  3896  3b24  cdde3c                CALL        REDRAW_STATS
  3897  3b27  0602                  LD          B,0x2                                   ;Was LD B,0x6
  3898                          MINOTAUR_DEAD_SOUND_LOOP:
  3899  3b29  d9                    EXX
  3900  3b2a  cdb70d                CALL        SUB_ram_cd5f
  3901  3b2d  cdd40d                CALL        END_OF_GAME_SOUND
  3902  3b30  d9                    EXX
  3903  3b31  10f6                  DJNZ        MINOTAUR_DEAD_SOUND_LOOP
  3904  3b33  c3222a                JP          SCREEN_SAVER_FULL_SCREEN
  3905                          DO_REST:
  3906  3b36  3a783a                LD          A,(LAST_ITEM_HELD)                   ;Load food inventory into A
  3907  3b39  a7                    AND         A
  3908  3b3a  c2a621                JP          NZ,NO_ACTION_TAKEN                      ;If food is empty, do nothing
  3909                          CHK_NEEDS_HEALING:
  3910  3b3d  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)             ;HL = max PHYS health
  3911  3b40  ed5b933a              LD          DE,(PLAYER_PHYS_HEALTH)                 ;DE = current PHYS health
  3912  3b44  cd7c23                CALL        RECALC_PHYS_HEALTH
  3913  3b47  b5                    OR          L
  3914  3b48  c2593b                JP          NZ,HEAL_PLAYER_PHYS_HEALTH
  3915  3b4b  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
  3916  3b4e  4f                    LD          C,A
  3917  3b4f  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  3918  3b52  b9                    CP          C
  3919  3b53  ca0a2a                JP          Z,INPUT_DEBOUNCE
  3920  3b56  c3833b                JP          HEAL_PLAYER_SPRT_HEALTH
  3921                          HEAL_PLAYER_PHYS_HEALTH:
  3922  3b59  2aa93a                LD          HL,(BYTE_ram_3aa9)
  3923  3b5c  110100                LD          DE,0x1
  3924  3b5f  cd7c23                CALL        RECALC_PHYS_HEALTH
  3925  3b62  da0a2a                JP          C,INPUT_DEBOUNCE
  3926  3b65  22a93a                LD          (BYTE_ram_3aa9),HL
  3927  3b68  21ab3a                LD          HL,FOOD_INV
  3928  3b6b  35                    DEC         (HL)
  3929  3b6c  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
  3930  3b6f  cd7323                CALL        SUB_ram_e427
  3931  3b72  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  3932  3b75  cdde3c                CALL        REDRAW_STATS
  3933  3b78  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
  3934  3b7b  4f                    LD          C,A
  3935  3b7c  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  3936  3b7f  b9                    CP          C
  3937  3b80  ca3d3b                JP          Z,CHK_NEEDS_HEALING
  3938                          HEAL_PLAYER_SPRT_HEALTH:
  3939  3b83  2aa93a                LD          HL,(BYTE_ram_3aa9)
  3940  3b86  110100                LD          DE,0x1
  3941  3b89  cd7c23                CALL        RECALC_PHYS_HEALTH
  3942  3b8c  da0a2a                JP          C,INPUT_DEBOUNCE
  3943  3b8f  22a93a                LD          (BYTE_ram_3aa9),HL
  3944  3b92  21ab3a                LD          HL,FOOD_INV
  3945  3b95  35                    DEC         (HL)
  3946  3b96  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  3947  3b99  c601                  ADD         A,0x1
  3948  3b9b  27                    DAA
  3949  3b9c  32973a                LD          (PLAYER_SPRT_HEALTH),A
  3950  3b9f  cdde3c                CALL        REDRAW_STATS
  3951  3ba2  c33d3b                JP          CHK_NEEDS_HEALING
  3952                          KEY_COMPARE:
  3953  3ba5  3a663a                LD          A,(RAM_AE)
  3954  3ba8  fe31                  CP          $31                                    ;Compare to "1" db?
  3955  3baa  c20d2a                JP          NZ,WAIT_FOR_INPUT
  3956                          KEY_COL_0:
  3957  3bad  21f637                LD          HL,KEY_INPUT_COL0                       ;= $60
  3958  3bb0  7e                    LD          A,(HL)                  ;A = Key Column 0
  3959  3bb1  fefe                  CP          $fe                                    ;If Key Row = 0 "="
  3960  3bb3  caa621                JP          Z,NO_ACTION_TAKEN
  3961  3bb6  fefd                  CP          $fd                                    ;If Key Row = 1 "BKSP"
  3962  3bb8  caa621                JP          Z,NO_ACTION_TAKEN
  3963  3bbb  fefb                  CP          $fb                                    ;If Key Row = 2 ":"
  3964  3bbd  caa621                JP          Z,NO_ACTION_TAKEN
  3965  3bc0  fef7                  CP          $f7                                    ;If Key Row = 3 "RET"
  3966  3bc2  caa621                JP          Z,NO_ACTION_TAKEN
  3967  3bc5  feef                  CP          $ef                                    ;If Key Row = 4 ";"
  3968  3bc7  cacc2d                JP          Z,DO_GLANCE_RIGHT
  3969  3bca  fedf                  CP          $df                                    ;If Key Row = 5 "."
  3970  3bcc  cab22d                JP          Z,DO_TURN_RIGHT
  3971                          KEY_COL_1:
  3972  3bcf  2c                    INC         L
  3973  3bd0  7e                    LD          A,(HL)                  ;A = Key Column 1
  3974  3bd1  fefe                  CP          $fe                                    ;If Key Row = 0 "-"
  3975  3bd3  caa621                JP          Z,NO_ACTION_TAKEN
  3976  3bd6  fefd                  CP          $fd                                    ;If Key Row = 1 "/"
  3977  3bd8  caa621                JP          Z,NO_ACTION_TAKEN
  3978  3bdb  fefb                  CP          $fb                                    ;If Key Row = 2 "0"
  3979  3bdd  caa621                JP          Z,NO_ACTION_TAKEN
  3980  3be0  fef7                  CP          $f7                                    ;If Key Row = 3 "P"
  3981  3be2  caa621                JP          Z,NO_ACTION_TAKEN
  3982  3be5  feef                  CP          $ef                                    ;If Key Row = 4 "L"
  3983  3be7  ca1221                JP          Z,DO_MOVE_FW_CHK_WALLS
  3984  3bea  fedf                  CP          $df                                    ;If Key Row = 5 ","
  3985  3bec  ca4421                JP          Z,DO_JUMP_BACK
  3986                          KEY_COL_2:
  3987  3bef  2c                    INC         L
  3988  3bf0  7e                    LD          A,(HL)                  ;A = Key Column 2
  3989  3bf1  fefe                  CP          $fe                                    ;If Key Row = 0 "9"
  3990  3bf3  caa621                JP          Z,NO_ACTION_TAKEN
  3991  3bf6  fefd                  CP          $fd                                    ;If Key Row = 1 "O"
  3992  3bf8  caa621                JP          Z,NO_ACTION_TAKEN
  3993  3bfb  fefb                  CP          $fb                                    ;If Key Row = 2 "K"
  3994  3bfd  ca1221                JP          Z,DO_MOVE_FW_CHK_WALLS
  3995  3c00  fef7                  CP          $f7                                    ;If Key Row = 3 "M"
  3996  3c02  ca9a2d                JP          Z,DO_TURN_LEFT
  3997  3c05  feef                  CP          $ef                                    ;If Key Row = 4 "N"
  3998  3c07  caf82d                JP          Z,DO_USE_ATTACK
  3999  3c0a  fedf                  CP          $df                                    ;If Key Row = 5 "J"
  4000  3c0c  cae22d                JP          Z,DO_GLANCE_LEFT
  4001                          KEY_COL_3:
  4002  3c0f  2c                    INC         L
  4003  3c10  7e                    LD          A,(HL)                  ;A = Key Column 3
  4004  3c11  fefe                  CP          $fe                                    ;If Key Row = 0 "8"
  4005  3c13  caa621                JP          Z,NO_ACTION_TAKEN
  4006  3c16  fefd                  CP          $fd                                    ;If Key Row = 1 "I"
  4007  3c18  caa621                JP          Z,NO_ACTION_TAKEN
  4008  3c1b  fefb                  CP          $fb                                    ;If Key Row = 2 "7"
  4009  3c1d  caa621                JP          Z,NO_ACTION_TAKEN
  4010  3c20  fef7                  CP          $f7                                    ;If Key Row = 3 "U"
  4011  3c22  caa621                JP          Z,NO_ACTION_TAKEN
  4012  3c25  feef                  CP          $ef                                    ;If Key Row = 4 "H"
  4013  3c27  ca692c                JP          Z,DO_OPEN_CLOSE
  4014  3c2a  fedf                  CP          $df                                    ;If Key Row = 5 "B"
  4015  3c2c  caa621                JP          Z,NO_ACTION_TAKEN
  4016                          KEY_COL_4:
  4017  3c2f  2c                    INC         L
  4018  3c30  7e                    LD          A,(HL)                  ;A = Key Column 4
  4019  3c31  fefe                  CP          $fe                                    ;If Key Row = 0 "6"
  4020  3c33  caa621                JP          Z,NO_ACTION_TAKEN
  4021  3c36  fefd                  CP          $fd                                    ;If Key Row = 1 "Y"
  4022  3c38  cac321                JP          Z,USE_MAP
  4023  3c3b  fefb                  CP          $fb                                    ;If Key Row = 2 "G"
  4024  3c3d  caa621                JP          Z,NO_ACTION_TAKEN
  4025  3c40  fef7                  CP          $f7                                    ;If Key Row = 3 "V"
  4026  3c42  caa621                JP          Z,NO_ACTION_TAKEN
  4027  3c45  feef                  CP          $ef                                    ;If Key Row = 4 "C"
  4028  3c47  caa021                JP          Z,DO_COUNT_ARROWS
  4029  3c4a  fedf                  CP          $df                                    ;If Key Row = 5 "F"
  4030  3c4c  ca363b                JP          Z,DO_REST
  4031                          KEY_COL_5:
  4032  3c4f  2c                    INC         L
  4033  3c50  7e                    LD          A,(HL)                  ;A = Key Column 5
  4034  3c51  fefe                  CP          $fe                                    ;If Key Row = 0 "5"
  4035  3c53  caa621                JP          Z,NO_ACTION_TAKEN
  4036  3c56  fefd                  CP          $fd                                    ;If Key Row = 1 "T"
  4037  3c58  cad23c                JP          Z,DO_TELEPORT
  4038  3c5b  fefb                  CP          $fb                                    ;If Key Row = 2 "4"
  4039  3c5d  caa621                JP          Z,NO_ACTION_TAKEN
  4040  3c60  fef7                  CP          $f7                                    ;If Key Row = 3 "R"
  4041  3c62  cad629                JP          Z,DO_SWAP_PACK
  4042  3c65  feef                  CP          $ef                                    ;If Key Row = 4 "D"
  4043  3c67  ca7932                JP          Z,DO_USE_LADDER
  4044  3c6a  fedf                  CP          $df                                    ;If Key Row = 5 "X"
  4045  3c6c  ca8821                JP          Z,DO_COUNT_FOOD
  4046                          KEY_COL_6:
  4047  3c6f  2c                    INC         L
  4048  3c70  7e                    LD          A,(HL)                  ;A = Key Column 6
  4049  3c71  fefe                  CP          $fe                                    ;If Key Row = 0 "3"
  4050  3c73  caa621                JP          Z,NO_ACTION_TAKEN
  4051  3c76  fefd                  CP          $fd                                    ;If Key Row = 1 "E"
  4052  3c78  ca1726                JP          Z,DO_SWAP_HANDS
  4053  3c7b  fefb                  CP          $fb                                    ;If Key Row = 2 "S"
  4054  3c7d  ca6629                JP          Z,DO_ROTATE_PACK
  4055  3c80  fef7                  CP          $f7                                    ;If Key Row = 3 "Z"
  4056  3c82  ca2512                JP          Z,WIPE_WALLS
  4057  3c85  feef                  CP          $ef                                    ;If Key Row = 4 "SPC"
  4058  3c87  caa621                JP          Z,NO_ACTION_TAKEN
  4059  3c8a  fedf                  CP          $df                                    ;If Key Row = 5 "A"
  4060  3c8c  caa621                JP          Z,NO_ACTION_TAKEN
  4061                          KEY_COL_7:
  4062  3c8f  2c                    INC         L
  4063  3c90  7e                    LD          A,(HL)                  ;A = Key Column 7
  4064  3c91  fefe                  CP          $fe                                    ;If Key Row = 0 "2"
  4065  3c93  caa621                JP          Z,NO_ACTION_TAKEN
  4066  3c96  fefd                  CP          $fd                                    ;If Key Row = 1 "W"
  4067  3c98  ca2827                JP          Z,DO_PICK_UP
  4068  3c9b  fefb                  CP          $fb                                    ;If Key Row = 2 "1"
  4069  3c9d  caa621                JP          Z,NO_ACTION_TAKEN
  4070  3ca0  fef7                  CP          $f7                                    ;If Key Row = 3 "Q"
  4071  3ca2  cab33c                JP          Z,MAX_HEALTH_ARROWS_FOOD
  4072  3ca5  feef                  CP          $ef                                    ;If Key Row = 4 "SHFT"
  4073  3ca7  caa621                JP          Z,NO_ACTION_TAKEN
  4074  3caa  fedf                  CP          $df                                    ;If Key Row = 5 "CTRL"
  4075  3cac  caa621                JP          Z,NO_ACTION_TAKEN
  4076  3caf  c3a621                JP          NO_ACTION_TAKEN
  4077  3cb2  00                    NOP
  4078                          MAX_HEALTH_ARROWS_FOOD:
  4079  3cb3  21933a                LD          HL,PLAYER_PHYS_HEALTH
  4080  3cb6  3e99                  LD          A,$99
  4081  3cb8  77                    LD          (HL),A
  4082  3cb9  23                    INC         HL
  4083  3cba  77                    LD          (HL),A
  4084  3cbb  23                    INC         HL
  4085  3cbc  77                    LD          (HL),A
  4086  3cbd  23                    INC         HL
  4087  3cbe  77                    LD          (HL),A
  4088  3cbf  23                    INC         HL
  4089  3cc0  77                    LD          (HL),A
  4090  3cc1  23                    INC         HL
  4091  3cc2  77                    LD          (HL),A
  4092  3cc3  21ab3a                LD          HL,FOOD_INV
  4093  3cc6  77                    LD          (HL),A
  4094  3cc7  23                    INC         HL
  4095  3cc8  77                    LD          (HL),A
  4096  3cc9  cd583d                CALL        PLAY_POWER_UP_SOUND
  4097  3ccc  cdde3c                CALL        REDRAW_STATS
  4098  3ccf  c30a2a                JP          INPUT_DEBOUNCE
  4099                          DO_TELEPORT:
  4100  3cd2  3a0039                LD          A,(MAP_LADDER_OFFSET)
  4101  3cd5  32793a                LD          (PLAYER_MAP_POS),A
  4102  3cd8  cd333d                CALL        PLAY_TELEPORT_SOUND
  4103  3cdb  c3042a                JP          UPDATE_VIEWPORT
  4104                          REDRAW_STATS:
  4105  3cde  cdd811                CALL        DRAW_ICON_BAR
  4106  3ce1  21933a                LD          HL,PLAYER_PHYS_HEALTH
  4107  3ce4  114130                LD          DE,CHRRAM_PHYS_HEALTH_1000              ;= $20
  4108  3ce7  0602                  LD          B,0x2
  4109  3ce9  cdd532                CALL        RECALC_AND_REDRAW_BCD
  4110  3cec  21973a                LD          HL,PLAYER_SPRT_HEALTH
  4111  3cef  114730                LD          DE,CHRRAM_SPRT_HEALTH_10                ;= $20
  4112  3cf2  0601                  LD          B,0x1
  4113  3cf4  c3d532                JP          RECALC_AND_REDRAW_BCD
  4114                          CHECK_RING:
  4115  3cf7  f5                    PUSH        AF
  4116  3cf8  3a763a                LD          A,(RING_INV_SLOT)
  4117  3cfb  cd1b3d                CALL        LEVEL_TO_COLRAM_FIX
  4118  3cfe  321734                LD          (COLRAM_RING_IDX),A                     ;= $60    `
  4119  3d01  f1                    POP         AF
  4120  3d02  c9                    RET
  4121                          CHECK_HELMET:
  4122  3d03  f5                    PUSH        AF
  4123  3d04  3a753a                LD          A,(HELMET_INV_SLOT)
  4124  3d07  cd1b3d                CALL        LEVEL_TO_COLRAM_FIX
  4125  3d0a  321534                LD          (COLRAM_HELMET_IDX),A                   ;= $60    `
  4126  3d0d  f1                    POP         AF
  4127  3d0e  c9                    RET
  4128                          CHECK_ARMOR:
  4129  3d0f  f5                    PUSH        AF
  4130  3d10  3a743a                LD          A,(ARMOR_INV_SLOT)
  4131  3d13  cd1b3d                CALL        LEVEL_TO_COLRAM_FIX
  4132  3d16  321334                LD          (COLRAM_ARMOR_IDX),A                    ;= $60    `
  4133  3d19  f1                    POP         AF
  4134  3d1a  c9                    RET
  4135                          LEVEL_TO_COLRAM_FIX:
  4136  3d1b  87                    ADD         A,A
  4137  3d1c  d601                  SUB         0x1
  4138  3d1e  cb27                  SLA         A
  4139  3d20  cb27                  SLA         A
  4140  3d22  cb27                  SLA         A
  4141  3d24  cb27                  SLA         A
  4142  3d26  c9                    RET
  4143                          RHA_REDRAW:
  4144  3d27  cdf73c                CALL        CHECK_RING
  4145  3d2a  cd033d                CALL        CHECK_HELMET
  4146  3d2d  cd0f3d                CALL        CHECK_ARMOR
  4147  3d30  c30a2a                JP          INPUT_DEBOUNCE
  4148                          PLAY_TELEPORT_SOUND:
  4149  3d33  012002                LD          BC,$220
  4150  3d36  111800                LD          DE,$18
  4151  3d39  cdb221                CALL        PLAY_SOUND_LOOP
  4152  3d3c  011001                LD          BC,$110
  4153  3d3f  111800                LD          DE,$18
  4154  3d42  cdb221                CALL        PLAY_SOUND_LOOP
  4155  3d45  018800                LD          BC,$88
  4156  3d48  111800                LD          DE,$18
  4157  3d4b  cdb221                CALL        PLAY_SOUND_LOOP
  4158  3d4e  014400                LD          BC,$44
  4159  3d51  111800                LD          DE,$18
  4160  3d54  cdb221                CALL        PLAY_SOUND_LOOP
  4161  3d57  c9                    RET
  4162                          PLAY_POWER_UP_SOUND:
  4163  3d58  012002                LD          BC,$220
  4164  3d5b  111800                LD          DE,$18
  4165  3d5e  cdb221                CALL        PLAY_SOUND_LOOP
  4166  3d61  010002                LD          BC,$200
  4167  3d64  111800                LD          DE,$18
  4168  3d67  cdb221                CALL        PLAY_SOUND_LOOP
  4169  3d6a  01e001                LD          BC,$1e0
  4170  3d6d  111800                LD          DE,$18
  4171  3d70  cdb221                CALL        PLAY_SOUND_LOOP
  4172  3d73  01c001                LD          BC,$1c0
  4173  3d76  116000                LD          DE,$60
  4174  3d79  cdb221                CALL        PLAY_SOUND_LOOP
  4175  3d7c  c9                    RET
  4176                          
src/asterion.asm:
    20  3d7d  0000000000000000      defs         $3EFF - $, $00
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000              
    21                          
    22                          include "asterion_gfx_pointers.asm"
src/asterion_gfx_pointers.asm:
     1                          GFX_POINTERS:
     2  3eff  00                    db          0h
     3                          GFX_PTR_BUCKLER:
     4  3f00  0100                  dw        BUCKLER                                 ;= $01,$01,$01,$01,$01
     5                          GFX_PTR_BUCKLER_S:
     6  3f02  1400                  dw        BUCKLER_S                               ;= $01,$01
     7                          GFX_PTR_BUCKLER_T:
     8  3f04  1900                  dw        BUCKLER_T                               ;= $00,$87,$FF
     9                          GFX_PTR_RING:
    10  3f06  1c00                  dw        RING                                    ;= $01,$01,$01,$01,$01,$01,$01
    11                          GFX_PTR_RING_S:
    12  3f08  2600                  dw        RING_S                                  ;= $01,$01,$01
    13                          GFX_PTR_RING_T:
    14  3f0a  2c00                  dw        RING_T                                  ;= $00,".",$FF
    15                          GFX_PTR_HELMET:
    16  3f0c  2f00                  dw        HELMET                                  ;= $01,$01,$01,$01,$01,$01
    17                          GFX_PTR_HELMET_S:
    18  3f0e  3d00                  dw        HELMET_S                                ;= $01,$01,$01
    19                          GFX_PTR_HELMET_T:
    20  3f10  4700                  dw        HELMET_T                                ;= $00,"^",$FF
    21                          GFX_PTR_ARMOR:
    22  3f12  4a00                  dw        ARMOR                                   ;= $01,$01,$01,$01,$01
    23                          GFX_PTR_ARMOR_S:
    24  3f14  6200                  dw        ARMOR_S                                 ;= $01,$01
    25                          GFX_PTR_ARMOR_T:
    26  3f16  7300                  dw        ARMOR_T                                 ;= $00,$A0,$C7,$D9,$01
    27                          GFX_PTR_PAVISE:
    28  3f18  7d00                  dw        PAVICE                                  ;= $01,$01,$01,$01,$01
    29                          GFX_PTR_PAVISE_S:
    30  3f1a  9500                  dw        PAVICE_S                                ;= $01,$01
    31                          GFX_PTR_PAVISE_T:
    32  3f1c  a300                  dw        PAVICE_T                                ;= $00,$7F,$01
    33                          GFX_PTR_ARROW_L:
    34  3f1e  bf01                  dw        ARROW_FLYING_LEFT                       ;= $01,$01,$01,$01,$01,$01
    35                          GFX_PTR_ARROW_R:
    36  3f20  a900                  dw        ARROW_FLYING_RIGHT                      ;= $01,$01,$01,$01,$01,$01
    37                          GFX_PTR_ARROW_L_2:
    38  3f22  bf01                  dw        ARROW_FLYING_LEFT                       ;= $01,$01,$01,$01,$01,$01
    39                          GFX_PTR_BOW:
    40  3f24  b200                  dw        BOW                                     ;= $01,$01,$01,$01,$01
    41                          GFX_PTR_BOW_S:
    42  3f26  c600                  dw        BOW_S                                   ;= $01,$01
    43                          GFX_PTR_BOW_T:
    44  3f28  d100                  dw        BOW_T                                   ;= $00,"{",$FF
    45                          GFX_PTR_SCROLL:
    46  3f2a  d400                  dw        SCROLL                                  ;= $01,$01,$01,$01,$01
    47                          GFX_PTR_SCROLL_S:
    48  3f2c  ef00                  dw        SCROLL_S                                ;= $01,$01
    49                          GFX_PTR_SCROLL_NEW_T:
    50  3f2e  f900                  dw        SCROLL_T                                ;= $00,"H",$FF
    51                          GFX_PTR_AXE:
    52  3f30  fc00                  dw        AXE                                     ;= $01,$01,$01,$01,$01
    53                          GFX_PTR_AXE_S:
    54  3f32  1101                  dw        AXE_S                                   ;= $01,$01
    55                          GFX_PTR_AXE_T:
    56  3f34  2101                  dw        AXE_T                                   ;= $00,$11,$FF
    57                          GFX_PTR_FIREBALL:
    58  3f36  2401                  dw        FIREBALL                                ;= $01,$01,$01,$01,$01
    59                          GFX_PTR_FIREBALL_S:
    60  3f38  3501                  dw        FIREBALL_S                              ;= $01,$01
    61                          GFX_PTR_FIREBALL_T:
    62  3f3a  3a01                  dw        FIREBALL_T                              ;= $00,$D3,$FF
    63                          GFX_PTR_MACE:
    64  3f3c  3d01                  dw        MACE                                    ;= $01,$01,$01,$01,$01
    65                          GFX_PTR_MACE_S:
    66  3f3e  5801                  dw        MACE_S                                  ;= $01,$01
    67                          GFX_PTR_MACE_T:
    68  3f40  6a01                  dw        MACE_T                                  ;= $00,"T",$FF
    69                          GFX_PTR_STAFF:
    70  3f42  6d01                  dw        STAFF                                   ;= $01,$01,$01,$01,$01
    71                          GFX_PTR_STAFF_S:
    72  3f44  8001                  dw        STAFF_S                                 ;= $01,$01
    73                          GFX_PTR_STAFF_T:
    74  3f46  8901                  dw        STAFF_T                                 ;= $00,"\\",$FF
    75                          GFX_PTR_CROSSBOW:
    76  3f48  8c01                  dw        CROSSBOW                                ;= $01,$01,$01,$01,$01
    77                          GFX_PTR_CROSSBOW_S:
    78  3f4a  af01                  dw        CROSSBOW_S                              ;= $01,$01
    79                          GFX_PTR_CROSSBOW_T:
    80  3f4c  b701                  dw        CROSSBOW_T                              ;= $A0,$91,$A0,$D8,$02,$04,$90,$FF
    81  3f4e  8b03                  dw        EXCL_MARK_GFX
    82  3f50  8b03                  dw        EXCL_MARK_GFX
    83  3f52  8b03                  dw        EXCL_MARK_GFX
    84  3f54  8b03                  dw        EXCL_MARK_GFX
    85  3f56  8b03                  dw        EXCL_MARK_GFX
    86  3f58  8b03                  dw        EXCL_MARK_GFX
    87                          GFX_PTR_ARROW_R_2:
    88  3f5a  a900                  dw        ARROW_FLYING_RIGHT                      ;= $01,$01,$01,$01,$01,$01
    89  3f5c  8b03                  dw        EXCL_MARK_GFX
    90  3f5e  8b03                  dw        EXCL_MARK_GFX
    91                          GFX_PTR_LADDER:
    92  3f60  c801                  dw        LADDER                                  ;= $01,$01,$01,$01,$01
    93                          GFX_PTR_LADDER_S:
    94  3f62  e101                  dw        LADDER_S                                ;= $01,$01
    95                          GFX_PTR_LADDER_T:
    96  3f64  f101                  dw        LADDER_T                                ;= $00,$CD,$97,$FF
    97                          GFX_PTR_CHEST:
    98  3f66  f501                  dw        CHEST                                   ;= $01,$01,$01,$01,$01
    99                          GFX_PTR_CHEST_S:
   100  3f68  1402                  dw        CHEST_S                                 ;= $01,$E0,$1F,$1F,$B0,$01
   101                          GFX_PTR_CHEST_T:
   102  3f6a  2602                  dw        CHEST_T                                 ;= $00,$FC,$FF
   103                          GFX_PTR_FOOD:
   104  3f6c  2902                  dw        FOOD                                    ;= $01,$01,$01,$01,$01
   105                          GFX_PTR_FOOD_S:
   106  3f6e  4002                  dw        FOOD_S                                  ;= $01,$01
   107                          GFX_PTR_FOOD_T:
   108  3f70  4a02                  dw        FOOD_T                                  ;= $00,"#",$FF
   109                          GFX_PTR_QUIVER:
   110  3f72  4d02                  dw        QUIVER                                  ;= $01,$01,$01,$01,$01,$01
   111                          GFX_PTR_QUIVER_S:
   112  3f74  6402                  dw        QUIVER_S                                ;= $01,$01
   113                          GFX_PTR_QUIVER_T:
   114  3f76  6f02                  dw        QUIVER_T                                ;= $00,$F0,$FF
   115                          GFX_PTR_LOCK_CHEST:
   116  3f78  7202                  dw        LOCKED_CHEST                            ;= $01,$01,$01,$01,$01
   117                          GFX_PTR_LOCK_CHEST_S:
   118  3f7a  1402                  dw        CHEST_S                                 ;= $01,$E0,$1F,$1F,$B0,$01
   119                          GFX_PTR_LOCK_CHEST_T:
   120  3f7c  2602                  dw        CHEST_T                                 ;= $00,$FC,$FF
   121  3f7e  8b03                  dw        EXCL_MARK_GFX
   122  3f80  8b03                  dw        EXCL_MARK_GFX
   123  3f82  8b03                  dw        EXCL_MARK_GFX
   124                          GFX_PTR_KEY:
   125  3f84  9102                  dw        KEY                                     ;= $01,$01,$01,$01,$01,$01
   126                          GFX_PTR_KEY_S:
   127  3f86  a302                  dw        KEY_S                                   ;= $01,$01,$01
   128                          GFX_PTR_KEY_T:
   129  3f88  a902                  dw        KEY_T                                   ;= $FF,"-",$FF
   130                          GFX_PTR_AMULET:
   131  3f8a  ac02                  dw        AMULET                                  ;= $01,$01,$01,$01,$01
   132                          GFX_PTR_AMULET_S:
   133  3f8c  c402                  dw        AMULET_S                                ;= $01,$01
   134                          GFX_PTR_AMULET_T:
   135  3f8e  d402                  dw        AMULET_T                                ;= $00,"&",$FF
   136                          GFX_PTR_CHALICE:
   137  3f90  d702                  dw        CHALICE                                 ;= $01,$01,$01,$01,$01,$01
   138                          GFX_PTR_CHALICE_S:
   139  3f92  ea02                  dw        CHALICE_S                               ;= $01,$01
   140                          GFX_PTR_CHALICE_T:
   141  3f94  f202                  dw        CHALICE_T                               ;= $00,"Y",$FF
   142                          GFX_PTR_WARRIOR_POTION:
   143  3f96  f502                  dw        WARRIOR_POTION                          ;= $01,$01,$01,$01,$01
   144                          GFX_PTR_WARRIOR_POTION_S:
   145  3f98  0a03                  dw        WARRIOR_POTION_S                        ;= $01,$01
   146                          GFX_PTR_WARRIOR_POTION_T:
   147  3f9a  1503                  dw        POTION_T                                ;= $00,"U",$02,$04,"_",$FF
   148                          GFX_PTR_MAGE_POTION:
   149  3f9c  1b03                  dw        MAGE_POTION                             ;= $01,$01,$01,$01,$01
   150                          GFX_PTR_MAGE_POTION_S:
   151  3f9e  3003                  dw        MAGE_POTION_S                           ;= $01,$01
   152                          GFX_PTR_MAGE_POTION_T:
   153  3fa0  1503                  dw        POTION_T                                ;= $00,"U",$02,$04,"_",$FF
   154                          GFX_PTR_MAP:
   155  3fa2  3b03                  dw        MAP                                     ;= $01,$01,$01,$01,$01
   156                          GFX_PTR_MAP_S:
   157  3fa4  5a03                  dw        MAP_S                                   ;= $01,$01
   158                          GFX_PTR_MAP_T:
   159  3fa6  6803                  dw        MAP_T                                   ;= $00,$D5,$FF
   160                          GFX_PTR_CHAOS_POTION:
   161  3fa8  6b03                  dw        CHAOS_POTION                            ;= $01,$01,$01,$01,$01
   162                          GFX_PTR_CHAOS_POTION_S:
   163  3faa  8003                  dw        CHAOS_POTION_S                          ;= $01,$01
   164                          GFX_PTR_CHAOS_POTION_T:
   165  3fac  1503                  dw        POTION_T                                ;= $00,"U",$02,$04,"_",$FF
   166  3fae  8b03                  dw        EXCL_MARK_GFX
   167  3fb0  8b03                  dw        EXCL_MARK_GFX
   168  3fb2  8b03                  dw        EXCL_MARK_GFX
   169                          GFX_END_PT1:
   170  3fb4  0000                  dw        NO_GFX                                  ;= $FF
   171                          GFX_PTR_SKELETON:
   172  3fb6  8d03                  dw        SKELETON                                ;= $04,$04,$04,$04
   173                          GFX_PTR_SKELETON_S:
   174  3fb8  cb03                  dw        SKELETON_S                              ;= $04,$04,$04
   175  3fba  0000                  dw        NO_GFX                                  ;= $FF
   176                          GFX_PTR_SNAKE:
   177  3fbc  e103                  dw        SNAKE                                   ;= $04,$04,$04
   178                          GFX_PTR_SNAKE_S:
   179  3fbe  2204                  dw        SNAKE_S                                 ;= $04,$04,$04
   180  3fc0  0000                  dw        NO_GFX                                  ;= $FF
   181                          GFX_PTR_SPIDER:
   182  3fc2  3a04                  dw        SPIDER                                  ;= $04,$04
   183                          GFX_PTR_SPIDER_S:
   184  3fc4  6b04                  dw        SPIDER_S                                ;= $04,$04,$04,$04
   185  3fc6  0000                  dw        NO_GFX                                  ;= $FF
   186                          GFX_PTR_MIMIC:
   187  3fc8  8404                  dw        MIMIC                                   ;= $04,$02,$D7,$96,$00,$00,$96,$C9,$01
   188                          GFX_PTR_MIMIC_S:
   189  3fca  b704                  dw        MIMIC_S                                 ;= $01,$E0,$1F,$1F,$B0,$01
   190  3fcc  0000                  dw        NO_GFX                                  ;= $FF
   191                          GFX_PTR_MALOCCHIO:
   192  3fce  c904                  dw        MALOCCHIO                               ;= $04,$04,$04,$04
   193                          GFX_PTR_MALOCCHIO_S:
   194  3fd0  ff04                  dw        MALOCCHIO_S                             ;= $04,$04,$04,$04
   195  3fd2  0000                  dw        NO_GFX                                  ;= $FF
   196                          GFX_PTR_DRAGON:
   197  3fd4  1905                  dw        DRAGON                                  ;= $04,$04,$04,$04
   198                          GFX_PTR_DRAGON_S:
   199  3fd6  8505                  dw        DRAGON_S                                ;= $04,$04,$04,$C9,$C9,$C0,$C0,$01
   200                          GFX_PTR_END_A:
   201  3fd8  0000                  dw        NO_GFX                                  ;= $FF
   202                          GFX_PTR_MUMMY:
   203  3fda  a705                  dw        MUMMY                                   ;= $04,$04,$04,$04
   204                          GFX_PTR_MUMMY_S:
   205  3fdc  0a06                  dw        MUMMY_S                                 ;= $04,$04,$04
   206                          GFX_PTR_END_B:
   207  3fde  0000                  dw        NO_GFX                                  ;= $FF
   208                          GFX_PTR_NECRO:
   209  3fe0  2306                  dw        NECROMANCER                             ;= $04,$04,$04,$04
   210                          GFX_PTR_NECRO_S:
   211  3fe2  7e06                  dw        NECROMANCER_S                           ;= $04,$04,$04
   212                          GFX_PTR_END_C:
   213  3fe4  0000                  dw        NO_GFX                                  ;= $FF
   214                          GFX_PTR_GRYPHON:
   215  3fe6  9506                  dw        GRYPHON                                 ;= $04,$04,$04,$04
   216                          GFX_PTR_GRYPHON_S:
   217  3fe8  f506                  dw        GRYPHON_S                               ;= $04,$04,$04,$B8,$B8,$B0,$01
   218                          GFX_PTR_END_D:
   219  3fea  0000                  dw        NO_GFX                                  ;= $FF
   220                          GFX_PTR_MINOTAUR:
   221  3fec  0f07                  dw        MINOTAUR                                ;= $04,$04,$04,$04
   222                          GFX_PTR_MINOTAUR_S:
   223  3fee  5607                  dw        MINOTAUR_S                              ;= $04,$04,$04,$04
   224                          
src/asterion.asm:
    23  3ff0  0000000000000000      defs         $4000 - $, $00
              0000000000000000  
    24                          
