src/asterion.asm:
     1                          INCLUDE "aquarius.inc"
src/aquarius.inc:
     1                          ; Aquarius SYSROM Routines
     2                          EXCL_MARK_GFX EQU $0056
     3                          SLEEP_ZERO EQU $1d48
     4                          SLEEP EQU $1d4b
     5                          FILL_FULL_1024 EQU $1e59
     6                          
     7                          ; CHRRAM - Character RAM
     8                          CHRRAM EQU $3000
     9                          
    10                          ; COLRAM: Color RAM
    11                          COLRAM EQU $3400
    12                          
    13                          ; Aquarius IO ports
    14                          MODEM_A EQU $7E
    15                          MODEM_B EQU $7F
    16                          CONTROL_PADS EQU $F6
    17                          PSG EQU $F7
    18                          SPEAKER EQU $FC
    19                          VSYNC EQU $FD
    20                          PRINTER EQU $FE
    21                          KEYBOARD EQU $FF
    22                          
src/asterion.asm:
     2                          INCLUDE "asterion.inc"
src/asterion.inc:
     1                          ; CHRRAM - Character RAM
     2                          CHRRAM_LEVEL_IND_L EQU $3001
     3                          CHRRAM_LEVEL_IND_R EQU $3004
     4                          CHRRAM_SHIFT_MODE_IDX EQU $3005
     5                          CHRRAM_LADDER_IDX EQU $3007
     6                          CHRRAM_ITEM_IDX EQU $3009
     7                          CHRRAM_MONSTER_IDX EQU $300b
     8                          CHRRAM_DOOR_IDX EQU $300d
     9                          CHRRAM_MAP_IDX EQU $3011
    10                          CHRRAM_ARMOR_IDX EQU $3013
    11                          CHRRAM_HELMET_IDX EQU $3015
    12                          CHRRAM_RING_IDX EQU $3017
    13                          IDX_VIEWPORT_CHRRAM EQU $3028
    14                          DAT_ram_3050 EQU $3050
    15                          CHRRAM_WALL_F0_IDX EQU $30cc
    16                          DAT_ram_3168 EQU $3168
    17                          CHRRAM_L1_DOOR_IDX EQU $316d
    18                          DAT_ram_3177 EQU $3177
    19                          DAT_ram_317a EQU $317a
    20                          DAT_ram_317f EQU $317f
    21                          DAT_ram_3191 EQU $3191
    22                          DAT_ram_3196 EQU $3196
    23                          DAT_ram_31a1 EQU $31a1
    24                          DAT_ram_31a6 EQU $31a6
    25                          CHRRAM_POINTER_IDX EQU $31d8
    26                          DAT_ram_3259 EQU $3259
    27                          DAT_ram_3266 EQU $3266
    28                          DAT_ram_326e EQU $326e
    29                          DAT_ram_3280 EQU $3280
    30                          DAT_ram_3297 EQU $3297
    31                          
    32                          ; CHRRAM Spare 24
    33                          WALL_F0_STATE EQU $33e8
    34                          WALL_F1_STATE EQU $33e9
    35                          WALL_F2_STATE EQU $33ea
    36                          WALL_F3_STATE EQU $33eb
    37                          DAT_ram_33ec EQU $33ec
    38                          DAT_ram_33ed EQU $33ed
    39                          DAT_ram_33ee EQU $33ee
    40                          DAT_ram_33ef EQU $33ef
    41                          DAT_ram_33f0 EQU $33f0
    42                          DAT_ram_33f1 EQU $33f1
    43                          DAT_ram_33f2 EQU $33f2
    44                          DAT_ram_33f3 EQU $33f3
    45                          DAT_ram_33f4 EQU $33f4
    46                          DAT_ram_33f5 EQU $33f5
    47                          DAT_ram_33f6 EQU $33f6
    48                          DAT_ram_33f7 EQU $33f7
    49                          DAT_ram_33f9 EQU $33f9
    50                          DAT_ram_33fa EQU $33fa
    51                          DAT_ram_33fb EQU $33fb
    52                          DAT_ram_33fd EQU $33fd
    53                          
    54                          ; COLRAM: Color RAM
    55                          COLRAM_LEVEL_IDX_L EQU $3401
    56                          COLRAM_FLOOR_IDX_10 EQU $3402
    57                          COLRAM_FLOOR_IDX_1 EQU $3403
    58                          COLRAM_LEVEL_IDX_R EQU $3404
    59                          COLRAM_ARMOR_IDX EQU $3413
    60                          COLRAM_HELMET_IDX EQU $3415
    61                          COLRAM_RING_IDX EQU $3417
    62                          COLRAM_PHYS_STATS_1000 EQU $3441
    63                          COLRAM_SPRT_STATS_10 EQU $3446
    64                          DAT_ram_3568 EQU $3568
    65                          COLRAM_F0_DOOR_IDX EQU $3570
    66                          DAT_ram_357f EQU $357f
    67                          DAT_ram_3590 EQU $3590
    68                          DAT_ram_3591 EQU $3591
    69                          DAT_ram_35a6 EQU $35a6
    70                          DAT_ram_35a7 EQU $35a7
    71                          DAT_ram_35d8 EQU $35d8
    72                          DAT_ram_35e0 EQU $35e0
    73                          DAT_ram_35e1 EQU $35e1
    74                          DAT_ram_35f6 EQU $35f6
    75                          DAT_ram_35f7 EQU $35f7
    76                          DAT_ram_3608 EQU $3608
    77                          DAT_ram_361f EQU $361f
    78                          DAT_ram_3728 EQU $3728
    79                          
    80                          ; COLRAM Spare 24
    81                          ITEM_F2 EQU $37e8
    82                          ITEM_F1 EQU $37e9
    83                          ITEM_F0 EQU $37ea
    84                          ITEM_FL1 EQU $37eb
    85                          ITEM_FR1 EQU $37ec
    86                          ITEM_R1 EQU $37ed
    87                          ITEM_L1 EQU $37ee
    88                          ITEM_B1 EQU $37ef
    89                          KEY_INPUT_COL0 EQU $37f6
    90                          KEY_INPUT_COL1 EQU $37f7
    91                          KEY_INPUT_COL2 EQU $37f8
    92                          KEY_INPUT_COL3 EQU $37f9
    93                          KEY_INPUT_COL4 EQU $37fa
    94                          KEY_INPUT_COL5 EQU $37fb
    95                          KEY_INPUT_COL6 EQU $37fc
    96                          KEY_INPUT_COL7 EQU $37fd
    97                          HC_INPUT_HOLDER EQU $37fe
    98                          
    99                          ; Aquarius Built-In 2k RAM Space
   100                          MAPSPACE_WALLS EQU $3800
   101                          MAP_LADDER_OFFSET EQU $3900
   102                          LADDER_POS EQU $3901
   103                          MAP_ITEM_SPACE EQU $3902
   104                          BYTE_ram_3903 EQU $3903
   105                          BYTE_ram_3904 EQU $3904
   106                          BYTE_ram_3905 EQU $3905
   107                          BYTE_ram_3906 EQU $3906
   108                          ITEM_MOVE_CHR_BUFFER EQU $3a00
   109                          ITEM_MOVE_COL_BUFFER EQU $3a10
   110                          BYTE_ram_3a20 EQU $3a20
   111                          BYTE_ram_3a58 EQU $3a58
   112                          DIR_FACING_FW EQU $3a60
   113                          DIR_FACING_BW EQU $3a61
   114                          DIR_FACING_SHORT EQU $3a62
   115                          MON_FS EQU $3a63
   116                          RAM_AC EQU $3a64
   117                          RAM_AD EQU $3a65
   118                          RAM_AE EQU $3a66
   119                          RAM_AF EQU $3a67
   120                          DUNGEON_LEVEL EQU $3a68
   121                          TIMER_A EQU $3a69
   122                          TIMER_B EQU $3a6a
   123                          TIMER_C EQU $3a6b
   124                          TIMER_D EQU $3a88
   125                          TIMER_E EQU $3a9c
   126                          
   127                          INPUT_HOLDER EQU $3a6c
   128                          SHIELD_PHYS EQU $3a71
   129                          SHIELD_SPRT EQU $3a73
   130                          ARMOR_INV_SLOT EQU $3a74
   131                          HELMET_INV_SLOT EQU $3a75
   132                          RING_INV_SLOT EQU $3a76
   133                          PLAYER_PREV_MAP_LOC EQU $3a77
   134                          LAST_ITEM_HELD EQU $3a78
   135                          PLAYER_MAP_POS EQU $3a79
   136                          RIGHT_HAND_ITEM EQU $3a7a
   137                          LEFT_HAND_ITEM EQU $3a7b
   138                          INV_ITEM_SLOT_1 EQU $3a7c
   139                          INV_ITEM_SLOT_2 EQU $3a7d
   140                          INV_ITEM_SLOT_3 EQU $3a7e
   141                          BYTE_ram_3a82 EQU $3a82
   142                          BYTE_ram_3a83 EQU $3a83
   143                          BYTE_ram_3a85 EQU $3a85
   144                          BYTE_ram_3a87 EQU $3a87
   145                          
   146                          BYTE_ram_3a89 EQU $3a89
   147                          BYTE_ram_3a8a EQU $3a8a
   148                          MELEE_ANIM_STATE EQU $3a8b
   149                          BYTE_ram_3a8c EQU $3a8c
   150                          MONSTER_ATT_POS_COUNT EQU $3a8d
   151                          MONSTER_ATT_POS_OFFSET EQU $3a8f
   152                          RNDHOLD_AA EQU $3a91
   153                          PLAYER_PHYS_HEALTH EQU $3a93
   154                          PLAYER_PHYS_HEALTH_MAX EQU $3a95
   155                          PLAYER_SPRT_HEALTH EQU $3a97
   156                          PLAYER_SPRT_HEALTH_MAX EQU $3a98
   157                          WEAPON_PHYS EQU $3a99
   158                          WEAPON_SPRT EQU $3a9b
   159                          BYTE_ram_3a9e EQU $3a9e
   160                          BYTE_ram_3aa0 EQU $3aa0
   161                          ITEM_HOLDER EQU $3aa1
   162                          CURR_MONSTER_SPRT EQU $3aa2
   163                          CURR_MONSTER_PHYS EQU $3aa3
   164                          BYTE_ram_3aa5 EQU $3aa5
   165                          NEW_DAMAGE EQU $3aa6
   166                          WEAPON_VALUE_HOLDER EQU $3aa8
   167                          BYTE_ram_3aa9 EQU $3aa9
   168                          FOOD_INV EQU $3aab
   169                          ARROW_INV EQU $3aac
   170                          MAP_INV_SLOT EQU $3aad
   171                          SND_CYCLE_HOLDER EQU $3ab3
   172                          PITCH_UP_BOOL EQU $3ab5
   173                          SOUND_REPEAT_COUNT EQU $3ab8
   174                          GAME_BOOLEANS EQU $3ab9
   175                          NEXT_BLINK_CHECK EQU $3aba
   176                          TEMP_MAP EQU $3b00
   177                          BYTE_ram_3ffd EQU $3ffd
   178                          
   179                          ; Missing items
   180                          BYTE_ram_2400 EQU $2400
   181                          BYTE_ram_2613 EQU $2613
   182                          DAT_ram_303f EQU $303f
   183                          DAT_ram_3051 EQU $3051
   184                          DAT_ram_30a0 EQU $30a0
   185                          DAT_ram_30c8 EQU $30c8
   186                          DAT_ram_30df EQU $30df
   187                          DAT_ram_310c EQU $310c
   188                          DAT_ram_3111 EQU $3111
   189                          DAT_ram_3150 EQU $3150
   190                          DAT_ram_316c EQU $316c
   191                          DAT_ram_3178 EQU $3178
   192                          DAT_ram_317c EQU $317c
   193                          DAT_ram_31af EQU $31af
   194                          DAT_ram_31b4 EQU $31b4
   195                          DAT_ram_3200 EQU $3200
   196                          DAT_ram_3230 EQU $3230
   197                          DAT_ram_324c EQU $324c
   198                          DAT_ram_32da EQU $32da
   199                          DAT_ram_335c EQU $335c
   200                          DAT_ram_33c0 EQU $33c0
   201                          DAT_ram_34b4 EQU $34b4
   202                          DAT_ram_34c8 EQU $34c8
   203                          DAT_ram_34dc EQU $34dc
   204                          DAT_ram_351a EQU $351a
   205                          DAT_ram_352d EQU $352d
   206                          DAT_ram_3547 EQU $3547
   207                          DAT_ram_3550 EQU $3550
   208                          DAT_ram_356c EQU $356c
   209                          DAT_ram_3577 EQU $3577
   210                          DAT_ram_3578 EQU $3578
   211                          DAT_ram_357a EQU $357a
   212                          DAT_ram_357c EQU $357c
   213                          DAT_ram_35ba EQU $35ba
   214                          DAT_ram_35c0 EQU $35c0
   215                          DAT_ram_35c6 EQU $35c6
   216                          DAT_ram_35c8 EQU $35c8
   217                          DAT_ram_35ca EQU $35ca
   218                          DAT_ram_35cc EQU $35cc
   219                          LAB_ram_1208 EQU $1208
   220                          LAB_ram_efef EQU $efef
   221                          CHHRAM_INV_4_IDX EQU $31a9
   222                          CHHRAM_INV_6_IDX EQU $3251
   223                          CHHRAM_LVL_IDX EQU $33df
   224                          CHRRAM_AUTHORS_IDX EQU $3348
   225                          CHRRAM_F1_WALL_IDX EQU $3170
   226                          CHRRAM_FL1_WALL_IDX EQU $3147
   227                          CHRRAM_FO_ITEM_IDX EQU $3352
   228                          CHRRAM_LEFT_HAND_ITEM_IDX EQU $3271
   229                          CHRRAM_LEFT_HD_GFX_IDX EQU $3339
   230                          CHRRAM_LEVEL_IDX EQU $333d
   231                          CHRRAM_MONSTER_PHYS EQU $3089
   232                          CHRRAM_MONSTER_POOF_IDX EQU $323b
   233                          CHRRAM_MONSTER_SPRT EQU $3063
   234                          CHRRAM_PHYS_HEALTH_1000 EQU $3041
   235                          CHRRAM_PHYS_SHIELD_IDX EQU $3069
   236                          CHRRAM_PHYS_WEAPON_IDX EQU $3091
   237                          CHRRAM_RH_POOF_IDX EQU $336c
   238                          CHRRAM_RIGHT_HAND_ITEM_IDX EQU $327b
   239                          CHRRAM_RIGHT_HD_GFX_IDX EQU $3343
   240                          CHRRAM_SPRT_HEALTH_10 EQU $3047
   241                          CHRRAM_SPRT_SHIELD_IDX EQU $306f
   242                          CHRRAM_SPRT_WEAPON_IDX EQU $3097
   243                          CHRRAM_STATS_TOP EQU $3019
   244                          CHRRAM_YOU_DIED_IDX EQU $31e7
   245                          COLRAM_F0_WALL_MAP_IDX EQU $34cc
   246                          COLRAM_F1_DOOR_IDX EQU $35c2
   247                          COLRAM_FL00_WALL_IDX EQU $34a3
   248                          COLRAM_FL2_PLUS_WALL_IDX EQU $35be
   249                          COLRAM_FL2_WALL_IDX EQU $35bc
   250                          COLRAM_FL22_WALL_IDX EQU $35b8
   251                          COLRAM_FO_ITEM_IDX EQU $3752
   252                          COLRAM_L1_DOOR_IDX EQU $356d
   253                          COLRAM_MAP_IDX EQU $3411
   254                          COLRAM_PHYS_STATS_10 EQU $3443
   255                          COLRAM_RH_ITEM_IDX EQU $3743
   256                          COLRAM_SHIFT_MODE_IDX EQU $3405
   257                          COLRAM_SPRT_STATS_1 EQU $3447
   258                          COLRAM_VIEWPORT_IDX EQU $3428
   259                          HC_LAST_INPUT EQU $37ff
   260                          IDX_HEALTH_SPACER EQU $3045
   261                          
src/asterion.asm:
     3                          
     4                          org $c000
     5                          
     6                          ; include "asterion_low_rom.asm"
     7                          
     8                          TITLE_SCREEN:
     9  0000  2020202020202020  INCBIN "asterion_title.scr"
              2020e0fcfcb02020  
              2020202020202020  
              2020202020202020  
              e0f0202020202020  
              20202020202020e8  
              fffcbfa3a3efb4ff  
              20eab5e8ffb4eaff  
              80b4ffeab520ffe8  
              bfabb5c420202020  
              20202020202020fe  
              8ffff5f5fdffffff  
              20eab5fe8ffdeab5  
              dbc3ffeab520ffaa  
              fd1fb02020202020  
              d02020202020e8ff  
              ffffb0ebb4f5ffff  
              b0eaffffffffffff  
              ffa1ffeaf520ffe0  
              a2abfd20202020d0  
              d1d1d0202020fea5  
              20aafdf0f0fef7aa  
              ffffffa520aaffb5  
              ebf5ffa2efffffea  
              fdfebf2020d0d1d1  
              20d0d0d1d0202020  
              d020a2afafa3effd  
              b0436f6d70757465  
              722053797374656d  
              a2a320d0d1d0d020  
              d1d1d1d0d0d0d1d0  
              d0d0d020d0d0d0d0  
              d020d0d0d0d0d0d0  
              20d0d020d0d0d0d0  
              d0d1d0d0d1d0d1d1  
              d0d1d020d1d1d020  
              d0d1d0d1d0d1d0d0  
              d0d1d0d1d1d0d1d1  
              d1d0d1d0d020d0d0  
              20d0d1d020d0d1d0  
              2020d0d1d020d0d1  
              d0d0d0d1d1d0d1d1  
              d1d1d0d1d1d0d1d1  
              d1d1d0d1d1d0d0d0  
              d1d020d0d1d12020  
              202020d0d1d0d0d0  
              d1d1d0d0d1d1d1d0  
              d0d1d0d0d1d0d0d1  
              d1d1d1d1d1d1d0d1  
              d020d0d1d0202020  
              eafffcffb0feffb0  
              fefdb5fdffb4d0d0  
              e8fff5e0fffffcff  
              fffdfdffb4fffdff  
              eab5faffb0ffffb4  
              e0b5ffeab5faebb5  
              a1fae5bfd0a1d0d0  
              e0b7ffeaf5d0a1ea  
              b5e0bfd0a1fae0ff  
              eaf5ffeaf5faeab5  
              eab5ffeab5fffeb5  
              e8bfeaffffd04f46  
              eafdffaaffffb4ea  
              b5eaffffd0ffffa5  
              eaffb5d0ffffeab5  
              eab5ffeab5ffebb5  
              ffa5b2fdd0b0d0d0  
              eab7ffe0d0ebb5ea  
              b5a2fd20b0ffeab5  
              eab7ffeab7ffeab5  
              eab5ffeab5ffeab5  
              bfffa5bfffa5d0d0  
              eab5ffaaffffa1ea  
              b5d0bfffa5ffa2ff  
              eab5ebffa1ffeab5  
              d0d0d1d1d1d1d1d0  
              d0d1d1d0d0d0d0d0  
              d1d1d0d0d0d0d0d0  
              d0d0d0d0d0d0d0d0  
              d1d1d1d1d1d1d120  
              d12020d0d0d1d1d1  
              d1d0d0d0d0d0d0d0  
              d0d0d0d0d0d0d0d0  
              d0d0d0d0d0d0d1d1  
              d1d1d0d0d020d0d0  
              20d02020d0d1d0d1  
              d1d1d15072657373  
              d133d1666f72d145  
              415359d1d1d1d1d1  
              d0d1d1d020202020  
              d020202020d020c6  
              d0d1d15072657373  
              d132d1666f72d14d  
              454449554dd1d1d1  
              20c6d020202020d0  
              2020202020d02020  
              d0d1d15072657373  
              d131d1666f72d148  
              415244d1d1d1d1d0  
              2020d02020202020  
              202020d02020d0d0  
              d1d0d15072657373  
              d134d1666f72d148  
              415244455354d0d1  
              d0d0202020202020  
              20202020202020d0  
              d0d0d0d1d1d1d0d1  
              d1d1d1d1d1d1d1d0  
              d1d1d1d1d1d1d020  
              202020d020202020  
              20202020d0202020  
              d0d0d1d0d1d0d1d0  
              d0d1d0d0d0d1d0d1  
              d0d0d0d1d0d120d0  
              2020d02020202020  
              2043616e20796f75  
              20636f6e71756572  
              20746865206d696e  
              6f746175722cd041  
              73746572696f6e3f  
              2020202020202020  
              2020202020202020  
              2020202020202020  
              2020202020202020  
              2020202020202020  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              7030303030303030  
              3030404040403030  
              3030303030303030  
              3030303030303030  
              4040303030303030  
              3030303030303040  
              404041434d4d4040  
              3040404040404040  
              4040404040304040  
              4040404030303030  
              3030303030303040  
              0440e1133dd34040  
              3040404004404040  
              0440404040304040  
              4040403030303030  
              b030303030304040  
              40404e1e133d4040  
              4040404040404040  
              4040404040304040  
              40404030303030b0  
              0ff0b03030304040  
              30404e4e41434040  
              4040404030404040  
              4040404040404040  
              4040403030b0f00f  
              0fbf0f0fb0303030  
              f030404040404040  
              4080808080808080  
              8030808080808080  
              404030b00f0fbf0f  
              0f0fbfbfbf0ff0f0  
              f0f0f030f0f0f0f0  
              f030f0f0f0f0f0f0  
              30f0f030f0f0f0f0  
              f00f0fbfbfbf0f0f  
              f0f00f0fbfbfbf0f  
              b0f0f0f0f0f0f0f0  
              f0f0b0f0f0f0f0f0  
              f0b0f0f0f030b00f  
              0fbfbfbf0f0ff0f0  
              3030f0f00f0fbfbf  
              bf0f0ff0f0f0f0f0  
              f00f0f0f0f0f0ff0  
              f0f0f0f0f0b00fbf  
              bfbf0f0f0ff03030  
              303030f0f00f0fbf  
              bfbf0f0f0ff00f0f  
              0f0f0f0f0f0f0f0f  
              0ff0f0f00f0fbfbf  
              bf0f0f0ff0303030  
              303f3030303f303f  
              3f3f3f3f303f0f0f  
              3f303f3f30303f30  
              303f3f303f303f30  
              3f3f3f3f303f3f30  
              30303f303030303f  
              3f3f3f300f3f0f0f  
              3f3f3f3f3f0f3f3f  
              3f3f3f0f3f3f3f3f  
              30303f3030303030  
              30303f30303f303f  
              3f3f3f303f0f3f3f  
              3f3f303f3f3f3f3f  
              3f3f3f3f0f303f3f  
              3f3f30f030303030  
              30303f30303f303f  
              303f3f300f3f0f0f  
              3f3f303f0f3f3f3f  
              3f3f3f3f3f303f3f  
              3f303f3030303030  
              303030303030303f  
              30303f30303f0f0f  
              3f3f303f303f3f3f  
              3f0f30303f303f3f  
              3f3f3f3f303f3030  
              f0f0f0f00f0f0f0f  
              0ff00f0f0f0f0f0f  
              0f0f0f0f0f0f0f0f  
              0f0f0f0f0f0f0f0f  
              0ff0f0f0f00ff030  
              f03030f0f0f0f0f0  
              0f0f0f0f0f0f0f0f  
              0f0f0f0f0f0f0f0f  
              0f0f0f0f0f0f0ff0  
              f0f0f0f0f030f0b0  
              30f03030f0f0bfbf  
              f00f0f1f1f1f1f1f  
              0f010f1f1f1f0f1f  
              1f1f1f0f0f0f0ff0  
              bfbff0f030303030  
              f030303030f03040  
              bf0f0f3f3f3f3f3f  
              0ff30f3f3f3f0f3f  
              3f3f3f3f3f0f0f0f  
              3040b030303030f0  
              3030303030f03030  
              0ff00f5f5f5f5f5f  
              0ff50f5f5f5f0f5f  
              5f5f5f0f0f0ff00f  
              3030f03030303030  
              303030f03030f0f0  
              f0f0f07f7f7f7f7f  
              0ff70f7f7f7f0f7f  
              7f7f7f7f7f7ff0f0  
              f0f0303030303030  
              30303030303030f0  
              f0f0f0f0f0f0f0f0  
              f0f0f0f0f0f0f0f0  
              f0f0f0f0f0f0f030  
              303030f030303030  
              30303030f0303030  
              f0f0f0f0f0f0f0f0  
              f0f0f0f0f0f0f0f0  
              f0f0f0f0f0f030f0  
              3030f03030303030  
              30d0d0d030d0d0d0  
              30d0d0d0d0d0d0d0  
              30d0d0d030d0d0d0  
              d0d0d0d0d0d0f020  
              20202020202020d0  
              3030303030303030  
              3030303030303030  
              3030303030303030  
              3030303030303030  
              3030303030303030  
              0000000000000000  
              0000000000000000  
              0000000000000000  
    10                          
    11                          TS_EYES_OPEN_CHR EQU TITLE_SCREEN + 726
    12                          TITLE_SCREEN_COL EQU TITLE_SCREEN + 1024
    13                          TS_EYES_OPTN_COL EQU TITLE_SCREEN + 1750
    14                          
    15                          include "asterion_low_rom.asm"
src/asterion_low_rom.asm:
     1                          NO_GFX:
     2  0800  ff                    db          $FF
     3                          DRAGON:
     4  0801  04040404              db          $04,$04,$04,$04
     5  0805  02b0e000c0a0c2a0      db          $02,$B0,$E0,$00,$C0,$A0,$C2,$A0,$C1,$01
              c101              
     6  080f  0202a099a0c9d798      db          $02,$02,$A0,$99,$A0,$C9,$D7,$98,$A0,$95,$95,$85,$A0,$81,$01
              a0959585a08101    
     7  081e  0202a0c3a4a81285      db          $02,$02,$A0,$C3,$A4,$A8,$12,$85,$86,$85,$A0,$97,$01
              8685a09701        
     8  082b  02a0178ca52094a0      db          $02,$A0,$17,$8C,$A5," ",$94,$A0,$94,$A5,$01
              94a501            
     9  0836  0202d7f6f97f7f7f      db          $02,$02,$D7,$F6,$F9,$7F,$7F,$7F,$7F,$B4,$01
              7fb401            
    10  0841  0202a0b595862084      db          $02,$02,$A0,$B5,$95,$86," ",$84," ",$B0,$A0,$99,$01
              20b0a09901        
    11  084e  0202a0c3d7a094a0      db          $02,$02,$A0,$C3,$D7,$A0,$94,$A0,$C9,$A0,$DB,$18,$A2,$C3,$01
              c9a0db18a2c301    
    12  085d  0218008d0000e899      db          $02,$18,$00,$8D,$00,$00,$E8,$99,$01
              01                
    13  0866  009eec1fbfa1ff        db          $00,$9E,$EC,$1F,$BF,$A1,$FF
    14                          DRAGON_S:
    15  086d  040404c9c9c0c001      db          $04,$04,$04,$C9,$C9,$C0,$C0,$01
    16  0875  eda5a09595a001        db          $ED,$A5,$A0,$95,$95,$A0,$01
    17  087c  a092a0f9a0caa0a7      db          $A0,$92,$A0,$F9,$A0,$CA,$A0,$A7,$01
              01                
    18  0885  babfefe901            db          $BA,$BF,$EF,$E9,$01
    19  088a  d9d907abff            db          $D9,$D9,"\a",$AB,$FF
    20  088f  ff                    db          $FF
    21  0890  ff                    db          $FF
    22  0891  ff                    db          $FF
    23  0892  ff                    db          $FF
    24  0893  ff                    db          $FF
    25  0894  ff                    db          $FF
    26  0895  ff                    db          $FF
    27  0896  ff                    db          $FF
    28  0897  ff                    db          $FF
    29  0898  ff                    db          $FF
    30  0899  ff                    db          $FF
    31  089a  ff                    db          $FF
    32  089b  ff                    db          $FF
    33  089c  ff                    db          $FF
    34  089d  ff                    db          $FF
    35  089e  ff                    db          $FF
    36  089f  ff                    db          $FF
    37  08a0  ff                    db          $FF
    38  08a1  ff                    db          $FF
    39  08a2  ff                    db          $FF
    40  08a3  ff                    db          $FF
    41  08a4  ff                    db          $FF
    42  08a5  ff                    db          $FF
    43  08a6  ff                    db          $FF
    44  08a7  ff                    db          $FF
    45  08a8  ff                    db          $FF
    46  08a9  ff                    db          $FF
    47  08aa  ff                    db          $FF
    48  08ab  ff                    db          $FF
    49  08ac  ff                    db          $FF
    50  08ad  ff                    db          $FF
    51  08ae  ff                    db          $FF
    52  08af  ff                    db          $FF
    53  08b0  ff                    db          $FF
    54  08b1  ff                    db          $FF
    55  08b2  ff                    db          $FF
    56  08b3  ff                    db          $FF
    57  08b4  ff                    db          $FF
    58  08b5  ff                    db          $FF
    59  08b6  ff                    db          $FF
    60  08b7  ff                    db          $FF
    61  08b8  ff                    db          $FF
    62  08b9  ff                    db          $FF
    63  08ba  ff                    db          $FF
    64  08bb  ff                    db          $FF
    65  08bc  ff                    db          $FF
    66  08bd  ff                    db          $FF
    67  08be  ff                    db          $FF
    68  08bf  ff                    db          $FF
    69  08c0  ff                    db          $FF
    70  08c1  ff                    db          $FF
    71  08c2  ff                    db          $FF
    72  08c3  ff                    db          $FF
    73  08c4  ff                    db          $FF
    74  08c5  ff                    db          $FF
    75  08c6  ff                    db          $FF
    76  08c7  ff                    db          $FF
    77  08c8  ff                    db          $FF
    78  08c9  ff                    db          $FF
    79  08ca  ff                    db          $FF
    80  08cb  ff                    db          $FF
    81  08cc  ff                    db          $FF
    82  08cd  ff                    db          $FF
    83  08ce  ff                    db          $FF
    84  08cf  ff                    db          $FF
    85  08d0  ff                    db          $FF
    86  08d1  ff                    db          $FF
    87  08d2  ff                    db          $FF
    88  08d3  ff                    db          $FF
    89  08d4  ff                    db          $FF
    90  08d5  ff                    db          $FF
    91  08d6  ff                    db          $FF
    92  08d7  ff                    db          $FF
    93  08d8  ff                    db          $FF
    94  08d9  ff                    db          $FF
    95  08da  ff                    db          $FF
    96  08db  ff                    db          $FF
    97  08dc  ff                    db          $FF
    98  08dd  ff                    db          $FF
    99  08de  ff                    db          $FF
   100  08df  ff                    db          $FF
   101  08e0  ff                    db          $FF
   102  08e1  ff                    db          $FF
   103  08e2  ff                    db          $FF
   104  08e3  ff                    db          $FF
   105  08e4  ff                    db          $FF
   106  08e5  ff                    db          $FF
   107  08e6  ff                    db          $FF
   108  08e7  ff                    db          $FF
   109  08e8  ff                    db          $FF
   110  08e9  ff                    db          $FF
   111  08ea  ff                    db          $FF
   112  08eb  ff                    db          $FF
   113  08ec  ff                    db          $FF
   114  08ed  ff                    db          $FF
   115  08ee  ff                    db          $FF
   116  08ef  ff                    db          $FF
   117  08f0  ff                    db          $FF
   118  08f1  ff                    db          $FF
   119  08f2  ff                    db          $FF
   120  08f3  ff                    db          $FF
   121  08f4  ff                    db          $FF
   122  08f5  ff                    db          $FF
   123  08f6  ff                    db          $FF
   124  08f7  ff                    db          $FF
   125  08f8  ff                    db          $FF
   126  08f9  ff                    db          $FF
   127  08fa  ff                    db          $FF
   128  08fb  ff                    db          $FF
   129  08fc  ff                    db          $FF
   130  08fd  ff                    db          $FF
   131  08fe  ff                    db          $FF
   132  08ff  ff                    db          $FF
   133  0900  ff                    db          $FF
   134  0901  ff                    db          $FF
   135  0902  ff                    db          $FF
   136  0903  ff                    db          $FF
   137  0904  ff                    db          $FF
   138  0905  ff                    db          $FF
   139  0906  ff                    db          $FF
   140  0907  ff                    db          $FF
   141  0908  ff                    db          $FF
   142  0909  ff                    db          $FF
   143  090a  ff                    db          $FF
   144  090b  ff                    db          $FF
   145  090c  ff                    db          $FF
   146  090d  ff                    db          $FF
   147  090e  ff                    db          $FF
   148  090f  ff                    db          $FF
   149  0910  ff                    db          $FF
   150  0911  ff                    db          $FF
   151  0912  ff                    db          $FF
   152                          LEVEL_99_LOOP:
   153  0913  4c6f6f6b73206c69      db          "Looks like this dungeon",$01
              6b65207468697320  
              64756e67656f6e01  
   154  092b  697320746f6f2073      db          "is too small for you",$01
              6d616c6c20666f72  
              20796f7501        
   155  0940  736f207765207769      db          "so we will put you back",$01
              6c6c207075742079  
              6f75206261636b01  
   156  0958  696e746f2061206e      db          "into a new floor #90.",$FF
              657720666c6f6f72  
              202339302eff      
   157                          STATS_TXT:
   158  096e  50485953d6535052      db          "PHYS",$D6,"SPRT",$FF
              54ff              
   159  0978  d600000000486561      db          $D6,$00,$00,$00,$00,"Health",$01
              6c746801          
   160  0984  d600000000536869      db          $D6,$00,$00,$00,$00,"Shield",$01
              656c6401          
   161  0990  d600000000576561      db          $D6,$00,$00,$00,$00,"Weapon",$FF
              706f6eff          
   162  099c  ff                    db          $FF
   163  099d  ff                    db          $FF
   164  099e  ff                    db          $FF
   165  099f  ff                    db          $FF
   166  09a0  ff                    db          $FF
   167  09a1  ff                    db          $FF
   168  09a2  ff                    db          $FF
   169  09a3  ff                    db          $FF
   170  09a4  ff                    db          $FF
   171  09a5  ff                    db          $FF
   172  09a6  ff                    db          $FF
   173  09a7  ff                    db          $FF
   174  09a8  ff                    db          $FF
   175  09a9  ff                    db          $FF
   176  09aa  ff                    db          $FF
   177  09ab  ff                    db          $FF
   178  09ac  ff                    db          $FF
   179  09ad  ff                    db          $FF
   180  09ae  ff                    db          $FF
   181  09af  ff                    db          $FF
   182  09b0  ff                    db          $FF
   183  09b1  ff                    db          $FF
   184  09b2  ff                    db          $FF
   185  09b3  ff                    db          $FF
   186  09b4  ff                    db          $FF
   187  09b5  ff                    db          $FF
   188  09b6  ff                    db          $FF
   189                          POOF_1:
   190  09b7  d7c901                db          $D7,$C9,$01
   191  09ba  c7d9ff                db          $C7,$D9,$FF
   192                          POOF_2:
   193  09bd  d1d101                db          $D1,$D1,$01
   194  09c0  d1d1ff                db          $D1,$D1,$FF
   195                          POOF_3:
   196  09c3  d1d1d1d101            db          $D1,$D1,$D1,$D1,$01
   197  09c8  d1d0d0d101            db          $D1,$D0,$D0,$D1,$01
   198  09cd  d1d0d0d101            db          $D1,$D0,$D0,$D1,$01
   199  09d2  d1d1d1d1ff            db          $D1,$D1,$D1,$D1,$FF
   200                          POOF_4:
   201  09d7  0100d0d001            db          $01,$00,$D0,$D0,$01
   202  09dc  00d0d0ff              db          $00,$D0,$D0,$FF
   203                          POOF_5:
   204  09e0  d0d0d0d001            db          $D0,$D0,$D0,$D0,$01
   205  09e5  d00000d001            db          $D0,$00,$00,$D0,$01
   206  09ea  d00000d001            db          $D0,$00,$00,$D0,$01
   207  09ef  d0d0d0d0ff            db          $D0,$D0,$D0,$D0,$FF
   208                          POOF_6:
   209  09f4  2020202001            db          "    ",$01
   210  09f9  2020202001            db          "    ",$01
   211  09fe  2020202001            db          "    ",$01
   212  0a03  20202020ff            db          "    ",$FF
   213                          RING:
   214  0a08  01010101010101        db          $01,$01,$01,$01,$01,$01,$01
   215  0a0f  006fff                db          $00,"o",$FF
   216                          RING_S:
   217  0a12  010101                db          $01,$01,$01
   218  0a15  00c6ff                db          $00,$C6,$FF
   219                          RING_T:
   220  0a18  002eff                db          $00,".",$FF
   221                          ARROW_FLYING_LEFT:
   222  0a1b  010101010101          db          $01,$01,$01,$01,$01,$01
   223  0a21  9bacff                db          $9B,$AC,$FF
   224                          ARROW_FLYING_RIGHT:
   225  0a24  010101010101          db          $01,$01,$01,$01,$01,$01
   226  0a2a  ac9aff                db          $AC,$9A,$FF
   227                          QUIVER:
   228  0a2d  010101010101          db          $01,$01,$01,$01,$01,$01
   229  0a33  7f7fa0d7a00601        db          $7F,$7F,$A0,$D7,$A0,$06,$01
   230  0a3a  a2acb2e901            db          $A2,$AC,$B2,$E9,$01
   231  0a3f  0000a2a1ff            db          $00,$00,$A2,$A1,$FF
   232                          QUIVER_S:
   233  0a44  0101                  db          $01,$01
   234  0a46  00afbdb001            db          $00,$AF,$BD,$B0,$01
   235  0a4b  0000a2ff              db          $00,$00,$A2,$FF
   236                          QUIVER_T:
   237  0a4f  00f0ff                db          $00,$F0,$FF
   238                          BUCKLER:
   239  0a52  0101010101            db          $01,$01,$01,$01,$01
   240  0a57  d7fcc901              db          $D7,$FC,$C9,$01
   241  0a5b  a098a07f9901          db          $A0,$98,$A0,$7F,$99,$01
   242  0a61  c7afd9ff              db          $C7,$AF,$D9,$FF
   243                          BUCKLER_S:
   244  0a65  0101                  db          $01,$01
   245  0a67  0096ff                db          $00,$96,$FF
   246                          BUCKLER_T:
   247  0a6a  0087ff                db          $00,$87,$FF
   248                          CHALICE:
   249  0a6d  010101010101          db          $01,$01,$01,$01,$01,$01
   250  0a73  a0c3a0899701          db          $A0,$C3,$A0,$89,$97,$01
   251  0a79  009f01                db          $00,$9F,$01
   252  0a7c  e00eb0ff              db          $E0,$0E,$B0,$FF
   253                          CHALICE_S:
   254  0a80  0101                  db          $01,$01
   255  0a82  009f01                db          $00,$9F,$01
   256  0a85  00ccff                db          $00,$CC,$FF
   257                          CHALICE_T:
   258  0a88  0059ff                db          $00,"Y",$FF
   259                          HELMET:
   260  0a8b  010101010101          db          $01,$01,$01,$01,$01,$01
   261  0a91  00c0c101              db          $00,$C0,$C1,$01
   262  0a95  00bfefff              db          $00,$BF,$EF,$FF
   263                          HELMET_S:
   264  0a99  010101                db          $01,$01,$01
   265  0a9c  0400d201              db          $04,$00,$D2,$01
   266  0aa0  00a3ff                db          $00,$A3,$FF
   267                          HELMET_T:
   268  0aa3  005eff                db          $00,"^",$FF
   269                          KEY:
   270  0aa6  010101010101          db          $01,$01,$01,$01,$01,$01
   271  0aac  9090b8c901            db          $90,$90,$B8,$C9,$01
   272  0ab1  10a080a0a9d9ff        db          $10,$A0,$80,$A0,$A9,$D9,$FF
   273                          KEY_S:
   274  0ab8  010101                db          $01,$01,$01
   275  0abb  bcc5ff                db          $BC,$C5,$FF
   276                          KEY_T:
   277  0abe  ff2dff                db          $FF,"-",$FF
   278                          BOW:
   279  0ac1  0101010101            db          $01,$01,$01,$01,$01
   280  0ac6  d7aca38e01            db          $D7,$AC,$A3,$8E,$01
   281  0acb  d600ca01              db          $D6,$00,$CA,$01
   282  0acf  b5ca01                db          $B5,$CA,$01
   283  0ad2  9f00ff                db          $9F,$00,$FF
   284                          BOW_S:
   285  0ad5  0101                  db          $01,$01
   286  0ad7  d7acc901              db          $D7,$AC,$C9,$01
   287  0adb  d6ca01                db          $D6,$CA,$01
   288  0ade  c7ff                  db          $C7,$FF
   289                          BOW_T:
   290  0ae0  007bff                db          $00,"{",$FF
   291                          AXE:
   292  0ae3  0101010101            db          $01,$01,$01,$01,$01
   293  0ae8  007fb701              db          $00,$7F,$B7,$01
   294  0aec  00d99801              db          $00,$D9,$98,$01
   295  0af0  0000b501              db          $00,$00,$B5,$01
   296  0af4  000099ff              db          $00,$00,$99,$FF
   297                          AXE_S:
   298  0af8  0101                  db          $01,$01
   299  0afa  00a0d7a0b701          db          $00,$A0,$D7,$A0,$B7,$01
   300  0b00  00009801              db          $00,$00,$98,$01
   301  0b04  0000b5ff              db          $00,$00,$B5,$FF
   302                          AXE_T:
   303  0b08  0011ff                db          $00,$11,$FF
   304                          FOOD:
   305  0b0b  0101010101            db          $01,$01,$01,$01,$01
   306  0b10  e41ff601              db          $E4,$1F,$F6,$01
   307  0b14  a0c3cbdba09701        db          $A0,$C3,$CB,$DB,$A0,$97,$01
   308  0b1b  00bba01fa0a9ff        db          $00,$BB,$A0,$1F,$A0,$A9,$FF
   309                          FOOD_S:
   310  0b22  0101                  db          $01,$01
   311  0b24  e0beb001              db          $E0,$BE,$B0,$01
   312  0b28  00e9a7ff              db          $00,$E9,$A7,$FF
   313                          FOOD_T:
   314  0b2c  0023ff                db          $00,"#",$FF
   315                          MAP:
   316  0b2f  0101010101            db          $01,$01,$01,$01,$01
   317  0b34  f01fc89801            db          $F0,$1F,$C8,$98,$01
   318  0b39  12c8ccb501            db          $12,$C8,$CC,$B5,$01
   319  0b3e  a0b5a0cdcc1201        db          $A0,$B5,$A0,$CD,$CC,$12,$01
   320  0b45  a099a0cca01ffca0      db          $A0,$99,$A0,$CC,$A0,$1F,$FC,$A0,$FF
              ff                
   321                          MAP_S:
   322  0b4e  0101                  db          $01,$01
   323  0b50  00d701                db          $00,$D7,$01
   324  0b53  c7a0d5a0c901          db          $C7,$A0,$D5,$A0,$C9,$01
   325  0b59  00d9ff                db          $00,$D9,$FF
   326                          MAP_T:
   327  0b5c  00d5ff                db          $00,$D5,$FF
   328                          CHEST:
   329  0b5f  0101010101            db          $01,$01,$01,$01,$01
   330  0b64  9088889001            db          $90,$88,$88,$90,$01
   331  0b69  a090888890a001        db          $A0,$90,$88,$88,$90,$A0,$01
   332  0b70  a0819090a09101        db          $A0,$81,$90,$90,$A0,$91,$01
   333  0b77  a0d7fcfcc9a0ff        db          $A0,$D7,$FC,$FC,$C9,$A0,$FF
   334                          LOCKED_CHEST:
   335  0b7e  0101010101            db          $01,$01,$01,$01,$01
   336  0b83  9088889001            db          $90,$88,$88,$90,$01
   337  0b88  a090888890a001        db          $A0,$90,$88,$88,$90,$A0,$01
   338  0b8f  a081cbdba09101        db          $A0,$81,$CB,$DB,$A0,$91,$01
   339  0b96  a0d7fcfcc9a0ff        db          $A0,$D7,$FC,$FC,$C9,$A0,$FF
   340                          CHEST_S:
   341  0b9d  01e01f1fb001          db          $01,$E0,$1F,$1F,$B0,$01
   342  0ba3  a099a080809801        db          $A0,$99,$A0,$80,$80,$98,$01
   343  0baa  a20000a1ff            db          $A2,$00,$00,$A1,$FF
   344                          CHEST_T:
   345  0baf  00fcff                db          $00,$FC,$FF
   346                          ARMOR:
   347  0bb2  0101010101            db          $01,$01,$01,$01,$01
   348  0bb7  a0c9c7d9d7a001        db          $A0,$C9,$C7,$D9,$D7,$A0,$01
   349  0bbe  ea7f7fb501            db          $EA,$7F,$7F,$B5,$01
   350  0bc3  a0c38888a097ff        db          $A0,$C3,$88,$88,$A0,$97,$FF
   351                          ARMOR_S:
   352  0bca  0101                  db          $01,$01
   353  0bcc  c7a0c7d9a0d901        db          $C7,$A0,$C7,$D9,$A0,$D9,$01
   354  0bd3  007f7f01              db          $00,$7F,$7F,$01
   355  0bd7  00d9c7ff              db          $00,$D9,$C7,$FF
   356                          ARMOR_T:
   357  0bdb  00a0c7d901            db          $00,$A0,$C7,$D9,$01
   358  0be0  0097a0c3ff            db          $00,$97,$A0,$C3,$FF
   359                          PAVICE:
   360  0be5  0101010101            db          $01,$01,$01,$01,$01
   361  0bea  e8f0f0b401            db          $E8,$F0,$F0,$B4,$01
   362  0bef  ea7f7fb501            db          $EA,$7F,$7F,$B5,$01
   363  0bf4  ea7f7fb501            db          $EA,$7F,$7F,$B5,$01
   364  0bf9  00efbfff              db          $00,$EF,$BF,$FF
   365                          PAVICE_S:
   366  0bfd  0101                  db          $01,$01
   367  0bff  00f4f801              db          $00,$F4,$F8,$01
   368  0c03  007f7f01              db          $00,$7F,$7F,$01
   369  0c07  00aba7ff              db          $00,$AB,$A7,$FF
   370                          PAVICE_T:
   371  0c0b  007f01                db          $00,$7F,$01
   372  0c0e  00c2ff                db          $00,$C2,$FF
   373                          AUTHORS:
   374  0c11  2020204f72696769      db          "   Originally programmed by Tom Loughry ",$01
              6e616c6c79207072  
              6f6772616d6d6564  
              20627920546f6d20  
              4c6f756768727920  
              01                
   375  0c3a  20204e6577204746      db          "  New GFX & routines by Sean Harrington ",$FF
              58202620726f7574  
              696e657320627920  
              5365616e20486172  
              72696e67746f6e20  
              ff                
   376                          
   377                          AMULET:
   378  0c63  0101010101            db          $01,$01,$01,$01,$01
   379  0c68  d7acc901              db          $D7,$AC,$C9,$01
   380  0c6c  c7acc8c901            db          $C7,$AC,$C8,$C9,$01
   381  0c71  d7acd9d601            db          $D7,$AC,$D9,$D6,$01
   382  0c76  c7ac05d9ff            db          $C7,$AC,$05,$D9,$FF
   383                          AMULET_S:
   384  0c7b  0101                  db          $01,$01
   385  0c7d  00d7c901              db          $00,$D7,$C9,$01
   386  0c81  00c7c8c901            db          $00,$C7,$C8,$C9,$01
   387  0c86  00cbf1a5ff            db          $00,$CB,$F1,$A5,$FF
   388                          AMULET_T:
   389  0c8b  0026ff                db          $00,"&",$FF
   390                          LADDER:
   391  0c8e  0101010101            db          $01,$01,$01,$01,$01
   392  0c93  ea0000b501            db          $EA,$00,$00,$B5,$01
   393  0c98  eaafafb501            db          $EA,$AF,$AF,$B5,$01
   394  0c9d  fafcfcf501            db          $FA,$FC,$FC,$F5,$01
   395  0ca2  abf0f0a7ff            db          $AB,$F0,$F0,$A7,$FF
   396                          LADDER_S:
   397  0ca7  0101                  db          $01,$01
   398  0ca9  00b4e801              db          $00,$B4,$E8,$01
   399  0cad  d7b7ebc901            db          $D7,$B7,$EB,$C9,$01
   400  0cb2  c7afafd9ff            db          $C7,$AF,$AF,$D9,$FF
   401                          LADDER_T:
   402  0cb7  00cd97ff              db          $00,$CD,$97,$FF
   403                          MACE:
   404  0cbb  0101010101            db          $01,$01,$01,$01,$01
   405  0cc0  009e8e01              db          $00,$9E,$8E,$01
   406  0cc4  00a0c3a09701          db          $00,$A0,$C3,$A0,$97,$01
   407  0cca  00a0c3a09701          db          $00,$A0,$C3,$A0,$97,$01
   408  0cd0  00a099a098ff          db          $00,$A0,$99,$A0,$98,$FF
   409                          MACE_S:
   410  0cd6  0101                  db          $01,$01
   411  0cd8  00e0b001              db          $00,$E0,$B0,$01
   412  0cdc  00a091a08101          db          $00,$A0,$91,$A0,$81,$01
   413  0ce2  00a0c3a097ff          db          $00,$A0,$C3,$A0,$97,$FF
   414                          MACE_T:
   415  0ce8  0054ff                db          $00,"T",$FF
   416                          FIREBALL:
   417  0ceb  0101010101            db          $01,$01,$01,$01,$01
   418  0cf0  bab9e101              db          $BA,$B9,$E1,$01
   419  0cf4  b8beb901              db          $B8,$BE,$B9,$01
   420  0cf8  a8e1b6ff              db          $A8,$E1,$B6,$FF
   421                          FIREBALL_S:
   422  0cfc  0101                  db          $01,$01
   423  0cfe  00d1ff                db          $00,$D1,$FF
   424                          FIREBALL_T:
   425  0d01  00d3ff                db          $00,$D3,$FF
   426                          GFX_BUFFER:
   427  0d04  ff                    db          $FF
   428  0d05  ff                    db          $FF
   429  0d06  ff                    db          $FF
   430  0d07  ff                    db          $FF
   431  0d08  ff                    db          $FF
   432  0d09  ff                    db          $FF
   433  0d0a  ff                    db          $FF
   434  0d0b  ff                    db          $FF
   435  0d0c  ff                    db          $FF
   436  0d0d  ff                    db          $FF
   437  0d0e  ff                    db          $FF
   438  0d0f  ff                    db          $FF
   439  0d10  ff                    db          $FF
   440  0d11  ff                    db          $FF
   441  0d12  ff                    db          $FF
   442  0d13  ff                    db          $FF
   443  0d14  ff                    db          $FF
   444  0d15  ff                    db          $FF
   445  0d16  ff                    db          $FF
   446  0d17  ff                    db          $FF
   447  0d18  ff                    db          $FF
   448  0d19  ff                    db          $FF
   449  0d1a  ff                    db          $FF
   450  0d1b  ff                    db          $FF
   451  0d1c  ff                    db          $FF
   452  0d1d  ff                    db          $FF
   453  0d1e  ff                    db          $FF
   454  0d1f  ff                    db          $FF
   455                          SPIDER:
   456  0d20  0404                  db          $04,$04
   457  0d22  00befd01              db          $00,$BE,$FD,$01
   458  0d26  a099a0f7ee9801        db          $A0,$99,$A0,$F7,$EE,$98,$01
   459  0d2d  02b6b9fbf7e6e901      db          $02,$B6,$B9,$FB,$F7,$E6,$E9,$01
   460  0d35  02f7e6eebdb9fb01      db          $02,$F7,$E6,$EE,$BD,$B9,$FB,$01
   461  0d3d  0212d6a0178ca0d6      db          $02,$12,$D6,$A0,$17,$8C,$A0,$D6,$12,$01
              1201              
   462  0d47  02a099a0c76027d9      db          $02,$A0,$99,$A0,$C7,"`'",$D9,$98,$FF
              98ff              
   463                          SPIDER_S:
   464  0d51  04040404              db          $04,$04,$04,$04
   465  0d55  00d7c901              db          $00,$D7,$C9,$01
   466  0d59  d79585c901            db          $D7,$95,$85,$C9,$01
   467  0d5e  4da0178ca04d01        db          "M",$A0,$17,$8C,$A0,"M",$01
   468  0d65  58602758ff            db          "X`'X",$FF
   469                          MIMIC:
   470  0d6a  0402d796000096c9      db          $04,$02,$D7,$96,$00,$00,$96,$C9,$01
              01                
   471  0d73  0212f01f1ff01201      db          $02,$12,$F0,$1F,$1F,$F0,$12,$01
   472  0d7b  02d611a0178ca00f      db          $02,$D6,$11,$A0,$17,$8C,$A0,$0F,$D6,$01
              d601              
   473  0d85  02c7a0188d188da0      db          $02,$C7,$A0,$18,$8D,$18,$8D,$A0,$D9,$01
              d901              
   474  0d8f  a0819090a09101        db          $A0,$81,$90,$90,$A0,$91,$01
   475  0d96  a0d7fcfcc9a0ff        db          $A0,$D7,$FC,$FC,$C9,$A0,$FF
   476                          MIMIC_S:
   477  0d9d  01e01f1fb001          db          $01,$E0,$1F,$1F,$B0,$01
   478  0da3  a099a080809801        db          $A0,$99,$A0,$80,$80,$98,$01
   479  0daa  a20000a1ff            db          $A2,$00,$00,$A1,$FF
   480                          MALOCCHIO:
   481  0daf  04040404              db          $04,$04,$04,$04
   482  0db3  02a8b0b600b6b001      db          $02,$A8,$B0,$B6,$00,$B6,$B0,$01
   483  0dbb  02b4e5beeeb8e101      db          $02,$B4,$E5,$BE,$EE,$B8,$E1,$01
   484  0dc3  02e27ff6f87fb101      db          $02,$E2,$7F,$F6,$F8,$7F,$B1,$01
   485  0dcb  02a5a014141414a0      db          $02,$A5,$A0,$14,$14,$14,$14,$A0,$EA,$01
              ea01              
   486  0dd5  02e8ab7f7fa7b401      db          $02,$E8,$AB,$7F,$7F,$A7,$B4,$01
   487  0ddd  02c7a40000a8d9ff      db          $02,$C7,$A4,$00,$00,$A8,$D9,$FF
   488                          MALOCCHIO_S:
   489  0de5  04040404              db          $04,$04,$04,$04
   490  0de9  00b6b8e001            db          $00,$B6,$B8,$E0,$01
   491  0dee  e3bee9f101            db          $E3,$BE,$E9,$F1,$01
   492  0df3  b9a08484a0e401        db          $B9,$A0,$84,$84,$A0,$E4,$01
   493  0dfa  a2a6a1a5ff            db          $A2,$A6,$A1,$A5,$FF
   494                          MINOTAUR:
   495  0dff  04040404              db          $04,$04,$04,$04
   496  0e03  e8a1e901              db          $E8,$A1,$E9,$01
   497  0e07  ebefefa101            db          $EB,$EF,$EF,$A1,$01
   498  0e0c  0202e0b8b4fbb1e4      db          $02,$02,$E0,$B8,$B4,$FB,$B1,$E4,$F0,$01
              f001              
   499  0e16  0202f6e6fef4e8ed      db          $02,$02,$F6,$E6,$FE,$F4,$E8,$ED,$FD,$ED,$01
              fded01            
   500  0e21  0202e9b5bfe1eafb      db          $02,$02,$E9,$B5,$BF,$E1,$EA,$FB,$FE,$FB,$01
              fefb01            
   501  0e2c  0202a1e0fe7ffdb9      db          $02,$02,$A1,$E0,$FE,$7F,$FD,$B9,$AD,$A1,$01
              ada101            
   502  0e37  02a27fb4feb70102      db          $02,$A2,$7F,$B4,$FE,$B7,$01,$02,$BE,$B6,$00,$A2,$BE,$B4,$FF
              beb600a2beb4ff    
   503                          MINOTAUR_S:
   504  0e46  04040404              db          $04,$04,$04,$04
   505  0e4a  00edbe01              db          $00,$ED,$BE,$01
   506  0e4e  d7e6b9d201            db          $D7,$E6,$B9,$D2,$01
   507  0e53  0a8eedc201            db          "\n",$8E,$ED,$C2,$01
   508  0e58  001683ff              db          $00,$16,$83,$FF
   509                          SNAKE:
   510  0e5c  040404                db          $04,$04,$04
   511  0e5f  02b8bef7bdb001        db          $02,$B8,$BE,$F7,$BD,$B0,$01
   512  0e66  021111e2e9ea01        db          $02,$11,$11,$E2,$E9,$EA,$01
   513  0e6d  02d7ade1b7b601        db          $02,$D7,$AD,$E1,$B7,$B6,$01
   514  0e74  028d00b6fae0f001      db          $02,$8D,$00,$B6,$FA,$E0,$F0,$01
   515  0e7c  0202b8a6fbb2faf1      db          $02,$02,$B8,$A6,$FB,$B2,$FA,$F1,$A4,$E9,$01
              a4e901            
   516  0e87  0202b5a2eab2b2b4      db          $02,$02,$B5,$A2,$EA,$B2,$B2,$B4,$E0,$E6,$01
              e0e601            
   517  0e92  0202a2aca3e6f2ae      db          $02,$02,$A2,$AC,$A3,$E6,$F2,$AE,$E1,$BB,$FF
              e1bbff            
   518                          SNAKE_S:
   519  0e9d  040404                db          $04,$04,$04
   520  0ea0  00fef901              db          $00,$FE,$F9,$01
   521  0ea4  0022a085a09701        db          $00,"\"",$A0,$85,$A0,$97,$01
   522  0eab  b8b6f6e401            db          $B8,$B6,$F6,$E4,$01
   523  0eb0  e5e7f9e6ff            db          $E5,$E7,$F9,$E6,$FF
   524                          SKELETON:
   525  0eb5  04040404              db          $04,$04,$04,$04
   526  0eb9  028a00eeed01          db          $02,$8A,$00,$EE,$ED,$01
   527  0ebf  02d600a017a0a701      db          $02,$D6,$00,$A0,$17,$A0,$A7,$01
   528  0ec7  02d6e0acb9e401        db          $02,$D6,$E0,$AC,$B9,$E4,$01
   529  0ece  0223a6e2e6a2b401      db          $02,"#",$A6,$E2,$E6,$A2,$B4,$01
   530  0ed6  02d600f8edb02301      db          $02,$D6,$00,$F8,$ED,$B0,"#",$01
   531  0ede  02d6e8a100e501        db          $02,$D6,$E8,$A1,$00,$E5,$01
   532  0ee5  02d6a2e400ba01        db          $02,$D6,$A2,$E4,$00,$BA,$01
   533  0eec  02d600a6a8f1ff        db          $02,$D6,$00,$A6,$A8,$F1,$FF
   534                          SKELETON_S:
   535  0ef3  040404                db          $04,$04,$04
   536  0ef6  08e2a501              db          "\b",$E2,$A5,$01
   537  0efa  cdb8b7b401            db          $CD,$B8,$B7,$B4,$01
   538  0eff  d6b8a9b001            db          $D6,$B8,$A9,$B0,$01
   539  0f04  d6a2e8b1ff            db          $D6,$A2,$E8,$B1,$FF
   540                          MUMMY:
   541  0f09  04040404              db          $04,$04,$04,$04
   542  0f0d  d7fcc901              db          $D7,$FC,$C9,$01
   543  0f11  0202d7c995a093a0      db          $02,$02,$D7,$C9,$95,$A0,$93,$A0,$B4,$00,$D7,$C9,$01
              b400d7c901        
   544  0f1e  0202a097a084a094      db          $02,$02,$A0,$97,$A0,$84,$A0,$94,$84,$94,$A0,$84,$A0,$D9,$A0,$97,$01
              8494a084a0d9a097  
              01                
   545  0f2f  0202a0b5f8c98494      db          $02,$02,$A0,$B5,$F8,$C9,$84,$94,$D2,$D6,$A0,$01
              d2d6a001          
   546  0f3b  0202a0c3a00095a0      db          $02,$02,$A0,$C3,$A0,$00,$95,$A0,$84,$94,$7F,$12,$A0,$01
              84947f12a001      
   547  0f49  0202a091bf94e094      db          $02,$02,$A0,$91,$BF,$94,$E0,$94,$AA,$91,$A0,$01
              aa91a001          
   548  0f55  0295a095a00011a0      db          $02,$95,$A0,$95,$A0,$00,$11,$A0,$95,$A0,$01
              95a001            
   549  0f60  02a0d9a0850027a0      db          $02,$A0,$D9,$A0,$85,$00,"'",$A0,$85,$A0,$C9,$FF
              85a0c9ff          
   550                          MUMMY_S:
   551  0f6c  040404                db          $04,$04,$04
   552  0f6f  1ceab11a01            db          $1C,$EA,$B1,$1A,$01
   553  0f74  11efbf0f01            db          $11,$EF,$BF,$0F,$01
   554  0f79  d6a0d9c7a06001        db          $D6,$A0,$D9,$C7,$A0,"`",$01
   555  0f80  e0b5eab0ff            db          $E0,$B5,$EA,$B0,$FF
   556                          NECROMANCER:
   557  0f85  04040404              db          $04,$04,$04,$04
   558  0f89  02d7d0a0110fa0d0      db          $02,$D7,$D0,$A0,$11,$0F,$A0,$D0,$C9,$01
              c901              
   559  0f93  0202d78dd1a4a4d1      db          $02,$02,$D7,$8D,$D1,$A4,$A4,$D1,$18,$C9,$01
              18c901            
   560  0f9e  0202d6e9a0d9a09c      db          $02,$02,$D6,$E9,$A0,$D9,$A0,$9C,$D7,$A0,$C7,$A0,$B6,$D6,$01
              d7a0c7a0b6d601    
   561  0fad  020212faefa0c2a0      db          $02,$02,$12,$FA,$EF,$A0,$C2,$A0,$7F,$BF,$F5,$12,$01
              7fbff51201        
   562  0fba  0202c7a7e2afedb1      db          $02,$02,$C7,$A7,$E2,$AF,$ED,$B1,$AB,$D9,$01
              abd901            
   563  0fc5  7fa0d6a07ffd01        db          $7F,$A0,$D6,$A0,$7F,$FD,$01
   564  0fcc  02a09920192020a0      db          $02,$A0,$99," ",$19,"  ",$A0,$98,$01,$02,$C7,$A0,$88," ",$90,$F0,$A0,$D9,$FF
              980102c7a0882090  
              f0a0d9ff          
   565                          NECROMANCER_S:
   566  0fe0  040404                db          $04,$04,$04
   567  0fe3  0be2db0c01            db          "\v",$E2,$DB,"\f",$01
   568  0fe8  9fa0c9d7a09f01        db          $9F,$A0,$C9,$D7,$A0,$9F,$01
   569  0fef  00129901              db          $00,$12,$99,$01
   570  0ff3  00fd91ff              db          $00,$FD,$91,$FF
   571  0ff7  ff                    db          $FF
   572  0ff8  ff                    db          $FF
   573  0ff9  ff                    db          $FF
   574  0ffa  ff                    db          $FF
   575  0ffb  ff                    db          $FF
   576  0ffc  ff                    db          $FF
   577  0ffd  ff                    db          $FF
   578  0ffe  ff                    db          $FF
   579  0fff  ff                    db          $FF
   580  1000  ff                    db          $FF
   581  1001  ff                    db          $FF
   582  1002  ff                    db          $FF
   583  1003  ff                    db          $FF
   584  1004  ff                    db          $FF
   585  1005  ff                    db          $FF
   586  1006  ff                    db          $FF
   587  1007  ff                    db          $FF
   588  1008  ff                    db          $FF
   589  1009  ff                    db          $FF
   590  100a  ff                    db          $FF
   591  100b  ff                    db          $FF
   592  100c  ff                    db          $FF
   593  100d  ff                    db          $FF
   594  100e  ff                    db          $FF
   595  100f  ff                    db          $FF
   596  1010  ff                    db          $FF
   597  1011  ff                    db          $FF
   598  1012  ff                    db          $FF
   599  1013  ff                    db          $FF
   600  1014  ff                    db          $FF
   601  1015  ff                    db          $FF
   602  1016  ff                    db          $FF
   603  1017  ff                    db          $FF
   604  1018  ff                    db          $FF
   605  1019  ff                    db          $FF
   606  101a  ff                    db          $FF
   607  101b  ff                    db          $FF
   608  101c  ff                    db          $FF
   609  101d  ff                    db          $FF
   610  101e  ff                    db          $FF
   611  101f  ff                    db          $FF
   612  1020  ff                    db          $FF
   613  1021  ff                    db          $FF
   614  1022  ff                    db          $FF
   615  1023  ff                    db          $FF
   616  1024  ff                    db          $FF
   617  1025  ff                    db          $FF
   618  1026  ff                    db          $FF
   619  1027  ff                    db          $FF
   620  1028  ff                    db          $FF
   621  1029  ff                    db          $FF
   622  102a  ff                    db          $FF
   623  102b  ff                    db          $FF
   624  102c  ff                    db          $FF
   625  102d  ff                    db          $FF
   626  102e  ff                    db          $FF
   627  102f  ff                    db          $FF
   628  1030  ff                    db          $FF
   629  1031  ff                    db          $FF
   630  1032  ff                    db          $FF
   631  1033  ff                    db          $FF
   632  1034  ff                    db          $FF
   633  1035  ff                    db          $FF
   634  1036  ff                    db          $FF
   635  1037  ff                    db          $FF
   636  1038  ff                    db          $FF
   637  1039  ff                    db          $FF
   638  103a  ff                    db          $FF
   639  103b  ff                    db          $FF
   640  103c  ff                    db          $FF
   641  103d  ff                    db          $FF
   642  103e  ff                    db          $FF
   643  103f  ff                    db          $FF
   644  1040  ff                    db          $FF
   645  1041  ff                    db          $FF
   646  1042  ff                    db          $FF
   647  1043  ff                    db          $FF
   648  1044  ff                    db          $FF
   649  1045  ff                    db          $FF
   650  1046  ff                    db          $FF
   651  1047  ff                    db          $FF
   652  1048  ff                    db          $FF
   653  1049  ff                    db          $FF
   654  104a  ff                    db          $FF
   655  104b  ff                    db          $FF
   656  104c  ff                    db          $FF
   657  104d  ff                    db          $FF
   658  104e  ff                    db          $FF
   659  104f  ff                    db          $FF
   660  1050  ff                    db          $FF
   661  1051  ff                    db          $FF
   662  1052  ff                    db          $FF
   663  1053  ff                    db          $FF
   664  1054  ff                    db          $FF
   665  1055  ff                    db          $FF
   666  1056  ff                    db          $FF
   667  1057  ff                    db          $FF
   668  1058  ff                    db          $FF
   669  1059  ff                    db          $FF
   670  105a  ff                    db          $FF
   671  105b  ff                    db          $FF
   672  105c  ff                    db          $FF
   673  105d  ff                    db          $FF
   674  105e  ff                    db          $FF
   675  105f  ff                    db          $FF
   676  1060  ff                    db          $FF
   677  1061  ff                    db          $FF
   678  1062  ff                    db          $FF
   679  1063  ff                    db          $FF
   680  1064  ff                    db          $FF
   681  1065  ff                    db          $FF
   682  1066  ff                    db          $FF
   683  1067  ff                    db          $FF
   684  1068  ff                    db          $FF
   685                          SUB_ram_c869:
   686  1069  112900                LD          DE,$29                                 ;GRN on DKCYN
   687                                                                                  ;(bottom of closed door)
   688                          SUB_ram_c86c:
   689  106c  77                    LD          (HL),A
   690  106d  37                    SCF
   691  106e  3f                    CCF
   692  106f  ed52                  SBC         HL,DE
   693                          SUB_ram_c871:
   694  1071  77                    LD          (HL),A
   695  1072  37                    SCF
   696  1073  3f                    CCF
   697  1074  ed52                  SBC         HL,DE
   698  1076  77                    LD          (HL),A
   699  1077  ed52                  SBC         HL,DE
   700  1079  77                    LD          (HL),A
   701  107a  c9                    RET
   702  107b  112900                LD          DE,$29                                 ;GRN on DKCYN
   703                                                                                  ;(bottom of closed door)
   704                          SUB_ram_c87e:
   705  107e  77                    LD          (HL),A
   706  107f  19                    ADD         HL,DE
   707                          LAB_ram_c880:
   708  1080  77                    LD          (HL),A
   709  1081  19                    ADD         HL,DE
   710  1082  77                    LD          (HL),A
   711  1083  19                    ADD         HL,DE
   712  1084  77                    LD          (HL),A
   713  1085  c9                    RET
   714                          SUB_ram_c886:
   715  1086  77                    LD          (HL),A
   716  1087  19                    ADD         HL,DE
   717  1088  77                    LD          (HL),A
   718  1089  23                    INC         HL
   719  108a  77                    LD          (HL),A
   720  108b  19                    ADD         HL,DE
   721  108c  23                    INC         HL
   722  108d  77                    LD          (HL),A
   723  108e  2b                    DEC         HL
   724  108f  77                    LD          (HL),A
   725  1090  2b                    DEC         HL
   726  1091  77                    LD          (HL),A
   727  1092  c9                    RET
   728                          SUB_ram_c893:
   729  1093  77                    LD          (HL),A
   730  1094  19                    ADD         HL,DE
   731  1095  77                    LD          (HL),A
   732  1096  2b                    DEC         HL
   733  1097  77                    LD          (HL),A
   734  1098  19                    ADD         HL,DE
   735  1099  23                    INC         HL
   736  109a  77                    LD          (HL),A
   737  109b  2b                    DEC         HL
   738  109c  77                    LD          (HL),A
   739  109d  2b                    DEC         HL
   740  109e  77                    LD          (HL),A
   741  109f  c9                    RET
   742                          SUB_ram_c8a0:
   743  10a0  77                    LD          (HL),A
   744  10a1  23                    INC         HL
   745  10a2  77                    LD          (HL),A
   746  10a3  23                    INC         HL
   747  10a4  77                    LD          (HL),A
   748  10a5  19                    ADD         HL,DE
   749  10a6  2b                    DEC         HL
   750  10a7  77                    LD          (HL),A
   751  10a8  2b                    DEC         HL
   752  10a9  77                    LD          (HL),A
   753  10aa  19                    ADD         HL,DE
   754  10ab  77                    LD          (HL),A
   755  10ac  c9                    RET
   756                          SUB_ram_c8ad:
   757  10ad  77                    LD          (HL),A
   758  10ae  23                    INC         HL
   759  10af  77                    LD          (HL),A
   760  10b0  23                    INC         HL
   761  10b1  77                    LD          (HL),A
   762  10b2  19                    ADD         HL,DE
   763  10b3  2b                    DEC         HL
   764  10b4  77                    LD          (HL),A
   765  10b5  23                    INC         HL
   766  10b6  77                    LD          (HL),A
   767  10b7  19                    ADD         HL,DE
   768  10b8  77                    LD          (HL),A
   769  10b9  c9                    RET
   770                          DRAW_ROW:
   771  10ba  77                    LD          (HL),A
   772  10bb  05                    DEC         B
   773  10bc  c8                    RET         Z
   774  10bd  23                    INC         HL
   775  10be  c3ba10                JP          DRAW_ROW
   776  10c1  112800                LD          DE,$28                                 ;DE = 40 (next line) / $28
   777                          DRAW_CELL:
   778  10c4  77                    LD          (HL),A
   779  10c5  0d                    DEC         C
   780  10c6  c8                    RET         Z
   781  10c7  19                    ADD         HL,DE                                   ;Goto next row
   782  10c8  c3c410                JP          DRAW_CELL
   783                          FILL_CHRCOL_RECT:
   784  10cb  112800                LD          DE,$28                                 ;DE = 40 / $28 (next row)
   785                          DRAW_CHRCOLS:
   786  10ce  e5                    PUSH        HL
   787  10cf  c5                    PUSH        BC
   788  10d0  cdba10                CALL        DRAW_ROW
   789  10d3  c1                    POP         BC
   790  10d4  e1                    POP         HL
   791  10d5  0d                    DEC         C
   792  10d6  c8                    RET         Z
   793  10d7  19                    ADD         HL,DE
   794  10d8  c3ce10                JP          DRAW_CHRCOLS
   795  10db  00                    db          $00
   796  10dc  00                    db          $00
   797  10dd  00                    db          $00
   798  10de  00                    db          $00
   799  10df  00                    db          $00
   800  10e0  00                    db          $00
   801  10e1  00                    db          $00
   802  10e2  00                    db          $00
   803  10e3  00                    db          $00
   804  10e4  00                    db          $00
   805  10e5  00                    db          $00
   806  10e6  00                    db          $00
   807  10e7  00                    db          $00
   808  10e8  00                    db          $00
   809  10e9  00                    db          $00
   810  10ea  00                    db          $00
   811  10eb  00                    db          $00
   812  10ec  00                    db          $00
   813  10ed  00                    db          $00
   814  10ee  00                    db          $00
   815  10ef  00                    db          $00
   816  10f0  00                    db          $00
   817  10f1  00                    db          $00
   818  10f2  00                    db          $00
   819  10f3  00                    db          $00
   820  10f4  00                    db          $00
   821  10f5  00                    db          $00
   822  10f6  00                    db          $00
   823  10f7  00                    db          $00
   824                          DRAW_F0_WALL:
   825  10f8  21cc34                LD          HL,COLRAM_F0_WALL_MAP_IDX               ;= $60    `
   826  10fb  011010                LD          BC,$1010                               ;16 x 16 rectangle
   827  10fe  3e44                  LD          A,$44                                  ;BLU on BLU
   828  1100  c3cb10                JP          FILL_CHRCOL_RECT
   829                          DRAW_F0_WALL_AND_CLOSED_DOOR:
   830  1103  cdf810                CALL        DRAW_F0_WALL
   831  1106  3e22                  LD          A,$22                                  ;GRN on GRN
   832                          DRAW_DOOR_F0:
   833  1108  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
   834  110b  010c08                LD          BC,$80c                                ;8 x 12 rectangle
   835  110e  c3cb10                JP          FILL_CHRCOL_RECT
   836                          DRAW_WALL_F0_AND_OPEN_DOOR:
   837  1111  cdf810                CALL        DRAW_F0_WALL
   838  1114  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
   839                                                                                  ;WAS BLK on DKBLU
   840                                                                                  ;WAS LD A,0xb
   841  1116  18f0                  JR          DRAW_DOOR_F0
   842                          DRAW_WALL_F1:
   843  1118  217031                LD          HL,CHRRAM_F1_WALL_IDX                   ;= $20
   844  111b  010808                LD          BC,$808                                ;8 x 8 rectangle
   845  111e  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   846                                                                                  ;WAS d134 / $86 crosshatch char
   847                                                                                  ;WAS LD A, $86
   848  1120  cdcb10                CALL        FILL_CHRCOL_RECT
   849  1123  0e08                  LD          C,0x8
   850  1125  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
   851  1128  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   852  112a  c3ce10                JP          DRAW_CHRCOLS
   853                          DRAW_WALL_F1_AND_CLOSED_DOOR:
   854  112d  cd1811                CALL        DRAW_WALL_F1
   855  1130  3e2d                  LD          A,$2d                                  ;GRN on DKGRN
   856                          DRAW_DOOR_F1_OPEN:
   857  1132  21c235                LD          HL,COLRAM_F1_DOOR_IDX                   ;= $60    `
   858  1135  010604                LD          BC,$406                                ;4 x 6 rectangle
   859  1138  c3cb10                JP          FILL_CHRCOL_RECT
   860                          DRAW_WALL_F1_AND_OPEN_DOOR:
   861  113b  cd1811                CALL        DRAW_WALL_F1
   862  113e  3e00                  LD          A,0x0                                   ;BLK on BLK
   863  1140  18f0                  JR          DRAW_DOOR_F1_OPEN
   864                          DRAW_WALL_F2:
   865  1142  010404                LD          BC,$404                                ;4 x 4 rectangle
   866  1145  21c235                LD          HL,COLRAM_F1_DOOR_IDX                   ;= $60    `
   867  1148  3eff                  LD          A,$ff                                  ;DKGRY on DKGRY
   868                                                                                  ;WAS BLK on DKBLU
   869                                                                                  ;WAS LD A,0xb
   870  114a  c3cb10                JP          FILL_CHRCOL_RECT
   871                          DRAW_DOOR_F2_OPEN:
   872  114d  21c235                LD          HL,COLRAM_F1_DOOR_IDX                   ;= $60    `
   873  1150  3e00                  LD          A,0x0                                   ;BLK on BLK
   874                          UPDATE_FO_ITEM:
   875  1152  010404                LD          BC,$404                                ;4 x 4 rectangle
   876  1155  c3cb10                JP          FILL_CHRCOL_RECT
   877                          DRAW_WALL_FL0:
   878  1158  21a334                LD          HL,COLRAM_FL00_WALL_IDX                 ;= $60    `
   879  115b  3e40                  LD          A,$40                                  ;BLU on BLK
   880                                                                                  ;WAS BLU on CYN
   881                                                                                  ;WAS LD A,$46
   882  115d  cd6910                CALL        SUB_ram_c869
   883  1160  1b                    DEC         DE
   884  1161  19                    ADD         HL,DE
   885  1162  3e04                  LD          A,0x4                                   ;BLK on BLU
   886  1164  cd8610                CALL        SUB_ram_c886
   887  1167  19                    ADD         HL,DE
   888  1168  011004                LD          BC,$410                                ;Jump into COLRAM and down one row
   889  116b  cdce10                CALL        DRAW_CHRCOLS
   890  116e  19                    ADD         HL,DE
   891  116f  cda010                CALL        SUB_ram_c8a0
   892  1172  19                    ADD         HL,DE
   893  1173  3ef4                  LD          A,$f4                                  ;DKGRY on BLU
   894                                                                                  ;WAS DKCYN on BLU
   895                                                                                  ;WAS LD A,$94
   896  1175  1b                    DEC         DE
   897  1176  cd6c10                CALL        SUB_ram_c86c
   898  1179  3ec0                  LD          A,$c0
   899  117b  21c033                LD          HL,DAT_ram_33c0                         ;= $20
   900  117e  cd6c10                CALL        SUB_ram_c86c
   901  1181  212830                LD          HL,IDX_VIEWPORT_CHRRAM                  ;= $20
   902  1184  3ec1                  LD          A,$c1
   903  1186  13                    INC         DE
   904  1187  13                    INC         DE
   905  1188  c37e10                JP          SUB_ram_c87e
   906  118b  c9                    RET
   907                          DRAW_DOOR_FLO:
   908  118c  cd5811                CALL        DRAW_WALL_FL0
   909  118f  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
   910                                                                                  ;WAS DKCYN on DKBLU
   911                                                                                  ;WAS LD A,$9b
   912  1191  08                    EX          AF,AF'
   913  1192  3e04                  LD          A,0x4                                   ;BLK on BLU
   914                                                                                  ;WAS DKBLU on BLU
   915                                                                                  ;LD A,$b4
   916  1194  1808                  JR          LAB_ram_c99e
   917                          SUB_ram_c996:
   918  1196  cd5811                CALL        DRAW_WALL_FL0
   919  1199  3ef2                  LD          A,$f2                                  ;DKGRY on GRN
   920                                                                                  ;WAS DKCYN on GRN
   921                                                                                  ;WAS LD A,$92
   922  119b  08                    EX          AF,AF'
   923  119c  3e24                  LD          A,$24                                  ;GRN on BLU
   924                          LAB_ram_c99e:
   925  119e  211a35                LD          HL,DAT_ram_351a                         ;= $60    `
   926  11a1  cd7110                CALL        SUB_ram_c871
   927  11a4  1b                    DEC         DE
   928  11a5  19                    ADD         HL,DE
   929  11a6  08                    EX          AF,AF'
   930  11a7  cd8610                CALL        SUB_ram_c886
   931  11aa  19                    ADD         HL,DE
   932  11ab  010c03                LD          BC,$30c
   933  11ae  cdce10                CALL        DRAW_CHRCOLS
   934  11b1  19                    ADD         HL,DE
   935  11b2  cda010                CALL        SUB_ram_c8a0
   936  11b5  19                    ADD         HL,DE
   937  11b6  1b                    DEC         DE
   938  11b7  cd7110                CALL        SUB_ram_c871
   939  11ba  21c830                LD          HL,DAT_ram_30c8                         ;= $20
   940  11bd  3ec1                  LD          A,$c1
   941  11bf  13                    INC         DE
   942  11c0  13                    INC         DE
   943  11c1  c38010                JP          LAB_ram_c880
   944  11c4  c9                    RET
   945                          SUB_ram_c9c5:
   946  11c5  21c834                LD          HL,DAT_ram_34c8                         ;= $60    `
   947  11c8  3e04                  LD          A,0x4                                   ;BLK on BLU
   948  11ca  011004                LD          BC,$410                                ;4 x 10 rectangle
   949  11cd  c3cb10                JP          FILL_CHRCOL_RECT
   950                          SUB_ram_c9d0:
   951  11d0  216831                LD          HL,DAT_ram_3168                         ;= $20
   952  11d3  010804                LD          BC,$408                                ;4 x 8 rectangle
   953  11d6  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   954                                                                                  ;WAS d134 / $86 crosshatch char
   955                                                                                  ;WAS LD A, $86
   956  11d8  cdcb10                CALL        FILL_CHRCOL_RECT
   957  11db  216835                LD          HL,DAT_ram_3568                         ;= $60
   958  11de  0e08                  LD          C,0x8
   959  11e0  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   960  11e2  c3ce10                JP          DRAW_CHRCOLS
   961                          SUB_ram_c9e5:
   962  11e5  cdd011                CALL        SUB_ram_c9d0
   963  11e8  3edd                  LD          A,$dd                                  ;DKGRN on DKGRN
   964                          LAB_ram_c9ea:
   965  11ea  21ba35                LD          HL,DAT_ram_35ba                         ;= $60    `
   966  11ed  010602                LD          BC,$206                                ;2 x 6 rectangle
   967  11f0  c3ce10                JP          DRAW_CHRCOLS
   968                          SUB_ram_c9f3:
   969  11f3  cdd011                CALL        SUB_ram_c9d0
   970  11f6  af                    XOR         A
   971  11f7  18f1                  JR          LAB_ram_c9ea
   972                          SUB_ram_c9f9:
   973  11f9  216831                LD          HL,DAT_ram_3168                         ;= $20
   974  11fc  3ec1                  LD          A,$c1
   975  11fe  77                    LD          (HL),A                    ;= $20
   976  11ff  112800                LD          DE,$28
   977  1202  19                    ADD         HL,DE
   978  1203  23                    INC         HL
   979  1204  77                    LD          (HL),A                    ;= $20
   980  1205  215932                LD          HL,DAT_ram_3259                         ;= $20
   981  1208  3ec0                  LD          A,$c0
   982  120a  77                    LD          (HL),A                    ;= $20
   983  120b  19                    ADD         HL,DE
   984  120c  2b                    DEC         HL
   985  120d  77                    LD          (HL),A                    ;= $20
   986  120e  216835                LD          HL,DAT_ram_3568                         ;= $60
   987  1211  3ebf                  LD          A,$bf                                  ;DKBLU on DKGRY
   988                                                                                  ;WAS DKBLU on DKCYN
   989                                                                                  ;WAS LD A,$b9
   990  1213  77                    LD          (HL),A                    ;= $60
   991  1214  19                    ADD         HL,DE
   992  1215  23                    INC         HL
   993  1216  77                    LD          (HL),A                    ;= $60
   994  1217  2b                    DEC         HL
   995  1218  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   996                                                                                  ;WAS BLK on DKBLU
   997                                                                                  ;WAS LD A,0xb
   998  121a  77                    LD          (HL),A                    ;= $60
   999  121b  010402                LD          BC,$204                                ;2 x 4 rectangle
  1000  121e  19                    ADD         HL,DE             ;= $60    `
  1001  121f  cdce10                CALL        DRAW_CHRCOLS
  1002  1222  19                    ADD         HL,DE
  1003  1223  77                    LD          (HL),A                    ;= $60
  1004  1224  23                    INC         HL
  1005  1225  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
  1006                                                                                  ;WAS DKCYN on DKBLU
  1007                                                                                  ;WAS LD A,$9b
  1008  1227  77                    LD          (HL),A                    ;= $60
  1009  1228  19                    ADD         HL,DE
  1010  1229  2b                    DEC         HL
  1011  122a  77                    LD          (HL),A                    ;= $60
  1012  122b  21ba35                LD          HL,DAT_ram_35ba                         ;= $60    `
  1013  122e  0e04                  LD          C,0x4
  1014  1230  3e00                  LD          A,0x0
  1015  1232  c3ce10                JP          DRAW_CHRCOLS
  1016                          DRAW_WALL_FL22:
  1017  1235  21b835                LD          HL,COLRAM_FL22_WALL_IDX                 ;= $60    `
  1018  1238  010404                LD          BC,$404                                ;4 x 4 rectangle
  1019  123b  3eff                  LD          A,$ff                                  ;DKGRY on DKGRY
  1020  123d  c3cb10                JP          FILL_CHRCOL_RECT
  1021                          DRAW_L1_WALL:
  1022  1240  214731                LD          HL,CHRRAM_FL1_WALL_IDX                  ;= $20
  1023  1243  3ec1                  LD          A,$c1                                  ;LEFT angle CHR
  1024  1245  cd6910                CALL        SUB_ram_c869
  1025  1248  1b                    DEC         DE
  1026  1249  19                    ADD         HL,DE
  1027  124a  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
  1028                                                                                  ;WAS d134 / $86 crosshatch char
  1029                                                                                  ;WAS LD A, $86
  1030  124c  cd8610                CALL        SUB_ram_c886
  1031  124f  19                    ADD         HL,DE
  1032  1250  010804                LD          BC,$408                                ;4 x 8 rectangle
  1033  1253  cdce10                CALL        DRAW_CHRCOLS
  1034  1256  19                    ADD         HL,DE
  1035  1257  cda010                CALL        SUB_ram_c8a0
  1036  125a  19                    ADD         HL,DE
  1037  125b  3ec0                  LD          A,$c0                                  ;RIGHT angle CHR
  1038  125d  1b                    DEC         DE
  1039  125e  cd6c10                CALL        SUB_ram_c86c
  1040  1261  214735                LD          HL,DAT_ram_3547                         ;= $60    `
  1041  1264  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
  1042                                                                                  ;WAS DKBLU on CYN
  1043                                                                                  ;WAS LD A,$b6
  1044  1266  cd6910                CALL        SUB_ram_c869
  1045  1269  1b                    DEC         DE
  1046  126a  19                    ADD         HL,DE
  1047  126b  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
  1048  126d  cd8610                CALL        SUB_ram_c886
  1049  1270  19                    ADD         HL,DE
  1050  1271  010804                LD          BC,$408                                ;Jump to COLRAM + 32 cells
  1051  1274  cdce10                CALL        DRAW_CHRCOLS
  1052  1277  19                    ADD         HL,DE
  1053  1278  cda010                CALL        SUB_ram_c8a0
  1054  127b  19                    ADD         HL,DE
  1055  127c  3efb                  LD          A,$fb                                  ;DKGRY on DKBLU
  1056                                                                                  ;WAS DKCYN on DKBLU
  1057                                                                                  ;WAS LD A,$9b
  1058  127e  1b                    DEC         DE
  1059  127f  c36c10                JP          SUB_ram_c86c
  1060  1282  c9                    RET
  1061                          DRAW_FL1_DOOR:
  1062  1283  cd4012                CALL        DRAW_L1_WALL
  1063  1286  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
  1064                                                                                  ;WAS DKCYN on BLK
  1065                                                                                  ;WAS LD A,$90
  1066  1288  f5                    PUSH        AF
  1067  1289  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
  1068  128b  f5                    PUSH        AF
  1069  128c  3e0b                  LD          A,0xb                                   ;BLK on DKGRY
  1070                                                                                  ;WAS BLK on DKBLU
  1071                                                                                  ;WAS LD A,0xb
  1072  128e  180b                  JR          DRAW_L1_DOOR
  1073                          DRAW_L1:
  1074  1290  cd4012                CALL        DRAW_L1_WALL
  1075  1293  3efd                  LD          A,$fd                                  ;DKGRY on DKGRN
  1076                                                                                  ;WAS DKCYN on DKGRN
  1077                                                                                  ;WAS LD A,$9d
  1078  1295  f5                    PUSH        AF
  1079  1296  3e2d                  LD          A,$2d                                  ;GRN on DKGRN
  1080  1298  f5                    PUSH        AF
  1081  1299  3edb                  LD          A,$db                                  ;DKGRN on DKBLU
  1082                          DRAW_L1_DOOR:
  1083  129b  216d35                LD          HL,COLRAM_L1_DOOR_IDX                   ;= $60    `
  1084  129e  010702                LD          BC,$207                                ;2 x 7 rectangle
  1085  12a1  cd1c13                CALL        SUB_ram_cb1c
  1086  12a4  216d31                LD          HL,CHRRAM_L1_DOOR_IDX                   ;= $20
  1087  12a7  3ec1                  LD          A,$c1                                  ;LEFT ANGLE CHR
  1088  12a9  77                    LD          (HL),A              ;= $20
  1089  12aa  112900                LD          DE,$29
  1090  12ad  19                    ADD         HL,DE
  1091  12ae  77                    LD          (HL),A                    ;= $20
  1092  12af  c9                    RET
  1093                          SUB_ram_cab0:
  1094  12b0  216c35                LD          HL,DAT_ram_356c                         ;= $60    `
  1095  12b3  010804                LD          BC,$408                                ;4 x 8 rectangle
  1096  12b6  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
  1097  12b8  cdcb10                CALL        FILL_CHRCOL_RECT
  1098  12bb  216c31                LD          HL,DAT_ram_316c                         ;= $20
  1099  12be  0e08                  LD          C,0x8
  1100  12c0  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
  1101                                                                                  ;WAS d134 / $86 crosshatch char
  1102                                                                                  ;WAS LD A, $86
  1103  12c2  c3ce10                JP          DRAW_CHRCOLS
  1104                          SUB_ram_cac5:
  1105  12c5  cdb012                CALL        SUB_ram_cab0
  1106  12c8  af                    XOR         A
  1107  12c9  1805                  JR          DRAW_L1_DOOR_2
  1108                          DRAW_L1_DOOR_CLOSED:
  1109  12cb  cdb012                CALL        SUB_ram_cab0
  1110  12ce  3edd                  LD          A,$dd                                  ;DKGRN on DKGRN
  1111                          DRAW_L1_DOOR_2:
  1112  12d0  21bc35                LD          HL,COLRAM_FL2_WALL_IDX                  ;= $60    `
  1113  12d3  010602                LD          BC,$206                                ;2 x 6 rectangle
  1114  12d6  c3ce10                JP          DRAW_CHRCOLS
  1115                          DRAW_WALL_FL2:
  1116  12d9  21bc35                LD          HL,COLRAM_FL2_WALL_IDX                  ;= $60    `
  1117  12dc  010402                LD          BC,$204                                ;2 x 4 rectangle
  1118  12df  3e11                  LD          A,$11                                  ;BLK on DKGRY
  1119  12e1  cdcb10                CALL        FILL_CHRCOL_RECT
  1120  12e4  0e04                  LD          C,0x4
  1121  12e6  21be35                LD          HL,COLRAM_FL2_PLUS_WALL_IDX             ;= $60    `
  1122  12e9  3e22                  LD          A,$22                                  ;BLK on DKGRY
  1123                                                                                  ;WAS BLK on DKBLU
  1124                                                                                  ;WAS LD A,0xb
  1125  12eb  c3ce10                JP          DRAW_CHRCOLS
  1126                          DRAW_WALL_FL2_EMPTY:
  1127  12ee  21bc35                LD          HL,COLRAM_FL2_WALL_IDX                  ;= $60    `
  1128  12f1  010404                LD          BC,$404                                ;4 x 4 rectangle
  1129  12f4  3e00                  LD          A,0x0                                   ;BLK on BLK
  1130  12f6  c3cb10                JP          FILL_CHRCOL_RECT
  1131                          DRAW_WALL_L2:
  1132  12f9  3eca                  LD          A,$ca                                  ;Right slash char
  1133  12fb  f5                    PUSH        AF
  1134  12fc  3e20                  LD          A,$20                                  ;GRN on BLK
  1135  12fe  f5                    PUSH        AF
  1136  12ff  217031                LD          HL,CHRRAM_F1_WALL_IDX                   ;= $20
  1137  1302  3ec1                  LD          A,$c1                                  ;Left angle char
  1138  1304  010402                LD          BC,$204                                ;2 x 4 rectangle
  1139  1307  cd1c13                CALL        SUB_ram_cb1c
  1140  130a  3e0f                  LD          A,0xf                                   ;FL2 Bottom Color
  1141                                                                                  ;BLK on DKGRY
  1142                                                                                  ;WAS DKCYN on DKBLU
  1143                                                                                  ;WAS LD A,$9b
  1144  130c  f5                    PUSH        AF
  1145  130d  3e0f                  LD          A,0xf                                   ;FL2 Wall Color
  1146                                                                                  ;BLK on DKGRY
  1147                                                                                  ;WAS BLK on DKBLU
  1148                                                                                  ;WAS LD A,0xb
  1149  130f  f5                    PUSH        AF
  1150  1310  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
  1151  1313  3ef0                  LD          A,$f0                                  ;FL2 Top Color
  1152                                                                                  ;DKGRY on BLK
  1153                                                                                  ;WAS DKBLU on CYN
  1154                                                                                  ;WAS LD A,$b6
  1155  1315  010402                LD          BC,$204                                ;2 x 4 rectangle
  1156  1318  cd1c13                CALL        SUB_ram_cb1c
  1157  131b  c9                    RET
  1158                          SUB_ram_cb1c:
  1159  131c  dde1                  POP         IX
  1160  131e  77                    LD          (HL),A
  1161  131f  112900                LD          DE,$29                                 ;EDIT MEdb?
  1162  1322  19                    ADD         HL,DE
  1163  1323  77                    LD          (HL),A
  1164  1324  2b                    DEC         HL
  1165  1325  1b                    DEC         DE
  1166  1326  f1                    POP         AF
  1167  1327  77                    LD          (HL),A
  1168  1328  19                    ADD         HL,DE
  1169  1329  cdce10                CALL        DRAW_CHRCOLS
  1170  132c  19                    ADD         HL,DE
  1171  132d  77                    LD          (HL),A
  1172  132e  19                    ADD         HL,DE
  1173  132f  f1                    POP         AF
  1174  1330  77                    LD          (HL),A
  1175  1331  37                    SCF
  1176  1332  3f                    CCF
  1177  1333  ed52                  SBC         HL,DE
  1178  1335  23                    INC         HL
  1179  1336  77                    LD          (HL),A
  1180  1337  dde9                  JP          (IX)
  1181                          DRAW_WALL_L2_C:
  1182  1339  21c035                LD          HL,DAT_ram_35c0                         ;= $60    `
  1183  133c  010402                LD          BC,$204                                ;2 x 4 rectangle
  1184  133f  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
  1185                                                                                  ;WAS BLK on DKBLU
  1186                                                                                  ;WAS LD A,0xb
  1187  1341  c3cb10                JP          FILL_CHRCOL_RECT
  1188                          DRAW_WALL_L2_C_EMPTY:
  1189  1344  21c035                LD          HL,DAT_ram_35c0                         ;= $60    `
  1190  1347  010402                LD          BC,$204                                ;2 x 4 rectangle
  1191  134a  3e00                  LD          A,0x0                                   ;BLK on BLK
  1192  134c  c3cb10                JP          FILL_CHRCOL_RECT
  1193                          SUB_ram_cb4f:
  1194  134f  3ef4                  LD          A,$f4                                  ;DKGRY on BLU
  1195                                                                                  ;WAS DKCYN on BLU
  1196                                                                                  ;WAS LD A,$94
  1197  1351  f5                    PUSH        AF
  1198  1352  011004                LD          BC,$410
  1199  1355  3e04                  LD          A,0x4                                   ;BLK on BLU
  1200  1357  f5                    PUSH        AF
  1201  1358  3e40                  LD          A,$40                                  ;BLU on BLK
  1202                                                                                  ;WAS BLU on CYN
  1203                                                                                  ;WAS LD A, $46
  1204  135a  21b434                LD          HL,DAT_ram_34b4                         ;= $60    `
  1205  135d  cd4d14                CALL        SUB_ram_cc4d
  1206  1360  213f30                LD          HL,DAT_ram_303f                         ;= $20
  1207  1363  3ec0                  LD          A,$c0                                  ;Right angle char
  1208  1365  112700                LD          DE,$27
  1209  1368  cd7e10                CALL        SUB_ram_c87e
  1210  136b  215c33                LD          HL,DAT_ram_335c                         ;= $20
  1211  136e  3c                    INC         A
  1212  136f  13                    INC         DE
  1213  1370  13                    INC         DE
  1214  1371  c37e10                JP          SUB_ram_c87e
  1215                          DRAW_FRO_DOOR:
  1216  1374  cd4f13                CALL        SUB_ram_cb4f
  1217  1377  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
  1218                                                                                  ;WAS DKCYN on DKBLU
  1219                                                                                  ;WAS LD A,$9b
  1220  1379  08                    EX          AF,AF'
  1221  137a  3e04                  LD          A,0x4                                   ;BLK on BLU
  1222                                                                                  ;WAS DKBLU on BLU
  1223                                                                                  ;WAS LDA A,$b4
  1224  137c  1808                  JR          LAB_ram_cb86
  1225                          SUB_ram_cb7e:
  1226  137e  cd4f13                CALL        SUB_ram_cb4f
  1227  1381  3ef2                  LD          A,$f2                                  ;DKGRY on GRN
  1228                                                                                  ;WAS DKCYN on GRN
  1229                                                                                  ;WAS LD A,$92
  1230  1383  08                    EX          AF,AF'
  1231  1384  3e24                  LD          A,$24                                  ;GRN on BLU
  1232                          LAB_ram_cb86:
  1233  1386  212d35                LD          HL,DAT_ram_352d                         ;= $60    `
  1234  1389  1b                    DEC         DE
  1235  138a  1b                    DEC         DE
  1236  138b  cd7110                CALL        SUB_ram_c871
  1237  138e  13                    INC         DE
  1238  138f  19                    ADD         HL,DE
  1239  1390  08                    EX          AF,AF'
  1240  1391  cd9310                CALL        SUB_ram_c893
  1241  1394  19                    ADD         HL,DE
  1242  1395  010c03                LD          BC,$30c
  1243  1398  cdce10                CALL        DRAW_CHRCOLS
  1244  139b  19                    ADD         HL,DE
  1245  139c  cdad10                CALL        SUB_ram_c8ad
  1246  139f  19                    ADD         HL,DE
  1247  13a0  13                    INC         DE
  1248  13a1  cd7110                CALL        SUB_ram_c871
  1249  13a4  21df30                LD          HL,DAT_ram_30df                         ;= $20
  1250  13a7  3ec0                  LD          A,$c0                                  ;Right angle char
  1251  13a9  1b                    DEC         DE
  1252  13aa  1b                    DEC         DE
  1253  13ab  c38010                JP          LAB_ram_c880
  1254                          SUB_ram_cbae:
  1255  13ae  21dc34                LD          HL,DAT_ram_34dc                         ;= $60    `
  1256  13b1  3e04                  LD          A,0x4                                   ;BLK on BLU
  1257  13b3  011004                LD          BC,$410                                ;4 x 10 rectangle
  1258  13b6  c3cb10                JP          FILL_CHRCOL_RECT
  1259                          SUB_ram_cbb9:
  1260  13b9  217c31                LD          HL,DAT_ram_317c                         ;= $20
  1261  13bc  010804                LD          BC,$408
  1262  13bf  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
  1263                                                                                  ;WAS d134 / $86 crosshatch char
  1264                                                                                  ;WAS LD A, $86
  1265  13c1  cdcb10                CALL        FILL_CHRCOL_RECT
  1266  13c4  217c35                LD          HL,DAT_ram_357c                         ;= $60    `
  1267  13c7  0e08                  LD          C,0x8
  1268  13c9  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
  1269  13cb  c3ce10                JP          DRAW_CHRCOLS
  1270                          SUB_ram_cbce:
  1271  13ce  cdb913                CALL        SUB_ram_cbb9
  1272  13d1  af                    XOR         A
  1273  13d2  1805                  JR          LAB_ram_cbd9
  1274                          SUB_ram_cbd4:
  1275  13d4  cdb913                CALL        SUB_ram_cbb9
  1276  13d7  3edd                  LD          A,$dd                                  ;DKGRN on DKGRNdb?
  1277                          LAB_ram_cbd9:
  1278  13d9  21cc35                LD          HL,DAT_ram_35cc                         ;= $60    `
  1279  13dc  010602                LD          BC,$206                                ;2 x 6 rectangledb?
  1280  13df  c3ce10                JP          DRAW_CHRCOLS
  1281                          SUB_ram_cbe2:
  1282  13e2  217f31                LD          HL,DAT_ram_317f                         ;= $20
  1283  13e5  3ec0                  LD          A,$c0                                  ;Right angle char
  1284  13e7  77                    LD          (HL),A                    ;= $20
  1285  13e8  112800                LD          DE,$28
  1286  13eb  19                    ADD         HL,DE
  1287  13ec  2b                    DEC         HL
  1288  13ed  77                    LD          (HL),A                    ;= $20
  1289  13ee  216e32                LD          HL,DAT_ram_326e                         ;= $20
  1290  13f1  3ec1                  LD          A,$c1                                  ;Left angle char
  1291  13f3  77                    LD          (HL),A                    ;= $20
  1292  13f4  19                    ADD         HL,DE
  1293  13f5  23                    INC         HL
  1294  13f6  77                    LD          (HL),A                    ;= $20
  1295  13f7  217f35                LD          HL,DAT_ram_357f                         ;= $60
  1296  13fa  3ebf                  LD          A,$bf                                  ;DKBLU on DKGRY
  1297                                                                                  ;WAS DKBLU on DKCYN
  1298                                                                                  ;WAS LD A,$b9
  1299  13fc  77                    LD          (HL),A                    ;= $60
  1300  13fd  19                    ADD         HL,DE
  1301  13fe  2b                    DEC         HL
  1302  13ff  77                    LD          (HL),A                    ;= $60
  1303  1400  23                    INC         HL
  1304  1401  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
  1305                                                                                  ;WAS BLK on DKBLU
  1306                                                                                  ;WAS LD A,0xb
  1307  1403  77                    LD          (HL),A                    ;= $60
  1308  1404  010402                LD          BC,$204                                ;2 x 4 rectangle
  1309  1407  19                    ADD         HL,DE
  1310  1408  2b                    DEC         HL                        ;= $60    `
  1311  1409  cdce10                CALL        DRAW_CHRCOLS
  1312  140c  19                    ADD         HL,DE
  1313  140d  23                    INC         HL
  1314  140e  77                    LD          (HL),A                    ;= $60
  1315  140f  2b                    DEC         HL
  1316  1410  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
  1317                                                                                  ;WAS DKCYN on DKBLU
  1318                                                                                  ;WAS LD A,$9b
  1319  1412  77                    LD          (HL),A                    ;= $60
  1320  1413  19                    ADD         HL,DE
  1321  1414  23                    INC         HL
  1322  1415  77                    LD          (HL),A                    ;= $60
  1323  1416  21cc35                LD          HL,DAT_ram_35cc                         ;= $60    `
  1324  1419  0e04                  LD          C,0x4
  1325  141b  3e00                  LD          A,0x0
  1326  141d  c3ce10                JP          DRAW_CHRCOLS
  1327                          DRAW_WALL_FR222_EMPTY:
  1328  1420  21cc35                LD          HL,DAT_ram_35cc                         ;= $60    `
  1329  1423  010404                LD          BC,$404                                ;4 x 4 rectangle
  1330  1426  3e00                  LD          A,0x0                                   ;BLK on BLK
  1331  1428  c3cb10                JP          FILL_CHRCOL_RECT
  1332                          DRAW_WALL_FR1:
  1333  142b  3ec1                  LD          A,$c1
  1334  142d  f5                    PUSH        AF
  1335  142e  010804                LD          BC,$408                                ;4 x 8 rectangle
  1336  1431  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
  1337                                                                                  ;WAS d134 / $86 crosshatch char
  1338                                                                                  ;WAS LD A, $86
  1339  1433  f5                    PUSH        AF
  1340  1434  3ec0                  LD          A,$c0                                  ;Right angle char
  1341  1436  215031                LD          HL,DAT_ram_3150                         ;= $20
  1342  1439  cd4d14                CALL        SUB_ram_cc4d
  1343  143c  3efb                  LD          A,$fb                                  ;DKGRY on DKBLU
  1344                                                                                  ;WAS DKCYN on DKBLU
  1345                                                                                  ;WAS LD $9b
  1346  143e  f5                    PUSH        AF
  1347  143f  0e08                  LD          C,0x8
  1348  1441  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
  1349  1443  f5                    PUSH        AF
  1350  1444  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
  1351                                                                                  ;WAS DKBLU on CYN
  1352                                                                                  ;WAS LD A,$b6
  1353  1446  215035                LD          HL,DAT_ram_3550                         ;= $60    `
  1354  1449  cd4d14                CALL        SUB_ram_cc4d
  1355  144c  c9                    RET
  1356                          SUB_ram_cc4d:
  1357  144d  dde1                  POP         IX
  1358  144f  112700                LD          DE,$27
  1359  1452  cd6c10                CALL        SUB_ram_c86c
  1360  1455  13                    INC         DE
  1361  1456  19                    ADD         HL,DE
  1362  1457  f1                    POP         AF
  1363  1458  cd9310                CALL        SUB_ram_c893
  1364  145b  19                    ADD         HL,DE
  1365  145c  2b                    DEC         HL
  1366  145d  cdce10                CALL        DRAW_CHRCOLS
  1367  1460  19                    ADD         HL,DE
  1368  1461  23                    INC         HL
  1369  1462  cdad10                CALL        SUB_ram_c8ad
  1370  1465  19                    ADD         HL,DE
  1371  1466  f1                    POP         AF
  1372  1467  13                    INC         DE
  1373  1468  cd6c10                CALL        SUB_ram_c86c
  1374  146b  dde9                  JP          (IX)
  1375                          SUB_ram_cc6d:
  1376  146d  cd2b14                CALL        DRAW_WALL_FR1
  1377  1470  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
  1378                                                                                  ;WAS DKCYN on BLK
  1379                                                                                  ;WAS LD A,$90
  1380  1472  f5                    PUSH        AF
  1381  1473  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
  1382  1475  f5                    PUSH        AF
  1383  1476  3e0b                  LD          A,0xb                                   ;BLK on DKBLU
  1384  1478  180b                  JR          LAB_ram_cc85
  1385                          SUB_ram_cc7a:
  1386  147a  cd2b14                CALL        DRAW_WALL_FR1
  1387  147d  3efd                  LD          A,$fd                                  ;DKGRY on DKGRN
  1388                                                                                  ;WAS DKCYN on DKGRN
  1389                                                                                  ;WAS LD A,$9d
  1390  147f  f5                    PUSH        AF
  1391  1480  3e2d                  LD          A,$2d                                  ;GRN on DKGRN
  1392  1482  f5                    PUSH        AF
  1393  1483  3edb                  LD          A,$db                                  ;DKGRN on DKBLU
  1394                          LAB_ram_cc85:
  1395  1485  217a35                LD          HL,DAT_ram_357a                         ;= $60    `
  1396  1488  010702                LD          BC,$207                                ;2 x 7 rectangle
  1397  148b  cd0715                CALL        SUB_ram_cd07
  1398  148e  217a31                LD          HL,DAT_ram_317a                         ;= $20
  1399  1491  3ec0                  LD          A,$c0                                  ;Right angle char
  1400  1493  77                    LD          (HL),A                    ;= $20
  1401  1494  112700                LD          DE,$27
  1402  1497  19                    ADD         HL,DE
  1403  1498  77                    LD          (HL),A                    ;= $20
  1404  1499  c9                    RET
  1405                          SUB_ram_cc9a:
  1406  149a  217835                LD          HL,DAT_ram_3578                         ;= $60    `
  1407  149d  010804                LD          BC,$408                                ;4 x 8 rectangle
  1408  14a0  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
  1409  14a2  cdcb10                CALL        FILL_CHRCOL_RECT
  1410  14a5  217831                LD          HL,DAT_ram_3178                         ;= $20
  1411  14a8  0e08                  LD          C,0x8
  1412  14aa  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
  1413                                                                                  ;WAS d134 / $86 crosshatch char
  1414                                                                                  ;WAS LD A, $86
  1415  14ac  c3ce10                JP          DRAW_CHRCOLS
  1416                          SUB_ram_ccaf:
  1417  14af  cd9a14                CALL        SUB_ram_cc9a
  1418  14b2  af                    XOR         A
  1419  14b3  1805                  JR          LAB_ram_ccba
  1420                          SUB_ram_ccb5:
  1421  14b5  cd9a14                CALL        SUB_ram_cc9a
  1422  14b8  3edd                  LD          A,$dd                                  ;DKGRN on DKGRN
  1423                          LAB_ram_ccba:
  1424  14ba  21ca35                LD          HL,DAT_ram_35ca                         ;= $60    `
  1425  14bd  010602                LD          BC,$206                                ;2 x 6 rectangle
  1426  14c0  c3ce10                JP          DRAW_CHRCOLS
  1427                          SUB_ram_ccc3:
  1428  14c3  21ca35                LD          HL,DAT_ram_35ca                         ;= $60    `
  1429  14c6  010402                LD          BC,$204                                ;2 x 4 rectangle
  1430  14c9  3e00                  LD          A,0x0                                   ;BLK on BLK
  1431  14cb  cdcb10                CALL        FILL_CHRCOL_RECT
  1432  14ce  0e04                  LD          C,0x4
  1433  14d0  21c835                LD          HL,DAT_ram_35c8                         ;= $60    `
  1434  14d3  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
  1435                                                                                  ;WAS BLK on DKBLU
  1436                                                                                  ;WAS LD A, 0xb
  1437  14d5  c3ce10                JP          DRAW_CHRCOLS
  1438                          DRAW_WALL_FR2_EMPTY:
  1439  14d8  21c835                LD          HL,DAT_ram_35c8                         ;= $60    `
  1440  14db  010404                LD          BC,$404                                ;4 x 4 rectangle
  1441  14de  3e00                  LD          A,0x0                                   ;BLK on BLK
  1442  14e0  c3cb10                JP          FILL_CHRCOL_RECT
  1443                          DRAW_WALL_FR2:
  1444  14e3  3e0f                  LD          A,0xf                                   ;FR2 Bottom
  1445                                                                                  ;BLK on DKGRY
  1446                                                                                  ;WAS DKCYN on DKBLU
  1447                                                                                  ;WAS LD A,$9b
  1448  14e5  f5                    PUSH        AF
  1449  14e6  3e0f                  LD          A,0xf                                   ;FR2 Wall
  1450                                                                                  ;BLK on DKGRY
  1451                                                                                  ;WAS BLK on DKBLU
  1452                                                                                  ;WAS LD A,0xb
  1453  14e8  f5                    PUSH        AF
  1454  14e9  3ef0                  LD          A,$f0                                  ;FR2 Top
  1455                                                                                  ;DKGRY on BLK
  1456                                                                                  ;WAS DKBLU on CYN
  1457                                                                                  ;WAS LD A,$b6
  1458  14eb  217735                LD          HL,DAT_ram_3577                         ;= $60    `
  1459  14ee  010402                LD          BC,$204                                ;2 x 4 rectangle
  1460  14f1  cd0715                CALL        SUB_ram_cd07
  1461  14f4  216632                LD          HL,DAT_ram_3266                         ;= $20
  1462  14f7  3eda                  LD          A,$da                                  ;Left slash char
  1463  14f9  77                    LD          (HL),A                    ;= $20
  1464  14fa  19                    ADD         HL,DE
  1465  14fb  77                    LD          (HL),A                    ;= $20
  1466  14fc  217731                LD          HL,DAT_ram_3177                         ;= $20
  1467  14ff  3ec0                  LD          A,$c0                                  ;Right angle char
  1468  1501  77                    LD          (HL),A                    ;= $20
  1469  1502  1b                    DEC         DE
  1470  1503  1b                    DEC         DE
  1471  1504  19                    ADD         HL,DE
  1472  1505  77                    LD          (HL),A                    ;= $20
  1473  1506  c9                    RET
  1474                          SUB_ram_cd07:
  1475  1507  dde1                  POP         IX
  1476  1509  77                    LD          (HL),A
  1477  150a  112700                LD          DE,$27
  1478  150d  19                    ADD         HL,DE
  1479  150e  77                    LD          (HL),A
  1480  150f  23                    INC         HL
  1481  1510  f1                    POP         AF
  1482  1511  77                    LD          (HL),A
  1483  1512  19                    ADD         HL,DE
  1484  1513  13                    INC         DE
  1485  1514  cdce10                CALL        DRAW_CHRCOLS
  1486  1517  13                    INC         DE
  1487  1518  19                    ADD         HL,DE
  1488  1519  77                    LD          (HL),A
  1489  151a  2b                    DEC         HL
  1490  151b  f1                    POP         AF
  1491  151c  77                    LD          (HL),A
  1492  151d  19                    ADD         HL,DE
  1493  151e  77                    LD          (HL),A
  1494  151f  dde9                  JP          (IX)
  1495                          SUB_ram_cd21:
  1496  1521  21c635                LD          HL,DAT_ram_35c6                         ;= $60    `
  1497  1524  010402                LD          BC,$204                                ;2 x 4 rectangle
  1498  1527  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
  1499                                                                                  ;WAS BLK on DKBLU
  1500                                                                                  ;WAS LD A,0xb
  1501  1529  c3cb10                JP          FILL_CHRCOL_RECT
  1502                          SUB_ram_cd2c:
  1503  152c  21c635                LD          HL,DAT_ram_35c6                         ;= $60    `
  1504  152f  010402                LD          BC,$204                                ;2 x 4 rectangle
  1505  1532  3e00                  LD          A,0x0                                   ;BLK on BLK
  1506  1534  c3cb10                JP          FILL_CHRCOL_RECT
  1507  1537  3e08                  LD          A,0x8
  1508  1539  32b83a                LD          (SOUND_REPEAT_COUNT),A
  1509  153c  47                    LD          B,A
  1510                          LAB_ram_cd3d:
  1511  153d  c5                    PUSH        BC
  1512  153e  cd5c16                CALL        SOUND_04
  1513  1541  cde715                CALL        SUB_ram_cde7
  1514  1544  cd3416                CALL        SOUND_02
  1515  1547  cd2016                CALL        SOUND_01
  1516  154a  c1                    POP         BC
  1517  154b  10f0                  DJNZ        LAB_ram_cd3d
  1518  154d  c9                    RET
  1519  154e  3e07                  LD          A,0x7
  1520  1550  32b83a                LD          (SOUND_REPEAT_COUNT),A
  1521  1553  47                    LD          B,A
  1522                          LAB_ram_cd54:
  1523  1554  c5                    PUSH        BC
  1524  1555  cd3416                CALL        SOUND_02
  1525  1558  cd4816                CALL        SOUND_03
  1526  155b  c1                    POP         BC
  1527  155c  10f6                  DJNZ        LAB_ram_cd54
  1528  155e  c9                    RET
  1529                          SUB_ram_cd5f:
  1530  155f  3e0a                  LD          A,0xa
  1531  1561  32b83a                LD          (SOUND_REPEAT_COUNT),A
  1532  1564  47                    LD          B,A
  1533                          LAB_ram_cd65:
  1534  1565  c5                    PUSH        BC
  1535  1566  cd5c16                CALL        SOUND_04
  1536  1569  cd7016                CALL        SOUND_05
  1537  156c  c1                    POP         BC
  1538  156d  10f6                  DJNZ        LAB_ram_cd65
  1539  156f  c3bf15                JP          SUB_ram_cdbf
  1540                          POOF_SOUND:
  1541  1572  3e07                  LD          A,0x7
  1542  1574  32b83a                LD          (SOUND_REPEAT_COUNT),A
  1543  1577  0601                  LD          B,0x1
  1544  1579  1806                  JR          DOINK_SOUND
  1545                          END_OF_GAME_SOUND:
  1546  157b  3e04                  LD          A,0x4                                   ;Was LD A,0x7
  1547  157d  32b83a                LD          (SOUND_REPEAT_COUNT),A
  1548  1580  47                    LD          B,A
  1549                          DOINK_SOUND:
  1550  1581  c5                    PUSH        BC
  1551  1582  cd3416                CALL        SOUND_02
  1552  1585  cde715                CALL        SUB_ram_cde7
  1553  1588  cd4816                CALL        SOUND_03
  1554  158b  c1                    POP         BC
  1555  158c  10f3                  DJNZ        DOINK_SOUND
  1556  158e  c9                    RET
  1557  158f  cde715                CALL        SUB_ram_cde7
  1558  1592  cde715                CALL        SUB_ram_cde7
  1559  1595  cde715                CALL        SUB_ram_cde7
  1560  1598  cde715                CALL        SUB_ram_cde7
  1561  159b  cde715                CALL        SUB_ram_cde7
  1562  159e  cde715                CALL        SUB_ram_cde7
  1563  15a1  cde715                CALL        SUB_ram_cde7
  1564  15a4  cde715                CALL        SUB_ram_cde7
  1565  15a7  cde715                CALL        SUB_ram_cde7
  1566  15aa  cde715                CALL        SUB_ram_cde7
  1567  15ad  cde715                CALL        SUB_ram_cde7
  1568  15b0  cd7016                CALL        SOUND_05
  1569  15b3  cd7016                CALL        SOUND_05
  1570  15b6  cd7016                CALL        SOUND_05
  1571  15b9  cd7016                CALL        SOUND_05
  1572  15bc  c37016                JP          SOUND_05
  1573                          SUB_ram_cdbf:
  1574  15bf  3e00                  LD          A,0x0
  1575  15c1  f5                    PUSH        AF
  1576  15c2  014000                LD          BC,$40
  1577  15c5  111500                LD          DE,$15
  1578  15c8  210004                LD          HL,$400
  1579  15cb  3e00                  LD          A,0x0
  1580  15cd  32b53a                LD          (PITCH_UP_BOOL),A
  1581  15d0  c38416                JP          PLAY_PITCH_CHANGE
  1582                          SUB_ram_cdd3:
  1583  15d3  3e00                  LD          A,0x0
  1584  15d5  f5                    PUSH        AF
  1585  15d6  01a000                LD          BC,$a0
  1586  15d9  110800                LD          DE,0x8
  1587  15dc  210008                LD          HL,$800
  1588  15df  3e00                  LD          A,0x0
  1589  15e1  32b53a                LD          (PITCH_UP_BOOL),A
  1590  15e4  c38416                JP          PLAY_PITCH_CHANGE
  1591                          SUB_ram_cde7:
  1592  15e7  3e00                  LD          A,0x0
  1593  15e9  f5                    PUSH        AF
  1594  15ea  01a000                LD          BC,$a0
  1595  15ed  110100                LD          DE,0x1
  1596  15f0  210200                LD          HL,0x2
  1597  15f3  3e00                  LD          A,0x0
  1598  15f5  32b53a                LD          (PITCH_UP_BOOL),A
  1599  15f8  c38416                JP          PLAY_PITCH_CHANGE
  1600                          SETUP_OPEN_DOOR_SOUND:
  1601  15fb  110f00                LD          DE,0xf
  1602  15fe  218005                LD          HL,$580
  1603                          LO_HI_PITCH_SOUND:
  1604  1601  010800                LD          BC,0x8
  1605  1604  3e00                  LD          A,0x0
  1606  1606  f5                    PUSH        AF
  1607  1607  3e01                  LD          A,0x1
  1608  1609  32b53a                LD          (PITCH_UP_BOOL),A
  1609  160c  c38416                JP          PLAY_PITCH_CHANGE
  1610                          SETUP_CLOSE_DOOR_SOUND:
  1611  160f  210500                LD          HL,0x5
  1612  1612  110c00                LD          DE,0xc
  1613                          HI_LO_PITCH_SOUND:
  1614  1615  010e00                LD          BC,0xe                                  ;H
  1615  1618  af                    XOR         A
  1616  1619  f5                    PUSH        AF
  1617  161a  32b53a                LD          (PITCH_UP_BOOL),A
  1618  161d  c38416                JP          PLAY_PITCH_CHANGE
  1619                          SOUND_01:
  1620  1620  3e00                  LD          A,0x0
  1621  1622  f5                    PUSH        AF
  1622  1623  013000                LD          BC,$30
  1623  1626  110200                LD          DE,0x2
  1624  1629  210001                LD          HL,$100
  1625  162c  3e01                  LD          A,0x1
  1626  162e  32b53a                LD          (PITCH_UP_BOOL),A
  1627  1631  c38416                JP          PLAY_PITCH_CHANGE
  1628                          SOUND_02:
  1629  1634  3e00                  LD          A,0x0
  1630  1636  f5                    PUSH        AF
  1631  1637  011a00                LD          BC,$1a
  1632  163a  111000                LD          DE,$10
  1633  163d  210003                LD          HL,$300
  1634  1640  3e01                  LD          A,0x1
  1635  1642  32b53a                LD          (PITCH_UP_BOOL),A
  1636  1645  c38416                JP          PLAY_PITCH_CHANGE
  1637                          SOUND_03:
  1638  1648  3e00                  LD          A,0x0
  1639  164a  f5                    PUSH        AF
  1640  164b  012a00                LD          BC,$2a
  1641  164e  110a00                LD          DE,0xa
  1642  1651  210400                LD          HL,0x4
  1643  1654  3e00                  LD          A,0x0
  1644  1656  32b53a                LD          (PITCH_UP_BOOL),A
  1645  1659  c38416                JP          PLAY_PITCH_CHANGE
  1646                          SOUND_04:
  1647  165c  3e00                  LD          A,0x0
  1648  165e  f5                    PUSH        AF
  1649  165f  012000                LD          BC,$20
  1650  1662  110200                LD          DE,0x2
  1651  1665  215500                LD          HL,$55
  1652  1668  3e01                  LD          A,0x1
  1653  166a  32b53a                LD          (PITCH_UP_BOOL),A
  1654  166d  c38416                JP          PLAY_PITCH_CHANGE
  1655                          SOUND_05:
  1656  1670  3e00                  LD          A,0x0
  1657  1672  f5                    PUSH        AF
  1658  1673  013000                LD          BC,$30
  1659  1676  110100                LD          DE,0x1
  1660  1679  210100                LD          HL,0x1
  1661  167c  3e00                  LD          A,0x0
  1662  167e  32b53a                LD          (PITCH_UP_BOOL),A
  1663  1681  c38416                JP          PLAY_PITCH_CHANGE
  1664                          PLAY_PITCH_CHANGE:
  1665  1684  22b33a                LD          (SND_CYCLE_HOLDER),HL
  1666                          PLAY_PITCH_CHANGE_LOOP:
  1667  1687  2b                    DEC         HL
  1668  1688  7c                    LD          A,H
  1669  1689  b5                    OR          L                                       ;Clear flags
  1670  168a  20fb                  JR          NZ,PLAY_PITCH_CHANGE_LOOP
  1671  168c  f1                    POP         AF
  1672  168d  d3fc                  OUT         (SPEAKER),A                             ;= db
  1673  168f  ee01                  XOR         0x1
  1674  1691  f5                    PUSH        AF
  1675  1692  0b                    DEC         BC
  1676  1693  78                    LD          A,B
  1677  1694  b1                    OR          C
  1678  1695  2005                  JR          NZ,INCREASE_PITCH
  1679  1697  f1                    POP         AF
  1680  1698  2ab33a                LD          HL,(SND_CYCLE_HOLDER)
  1681  169b  c9                    RET
  1682                          INCREASE_PITCH:
  1683  169c  21b53a                LD          HL,PITCH_UP_BOOL
  1684  169f  cb46                  BIT         0x0,(HL)
  1685  16a1  2807                  JR          Z,DECREASE_PITCH
  1686  16a3  2ab33a                LD          HL,(SND_CYCLE_HOLDER)
  1687  16a6  ed52                  SBC         HL,DE
  1688  16a8  18da                  JR          PLAY_PITCH_CHANGE
  1689                          DECREASE_PITCH:
  1690  16aa  2ab33a                LD          HL,(SND_CYCLE_HOLDER)
  1691  16ad  19                    ADD         HL,DE
  1692  16ae  18d4                  JR          PLAY_PITCH_CHANGE
  1693                          HC_JOY_INPUT_COMPARE:
  1694  16b0  3a663a                LD          A,(RAM_AE)
  1695  16b3  fe31                  CP          $31                                    ;Compare to "1" db?
  1696  16b5  c29f2a                JP          NZ,WAIT_FOR_INPUT
  1697  16b8  2afe37                LD          HL,(HC_INPUT_HOLDER)                    ;= $6060
  1698  16bb  3ef3                  LD          A,$f3                                  ;Compare to JOY disc UUL
  1699  16bd  bd                    CP          L
  1700  16be  ca9e21                JP          Z,DO_MOVE_FW_CHK_WALLS
  1701  16c1  bc                    CP          H
  1702  16c2  ca9e21                JP          Z,DO_MOVE_FW_CHK_WALLS
  1703  16c5  3efb                  LD          A,$fb                                  ;Compare to JOY disc UP
  1704  16c7  bd                    CP          L
  1705  16c8  ca9e21                JP          Z,DO_MOVE_FW_CHK_WALLS
  1706  16cb  bc                    CP          H
  1707  16cc  ca9e21                JP          Z,DO_MOVE_FW_CHK_WALLS
  1708  16cf  3eeb                  LD          A,$eb                                  ;Compare to JOY disc UUR
  1709  16d1  bc                    CP          H
  1710  16d2  ca9e21                JP          Z,DO_MOVE_FW_CHK_WALLS
  1711  16d5  bd                    CP          L
  1712  16d6  ca9e21                JP          Z,DO_MOVE_FW_CHK_WALLS
  1713  16d9  3ee9                  LD          A,$e9                                  ;Compare to JOY disc UR
  1714  16db  bd                    CP          L
  1715  16dc  ca182e                JP          Z,DO_TURN_RIGHT
  1716  16df  bc                    CP          H
  1717  16e0  ca182e                JP          Z,DO_TURN_RIGHT
  1718  16e3  3ef9                  LD          A,$f9                                  ;Compare to JOY disc RUR
  1719  16e5  bd                    CP          L
  1720  16e6  ca182e                JP          Z,DO_TURN_RIGHT
  1721  16e9  bc                    CP          H
  1722  16ea  ca182e                JP          Z,DO_TURN_RIGHT
  1723  16ed  3efd                  LD          A,$fd                                  ;Compare to JOY disc RIGHT
  1724  16ef  bd                    CP          L
  1725  16f0  ca182e                JP          Z,DO_TURN_RIGHT
  1726  16f3  bc                    CP          H
  1727  16f4  ca182e                JP          Z,DO_TURN_RIGHT
  1728  16f7  3ee7                  LD          A,$e7                                  ;Compare to JOY disc LUL
  1729  16f9  bd                    CP          L
  1730  16fa  ca002e                JP          Z,DO_TURN_LEFT
  1731  16fd  bc                    CP          H
  1732  16fe  ca002e                JP          Z,DO_TURN_LEFT
  1733  1701  3ee3                  LD          A,$e3                                  ;Compare to JOY disc UL
  1734  1703  bd                    CP          L
  1735  1704  ca002e                JP          Z,DO_TURN_LEFT
  1736  1707  bc                    CP          H
  1737  1708  ca002e                JP          Z,DO_TURN_LEFT
  1738  170b  3ef7                  LD          A,$f7                                  ;Compare to JOY disc LEFT
  1739  170d  bd                    CP          L
  1740  170e  ca002e                JP          Z,DO_TURN_LEFT
  1741  1711  bc                    CP          H
  1742  1712  ca002e                JP          Z,DO_TURN_LEFT
  1743  1715  3ef6                  LD          A,$f6                                  ;Compare to JOY disc LDL
  1744  1717  bd                    CP          L
  1745  1718  ca482e                JP          Z,DO_GLANCE_LEFT
  1746  171b  bc                    CP          H
  1747  171c  ca482e                JP          Z,DO_GLANCE_LEFT
  1748  171f  3ee6                  LD          A,$e6                                  ;Compare to JOY disc DL
  1749  1721  bd                    CP          L
  1750  1722  ca482e                JP          Z,DO_GLANCE_LEFT
  1751  1725  bc                    CP          H
  1752  1726  ca482e                JP          Z,DO_GLANCE_LEFT
  1753  1729  3eed                  LD          A,$ed                                  ;Compare to JOY disc RDR
  1754  172b  bd                    CP          L
  1755  172c  ca322e                JP          Z,DO_GLANCE_RIGHT
  1756  172f  bc                    CP          H
  1757  1730  ca322e                JP          Z,DO_GLANCE_RIGHT
  1758  1733  3eec                  LD          A,$ec                                  ;Compare to JOY disc DR
  1759  1735  bd                    CP          L
  1760  1736  ca322e                JP          Z,DO_GLANCE_RIGHT
  1761  1739  bc                    CP          H
  1762  173a  ca322e                JP          Z,DO_GLANCE_RIGHT
  1763  173d  3efc                  LD          A,$fc                                  ;Compare to JOY disc DDR
  1764  173f  bd                    CP          L
  1765  1740  cad021                JP          Z,DO_JUMP_BACK
  1766  1743  bc                    CP          H
  1767  1744  cad021                JP          Z,DO_JUMP_BACK
  1768  1747  3efe                  LD          A,$fe                                  ;Compare to JOY disc DOWN
  1769  1749  bd                    CP          L
  1770  174a  cad021                JP          Z,DO_JUMP_BACK
  1771  174d  bc                    CP          H
  1772  174e  cad021                JP          Z,DO_JUMP_BACK
  1773  1751  3eee                  LD          A,$ee                                  ;Compare to JOY disc DDL
  1774  1753  bd                    CP          L
  1775  1754  cad021                JP          Z,DO_JUMP_BACK
  1776  1757  bc                    CP          H
  1777  1758  cad021                JP          Z,DO_JUMP_BACK
  1778  175b  3edf                  LD          A,$df                                  ;Compare to JOY K4
  1779  175d  bd                    CP          L
  1780  175e  ca461e                JP          Z,TOGGLE_SHIFT_MODE
  1781  1761  bc                    CP          H
  1782  1762  ca461e                JP          Z,TOGGLE_SHIFT_MODE
  1783  1765  3ab93a                LD          A,(GAME_BOOLEANS)
  1784  1768  cb4f                  BIT         0x1,A
  1785  176a  c2a217                JP          NZ,DO_HC_SHIFT_ACTIONS
  1786                          DO_HC_BUTTON_ACTIONS:
  1787  176d  3ebf                  LD          A,$bf                                  ;Compare to JOY K1
  1788  176f  bd                    CP          L
  1789  1770  ca5e2e                JP          Z,DO_USE_ATTACK
  1790  1773  bc                    CP          H
  1791  1774  ca5e2e                JP          Z,DO_USE_ATTACK
  1792  1777  3e7b                  LD          A,$7b                                  ;Compare to JOY K2
  1793  1779  bd                    CP          L
  1794  177a  cadb2c                JP          Z,DO_OPEN_CLOSE
  1795  177d  bc                    CP          H
  1796  177e  cadb2c                JP          Z,DO_OPEN_CLOSE
  1797  1781  3e5f                  LD          A,$5f                                  ;Compare to JOY K3
  1798  1783  bd                    CP          L
  1799  1784  cacc27                JP          Z,DO_PICK_UP
  1800  1787  bc                    CP          H
  1801  1788  cacc27                JP          Z,DO_PICK_UP
  1802  178b  3e7d                  LD          A,$7d                                  ;Compare to JOY K5
  1803  178d  bd                    CP          L
  1804  178e  ca682a                JP          Z,DO_SWAP_PACK
  1805  1791  bc                    CP          H
  1806  1792  ca682a                JP          Z,DO_SWAP_PACK
  1807  1795  3e7e                  LD          A,$7e                                  ;Compare to JOY K6
  1808  1797  bd                    CP          L
  1809  1798  caf829                JP          Z,DO_ROTATE_PACK
  1810  179b  bc                    CP          H
  1811  179c  caf829                JP          Z,DO_ROTATE_PACK
  1812  179f  c33022                JP          NO_ACTION_TAKEN
  1813                          DO_HC_SHIFT_ACTIONS:
  1814  17a2  3ebf                  LD          A,$bf                                  ;Compare to JOY K1
  1815  17a4  bd                    CP          L
  1816  17a5  caa332                JP          Z,DO_USE_LADDER
  1817  17a8  bc                    CP          H
  1818  17a9  caa332                JP          Z,DO_USE_LADDER
  1819  17ac  3e7b                  LD          A,$7b                                  ;Compare to JOY K2
  1820  17ae  bd                    CP          L
  1821  17af  ca1422                JP          Z,DO_COUNT_FOOD
  1822  17b2  bc                    CP          H
  1823  17b3  ca1422                JP          Z,DO_COUNT_FOOD
  1824  17b6  3e5f                  LD          A,$5f                                  ;Compare to JOY K3
  1825  17b8  bd                    CP          L
  1826  17b9  ca2b22                JP          Z,DO_COUNT_ARROWS
  1827  17bc  bc                    CP          H
  1828  17bd  ca2b22                JP          Z,DO_COUNT_ARROWS
  1829  17c0  3e7d                  LD          A,$7d                                  ;Compare to JOY K5
  1830  17c2  bd                    CP          L
  1831  17c3  cacc26                JP          Z,DO_SWAP_HANDS
  1832  17c6  bc                    CP          H
  1833  17c7  cacc26                JP          Z,DO_SWAP_HANDS
  1834  17ca  3e7e                  LD          A,$7e                                  ;Compare to JOY K6
  1835  17cc  bd                    CP          L
  1836  17cd  ca6b3b                JP          Z,DO_REST
  1837  17d0  bc                    CP          H
  1838  17d1  ca6b3b                JP          Z,DO_REST
  1839  17d4  3ecc                  LD          A,$cc                                  ;Compare to K4 + DR chord
  1840  17d6  bd                    CP          L
  1841  17d7  caee3c                JP          Z,MAX_HEALTH_ARROWS_FOOD
  1842  17da  bc                    CP          H
  1843  17db  caee3c                JP          Z,MAX_HEALTH_ARROWS_FOOD
  1844  17de  3ec6                  LD          A,$c6                                  ;Compare to K4 + DL chord
  1845  17e0  bd                    CP          L
  1846  17e1  ca303d                JP          Z,DO_TELEPORT
  1847  17e4  bc                    CP          H
  1848  17e5  ca303d                JP          Z,DO_TELEPORT
  1849  17e8  00                    NOP
  1850  17e9  00                    NOP
  1851  17ea  00                    NOP
  1852  17eb  00                    NOP
  1853  17ec  00                    NOP
  1854  17ed  00                    NOP
  1855  17ee  00                    NOP
  1856  17ef  00                    NOP
  1857  17f0  00                    NOP
  1858  17f1  00                    NOP
  1859  17f2  00                    NOP
  1860  17f3  00                    NOP
  1861  17f4  00                    NOP
  1862  17f5  00                    NOP
  1863  17f6  00                    NOP
  1864  17f7  00                    NOP
  1865  17f8  00                    NOP
  1866  17f9  00                    NOP
  1867  17fa  00                    NOP
  1868  17fb  00                    NOP
  1869  17fc  c33022                JP          NO_ACTION_TAKEN
  1870  17ff  00                    NOP
  1871  1800  ff                    db          $FF
  1872                          GRYPHON:
  1873  1801  04040404              db          $04,$04,$04,$04
  1874  1805  02889088f001          db          $02,$88,$90,$88,$F0,$01
  1875  180b  0202bea0aca0ed95      db          $02,$02,$BE,$A0,$AC,$A0,$ED,$95,$A0,$85,$A0,$F5,$01
              a085a0f501        
  1876  1818  0202a0959595a0b5      db          $02,$02,$A0,$95,$95,$95,$A0,$B5,$86,$91,$01
              869101            
  1877  1823  0202a0959595a0c3      db          $02,$02,$A0,$95,$95,$95,$A0,$C3,$95,$E5,$A0,$C7,$A0,$B0,$01
              95e5a0c7a0b001    
  1878  1832  0202a09595a0a1ef      db          $02,$02,$A0,$95,$95,$A0,$A1,$EF,$F4,$EF,$F5,$A0,",",$A0,$01
              f4eff5a02ca001    
  1879  1841  020212b97ff57ff5      db          $02,$02,$12,$B9,$7F,$F5,$7F,$F5,"\r",$C7,$01
              0dc701            
  1880  184c  0202b6eaf7e77feb      db          $02,$02,$B6,$EA,$F7,$E7,$7F,$EB,$F5,$01
              f501              
  1881  1856  02028bc7bfb6efed      db          $02,$02,$8B,$C7,$BF,$B6,$EF,$ED,$EB,$E5,$FF
              ebe5ff            
  1882                          GRYPHON_S:
  1883  1861  040404b8b8b001        db          $04,$04,$04,$B8,$B8,$B0,$01
  1884  1868  a09595a012c901        db          $A0,$95,$95,$A0,$12,$C9,$01
  1885  186f  e1a0d9d9a08d01        db          $E1,$A0,$D9,$D9,$A0,$8D,$01
  1886  1876  28e7e7e5ff            db          "(",$E7,$E7,$E5,$FF
  1887                          STAFF:
  1888  187b  0101010101            db          $01,$01,$01,$01,$01
  1889  1880  d501                  db          $D5,$01
  1890  1882  00da01                db          $00,$DA,$01
  1891  1885  0000da01              db          $00,$00,$DA,$01
  1892  1889  000000daff            db          $00,$00,$00,$DA,$FF
  1893                          STAFF_S:
  1894  188e  0101                  db          $01,$01
  1895  1890  00d301                db          $00,$D3,$01
  1896  1893  0000daff              db          $00,$00,$DA,$FF
  1897                          STAFF_T:
  1898  1897  005cff                db          $00,"\\",$FF
  1899                          SCROLL:
  1900  189a  0101010101            db          $01,$01,$01,$01,$01
  1901  189f  0990900901            db          "\t",$90,$90,"\t",$01
  1902  18a4  128f8e1201            db          $12,$8F,$8E,$12,$01
  1903  18a9  129e9f1201            db          $12,$9E,$9F,$12,$01
  1904  18ae  08a08080a008ff        db          "\b",$A0,$80,$80,$A0,"\b",$FF
  1905                          SCROLL_S:
  1906  18b5  0101                  db          $01,$01
  1907  18b7  00cddd01              db          $00,$CD,$DD,$01
  1908  18bb  00cdddff              db          $00,$CD,$DD,$FF
  1909                          SCROLL_T:
  1910  18bf  0048ff                db          $00,"H",$FF
  1911                          CROSSBOW:
  1912  18c2  0101010101            db          $01,$01,$01,$01,$01
  1913  18c7  000090f001            db          $00,$00,$90,$F0,$01
  1914  18cc  000cb7a091a001        db          $00,"\f",$B7,$A0,$91,$A0,$01
  1915  18d3  a091a0b7eda091a0      db          $A0,$91,$A0,$B7,$ED,$A0,$91,$A0,$01
              01                
  1916  18dc  a099a09090a0d7a0      db          $A0,$99,$A0,$90,$90,$A0,$D7,$A0,$FF
              ff                
  1917                          CROSSBOW_S:
  1918  18e5  0101                  db          $01,$01
  1919  18e7  d7dc01                db          $D7,$DC,$01
  1920  18ea  cd0dff                db          $CD,"\r",$FF
  1921                          CROSSBOW_T:
  1922  18ed  a091a0d8020490ff      db          $A0,$91,$A0,$D8,$02,$04,$90,$FF
  1923                          WARRIOR_POTION:
  1924  18f5  0101010101            db          $01,$01,$01,$01,$01
  1925  18fa  002bd401              db          $00,"+",$D4,$01
  1926  18fe  00110f01              db          $00,$11,$0F,$01
  1927  1902  00cddd01              db          $00,$CD,$DD,$01
  1928  1906  00c7d9ff              db          $00,$C7,$D9,$FF
  1929                          MAGE_POTION:
  1930  190a  0101010101            db          $01,$01,$01,$01,$01
  1931  190f  002bd501              db          $00,"+",$D5,$01
  1932  1913  00110f01              db          $00,$11,$0F,$01
  1933  1917  00cddd01              db          $00,$CD,$DD,$01
  1934  191b  00c7d9ff              db          $00,$C7,$D9,$FF
  1935                          CHAOS_POTION:
  1936  191f  0101010101            db          $01,$01,$01,$01,$01
  1937  1924  003f3f01              db          $00,"??",$01
  1938  1928  00110f01              db          $00,$11,$0F,$01
  1939  192c  00cddd01              db          $00,$CD,$DD,$01
  1940  1930  00c7d9ff              db          $00,$C7,$D9,$FF
  1941                          WARRIOR_POTION_S:
  1942  1934  0101                  db          $01,$01
  1943  1936  00d401                db          $00,$D4,$01
  1944  1939  001401                db          $00,$14,$01
  1945  193c  00c2ff                db          $00,$C2,$FF
  1946                          MAGE_POTION_S:
  1947  193f  0101                  db          $01,$01
  1948  1941  00d501                db          $00,$D5,$01
  1949  1944  001401                db          $00,$14,$01
  1950  1947  00c2ff                db          $00,$C2,$FF
  1951                          CHAOS_POTION_S:
  1952  194a  0101                  db          $01,$01
  1953  194c  003f01                db          $00,"?",$01
  1954  194f  001401                db          $00,$14,$01
  1955  1952  00c2ff                db          $00,$C2,$FF
  1956                          POTION_T:
  1957  1955  005502045fff          db          $00,"U",$02,$04,"_",$FF
  1958                          THE_END_PART_A:
  1959  195b  204173746572696f      db          " Asterion, the minotaur ",$FF
              6e2c20746865206d  
              696e6f7461757220  
              ff                
  1960                          THE_END_PART_B:
  1961  1974  2069732064656164      db          " is dead. ",$FF
              2e20ff            
  1962                          COMPASS:
  1963  197f  d76ec901              db          $D7,"n",$C9,$01
  1964  1983  77086501              db          "w\be",$01
  1965  1987  c773d9ff              db          $C7,"s",$D9,$FF
  1966  198b  ff                    db          $FF
  1967  198c  ff                    db          $FF
  1968  198d  ff                    db          $FF
  1969  198e  ff                    db          $FF
  1970  198f  ff                    db          $FF
  1971  1990  ff                    db          $FF
  1972  1991  ff                    db          $FF
  1973  1992  ff                    db          $FF
  1974  1993  ff                    db          $FF
  1975  1994  ff                    db          $FF
  1976  1995  ff                    db          $FF
  1977  1996  ff                    db          $FF
  1978  1997  ff                    db          $FF
  1979  1998  ff                    db          $FF
  1980  1999  ff                    db          $FF
  1981  199a  ff                    db          $FF
  1982  199b  ff                    db          $FF
  1983  199c  ff                    db          $FF
  1984  199d  ff                    db          $FF
  1985  199e  ff                    db          $FF
  1986  199f  ff                    db          $FF
  1987                          DRAW_BKGD:
  1988  19a0  3e20                  LD          A,$20                                  ;Set VIEWPORT fill chars to SPACE
  1989  19a2  212830                LD          HL,$3028
  1990  19a5  011818                LD          BC,$1818                               ;24 x 24 cells
  1991  19a8  cdcb10                CALL        FILL_CHRCOL_RECT
  1992  19ab  0e08                  LD          C,0x8                                   ;8 rows of ceiling
  1993  19ad  212834                LD          HL,$3428
  1994  19b0  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
  1995  19b2  cdce10                CALL        DRAW_CHRCOLS
  1996  19b5  0e06                  LD          C,0x6                                   ;6 more rows of ceiling
  1997  19b7  19                    ADD         HL,DE
  1998  19b8  3e00                  LD          A,0x0                                   ;BLK on BLK
  1999  19ba  cdce10                CALL        DRAW_CHRCOLS
  2000  19bd  0e0a                  LD          C,0xa                                   ;10 rows of floor
  2001  19bf  19                    ADD         HL,DE
  2002  19c0  3edf                  LD          A,$df                                  ;DKGRN on DKGRY
  2003  19c2  cdce10                CALL        DRAW_CHRCOLS
  2004  19c5  3aa33a                LD          A,(CURR_MONSTER_PHYS)
  2005  19c8  fe00                  CP          0x0
  2006  19ca  2816                  JR          Z,NOT_IN_BATTLE
  2007  19cc  3aa23a                LD          A,(CURR_MONSTER_SPRT)
  2008  19cf  fe00                  CP          0x0
  2009  19d1  280f                  JR          Z,NOT_IN_BATTLE
  2010  19d3  cd6932                CALL        REDRAW_MONSTER_HEALTH
  2011  19d6  00                    NOP
  2012  19d7  00                    NOP
  2013  19d8  00                    NOP
  2014  19d9  00                    NOP
  2015  19da  00                    NOP
  2016  19db  00                    NOP
  2017  19dc  00                    NOP
  2018  19dd  00                    NOP
  2019  19de  00                    NOP
  2020  19df  00                    NOP
  2021  19e0  00                    NOP
  2022  19e1  c9                    RET
  2023                          NOT_IN_BATTLE:
  2024  19e2  00                    NOP
  2025  19e3  00                    NOP
  2026  19e4  00                    NOP
  2027  19e5  00                    NOP
  2028  19e6  00                    NOP
  2029  19e7  00                    NOP
  2030  19e8  00                    NOP
  2031  19e9  00                    NOP
  2032  19ea  00                    NOP
  2033  19eb  00                    NOP
  2034  19ec  c9                    RET
  2035  19ed  ff                    db          $FF
  2036  19ee  ff                    db          $FF
  2037  19ef  ff                    db          $FF
  2038  19f0  ff                    db          $FF
  2039  19f1  ff                    db          $FF
  2040  19f2  ff                    db          $FF
  2041  19f3  ff                    db          $FF
  2042  19f4  ff                    db          $FF
  2043  19f5  ff                    db          $FF
  2044  19f6  ff                    db          $FF
  2045  19f7  ff                    db          $FF
  2046  19f8  ff                    db          $FF
  2047  19f9  ff                    db          $FF
  2048  19fa  ff                    db          $FF
  2049  19fb  ff                    db          $FF
  2050  19fc  ff                    db          $FF
  2051  19fd  ff                    db          $FF
  2052                          WIPE_VARIABLE_SPACE:
  2053  19fe  3e00                  LD          A,0x0
  2054  1a00  210039                LD          HL,$3900
  2055  1a03  06ff                  LD          B,$ff
  2056                          CLEAR_MAP_SPACE:
  2057  1a05  77                    LD          (HL),A
  2058  1a06  23                    INC         HL
  2059  1a07  77                    LD          (HL),A
  2060  1a08  23                    INC         HL
  2061  1a09  77                    LD          (HL),A
  2062  1a0a  23                    INC         HL
  2063  1a0b  10f8                  DJNZ        CLEAR_MAP_SPACE
  2064  1a0d  21623a                LD          HL,$3a62
  2065  1a10  22ba3a                LD          (NEXT_BLINK_CHECK),HL
  2066  1a13  c9                    RET
  2067  1a14  ff                    db          $FF
  2068  1a15  ff                    db          $FF
  2069  1a16  ff                    db          $FF
  2070                          DRAW_WHITE_MAP:
  2071  1a17  217400                LD          HL,$74
  2072  1a1a  cd1523                CALL        MAP_ITEM_MONSTER
  2073                          UPDATE_ITEM_CELLS:
  2074  1a1d  ca9422                JP          Z,DRAW_PURPLE_MAP
  2075  1a20  0a                    LD          A,(BC)
  2076  1a21  0c                    INC         C
  2077  1a22  0c                    INC         C
  2078  1a23  d9                    EXX
  2079  1a24  16b6                  LD          D,$b6
  2080  1a26  cd2723                CALL        UPDATE_COLRAM_FROM_OFFSET
  2081  1a29  d9                    EXX
  2082  1a2a  cd1823                CALL        FIND_NEXT_ITEM_MONSTER_LOOP
  2083  1a2d  18ee                  JR          UPDATE_ITEM_CELLS
  2084  1a2f  c39422                JP          DRAW_PURPLE_MAP
  2085  1a32  00                    db          $00
  2086                          SHOW_MAP:
  2087  1a33  ff                    db          $FF
  2088  1a34  ff                    db          $FF
  2089  1a35  ff                    db          $FF
  2090  1a36  ff                    db          $FF
  2091  1a37  ff                    db          $FF
  2092  1a38  ff                    db          $FF
  2093  1a39  ff                    db          $FF
  2094  1a3a  ff                    db          $FF
  2095  1a3b  ff                    db          $FF
  2096  1a3c  ff                    db          $FF
  2097  1a3d  ff                    db          $FF
  2098  1a3e  ff                    db          $FF
  2099  1a3f  ff                    db          $FF
  2100  1a40  ff                    db          $FF
  2101  1a41  ff                    db          $FF
  2102  1a42  ff                    db          $FF
  2103  1a43  ff                    db          $FF
  2104  1a44  ff                    db          $FF
  2105  1a45  ff                    db          $FF
  2106  1a46  ff                    db          $FF
  2107  1a47  ff                    db          $FF
  2108  1a48  ff                    db          $FF
  2109  1a49  ff                    db          $FF
  2110  1a4a  ff                    db          $FF
  2111  1a4b  ff                    db          $FF
  2112  1a4c  ff                    db          $FF
  2113  1a4d  ff                    db          $FF
  2114  1a4e  ff                    db          $FF
  2115  1a4f  ff                    db          $FF
  2116  1a50  ff                    db          $FF
  2117  1a51  ff                    db          $FF
  2118  1a52  ff                    db          $FF
  2119  1a53  ff                    db          $FF
  2120  1a54  ff                    db          $FF
  2121  1a55  ff                    db          $FF
  2122  1a56  ff                    db          $FF
  2123  1a57  ff                    db          $FF
  2124  1a58  ff                    db          $FF
  2125  1a59  ff                    db          $FF
  2126  1a5a  ff                    db          $FF
  2127  1a5b  ff                    db          $FF
  2128  1a5c  ff                    db          $FF
  2129  1a5d  ff                    db          $FF
  2130  1a5e  ff                    db          $FF
  2131  1a5f  ff                    db          $FF
  2132  1a60  ff                    db          $FF
  2133  1a61  ff                    db          $FF
  2134  1a62  ff                    db          $FF
  2135  1a63  ff                    db          $FF
  2136  1a64  ff                    db          $FF
  2137  1a65  ff                    db          $FF
  2138  1a66  ff                    db          $FF
  2139  1a67  ff                    db          $FF
  2140  1a68  ff                    db          $FF
  2141  1a69  ff                    db          $FF
  2142  1a6a  ff                    db          $FF
  2143  1a6b  ff                    db          $FF
  2144  1a6c  ff                    db          $FF
  2145  1a6d  ff                    db          $FF
  2146  1a6e  ff                    db          $FF
  2147  1a6f  ff                    db          $FF
  2148  1a70  ff                    db          $FF
  2149  1a71  ff                    db          $FF
  2150  1a72  ff                    db          $FF
  2151  1a73  ff                    db          $FF
  2152  1a74  ff                    db          $FF
  2153  1a75  ff                    db          $FF
  2154  1a76  ff                    db          $FF
  2155  1a77  ff                    db          $FF
  2156  1a78  ff                    db          $FF
  2157  1a79  ff                    db          $FF
  2158  1a7a  ff                    db          $FF
  2159  1a7b  ff                    db          $FF
  2160  1a7c  ff                    db          $FF
  2161  1a7d  ff                    db          $FF
  2162  1a7e  ff                    db          $FF
  2163  1a7f  ff                    db          $FF
  2164  1a80  ff                    db          $FF
  2165  1a81  ff                    db          $FF
  2166  1a82  ff                    db          $FF
  2167  1a83  ff                    db          $FF
  2168  1a84  ff                    db          $FF
  2169  1a85  ff                    db          $FF
  2170  1a86  ff                    db          $FF
  2171  1a87  ff                    db          $FF
  2172  1a88  ff                    db          $FF
  2173  1a89  ff                    db          $FF
  2174  1a8a  ff                    db          $FF
  2175  1a8b  ff                    db          $FF
  2176  1a8c  ff                    db          $FF
  2177  1a8d  ff                    db          $FF
  2178  1a8e  ff                    db          $FF
  2179  1a8f  ff                    db          $FF
  2180  1a90  ff                    db          $FF
  2181  1a91  ff                    db          $FF
  2182  1a92  ff                    db          $FF
  2183  1a93  ff                    db          $FF
  2184  1a94  ff                    db          $FF
  2185  1a95  ff                    db          $FF
  2186  1a96  ff                    db          $FF
  2187  1a97  ff                    db          $FF
  2188  1a98  ff                    db          $FF
  2189  1a99  ff                    db          $FF
  2190  1a9a  ff                    db          $FF
  2191  1a9b  ff                    db          $FF
  2192  1a9c  ff                    db          $FF
  2193  1a9d  ff                    db          $FF
  2194  1a9e  ff                    db          $FF
  2195  1a9f  ff                    db          $FF
  2196  1aa0  ff                    db          $FF
  2197  1aa1  ff                    db          $FF
  2198  1aa2  ff                    db          $FF
  2199  1aa3  ff                    db          $FF
  2200  1aa4  ff                    db          $FF
  2201  1aa5  ff                    db          $FF
  2202  1aa6  ff                    db          $FF
  2203  1aa7  ff                    db          $FF
  2204  1aa8  ff                    db          $FF
  2205  1aa9  ff                    db          $FF
  2206  1aaa  ff                    db          $FF
  2207  1aab  ff                    db          $FF
  2208  1aac  ff                    db          $FF
  2209  1aad  ff                    db          $FF
  2210  1aae  ff                    db          $FF
  2211  1aaf  ff                    db          $FF
  2212  1ab0  ff                    db          $FF
  2213  1ab1  ff                    db          $FF
  2214  1ab2  ff                    db          $FF
  2215  1ab3  ff                    db          $FF
  2216  1ab4  ff                    db          $FF
  2217  1ab5  ff                    db          $FF
  2218  1ab6  ff                    db          $FF
  2219  1ab7  ff                    db          $FF
  2220  1ab8  ff                    db          $FF
  2221  1ab9  ff                    db          $FF
  2222  1aba  ff                    db          $FF
  2223  1abb  ff                    db          $FF
  2224  1abc  ff                    db          $FF
  2225  1abd  ff                    db          $FF
  2226  1abe  ff                    db          $FF
  2227  1abf  ff                    db          $FF
  2228  1ac0  ff                    db          $FF
  2229  1ac1  ff                    db          $FF
  2230  1ac2  ff                    db          $FF
  2231  1ac3  ff                    db          $FF
  2232  1ac4  ff                    db          $FF
  2233  1ac5  ff                    db          $FF
  2234  1ac6  ff                    db          $FF
  2235  1ac7  ff                    db          $FF
  2236  1ac8  ff                    db          $FF
  2237  1ac9  ff                    db          $FF
  2238  1aca  ff                    db          $FF
  2239  1acb  ff                    db          $FF
  2240  1acc  ff                    db          $FF
  2241  1acd  ff                    db          $FF
  2242  1ace  ff                    db          $FF
  2243  1acf  ff                    db          $FF
  2244  1ad0  ff                    db          $FF
  2245  1ad1  ff                    db          $FF
  2246  1ad2  ff                    db          $FF
  2247  1ad3  ff                    db          $FF
  2248  1ad4  ff                    db          $FF
  2249  1ad5  ff                    db          $FF
  2250  1ad6  ff                    db          $FF
  2251  1ad7  ff                    db          $FF
  2252  1ad8  ff                    db          $FF
  2253  1ad9  ff                    db          $FF
  2254  1ada  f4                    db          $F4
  2255  1adb  ff                    db          $FF
  2256  1adc  ff                    db          $FF
  2257  1add  ff                    db          $FF
  2258  1ade  ff                    db          $FF
  2259  1adf  ff                    db          $FF
  2260  1ae0  ff                    db          $FF
  2261  1ae1  ff                    db          $FF
  2262  1ae2  ff                    db          $FF
  2263  1ae3  ff                    db          $FF
  2264  1ae4  ff                    db          $FF
  2265  1ae5  ff                    db          $FF
  2266  1ae6  ff                    db          $FF
  2267  1ae7  ff                    db          $FF
  2268  1ae8  ff                    db          $FF
  2269  1ae9  ff                    db          $FF
  2270  1aea  ff                    db          $FF
  2271  1aeb  ff                    db          $FF
  2272  1aec  ff                    db          $FF
  2273  1aed  ff                    db          $FF
  2274  1aee  ff                    db          $FF
  2275  1aef  ff                    db          $FF
  2276  1af0  ff                    db          $FF
  2277  1af1  ff                    db          $FF
  2278  1af2  ff                    db          $FF
  2279  1af3  ff                    db          $FF
  2280  1af4  ff                    db          $FF
  2281  1af5  ff                    db          $FF
  2282  1af6  ff                    db          $FF
  2283  1af7  ff                    db          $FF
  2284  1af8  ff                    db          $FF
  2285  1af9  ff                    db          $FF
  2286  1afa  ff                    db          $FF
  2287  1afb  ff                    db          $FF
  2288  1afc  ff                    db          $FF
  2289  1afd  ff                    db          $FF
  2290  1afe  ff                    db          $FF
  2291  1aff  ff                    db          $FF
  2292  1b00  ff                    db          $FF
  2293  1b01  ff                    db          $FF
  2294  1b02  ff                    db          $FF
  2295  1b03  ff                    db          $FF
  2296  1b04  ff                    db          $FF
  2297  1b05  ff                    db          $FF
  2298  1b06  ff                    db          $FF
  2299  1b07  ff                    db          $FF
  2300  1b08  ff                    db          $FF
  2301  1b09  ff                    db          $FF
  2302  1b0a  ff                    db          $FF
  2303  1b0b  ff                    db          $FF
  2304  1b0c  ff                    db          $FF
  2305  1b0d  ff                    db          $FF
  2306  1b0e  ff                    db          $FF
  2307  1b0f  ff                    db          $FF
  2308  1b10  ff                    db          $FF
  2309  1b11  ff                    db          $FF
  2310  1b12  ff                    db          $FF
  2311  1b13  ff                    db          $FF
  2312  1b14  ff                    db          $FF
  2313  1b15  ff                    db          $FF
  2314  1b16  ff                    db          $FF
  2315  1b17  ff                    db          $FF
  2316  1b18  ff                    db          $FF
  2317  1b19  ff                    db          $FF
  2318  1b1a  ff                    db          $FF
  2319  1b1b  ff                    db          $FF
  2320  1b1c  ff                    db          $FF
  2321  1b1d  ff                    db          $FF
  2322  1b1e  ff                    db          $FF
  2323  1b1f  ff                    db          $FF
  2324  1b20  ff                    db          $FF
  2325  1b21  ff                    db          $FF
  2326  1b22  ff                    db          $FF
  2327  1b23  ff                    db          $FF
  2328  1b24  ff                    db          $FF
  2329  1b25  ff                    db          $FF
  2330  1b26  ff                    db          $FF
  2331  1b27  ff                    db          $FF
  2332  1b28  ff                    db          $FF
  2333  1b29  ff                    db          $FF
  2334  1b2a  ff                    db          $FF
  2335  1b2b  ff                    db          $FF
  2336  1b2c  ff                    db          $FF
  2337  1b2d  ff                    db          $FF
  2338  1b2e  ff                    db          $FF
  2339  1b2f  ff                    db          $FF
  2340  1b30  ff                    db          $FF
  2341  1b31  ff                    db          $FF
  2342  1b32  ff                    db          $FF
  2343  1b33  ff                    db          $FF
  2344  1b34  ff                    db          $FF
  2345  1b35  ff                    db          $FF
  2346  1b36  ff                    db          $FF
  2347  1b37  ff                    db          $FF
  2348  1b38  ff                    db          $FF
  2349  1b39  ff                    db          $FF
  2350  1b3a  ff                    db          $FF
  2351  1b3b  ff                    db          $FF
  2352  1b3c  ff                    db          $FF
  2353  1b3d  ff                    db          $FF
  2354  1b3e  ff                    db          $FF
  2355  1b3f  ff                    db          $FF
  2356  1b40  ff                    db          $FF
  2357  1b41  ff                    db          $FF
  2358  1b42  ff                    db          $FF
  2359  1b43  ff                    db          $FF
  2360  1b44  ff                    db          $FF
  2361  1b45  ff                    db          $FF
  2362  1b46  ff                    db          $FF
  2363  1b47  ff                    db          $FF
  2364  1b48  ff                    db          $FF
  2365  1b49  ff                    db          $FF
  2366  1b4a  ff                    db          $FF
  2367  1b4b  ff                    db          $FF
  2368  1b4c  ff                    db          $FF
  2369  1b4d  ff                    db          $FF
  2370  1b4e  ff                    db          $FF
  2371  1b4f  ff                    db          $FF
  2372  1b50  ff                    db          $FF
  2373  1b51  ff                    db          $FF
  2374  1b52  ff                    db          $FF
  2375  1b53  ff                    db          $FF
  2376  1b54  ff                    db          $FF
  2377  1b55  ff                    db          $FF
  2378  1b56  ff                    db          $FF
  2379  1b57  ff                    db          $FF
  2380  1b58  ff                    db          $FF
  2381  1b59  ff                    db          $FF
  2382  1b5a  ff                    db          $FF
  2383  1b5b  ff                    db          $FF
  2384  1b5c  ff                    db          $FF
  2385  1b5d  ff                    db          $FF
  2386  1b5e  ff                    db          $FF
  2387  1b5f  ff                    db          $FF
  2388  1b60  ff                    db          $FF
  2389  1b61  ff                    db          $FF
  2390  1b62  ff                    db          $FF
  2391  1b63  ff                    db          $FF
  2392  1b64  ff                    db          $FF
  2393  1b65  ff                    db          $FF
  2394  1b66  ff                    db          $FF
  2395  1b67  ff                    db          $FF
  2396  1b68  ff                    db          $FF
  2397  1b69  ff                    db          $FF
  2398  1b6a  ff                    db          $FF
  2399  1b6b  ff                    db          $FF
  2400  1b6c  ff                    db          $FF
  2401  1b6d  ff                    db          $FF
  2402  1b6e  ff                    db          $FF
  2403  1b6f  ff                    db          $FF
  2404  1b70  ff                    db          $FF
  2405  1b71  ff                    db          $FF
  2406  1b72  ff                    db          $FF
  2407  1b73  ff                    db          $FF
  2408  1b74  ff                    db          $FF
  2409  1b75  ff                    db          $FF
  2410  1b76  ff                    db          $FF
  2411  1b77  ff                    db          $FF
  2412  1b78  ff                    db          $FF
  2413  1b79  ff                    db          $FF
  2414  1b7a  ff                    db          $FF
  2415  1b7b  ff                    db          $FF
  2416  1b7c  ff                    db          $FF
  2417  1b7d  ff                    db          $FF
  2418  1b7e  ff                    db          $FF
  2419  1b7f  ff                    db          $FF
  2420  1b80  ff                    db          $FF
  2421  1b81  ff                    db          $FF
  2422  1b82  ff                    db          $FF
  2423  1b83  ff                    db          $FF
  2424  1b84  ff                    db          $FF
  2425  1b85  ff                    db          $FF
  2426  1b86  ff                    db          $FF
  2427  1b87  ff                    db          $FF
  2428  1b88  ff                    db          $FF
  2429  1b89  ff                    db          $FF
  2430  1b8a  ff                    db          $FF
  2431  1b8b  ff                    db          $FF
  2432  1b8c  ff                    db          $FF
  2433  1b8d  ff                    db          $FF
  2434  1b8e  ff                    db          $FF
  2435  1b8f  ff                    db          $FF
  2436  1b90  ff                    db          $FF
  2437  1b91  ff                    db          $FF
  2438  1b92  ff                    db          $FF
  2439  1b93  ff                    db          $FF
  2440  1b94  ff                    db          $FF
  2441  1b95  ff                    db          $FF
  2442  1b96  ff                    db          $FF
  2443  1b97  ff                    db          $FF
  2444  1b98  ff                    db          $FF
  2445  1b99  ff                    db          $FF
  2446  1b9a  ff                    db          $FF
  2447  1b9b  ff                    db          $FF
  2448  1b9c  ff                    db          $FF
  2449  1b9d  ff                    db          $FF
  2450  1b9e  ff                    db          $FF
  2451  1b9f  ff                    db          $FF
  2452  1ba0  ff                    db          $FF
  2453  1ba1  ff                    db          $FF
  2454  1ba2  ff                    db          $FF
  2455  1ba3  ff                    db          $FF
  2456  1ba4  ff                    db          $FF
  2457  1ba5  ff                    db          $FF
  2458  1ba6  ff                    db          $FF
  2459  1ba7  ff                    db          $FF
  2460  1ba8  ff                    db          $FF
  2461  1ba9  ff                    db          $FF
  2462  1baa  ff                    db          $FF
  2463  1bab  ff                    db          $FF
  2464  1bac  ff                    db          $FF
  2465  1bad  ff                    db          $FF
  2466  1bae  ff                    db          $FF
  2467  1baf  ff                    db          $FF
  2468  1bb0  ff                    db          $FF
  2469  1bb1  ff                    db          $FF
  2470  1bb2  ff                    db          $FF
  2471  1bb3  ff                    db          $FF
  2472  1bb4  ff                    db          $FF
  2473  1bb5  ff                    db          $FF
  2474  1bb6  ff                    db          $FF
  2475  1bb7  ff                    db          $FF
  2476  1bb8  ff                    db          $FF
  2477  1bb9  ff                    db          $FF
  2478  1bba  ff                    db          $FF
  2479  1bbb  ff                    db          $FF
  2480  1bbc  ff                    db          $FF
  2481  1bbd  ff                    db          $FF
  2482  1bbe  ff                    db          $FF
  2483  1bbf  ff                    db          $FF
  2484  1bc0  ff                    db          $FF
  2485  1bc1  ff                    db          $FF
  2486  1bc2  ff                    db          $FF
  2487  1bc3  ff                    db          $FF
  2488  1bc4  ff                    db          $FF
  2489  1bc5  ff                    db          $FF
  2490  1bc6  ff                    db          $FF
  2491  1bc7  ff                    db          $FF
  2492  1bc8  ff                    db          $FF
  2493  1bc9  ff                    db          $FF
  2494  1bca  ff                    db          $FF
  2495  1bcb  ff                    db          $FF
  2496  1bcc  ff                    db          $FF
  2497  1bcd  ff                    db          $FF
  2498  1bce  ff                    db          $FF
  2499  1bcf  ff                    db          $FF
  2500  1bd0  ff                    db          $FF
  2501  1bd1  ff                    db          $FF
  2502  1bd2  ff                    db          $FF
  2503  1bd3  ff                    db          $FF
  2504  1bd4  ff                    db          $FF
  2505  1bd5  ff                    db          $FF
  2506  1bd6  ff                    db          $FF
  2507  1bd7  ff                    db          $FF
  2508  1bd8  ff                    db          $FF
  2509  1bd9  ff                    db          $FF
  2510  1bda  ff                    db          $FF
  2511  1bdb  ff                    db          $FF
  2512  1bdc  ff                    db          $FF
  2513  1bdd  ff                    db          $FF
  2514  1bde  ff                    db          $FF
  2515  1bdf  ff                    db          $FF
  2516  1be0  ff                    db          $FF
  2517  1be1  ff                    db          $FF
  2518  1be2  ff                    db          $FF
  2519  1be3  ff                    db          $FF
  2520  1be4  ff                    db          $FF
  2521  1be5  ff                    db          $FF
  2522  1be6  ff                    db          $FF
  2523  1be7  ff                    db          $FF
  2524  1be8  ff                    db          $FF
  2525  1be9  ff                    db          $FF
  2526  1bea  ff                    db          $FF
  2527  1beb  ff                    db          $FF
  2528  1bec  ff                    db          $FF
  2529  1bed  ff                    db          $FF
  2530  1bee  ff                    db          $FF
  2531  1bef  ff                    db          $FF
  2532  1bf0  ff                    db          $FF
  2533  1bf1  ff                    db          $FF
  2534  1bf2  ff                    db          $FF
  2535  1bf3  ff                    db          $FF
  2536  1bf4  ff                    db          $FF
  2537  1bf5  ff                    db          $FF
  2538  1bf6  ff                    db          $FF
  2539  1bf7  ff                    db          $FF
  2540  1bf8  ff                    db          $FF
  2541  1bf9  ff                    db          $FF
  2542  1bfa  ff                    db          $FF
  2543  1bfb  ff                    db          $FF
  2544  1bfc  ff                    db          $FF
  2545  1bfd  ff                    db          $FF
  2546  1bfe  ff                    db          $FF
  2547  1bff  ff                    db          $FF
  2548  1c00  ff                    db          $FF
  2549  1c01  ff                    db          $FF
  2550  1c02  ff                    db          $FF
  2551  1c03  ff                    db          $FF
  2552  1c04  ff                    db          $FF
  2553  1c05  ff                    db          $FF
  2554  1c06  ff                    db          $FF
  2555  1c07  ff                    db          $FF
  2556  1c08  ff                    db          $FF
  2557  1c09  ff                    db          $FF
  2558  1c0a  ff                    db          $FF
  2559  1c0b  ff                    db          $FF
  2560  1c0c  ff                    db          $FF
  2561  1c0d  ff                    db          $FF
  2562  1c0e  ff                    db          $FF
  2563  1c0f  ff                    db          $FF
  2564  1c10  ff                    db          $FF
  2565  1c11  ff                    db          $FF
  2566  1c12  ff                    db          $FF
  2567  1c13  ff                    db          $FF
  2568  1c14  ff                    db          $FF
  2569  1c15  ff                    db          $FF
  2570  1c16  ff                    db          $FF
  2571  1c17  ff                    db          $FF
  2572  1c18  ff                    db          $FF
  2573  1c19  ff                    db          $FF
  2574  1c1a  ff                    db          $FF
  2575  1c1b  ff                    db          $FF
  2576  1c1c  ff                    db          $FF
  2577  1c1d  ff                    db          $FF
  2578  1c1e  ff                    db          $FF
  2579  1c1f  ff                    db          $FF
  2580  1c20  ff                    db          $FF
  2581  1c21  ff                    db          $FF
  2582  1c22  ff                    db          $FF
  2583  1c23  ff                    db          $FF
  2584  1c24  ff                    db          $FF
  2585  1c25  ff                    db          $FF
  2586  1c26  ff                    db          $FF
  2587  1c27  ff                    db          $FF
  2588  1c28  ff                    db          $FF
  2589  1c29  ff                    db          $FF
  2590  1c2a  ff                    db          $FF
  2591  1c2b  ff                    db          $FF
  2592  1c2c  ff                    db          $FF
  2593  1c2d  ff                    db          $FF
  2594  1c2e  ff                    db          $FF
  2595  1c2f  ff                    db          $FF
  2596  1c30  ff                    db          $FF
  2597  1c31  ff                    db          $FF
  2598  1c32  ff                    db          $FF
  2599  1c33  ff                    db          $FF
  2600  1c34  ff                    db          $FF
  2601  1c35  ff                    db          $FF
  2602  1c36  ff                    db          $FF
  2603  1c37  ff                    db          $FF
  2604  1c38  ff                    db          $FF
  2605  1c39  ff                    db          $FF
  2606  1c3a  ff                    db          $FF
  2607  1c3b  ff                    db          $FF
  2608  1c3c  ff                    db          $FF
  2609  1c3d  ff                    db          $FF
  2610  1c3e  ff                    db          $FF
  2611  1c3f  ff                    db          $FF
  2612  1c40  ff                    db          $FF
  2613  1c41  ff                    db          $FF
  2614  1c42  ff                    db          $FF
  2615  1c43  ff                    db          $FF
  2616  1c44  ff                    db          $FF
  2617  1c45  ff                    db          $FF
  2618  1c46  ff                    db          $FF
  2619  1c47  ff                    db          $FF
  2620  1c48  ff                    db          $FF
  2621  1c49  ff                    db          $FF
  2622  1c4a  ff                    db          $FF
  2623  1c4b  ff                    db          $FF
  2624  1c4c  ff                    db          $FF
  2625  1c4d  ff                    db          $FF
  2626  1c4e  ff                    db          $FF
  2627  1c4f  ff                    db          $FF
  2628  1c50  ff                    db          $FF
  2629  1c51  ff                    db          $FF
  2630  1c52  ff                    db          $FF
  2631  1c53  ff                    db          $FF
  2632  1c54  ff                    db          $FF
  2633  1c55  ff                    db          $FF
  2634  1c56  ff                    db          $FF
  2635  1c57  ff                    db          $FF
  2636  1c58  ff                    db          $FF
  2637  1c59  ff                    db          $FF
  2638  1c5a  ff                    db          $FF
  2639  1c5b  ff                    db          $FF
  2640  1c5c  ff                    db          $FF
  2641  1c5d  ff                    db          $FF
  2642  1c5e  ff                    db          $FF
  2643  1c5f  ff                    db          $FF
  2644  1c60  ff                    db          $FF
  2645  1c61  ff                    db          $FF
  2646  1c62  ff                    db          $FF
  2647  1c63  ff                    db          $FF
  2648  1c64  ff                    db          $FF
  2649  1c65  ff                    db          $FF
  2650  1c66  ff                    db          $FF
  2651  1c67  ff                    db          $FF
  2652  1c68  ff                    db          $FF
  2653  1c69  ff                    db          $FF
  2654  1c6a  ff                    db          $FF
  2655  1c6b  ff                    db          $FF
  2656  1c6c  ff                    db          $FF
  2657  1c6d  ff                    db          $FF
  2658  1c6e  ff                    db          $FF
  2659  1c6f  ff                    db          $FF
  2660  1c70  ff                    db          $FF
  2661  1c71  ff                    db          $FF
  2662  1c72  ff                    db          $FF
  2663  1c73  ff                    db          $FF
  2664  1c74  ff                    db          $FF
  2665  1c75  ff                    db          $FF
  2666  1c76  ff                    db          $FF
  2667  1c77  ff                    db          $FF
  2668  1c78  ff                    db          $FF
  2669  1c79  ff                    db          $FF
  2670  1c7a  ff                    db          $FF
  2671  1c7b  ff                    db          $FF
  2672  1c7c  fa                    db          $FA
  2673  1c7d  ff                    db          $FF
  2674  1c7e  ff                    db          $FF
  2675  1c7f  ff                    db          $FF
  2676  1c80  ff                    db          $FF
  2677  1c81  ff                    db          $FF
  2678  1c82  ff                    db          $FF
  2679  1c83  ff                    db          $FF
  2680  1c84  ff                    db          $FF
  2681  1c85  ff                    db          $FF
  2682  1c86  ff                    db          $FF
  2683  1c87  ff                    db          $FF
  2684  1c88  ff                    db          $FF
  2685  1c89  ff                    db          $FF
  2686  1c8a  ff                    db          $FF
  2687  1c8b  ff                    db          $FF
  2688  1c8c  ff                    db          $FF
  2689  1c8d  ff                    db          $FF
  2690  1c8e  ff                    db          $FF
  2691  1c8f  ff                    db          $FF
  2692  1c90  ff                    db          $FF
  2693  1c91  ff                    db          $FF
  2694  1c92  ff                    db          $FF
  2695  1c93  ff                    db          $FF
  2696  1c94  ff                    db          $FF
  2697  1c95  ff                    db          $FF
  2698  1c96  ff                    db          $FF
  2699  1c97  ff                    db          $FF
  2700  1c98  ff                    db          $FF
  2701  1c99  ff                    db          $FF
  2702  1c9a  ff                    db          $FF
  2703  1c9b  ff                    db          $FF
  2704  1c9c  ff                    db          $FF
  2705  1c9d  ff                    db          $FF
  2706  1c9e  ff                    db          $FF
  2707  1c9f  ff                    db          $FF
  2708  1ca0  ff                    db          $FF
  2709  1ca1  ff                    db          $FF
  2710  1ca2  ff                    db          $FF
  2711  1ca3  ff                    db          $FF
  2712  1ca4  ff                    db          $FF
  2713  1ca5  ff                    db          $FF
  2714  1ca6  ff                    db          $FF
  2715  1ca7  ff                    db          $FF
  2716  1ca8  ff                    db          $FF
  2717  1ca9  ff                    db          $FF
  2718  1caa  ff                    db          $FF
  2719  1cab  ff                    db          $FF
  2720  1cac  ff                    db          $FF
  2721  1cad  ff                    db          $FF
  2722  1cae  ff                    db          $FF
  2723  1caf  ff                    db          $FF
  2724  1cb0  ff                    db          $FF
  2725  1cb1  ff                    db          $FF
  2726  1cb2  ff                    db          $FF
  2727  1cb3  ff                    db          $FF
  2728  1cb4  ff                    db          $FF
  2729  1cb5  ff                    db          $FF
  2730  1cb6  ff                    db          $FF
  2731  1cb7  ff                    db          $FF
  2732  1cb8  ff                    db          $FF
  2733  1cb9  ff                    db          $FF
  2734  1cba  ff                    db          $FF
  2735  1cbb  ff                    db          $FF
  2736  1cbc  ff                    db          $FF
  2737  1cbd  ff                    db          $FF
  2738  1cbe  ff                    db          $FF
  2739  1cbf  ff                    db          $FF
  2740  1cc0  ff                    db          $FF
  2741  1cc1  ff                    db          $FF
  2742  1cc2  ff                    db          $FF
  2743  1cc3  ff                    db          $FF
  2744  1cc4  ff                    db          $FF
  2745  1cc5  ff                    db          $FF
  2746  1cc6  ff                    db          $FF
  2747  1cc7  ff                    db          $FF
  2748  1cc8  ff                    db          $FF
  2749  1cc9  ff                    db          $FF
  2750  1cca  ff                    db          $FF
  2751  1ccb  ff                    db          $FF
  2752  1ccc  ff                    db          $FF
  2753  1ccd  ff                    db          $FF
  2754  1cce  ff                    db          $FF
  2755  1ccf  ff                    db          $FF
  2756  1cd0  ff                    db          $FF
  2757  1cd1  ff                    db          $FF
  2758  1cd2  ff                    db          $FF
  2759  1cd3  ff                    db          $FF
  2760  1cd4  ff                    db          $FF
  2761  1cd5  ff                    db          $FF
  2762  1cd6  ff                    db          $FF
  2763  1cd7  ff                    db          $FF
  2764  1cd8  ff                    db          $FF
  2765  1cd9  ff                    db          $FF
  2766  1cda  ff                    db          $FF
  2767  1cdb  ff                    db          $FF
  2768  1cdc  ff                    db          $FF
  2769  1cdd  ff                    db          $FF
  2770  1cde  ff                    db          $FF
  2771  1cdf  ff                    db          $FF
  2772  1ce0  ff                    db          $FF
  2773  1ce1  ff                    db          $FF
  2774  1ce2  ff                    db          $FF
  2775  1ce3  ff                    db          $FF
  2776  1ce4  ff                    db          $FF
  2777  1ce5  ff                    db          $FF
  2778  1ce6  ff                    db          $FF
  2779  1ce7  ff                    db          $FF
  2780  1ce8  ff                    db          $FF
  2781  1ce9  ff                    db          $FF
  2782  1cea  ff                    db          $FF
  2783  1ceb  ff                    db          $FF
  2784  1cec  ff                    db          $FF
  2785  1ced  ff                    db          $FF
  2786  1cee  ff                    db          $FF
  2787  1cef  ff                    db          $FF
  2788  1cf0  ff                    db          $FF
  2789  1cf1  ff                    db          $FF
  2790  1cf2  ff                    db          $FF
  2791  1cf3  ff                    db          $FF
  2792  1cf4  ff                    db          $FF
  2793  1cf5  ff                    db          $FF
  2794  1cf6  ff                    db          $FF
  2795  1cf7  ff                    db          $FF
  2796  1cf8  ff                    db          $FF
  2797  1cf9  ff                    db          $FF
  2798  1cfa  ff                    db          $FF
  2799  1cfb  ff                    db          $FF
  2800  1cfc  ff                    db          $FF
  2801  1cfd  ff                    db          $FF
  2802  1cfe  ff                    db          $FF
  2803  1cff  ff                    db          $FF
  2804  1d00  ff                    db          $FF
  2805  1d01  ff                    db          $FF
  2806  1d02  ff                    db          $FF
  2807  1d03  ff                    db          $FF
  2808  1d04  ff                    db          $FF
  2809  1d05  ff                    db          $FF
  2810  1d06  ff                    db          $FF
  2811  1d07  ff                    db          $FF
  2812  1d08  ff                    db          $FF
  2813  1d09  ff                    db          $FF
  2814  1d0a  ff                    db          $FF
  2815  1d0b  ff                    db          $FF
  2816  1d0c  ff                    db          $FF
  2817  1d0d  ff                    db          $FF
  2818  1d0e  ff                    db          $FF
  2819  1d0f  ff                    db          $FF
  2820  1d10  ff                    db          $FF
  2821  1d11  ff                    db          $FF
  2822  1d12  ff                    db          $FF
  2823  1d13  ff                    db          $FF
  2824  1d14  ff                    db          $FF
  2825  1d15  ff                    db          $FF
  2826  1d16  ff                    db          $FF
  2827  1d17  ff                    db          $FF
  2828  1d18  ff                    db          $FF
  2829  1d19  ff                    db          $FF
  2830  1d1a  ff                    db          $FF
  2831  1d1b  ff                    db          $FF
  2832  1d1c  ff                    db          $FF
  2833  1d1d  ff                    db          $FF
  2834  1d1e  ff                    db          $FF
  2835  1d1f  ff                    db          $FF
  2836  1d20  ff                    db          $FF
  2837  1d21  ff                    db          $FF
  2838  1d22  ff                    db          $FF
  2839  1d23  ff                    db          $FF
  2840  1d24  ff                    db          $FF
  2841  1d25  ff                    db          $FF
  2842  1d26  ff                    db          $FF
  2843  1d27  ff                    db          $FF
  2844  1d28  ff                    db          $FF
  2845  1d29  ff                    db          $FF
  2846  1d2a  ff                    db          $FF
  2847  1d2b  ff                    db          $FF
  2848  1d2c  ff                    db          $FF
  2849  1d2d  ff                    db          $FF
  2850  1d2e  ff                    db          $FF
  2851  1d2f  ff                    db          $FF
  2852  1d30  ff                    db          $FF
  2853  1d31  ff                    db          $FF
  2854  1d32  ff                    db          $FF
  2855  1d33  ff                    db          $FF
  2856  1d34  ff                    db          $FF
  2857  1d35  ff                    db          $FF
  2858  1d36  ff                    db          $FF
  2859  1d37  ff                    db          $FF
  2860  1d38  ff                    db          $FF
  2861  1d39  ff                    db          $FF
  2862  1d3a  ff                    db          $FF
  2863  1d3b  ff                    db          $FF
  2864  1d3c  ff                    db          $FF
  2865  1d3d  ff                    db          $FF
  2866  1d3e  ff                    db          $FF
  2867  1d3f  ff                    db          $FF
  2868  1d40  ff                    db          $FF
  2869  1d41  ff                    db          $FF
  2870  1d42  ff                    db          $FF
  2871  1d43  ff                    db          $FF
  2872  1d44  ff                    db          $FF
  2873  1d45  ff                    db          $FF
  2874  1d46  ff                    db          $FF
  2875  1d47  ff                    db          $FF
  2876  1d48  ff                    db          $FF
  2877  1d49  ff                    db          $FF
  2878  1d4a  ff                    db          $FF
  2879  1d4b  ff                    db          $FF
  2880  1d4c  ff                    db          $FF
  2881  1d4d  ff                    db          $FF
  2882  1d4e  ff                    db          $FF
  2883  1d4f  ff                    db          $FF
  2884  1d50  ff                    db          $FF
  2885  1d51  ff                    db          $FF
  2886  1d52  ff                    db          $FF
  2887  1d53  ff                    db          $FF
  2888  1d54  ff                    db          $FF
  2889  1d55  ff                    db          $FF
  2890  1d56  ff                    db          $FF
  2891  1d57  ff                    db          $FF
  2892  1d58  ff                    db          $FF
  2893  1d59  ff                    db          $FF
  2894  1d5a  ff                    db          $FF
  2895  1d5b  ff                    db          $FF
  2896  1d5c  ff                    db          $FF
  2897  1d5d  ff                    db          $FF
  2898  1d5e  ff                    db          $FF
  2899  1d5f  ff                    db          $FF
  2900  1d60  ff                    db          $FF
  2901  1d61  ff                    db          $FF
  2902  1d62  ff                    db          $FF
  2903  1d63  ff                    db          $FF
  2904  1d64  ff                    db          $FF
  2905  1d65  ff                    db          $FF
  2906  1d66  ff                    db          $FF
  2907  1d67  ff                    db          $FF
  2908  1d68  ff                    db          $FF
  2909  1d69  ff                    db          $FF
  2910  1d6a  ff                    db          $FF
  2911  1d6b  ff                    db          $FF
  2912  1d6c  ff                    db          $FF
  2913  1d6d  ff                    db          $FF
  2914  1d6e  ff                    db          $FF
  2915  1d6f  ff                    db          $FF
  2916  1d70  ff                    db          $FF
  2917  1d71  ff                    db          $FF
  2918  1d72  ff                    db          $FF
  2919  1d73  ff                    db          $FF
  2920  1d74  ff                    db          $FF
  2921  1d75  ff                    db          $FF
  2922  1d76  ff                    db          $FF
  2923  1d77  ff                    db          $FF
  2924  1d78  ff                    db          $FF
  2925  1d79  ff                    db          $FF
  2926  1d7a  ff                    db          $FF
  2927  1d7b  ff                    db          $FF
  2928  1d7c  ff                    db          $FF
  2929  1d7d  ff                    db          $FF
  2930  1d7e  ff                    db          $FF
  2931  1d7f  ff                    db          $FF
  2932  1d80  ff                    db          $FF
  2933  1d81  ff                    db          $FF
  2934  1d82  ff                    db          $FF
  2935  1d83  ff                    db          $FF
  2936  1d84  ff                    db          $FF
  2937  1d85  ff                    db          $FF
  2938  1d86  ff                    db          $FF
  2939  1d87  ff                    db          $FF
  2940  1d88  ff                    db          $FF
  2941  1d89  ff                    db          $FF
  2942  1d8a  ff                    db          $FF
  2943  1d8b  ff                    db          $FF
  2944  1d8c  ff                    db          $FF
  2945  1d8d  ff                    db          $FF
  2946  1d8e  ff                    db          $FF
  2947  1d8f  ff                    db          $FF
  2948  1d90  ff                    db          $FF
  2949  1d91  ff                    db          $FF
  2950  1d92  ff                    db          $FF
  2951  1d93  ff                    db          $FF
  2952  1d94  ff                    db          $FF
  2953  1d95  ff                    db          $FF
  2954  1d96  ff                    db          $FF
  2955  1d97  ff                    db          $FF
  2956  1d98  ff                    db          $FF
  2957  1d99  ff                    db          $FF
  2958  1d9a  ff                    db          $FF
  2959  1d9b  ff                    db          $FF
  2960  1d9c  ff                    db          $FF
  2961  1d9d  ff                    db          $FF
  2962  1d9e  ff                    db          $FF
  2963  1d9f  ff                    db          $FF
  2964  1da0  ff                    db          $FF
  2965  1da1  ff                    db          $FF
  2966  1da2  ff                    db          $FF
  2967  1da3  ff                    db          $FF
  2968  1da4  ff                    db          $FF
  2969  1da5  ff                    db          $FF
  2970  1da6  ff                    db          $FF
  2971  1da7  ff                    db          $FF
  2972  1da8  ff                    db          $FF
  2973  1da9  ff                    db          $FF
  2974  1daa  ff                    db          $FF
  2975  1dab  ff                    db          $FF
  2976  1dac  ff                    db          $FF
  2977  1dad  ff                    db          $FF
  2978  1dae  ff                    db          $FF
  2979  1daf  ff                    db          $FF
  2980                          PLAY_POOF_ANIM:
  2981  1db0  e5                    PUSH        HL                                      ;Save HL register value
  2982  1db1  11b709                LD          DE,POOF_1                               ;DE = Start of POOF animation graphic
  2983  1db4  0670                  LD          B,$70                                  ;Set color to WHT on BLK
  2984  1db6  d9                    EXX                                                 ;Swap BC DE HL with BC' DE' HL'
  2985  1db7  cd7215                CALL        POOF_SOUND
  2986  1dba  d9                    EXX                                                 ;Swap BC DE HL with BC' DE' HL'
  2987  1dbb  cd3533                CALL        GFX_DRAW
  2988  1dbe  e1                    POP         HL                  ;Restore DE register value
  2989  1dbf  cdef1d                CALL        TOGGLE_ITEM_POOF_AND_WAIT
  2990  1dc2  e5                    PUSH        HL
  2991  1dc3  cd3533                CALL        GFX_DRAW
  2992  1dc6  e1                    POP         HL
  2993  1dc7  d5                    PUSH        DE
  2994  1dc8  112900                LD          DE,$29
  2995  1dcb  ed52                  SBC         HL,DE
  2996  1dcd  d1                    POP         DE                              ;= $D7,$C9,$01
  2997  1dce  cdef1d                CALL        TOGGLE_ITEM_POOF_AND_WAIT
  2998  1dd1  e5                    PUSH        HL
  2999  1dd2  cd3533                CALL        GFX_DRAW
  3000  1dd5  e1                    POP         HL
  3001  1dd6  e5                    PUSH        HL
  3002  1dd7  0680                  LD          B,$80
  3003  1dd9  cd3533                CALL        GFX_DRAW
  3004  1ddc  cdef1d                CALL        TOGGLE_ITEM_POOF_AND_WAIT
  3005  1ddf  e1                    POP         HL
  3006  1de0  e5                    PUSH        HL
  3007  1de1  cd3533                CALL        GFX_DRAW
  3008  1de4  cdef1d                CALL        TOGGLE_ITEM_POOF_AND_WAIT
  3009  1de7  06d0                  LD          B,$d0
  3010  1de9  e1                    POP         HL
  3011  1dea  cd3533                CALL        GFX_DRAW
  3012  1ded  08                    EX          AF,AF'
  3013  1dee  c9                    RET
  3014                          TOGGLE_ITEM_POOF_AND_WAIT:
  3015  1def  d9                    EXX
  3016  1df0  010032                LD          BC,DAT_ram_3200                         ;= $20
  3017  1df3  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  3018  1df6  d9                    EXX
  3019  1df7  c9                    RET
  3020  1df8  ff                    db          $FF
  3021  1df9  ff                    db          $FF
  3022  1dfa  ff                    db          $FF
  3023  1dfb  ff                    db          $FF
  3024  1dfc  ff                    db          $FF
  3025  1dfd  ff                    db          $FF
  3026  1dfe  ff                    db          $FF
  3027  1dff  ff                    db          $FF
  3028  1e00  ff                    db          $FF
  3029  1e01  ff                    db          $FF
  3030  1e02  ff                    db          $FF
  3031  1e03  ff                    db          $FF
  3032  1e04  ff                    db          $FF
  3033  1e05  ff                    db          $FF
  3034  1e06  ff                    db          $FF
  3035  1e07  ff                    db          $FF
  3036  1e08  ff                    db          $FF
  3037  1e09  ff                    db          $FF
  3038  1e0a  ff                    db          $FF
  3039  1e0b  ff                    db          $FF
  3040  1e0c  ff                    db          $FF
  3041  1e0d  ff                    db          $FF
  3042  1e0e  ff                    db          $FF
  3043  1e0f  ff                    db          $FF
  3044                          MONSTER_KILLED:
  3045  1e10  213b32                LD          HL,CHRRAM_MONSTER_POOF_IDX              ;= $20
  3046  1e13  cdb01d                CALL        PLAY_POOF_ANIM
  3047  1e16  3a793a                LD          A,(PLAYER_MAP_POS)                      ;A  = Player position in map
  3048  1e19  2a603a                LD          HL,(DIR_FACING_FW)                      ;HL = FW adjustment value
  3049  1e1c  84                    ADD         A,H                                     ;A  = Player position in map
  3050                                                                                  ;one step forward
  3051  1e1d  cdf337                CALL        ITEM_MAP_CHECK                          ;Upon return,
  3052                                                                                  ;A  = itemNum one step forward
  3053                                                                                  ;BC = itemMapRAMLocation
  3054  1e20  fe9f                  CP          $9f                                    ;Check to see if it is
  3055                                                                                  ;the Minotaur ($9f)
  3056  1e22  caf43a                JP          Z,MINOTAUR_DEAD
  3057  1e25  3efe                  LD          A,$fe                                  ;A  = $fe (empty item space)
  3058  1e27  02                    LD          (BC),A                                  ;itemMapLocRAM = $fe (empty)
  3059  1e28  cdab25                CALL        CLEAR_MONSTER_STATS
  3060  1e2b  00                    db          $00
  3061  1e2c  00                    db          $00
  3062  1e2d  00                    db          $00
  3063  1e2e  00                    db          $00
  3064  1e2f  00                    db          $00
  3065  1e30  00                    db          $00
  3066  1e31  00                    db          $00
  3067  1e32  00                    db          $00
  3068  1e33  00                    db          $00
  3069  1e34  00                    db          $00
  3070  1e35  00                    db          $00
  3071  1e36  00                    db          $00
  3072  1e37  00                    db          $00
  3073  1e38  00                    db          $00
  3074  1e39  00                    db          $00
  3075  1e3a  00                    db          $00
  3076  1e3b  00                    db          $00
  3077  1e3c  00                    db          $00
  3078  1e3d  00                    db          $00
  3079  1e3e  00                    db          $00
  3080  1e3f  00                    db          $00
  3081  1e40  00                    db          $00
  3082  1e41  00                    db          $00
  3083  1e42  e1                    POP         HL
  3084  1e43  c3962a                JP          UPDATE_VIEWPORT
  3085                          TOGGLE_SHIFT_MODE:
  3086  1e46  3ab93a                LD          A,(GAME_BOOLEANS)
  3087  1e49  cb4f                  BIT         0x1,A                                   ;NZ if SHIFT MODE
  3088  1e4b  200d                  JR          NZ,RESET_SHIFT_MODE
  3089                          SET_SHIFT_MODE:
  3090  1e4d  cbcf                  SET         0x1,A                                   ;Set SHIFT MODE boolean
  3091  1e4f  32b93a                LD          (GAME_BOOLEANS),A
  3092  1e52  3ed0                  LD          A,$d0                                  ;DKGRN on BLK
  3093  1e54  320534                LD          (COLRAM_SHIFT_MODE_IDX),A               ;= $60    `
  3094  1e57  c39c2a                JP          INPUT_DEBOUNCE
  3095                          RESET_SHIFT_MODE:
  3096  1e5a  3ab93a                LD          A,(GAME_BOOLEANS)                       ;Reset SHIFT MODE boolean
  3097  1e5d  cb8f                  RES         0x1,A
  3098  1e5f  32b93a                LD          (GAME_BOOLEANS),A
  3099  1e62  3ef0                  LD          A,$f0
  3100  1e64  320534                LD          (COLRAM_SHIFT_MODE_IDX),A               ;= $60    `
  3101  1e67  c39c2a                JP          INPUT_DEBOUNCE
  3102                          SHOW_AUTHOR:
  3103  1e6a  214833                LD          HL,CHRRAM_AUTHORS_IDX                   ;= $20
  3104  1e6d  11110c                LD          DE,AUTHORS                              ;= "   Originally programmed by Tom L...
  3105  1e70  0620                  LD          B,$20
  3106  1e72  cd3533                CALL        GFX_DRAW
  3107  1e75  3eff                  LD          A,$ff
  3108  1e77  c39f2a                JP          WAIT_FOR_INPUT
  3109                          TIMER_UPDATE:
  3110  1e7a  2a693a                LD          HL,(TIMER_A)
  3111  1e7d  010100                LD          BC,0x1
  3112  1e80  09                    ADD         HL,BC
  3113  1e81  22693a                LD          (TIMER_A),HL
  3114  1e84  c9                    RET
  3115                          BLINK_ROUTINE:
  3116  1e85  f5                    PUSH        AF
  3117  1e86  3ab93a                LD          A,(GAME_BOOLEANS)
  3118  1e89  cb47                  BIT         0x0,A
  3119  1e8b  2807                  JR          Z,STILL_ON_TITLE
  3120  1e8d  1803                  JR          BLINK_EXIT_AF
  3121                          BLINK_EXIT_ALL:
  3122  1e8f  d1                    POP         DE
  3123  1e90  e1                    POP         HL
  3124                          BLINK_EXIT_BCAF:
  3125  1e91  c1                    POP         BC
  3126                          BLINK_EXIT_AF:
  3127  1e92  f1                    POP         AF
  3128  1e93  c9                    RET
  3129                          STILL_ON_TITLE:
  3130  1e94  c5                    PUSH        BC
  3131  1e95  3a6a3a                LD          A,(TIMER_B)
  3132  1e98  47                    LD          B,A
  3133  1e99  3aba3a                LD          A,(NEXT_BLINK_CHECK)
  3134  1e9c  b8                    CP          B
  3135  1e9d  20f2                  JR          NZ,BLINK_EXIT_BCAF
  3136  1e9f  ed5f                  LD          A,R
  3137  1ea1  32ba3a                LD          (NEXT_BLINK_CHECK),A
  3138  1ea4  e5                    PUSH        HL
  3139  1ea5  d5                    PUSH        DE
  3140  1ea6  cdcb1e                CALL        DO_CLOSE_EYES
  3141  1ea9  010080                LD          BC,$8000
  3142  1eac  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  3143  1eaf  cdb41e                CALL        DO_OPEN_EYES
  3144  1eb2  18db                  JR          BLINK_EXIT_ALL
  3145                          DO_OPEN_EYES:
  3146  1eb4  11d632                LD          DE,$32d6
  3147  1eb7  210000                LD          HL,TS_EYES_OPEN_CHR                    ; Pinned to TITLE_SCREEN (0xD800) + 726; WAS 0xdad6
  3148  1eba  014400                LD          BC,$44
  3149  1ebd  edb0                  LDIR
  3150  1ebf  11d636                LD          DE,$36d6
  3151  1ec2  210000                LD          HL,TS_EYES_OPTN_COL                    ; Pinned to TITLE_SCREEN (0XD800) + 1750; WAS 0xded6
  3152  1ec5  014400                LD          BC,$44
  3153  1ec8  edb0                  LDIR
  3154  1eca  c9                    RET
  3155                          DO_CLOSE_EYES:
  3156  1ecb  21d632                LD          HL,$32d6
  3157  1ece  01d0d1                LD          BC,$d1d0                    ; Value, not an address
  3158  1ed1  70                    LD          (HL),B
  3159  1ed2  23                    INC         HL
  3160  1ed3  70                    LD          (HL),B
  3161  1ed4  111a00                LD          DE,$1a
  3162  1ed7  19                    ADD         HL,DE
  3163  1ed8  70                    LD          (HL),B
  3164  1ed9  2b                    DEC         HL
  3165  1eda  70                    LD          (HL),B
  3166  1edb  21fe32                LD          HL,$32fe
  3167  1ede  71                    LD          (HL),C
  3168  1edf  23                    INC         HL
  3169  1ee0  70                    LD          (HL),B
  3170  1ee1  19                    ADD         HL,DE
  3171  1ee2  70                    LD          (HL),B
  3172  1ee3  2b                    DEC         HL
  3173  1ee4  71                    LD          (HL),C
  3174  1ee5  21d636                LD          HL,$36d6
  3175  1ee8  010ff0                LD          BC,$f00f                    ; Value, not an address
  3176  1eeb  70                    LD          (HL),B
  3177  1eec  23                    INC         HL
  3178  1eed  71                    LD          (HL),C
  3179  1eee  19                    ADD         HL,DE
  3180  1eef  71                    LD          (HL),C
  3181  1ef0  2b                    DEC         HL
  3182  1ef1  70                    LD          (HL),B
  3183  1ef2  21fe36                LD          HL,$36fe
  3184  1ef5  70                    LD          (HL),B
  3185  1ef6  23                    INC         HL
  3186  1ef7  70                    LD          (HL),B
  3187  1ef8  19                    ADD         HL,DE
  3188  1ef9  70                    LD          (HL),B
  3189  1efa  2b                    DEC         HL
  3190  1efb  70                    LD          (HL),B
  3191  1efc  c9                    RET
  3192  1efd  00                    db          $00
  3193  1efe  00                    db          $00
  3194  1eff  00                    db          $00
  3195                          DRAW_ICON_BAR:
  3196  1f00  f5                    PUSH        AF
  3197  1f01  e5                    PUSH        HL
  3198  1f02  210130                LD          HL,CHRRAM_LEVEL_IND_L                   ;= $20
  3199  1f05  3685                  LD          (HL),$85           ;Right side halftone CHR
  3200  1f07  23                    INC         HL
  3201  1f08  23                    INC         HL
  3202  1f09  23                    INC         HL
  3203  1f0a  3695                  LD          (HL),$95           ;Left side halftone CHR
  3204  1f0c  23                    INC         HL
  3205  1f0d  3608                  LD          (HL),0x8         ;Up arrow CHR
  3206  1f0f  23                    INC         HL
  3207  1f10  23                    INC         HL
  3208  1f11  3648                  LD          (HL),$48            ;Ladder (H) CHR
  3209  1f13  23                    INC         HL
  3210  1f14  23                    INC         HL
  3211  1f15  36d3                  LD          (HL),$d3              ;Item CHR
  3212  1f17  23                    INC         HL
  3213  1f18  23                    INC         HL
  3214  1f19  3693                  LD          (HL),$93           ;Monster CHR
  3215  1f1b  23                    INC         HL
  3216  1f1c  23                    INC         HL
  3217  1f1d  3685                  LD          (HL),$85              ;Right side halftone CHR
  3218  1f1f  00                    NOP
  3219  1f20  00                    NOP
  3220  1f21  23                    INC         HL
  3221  1f22  23                    INC         HL
  3222  1f23  23                    INC         HL
  3223  1f24  23                    INC         HL                                      ;Map CHR
  3224  1f25  36d1                  LD          (HL),$d1               ;= $20
  3225  1f27  23                    INC         HL
  3226  1f28  23                    INC         HL                                      ;Armor CHR
  3227  1f29  369d                  LD          (HL),$9d             ;= $20
  3228  1f2b  23                    INC         HL
  3229  1f2c  23                    INC         HL                                      ;Helmet CHR
  3230  1f2d  360e                  LD          (HL),0xe             ;= $20
  3231  1f2f  23                    INC         HL
  3232  1f30  23                    INC         HL                                      ;Ring (o) CHR
  3233  1f31  366f                  LD          (HL),$6f              ;= $20
  3234  1f33  00                    NOP
  3235  1f34  00                    NOP
  3236  1f35  00                    NOP
  3237  1f36  00                    NOP
  3238  1f37  00                    NOP
  3239  1f38  00                    NOP
  3240  1f39  00                    NOP
  3241  1f3a  00                    NOP
  3242  1f3b  00                    NOP
  3243  1f3c  00                    NOP
  3244  1f3d  e1                    POP         HL
  3245  1f3e  f1                    POP         AF
  3246  1f3f  c9                    RET
  3247                          DRAW_COMPASS:
  3248  1f40  f5                    PUSH        AF                                      ;DKBLU on BLK
  3249  1f41  c5                    PUSH        BC
  3250  1f42  e5                    PUSH        HL
  3251  1f43  d5                    PUSH        DE
  3252  1f44  06b0                  LD          B,$b0
  3253  1f46  21af31                LD          HL,DAT_ram_31af                         ;= $20
  3254  1f49  117f19                LD          DE,COMPASS                              ;= $D7,"n",$C9,$01
  3255  1f4c  cd3533                CALL        GFX_DRAW
  3256  1f4f  21d835                LD          HL,DAT_ram_35d8                         ;= $60
  3257  1f52  3610                  LD          (HL),$10                 ;= $60
  3258  1f54  d1                    POP         DE
  3259  1f55  e1                    POP         HL
  3260  1f56  c1                    POP         BC
  3261  1f57  f1                    POP         AF
  3262  1f58  c9                    RET
  3263  1f59  00                    db          $00
  3264  1f5a  00                    db          $00
  3265  1f5b  00                    db          $00
  3266  1f5c  00                    db          $00
  3267  1f5d  00                    db          $00
  3268  1f5e  00                    db          $00
  3269  1f5f  00                    db          $00
  3270  1f60  00                    db          $00
  3271  1f61  00                    db          $00
  3272  1f62  00                    db          $00
  3273  1f63  00                    db          $00
  3274  1f64  00                    db          $00
  3275  1f65  00                    db          $00
  3276  1f66  00                    db          $00
  3277                          WIPE_WALLS:
  3278  1f67  f5                    PUSH        AF
  3279  1f68  c5                    PUSH        BC
  3280  1f69  e5                    PUSH        HL
  3281  1f6a  210038                LD          HL,$3800
  3282  1f6d  010000                LD          BC,0x0
  3283  1f70  3e00                  LD          A,0x0
  3284                          WIPE_WALLS_LOOP:
  3285  1f72  77                    LD          (HL),A
  3286  1f73  23                    INC         HL
  3287  1f74  10fc                  DJNZ        WIPE_WALLS_LOOP
  3288  1f76  e1                    POP         HL
  3289  1f77  c1                    POP         BC
  3290  1f78  f1                    POP         AF
  3291  1f79  cd962a                CALL        UPDATE_VIEWPORT
  3292  1f7c  c39c2a                JP          INPUT_DEBOUNCE
  3293  1f7f  00                    db          $00
  3294  1f80  00                    db          $00
  3295  1f81  00                    db          $00
  3296  1f82  00                    db          $00
  3297  1f83  00                    db          $00
  3298  1f84  00                    db          $00
  3299  1f85  00                    db          $00
  3300  1f86  00                    db          $00
  3301  1f87  00                    db          $00
  3302  1f88  00                    db          $00
  3303  1f89  00                    db          $00
  3304  1f8a  00                    db          $00
  3305  1f8b  00                    db          $00
  3306  1f8c  00                    db          $00
  3307  1f8d  00                    db          $00
  3308  1f8e  00                    db          $00
  3309  1f8f  00                    db          $00
  3310  1f90  00                    db          $00
  3311  1f91  00                    db          $00
  3312  1f92  00                    db          $00
  3313  1f93  00                    db          $00
  3314  1f94  00                    db          $00
  3315  1f95  00                    db          $00
  3316  1f96  00                    db          $00
  3317  1f97  00                    db          $00
  3318  1f98  00                    db          $00
  3319  1f99  00                    db          $00
  3320  1f9a  00                    db          $00
  3321  1f9b  00                    db          $00
  3322  1f9c  00                    db          $00
  3323  1f9d  00                    db          $00
  3324  1f9e  00                    db          $00
  3325  1f9f  00                    db          $00
  3326  1fa0  00                    db          $00
  3327  1fa1  00                    db          $00
  3328  1fa2  00                    db          $00
  3329  1fa3  00                    db          $00
  3330  1fa4  00                    db          $00
  3331                          DRAW_WALL_FL22_EMPTY:
  3332  1fa5  21b835                LD          HL,COLRAM_FL22_WALL_IDX                 ;= $60    `
  3333  1fa8  010404                LD          BC,$404                                ;4 x 4 rectangle
  3334  1fab  3e00                  LD          A,0x0                                   ;BLK on BLK
  3335  1fad  cdcb10                CALL        FILL_CHRCOL_RECT
  3336  1fb0  213032                LD          HL,DAT_ram_3230                         ;= $20
  3337  1fb3  010104                LD          BC,$401                                ;4 x 1 rectangle
  3338  1fb6  3e20                  LD          A,$20                                  ;SPACE char
  3339  1fb8  c3cb10                JP          FILL_CHRCOL_RECT
  3340                          DRAW_WALL_FL2_NEW:
  3341  1fbb  213432                LD          HL,$3234                               ;Bottom CHARRAM IDX of FL2
  3342  1fbe  010104                LD          BC,$401                                ;4 x 1 rectangle
  3343  1fc1  3e90                  LD          A,$90                                  ;Thin base line char
  3344  1fc3  cdcb10                CALL        FILL_CHRCOL_RECT
  3345  1fc6  21bc35                LD          HL,$35bc
  3346  1fc9  010402                LD          BC,$204                                ;2 x 4 rectangle
  3347  1fcc  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
  3348  1fce  cdcb10                CALL        FILL_CHRCOL_RECT
  3349  1fd1  0e04                  LD          C,0x4
  3350  1fd3  21be35                LD          HL,$35be
  3351  1fd6  3e0f                  LD          A,0xf
  3352  1fd8  c3ce10                JP          DRAW_CHRCOLS
  3353                          FIX_ICON_COLORS:
  3354  1fdb  210134                LD          HL,COLRAM_LEVEL_IDX_L                   ;= $60
  3355  1fde  3a6c3a                LD          A,(INPUT_HOLDER)
  3356  1fe1  87                    ADD         A,A
  3357  1fe2  d601                  SUB         0x1
  3358  1fe4  77                    LD          (HL),A              ;= $60
  3359  1fe5  2c                    INC         L
  3360  1fe6  77                    LD          (HL),A             ;= $60
  3361  1fe7  2c                    INC         L
  3362  1fe8  77                    LD          (HL),A              ;= $60
  3363  1fe9  2c                    INC         L
  3364  1fea  77                    LD          (HL),A              ;= $60
  3365  1feb  210534                LD          HL,COLRAM_SHIFT_MODE_IDX                ;= $60    `
  3366  1fee  010013                LD          BC,$1300
  3367  1ff1  2b                    DEC         HL
  3368                          ICON_GREY_FILL_LOOP:
  3369  1ff2  23                    INC         HL
  3370  1ff3  36f0                  LD          (HL),$f0
  3371  1ff5  10fb                  DJNZ        ICON_GREY_FILL_LOOP
  3372  1ff7  00                    NOP
  3373  1ff8  00                    NOP
  3374  1ff9  00                    NOP
  3375  1ffa  00                    NOP
  3376  1ffb  00                    NOP
  3377  1ffc  00                    NOP
  3378  1ffd  00                    NOP
  3379  1ffe  00                    NOP
  3380  1fff  c9                    RET
  3381                          
src/asterion.asm:
    16                          
    17                          include "scramblecode.asm"
src/scramblecode.asm:
     1                          ; Aquarius SCRAMBLECODE include file
     2                          SCRAMBLECODE:
     3  2000  3e5b5e00              DB 0x3e,0x5b,0x5e,0x00
     4  2004  009c00b0              DB 0x00,0x9c,0x00,0xb0
     5  2008  006c0064              DB 0x00,0x6c,0x00,0x64
     6  200c  00a85e70              DB 0x00,0xa8,0x5e,0x70
     7                          
src/asterion.asm:
    18                          
    19                          include "asterion_high_rom.asm"
src/asterion_high_rom.asm:
     1                          GAMEINIT:
     2  2010  31ff3f                LD          SP,$3fff                      ;Set SP to top of BANK0 RAM
     3  2013  cdfe19                CALL        WIPE_VARIABLE_SPACE                     ;Wipe variable space first...
     4  2016  3602                  LD          (HL),0x2              ;($3a62) = 0x2
     5  2018  2c                    INC         L                                       ;HL = $3a63
     6  2019  3e32                  LD          A,$32                                  ;A = $32
     7  201b  77                    LD          (HL),A                          ;($3a63) = $32
     8  201c  2c                    INC         L                                       ;HL = $3a64
     9  201d  77                    LD          (HL),A                          ;($3a64) = $32
    10  201e  2c                    INC         L                                       ;HL = $3a65
    11  201f  77                    LD          (HL),A                          ;($3a65) = $32
    12  2020  2c                    INC         L                                       ;HL = $3a66
    13  2021  3d                    DEC         A                                       ;A = $31
    14  2022  77                    LD          (HL),A                          ;($3a66) = $31
    15  2023  2c                    INC         L                                       ;HL = $3a67
    16  2024  77                    LD          (HL),A                          ;($3a67) = $31
    17  2025  2c                    INC         L                                       ;HL = $3a68
    18  2026  0612                  LD          B,$12                                  ;B = $12
    19  2028  af                    XOR         A                                       ;A = 0x0, F = $44 (Z and P set)
    20                          LAB_ram_e029:
    21  2029  77                    LD          (HL),A                   ;($3a68) = $00
    22  202a  2c                    INC         L                                       ;HL = $3a69 to $3a7a,
    23                                                                                  ;A = 0x0, F = $28
    24  202b  10fc                  DJNZ        LAB_ram_e029                            ;Loop if Not Z (B is decremented)
    25  202d  3e18                  LD          A,$18                                  ;A = $18 (HL = $3a7a, B = 0x0)
    26  202f  77                    LD          (HL),A                         ;($3a7a) = $18
    27  2030  23                    INC         HL                                      ;HL = $3a7b
    28  2031  3efe                  LD          A,$fe                                  ;A = $fe
    29  2033  0610                  LD          B,$10                                  ;B = $10
    30                          LAB_ram_e035:
    31  2035  77                    LD          (HL),A                         ;= $60
    32  2036  23                    INC         HL
    33  2037  10fc                  DJNZ        LAB_ram_e035                            ;Loop if Not Z (B is decremented)
    34  2039  0620                  LD          B,$20                                  ;Set fill CHR to SPACE 32/$20
    35  203b  210030                LD          HL,CHRRAM                               ;HL = $3000 (Start of CHRRAM)
    36  203e  cd591e                CALL        FILL_FULL_1024                          ;byte FILL_FULL_1024(word chrColValue...
    37  2041  215e00                LD          HL,$5e                                 ;HL = $005e
    38  2044  229c3a                LD          (TIMER_E),HL                            ;($3a9c) = $0053
    39  2047  ed5f                  LD          A,R                                     ;Semi-random number into A
    40  2049  67                    LD          H,A
    41  204a  22913a                LD          (RNDHOLD_AA),HL
    42  204d  017f00                LD          BC,$7f
    43  2050  3e07                  LD          A,0x7
    44  2052  ed79                  OUT         (C),A                          ;= db
    45  2054  0d                    DEC         C
    46  2055  3e3f                  LD          A,$3f
    47  2057  ed79                  OUT         (C),A                          ;= db
    48  2059  0606                  LD          B,0x6                                   ;BLK on CYN
    49  205b  210034                LD          HL,COLRAM                               ;= $60
    50  205e  cd591e                CALL        FILL_FULL_1024                          ;byte FILL_FULL_1024(word chrColValue...
    51  2061  cdac2c                CALL        CHK_ITEM
    52  2064  cd6b20                CALL        DRAW_TITLE
    53  2067  c39c2a                JP          INPUT_DEBOUNCE
    54  206a  00                    NOP
    55                          DRAW_TITLE:
    56  206b  110030                LD          DE,CHRRAM                               ;= $20
    57  206e  210000                LD          HL,TITLE_SCREEN                    ; Pinned to TITLE_SCREEN ; WAS 0xD800
    58  2071  01e803                LD          BC,$3e8
    59  2074  edb0                  LDIR                                                ;= $20
    60  2076  110034                LD          DE,COLRAM                               ;= $60
    61  2079  210000                LD          HL,TITLE_SCREEN_COL                    ; Pinned to TITLE_SCREEN ; WAS 0xD800 + 1024
    62  207c  01e803                LD          BC,$3e8
    63  207f  edb0                  LDIR                                                ;= $60
    64                                                                                  ;= $70
    65  2081  c9                    RET
    66  2082  00                    db          $00
    67  2083  00                    db          $00
    68  2084  00                    db          $00
    69  2085  00                    db          $00
    70  2086  00                    db          $00
    71  2087  00                    db          $00
    72  2088  00                    db          $00
    73  2089  00                    db          $00
    74  208a  00                    db          $00
    75  208b  00                    db          $00
    76  208c  00                    db          $00
    77  208d  00                    db          $00
    78  208e  00                    db          $00
    79  208f  00                    db          $00
    80  2090  00                    db          $00
    81  2091  00                    db          $00
    82  2092  00                    db          $00
    83  2093  00                    db          $00
    84  2094  00                    db          $00
    85  2095  00                    db          $00
    86                          BLANK_SCRN:
    87  2096  210030                LD          HL,CHRRAM                               ;= $20
    88  2099  0620                  LD          B,$20                                  ;SPACE char
    89  209b  cd591e                CALL        FILL_FULL_1024                          ;byte FILL_FULL_1024(word chrColValue...
    90  209e  210034                LD          HL,COLRAM                               ;= $60
    91  20a1  06d0                  LD          B,$d0                                  ;DKGRN on BLK
    92  20a3  cd591e                CALL        FILL_FULL_1024                          ;byte FILL_FULL_1024(word chrColValue...
    93  20a6  116e09                LD          DE,STATS_TXT                            ;DE = STATS_TXT
    94  20a9  211930                LD          HL,CHRRAM_STATS_TOP                     ;HL = CHRRAM_STATS_TOP
    95  20ac  06d0                  LD          B,$d0                                  ;DKGRN on BLK
    96  20ae  cd3533                CALL        GFX_DRAW
    97  20b1  214530                LD          HL,IDX_HEALTH_SPACER                    ;= $20
    98  20b4  cd3533                CALL        GFX_DRAW
    99  20b7  213000                LD          HL,$30                                 ;Set starting PHYS HEALTH = 30
   100  20ba  1e15                  LD          E,$15                                  ;Set starting SPRT HEALTH = 15
   101  20bc  22933a                LD          (PLAYER_PHYS_HEALTH),HL
   102  20bf  22953a                LD          (PLAYER_PHYS_HEALTH_MAX),HL
   103  20c2  7b                    LD          A,E
   104  20c3  32973a                LD          (PLAYER_SPRT_HEALTH),A
   105  20c6  32983a                LD          (PLAYER_SPRT_HEALTH_MAX),A
   106  20c9  cd5d3d                CALL        REDRAW_STATS
   107  20cc  212000                LD          HL,$20
   108  20cf  22a93a                LD          (BYTE_ram_3aa9),HL
   109  20d2  3e14                  LD          A,$14
   110  20d4  32ab3a                LD          (FOOD_INV),A                            ;Set starting FOOD_INV  = 14
   111  20d7  32ac3a                LD          (ARROW_INV),A                           ;Set starting ARROW INV = 14
   112  20da  0610                  LD          B,$10                                  ;RED on BLK
   113  20dc  217132                LD          HL,CHRRAM_LEFT_HAND_ITEM_IDX            ;= $20
   114  20df  11c10a                LD          DE,BOW                                  ;= $01,$01,$01,$01,$01
   115  20e2  cd3533                CALL        GFX_DRAW
   116  20e5  cddb1f                CALL        FIX_ICON_COLORS
   117  20e8  cd401f                CALL        DRAW_COMPASS
   118  20eb  00                    NOP
   119  20ec  00                    NOP
   120  20ed  00                    NOP
   121  20ee  00                    NOP
   122  20ef  00                    NOP
   123  20f0  00                    NOP
   124  20f1  00                    NOP
   125  20f2  00                    NOP
   126  20f3  00                    NOP
   127  20f4  3d                    DEC         A
   128  20f5  47                    LD          B,A
   129  20f6  3e03                  LD          A,0x3
   130  20f8  90                    SUB         B
   131  20f9  327a3a                LD          (RIGHT_HAND_ITEM),A
   132  20fc  0f                    RRCA
   133  20fd  3804                  JR          C,LAB_ram_e103
   134  20ff  0610                  LD          B,$10                                  ;Right hand RED SHIELD_L
   135  2101  1802                  JR          ADJUST_SHIELD_LEVEL
   136                          LAB_ram_e103:
   137  2103  0630                  LD          B,$30
   138                          ADJUST_SHIELD_LEVEL:
   139  2105  0f                    RRCA
   140  2106  3004                  JR          NC,LAB_ram_e10c
   141  2108  3e40                  LD          A,$40
   142  210a  80                    ADD         A,B
   143  210b  47                    LD          B,A
   144                          LAB_ram_e10c:
   145  210c  3e18                  LD          A,$18                                  ;Left hand RED BOW
   146  210e  327b3a                LD          (LEFT_HAND_ITEM),A
   147  2111  217b32                LD          HL,CHRRAM_RIGHT_HAND_ITEM_IDX           ;= $20
   148  2114  11520a                LD          DE,BUCKLER                              ;= $01,$01,$01,$01,$01
   149  2117  cd3533                CALL        GFX_DRAW
   150  211a  cda333                CALL        BUILD_MAP
   151  211d  cdbf15                CALL        SUB_ram_cdbf
   152  2120  cdc432                CALL        SUB_ram_f2c4
   153  2123  cde634                CALL        REDRAW_START
   154  2126  cd0438                CALL        REDRAW_VIEWPORT
   155  2129  c3cc26                JP          DO_SWAP_HANDS
   156  212c  00                    db          $00
   157  212d  00                    db          $00
   158  212e  00                    db          $00
   159  212f  00                    db          $00
   160  2130  00                    db          $00
   161  2131  00                    db          $00
   162  2132  00                    db          $00
   163  2133  00                    db          $00
   164  2134  00                    db          $00
   165  2135  00                    db          $00
   166  2136  00                    db          $00
   167  2137  00                    db          $00
   168  2138  00                    db          $00
   169  2139  00                    db          $00
   170  213a  00                    db          $00
   171  213b  00                    db          $00
   172  213c  00                    db          $00
   173  213d  00                    db          $00
   174  213e  00                    db          $00
   175  213f  00                    db          $00
   176  2140  00                    db          $00
   177  2141  00                    db          $00
   178  2142  00                    db          $00
   179  2143  00                    db          $00
   180  2144  00                    db          $00
   181  2145  00                    db          $00
   182  2146  00                    db          $00
   183  2147  00                    db          $00
   184  2148  00                    db          $00
   185  2149  00                    db          $00
   186  214a  00                    db          $00
   187  214b  00                    db          $00
   188  214c  00                    db          $00
   189  214d  00                    db          $00
   190  214e  00                    db          $00
   191  214f  00                    db          $00
   192  2150  00                    db          $00
   193  2151  00                    db          $00
   194  2152  00                    db          $00
   195  2153  00                    db          $00
   196  2154  00                    db          $00
   197  2155  00                    db          $00
   198  2156  00                    db          $00
   199  2157  00                    db          $00
   200  2158  00                    db          $00
   201  2159  00                    db          $00
   202  215a  00                    db          $00
   203  215b  00                    db          $00
   204  215c  00                    db          $00
   205  215d  00                    db          $00
   206  215e  00                    db          $00
   207  215f  00                    db          $00
   208  2160  00                    db          $00
   209  2161  00                    db          $00
   210  2162  00                    db          $00
   211  2163  00                    db          $00
   212  2164  00                    db          $00
   213  2165  00                    db          $00
   214  2166  00                    db          $00
   215  2167  00                    db          $00
   216  2168  00                    db          $00
   217  2169  00                    db          $00
   218  216a  00                    db          $00
   219  216b  00                    db          $00
   220  216c  00                    db          $00
   221  216d  00                    db          $00
   222  216e  00                    db          $00
   223  216f  00                    db          $00
   224  2170  00                    db          $00
   225  2171  00                    db          $00
   226  2172  00                    db          $00
   227  2173  00                    db          $00
   228  2174  00                    db          $00
   229  2175  00                    db          $00
   230  2176  00                    db          $00
   231  2177  00                    db          $00
   232  2178  00                    db          $00
   233  2179  00                    db          $00
   234  217a  00                    db          $00
   235  217b  00                    db          $00
   236  217c  00                    db          $00
   237  217d  00                    db          $00
   238  217e  00                    db          $00
   239  217f  00                    db          $00
   240  2180  00                    db          $00
   241  2181  00                    db          $00
   242  2182  00                    db          $00
   243  2183  00                    db          $00
   244  2184  00                    db          $00
   245  2185  00                    db          $00
   246  2186  00                    db          $00
   247  2187  00                    db          $00
   248  2188  00                    db          $00
   249  2189  00                    db          $00
   250  218a  00                    db          $00
   251  218b  00                    db          $00
   252  218c  00                    db          $00
   253  218d  00                    db          $00
   254  218e  00                    db          $00
   255  218f  00                    db          $00
   256  2190  00                    db          $00
   257  2191  00                    db          $00
   258  2192  00                    db          $00
   259  2193  00                    db          $00
   260  2194  00                    db          $00
   261  2195  00                    db          $00
   262  2196  00                    db          $00
   263  2197  00                    db          $00
   264  2198  00                    db          $00
   265  2199  00                    db          $00
   266  219a  00                    db          $00
   267  219b  00                    db          $00
   268  219c  00                    db          $00
   269  219d  00                    db          $00
   270                          DO_MOVE_FW_CHK_WALLS:
   271  219e  3ae833                LD          A,(WALL_F0_STATE)                       ;= $20
   272  21a1  fe00                  CP          0x0                                     ;Check for no wall in F0
   273  21a3  caab21                JP          Z,FW_WALLS_CLEAR_CHK_MONSTER
   274  21a6  cb57                  BIT         0x2,A                                   ;Check for closed door
   275  21a8  ca3022                JP          Z,NO_ACTION_TAKEN
   276                          FW_WALLS_CLEAR_CHK_MONSTER:
   277  21ab  3ae937                LD          A,(ITEM_F1)                             ;= $60
   278  21ae  3c                    INC         A
   279  21af  3c                    INC         A
   280  21b0  fe7a                  CP          $7a                                    ;Check for monster in F1
   281  21b2  d23022                JP          NC,NO_ACTION_TAKEN                      ;Monster in your way!
   282                                                                                  ;Do nothing.
   283  21b5  ed4b603a              LD          BC,(DIR_FACING_FW)                      ;Way is clear!
   284                                                                                  ;Move forward.
   285  21b9  ed439e3a              LD          (BYTE_ram_3a9e),BC
   286  21bd  3a623a                LD          A,(DIR_FACING_SHORT)
   287  21c0  32a03a                LD          (BYTE_ram_3aa0),A
   288  21c3  3a793a                LD          A,(PLAYER_MAP_POS)
   289  21c6  32773a                LD          (PLAYER_PREV_MAP_LOC),A
   290  21c9  80                    ADD         A,B
   291  21ca  32793a                LD          (PLAYER_MAP_POS),A
   292  21cd  c3962a                JP          UPDATE_VIEWPORT
   293                          DO_JUMP_BACK:
   294  21d0  21793a                LD          HL,PLAYER_MAP_POS
   295  21d3  3a773a                LD          A,(PLAYER_PREV_MAP_LOC)
   296  21d6  be                    CP          (HL)
   297  21d7  ca0122                JP          Z,LAB_ram_e201
   298  21da  08                    EX          AF,AF'
   299  21db  2a9e3a                LD          HL,(BYTE_ram_3a9e)
   300  21de  3a613a                LD          A,(DIR_FACING_BW)
   301  21e1  ed44                  NEG                                                 ;Negate A
   302  21e3  bc                    CP          H
   303  21e4  ca3022                JP          Z,NO_ACTION_TAKEN
   304  21e7  08                    EX          AF,AF'
   305  21e8  32793a                LD          (PLAYER_MAP_POS),A
   306  21eb  22603a                LD          (DIR_FACING_FW),HL
   307  21ee  3aa03a                LD          A,(BYTE_ram_3aa0)
   308  21f1  32623a                LD          (DIR_FACING_SHORT),A
   309  21f4  3a783a                LD          A,(LAST_ITEM_HELD)
   310  21f7  a7                    AND         A
   311  21f8  ca962a                JP          Z,UPDATE_VIEWPORT
   312  21fb  cdab25                CALL        CLEAR_MONSTER_STATS
   313  21fe  c34e32                JP          INIT_MELEE_ANIM
   314                          LAB_ram_e201:
   315  2201  010005                LD          BC,$500
   316  2204  112000                LD          DE,$20
   317  2207  cd3c22                CALL        PLAY_SOUND_LOOP
   318  220a  3a783a                LD          A,(LAST_ITEM_HELD)
   319  220d  a7                    AND         A
   320  220e  ca9f2a                JP          Z,WAIT_FOR_INPUT
   321  2211  c34e32                JP          INIT_MELEE_ANIM
   322                          DO_COUNT_FOOD:
   323  2214  3aab3a                LD          A,(FOOD_INV)
   324                          COUNT_INV:
   325  2217  57                    LD          D,A
   326  2218  14                    INC         D
   327  2219  af                    XOR         A
   328                          PLAY_INV_COUNT_BLIPS:
   329  221a  15                    DEC         D
   330  221b  ca9c2a                JP          Z,INPUT_DEBOUNCE
   331  221e  08                    EX          AF,AF'
   332  221f  010024                LD          BC,BYTE_ram_2400                        ;= $FF
   333  2222  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
   334  2225  08                    EX          AF,AF'
   335  2226  d3fc                  OUT         (SPEAKER),A                             ;= db
   336  2228  3d                    DEC         A
   337  2229  18ef                  JR          PLAY_INV_COUNT_BLIPS
   338                          DO_COUNT_ARROWS:
   339  222b  3aac3a                LD          A,(ARROW_INV)
   340  222e  18e7                  JR          COUNT_INV
   341                          NO_ACTION_TAKEN:
   342  2230  010005                LD          BC,$500
   343  2233  112000                LD          DE,$20
   344  2236  cd3c22                CALL        PLAY_SOUND_LOOP
   345  2239  c39f2a                JP          WAIT_FOR_INPUT
   346                          PLAY_SOUND_LOOP:
   347  223c  1b                    DEC         DE
   348  223d  7b                    LD          A,E
   349  223e  b2                    OR          D
   350  223f  c8                    RET         Z
   351  2240  d3fc                  OUT         (SPEAKER),A                             ;Send sound to speaker
   352  2242  60                    LD          H,B
   353  2243  69                    LD          L,C
   354                          LAB_ram_e244:
   355  2244  2b                    DEC         HL
   356  2245  7d                    LD          A,L
   357  2246  b4                    OR          H
   358  2247  c24422                JP          NZ,LAB_ram_e244
   359  224a  c33c22                JP          PLAY_SOUND_LOOP
   360                          USE_MAP:
   361  224d  3ab93a                LD          A,(GAME_BOOLEANS)
   362  2250  cb57                  BIT         0x2,A                                   ;See if HAVE MAP bit is set
   363  2252  ca3022                JP          Z,NO_ACTION_TAKEN
   364  2255  3aad3a                LD          A,(MAP_INV_SLOT)
   365  2258  a7                    AND         A
   366  2259  ca4e32                JP          Z,INIT_MELEE_ANIM
   367  225c  d9                    EXX                                                 ;Swap BC  DE  HL
   368                                                                                  ;with BC' DE' HL'
   369  225d  011818                LD          BC,$1818                               ;24 x 24
   370  2260  212830                LD          HL,IDX_VIEWPORT_CHRRAM                  ;= $20
   371  2263  3e20                  LD          A,$20                                  ;SPACE character fill
   372  2265  cdcb10                CALL        FILL_CHRCOL_RECT                        ;Fill map CHARs with SPACES
   373  2268  cd4816                CALL        SOUND_03
   374  226b  011818                LD          BC,$1818                               ;24 x 24
   375  226e  212834                LD          HL,COLRAM_VIEWPORT_IDX                  ;= $60    `
   376  2271  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
   377                                                                                  ;Was DKGN on BLK
   378  2273  cdcb10                CALL        FILL_CHRCOL_RECT                        ;Fill map colors
   379  2276  d9                    EXX                                                 ;Swap BC  DE  HL
   380                                                                                  ;with BC' DE' HL'
   381  2277  f5                    PUSH        AF
   382  2278  3aad3a                LD          A,(MAP_INV_SLOT)
   383  227b  47                    LD          B,A
   384  227c  f1                    POP         AF
   385  227d  00                    NOP                                                 ;Reset N flag
   386  227e  05                    DEC         B
   387  227f  cab322                JP          Z,DRAW_RED_MAP                          ;Walls and player
   388  2282  05                    DEC         B
   389  2283  caab22                JP          Z,DRAW_YELLOW_MAP                       ;Walls, player, and ladder
   390  2286  05                    DEC         B
   391  2287  ca9422                JP          Z,DRAW_PURPLE_MAP                       ;Walls, player, ladder,
   392                                                                                  ;and monsters
   393  228a  c3171a                JP          DRAW_WHITE_MAP                          ;Walls, player, ladder,
   394                                                                                  ;monsters, and items
   395  228d  00                    db          $00
   396  228e  00                    db          $00
   397  228f  00                    db          $00
   398  2290  00                    db          $00
   399  2291  00                    db          $00
   400  2292  00                    db          $00
   401  2293  00                    db          $00
   402                          DRAW_PURPLE_MAP:
   403  2294  21a878                LD          HL,$78a8                               ;Item range for monsters:
   404                                                                                  ;78 - skeleton
   405                                                                                  ;a8 - db?
   406  2297  cd1523                CALL        MAP_ITEM_MONSTER
   407                          UPDATE_MONSTER_CELLS:
   408  229a  280f                  JR          Z,DRAW_YELLOW_MAP
   409  229c  0a                    LD          A,(BC)
   410  229d  0c                    INC         C
   411  229e  0c                    INC         C
   412  229f  d9                    EXX                                                 ;Swap BC  DE  HL
   413                                                                                  ;with BC' DE' HL'
   414  22a0  16b1                  LD          D,$b1                                  ;Set current map position color
   415                                                                                  ;to $b1 DKBLU on RED
   416                                                                                  ;was DKGRN on YEL
   417  22a2  cd2723                CALL        UPDATE_COLRAM_FROM_OFFSET
   418  22a5  d9                    EXX                                                 ;Swap BC  DE  HL
   419                                                                                  ;with BC' DE' HL'
   420  22a6  cd1823                CALL        FIND_NEXT_ITEM_MONSTER_LOOP
   421  22a9  18ef                  JR          UPDATE_MONSTER_CELLS
   422                          DRAW_YELLOW_MAP:
   423  22ab  16b5                  LD          D,$b5                                  ;Set current map position color
   424                                                                                  ;to $b5, DKBLU on PUR
   425                                                                                  ;was DKGRN on PUR
   426  22ad  3aa13a                LD          A,(ITEM_HOLDER)
   427  22b0  cd2723                CALL        UPDATE_COLRAM_FROM_OFFSET
   428                          DRAW_RED_MAP:
   429  22b3  011810                LD          BC,$1018                               ;16 x 20
   430  22b6  11ff37                LD          DE,HC_LAST_INPUT
   431  22b9  21cc30                LD          HL,CHRRAM_WALL_F0_IDX                   ;= $20
   432                          CALC_MINIMAP_WALL:
   433  22bc  13                    INC         DE
   434  22bd  7a                    LD          A,D
   435  22be  fe39                  CP          $39
   436  22c0  2824                  JR          Z,SET_MINIMAP_PLAYER_LOC
   437  22c2  1a                    LD          A,(DE)
   438  22c3  b7                    OR          A
   439  22c4  2808                  JR          Z,SET_MINIMAP_NO_WALLS
   440  22c6  e60f                  AND         0xf
   441  22c8  200c                  JR          NZ,LAB_ram_e2d6
   442                          SET_MINIMAP_N_WALL:
   443  22ca  3ea3                  LD          A,$a3                                  ;A = $a3, map CHAR N wall
   444  22cc  180f                  JR          DRAW_MINIMAP_WALL
   445                          SET_MINIMAP_NO_WALLS:
   446  22ce  3ea0                  LD          A,$a0                                  ;A = $a0, map CHAR no walls
   447  22d0  180b                  JR          DRAW_MINIMAP_WALL
   448                          SET_MINIMAP_NW_WALLS:
   449  22d2  3eb7                  LD          A,$b7                                  ;A = $b7, map CHAR N and W walls
   450  22d4  1807                  JR          DRAW_MINIMAP_WALL
   451                          LAB_ram_e2d6:
   452  22d6  1a                    LD          A,(DE)
   453  22d7  e6f0                  AND         $f0
   454  22d9  20f7                  JR          NZ,SET_MINIMAP_NW_WALLS
   455                          SET_MINIMAP_W_WALL:
   456  22db  3eb5                  LD          A,$b5                                  ;A = $b5, map CHAR W wall
   457                          DRAW_MINIMAP_WALL:
   458  22dd  77                    LD          (HL),A              ;= $20
   459  22de  23                    INC         HL
   460  22df  10db                  DJNZ        CALC_MINIMAP_WALL
   461  22e1  09                    ADD         HL,BC
   462  22e2  0610                  LD          B,$10
   463  22e4  18d6                  JR          CALC_MINIMAP_WALL
   464                          SET_MINIMAP_PLAYER_LOC:
   465  22e6  3a793a                LD          A,(PLAYER_MAP_POS)
   466  22e9  16b7                  LD          D,$b7                                  ;Set player position color
   467                                                                                  ;to $b7 DKBLU on WHT
   468                                                                                  ;was DKGRN on WHT
   469  22eb  cd2723                CALL        UPDATE_COLRAM_FROM_OFFSET
   470  22ee  cd3b29                CALL        WAIT_A_TICK
   471                          READ_KEY:
   472  22f1  01ff00                LD          BC,$ff
   473  22f4  ed78                  IN          A,(C)
   474  22f6  3c                    INC         A
   475  22f7  20f8                  JR          NZ,READ_KEY
   476                          ENABLE_HC:
   477  22f9  0ef7                  LD          C,$f7
   478  22fb  3e0f                  LD          A,0xf
   479  22fd  ed79                  OUT         (C),A                              ;= db
   480  22ff  0d                    DEC         C
   481                          READ_HC:
   482  2300  ed78                  IN          A,(C)                     ;= db
   483  2302  3c                    INC         A
   484  2303  c2f122                JP          NZ,READ_KEY
   485  2306  0c                    INC         C
   486  2307  3e0e                  LD          A,0xe
   487                          DISABLE_HC:
   488  2309  ed79                  OUT         (C),A                              ;= db
   489  230b  0d                    DEC         C
   490  230c  ed78                  IN          A,(C)                     ;= db
   491  230e  3c                    INC         A
   492  230f  c2f122                JP          NZ,READ_KEY
   493  2312  c3962a                JP          UPDATE_VIEWPORT
   494                          MAP_ITEM_MONSTER:
   495  2315  010039                LD          BC,MAP_LADDER_OFFSET
   496                          FIND_NEXT_ITEM_MONSTER_LOOP:
   497  2318  0a                    LD          A,(BC)
   498  2319  03                    INC         BC
   499  231a  3c                    INC         A
   500  231b  c8                    RET         Z
   501  231c  0a                    LD          A,(BC)
   502  231d  bc                    CP          H                                       ;CP A to H (low end of itemRange)
   503  231e  03                    INC         BC
   504  231f  38f7                  JR          C,FIND_NEXT_ITEM_MONSTER_LOOP
   505  2321  bd                    CP          L                                       ;CP A to L (high end of itemRange)
   506  2322  30f4                  JR          NC,FIND_NEXT_ITEM_MONSTER_LOOP
   507  2324  0d                    DEC         C
   508  2325  0b                    DEC         BC
   509  2326  c9                    RET
   510                          UPDATE_COLRAM_FROM_OFFSET:
   511  2327  f5                    PUSH        AF
   512  2328  e60f                  AND         0xf
   513  232a  21cc34                LD          HL,COLRAM_F0_WALL_MAP_IDX               ;= $60    `
   514  232d  4f                    LD          C,A
   515  232e  0600                  LD          B,0x0
   516  2330  09                    ADD         HL,BC
   517  2331  f1                    POP         AF
   518  2332  e6f0                  AND         $f0
   519  2334  1f                    RRA
   520  2335  4f                    LD          C,A
   521  2336  09                    ADD         HL,BC
   522  2337  17                    RLA
   523  2338  17                    RLA
   524  2339  cb10                  RL          B
   525  233b  4f                    LD          C,A
   526  233c  09                    ADD         HL,BC
   527  233d  72                    LD          (HL),D                                  ;LD (HL),D
   528  233e  c9                    RET
   529                          CHK_ITEM_BREAK:
   530  233f  78                    LD          A,B                                     ;A  = itemLevel (0-3)
   531  2340  07                    RLCA                                                ;A  = A * 2
   532  2341  07                    RLCA                                                ;A  = A * 2
   533  2342  07                    RLCA                                                ;A  = A * 2
   534  2343  4f                    LD          C,A                                     ;B  = A
   535  2344  cdac3a                CALL        MAKE_RANDOM_BYTE                        ;A  = Random Byte
   536  2347  81                    ADD         A,C                                     ;A  = A + B (orig A * 8)
   537  2348  3806                  JR          C,ITEM_POOFS_RH                         ;If A > 255, item breaks
   538  234a  c605                  ADD         A,0x5                                   ;A  = A + 5
   539  234c  d0                    RET         NC                                      ;If A < 255, item doesn't break
   540  234d  00                    db          $00
   541  234e  00                    db          $00
   542  234f  00                    db          $00
   543                          ITEM_POOFS_RH:
   544  2350  37                    SCF                                                 ;Set C
   545  2351  08                    EX          AF,AF'
   546  2352  216c33                LD          HL,CHRRAM_RH_POOF_IDX                   ;= $20
   547  2355  cdb01d                CALL        PLAY_POOF_ANIM
   548  2358  00                    db          $00
   549  2359  00                    db          $00
   550  235a  00                    db          $00
   551  235b  00                    db          $00
   552  235c  00                    db          $00
   553  235d  00                    db          $00
   554  235e  00                    db          $00
   555  235f  00                    db          $00
   556  2360  00                    db          $00
   557  2361  00                    db          $00
   558  2362  00                    db          $00
   559  2363  00                    db          $00
   560                          FIX_RH_COLORS:
   561  2364  f5                    PUSH        AF
   562  2365  c5                    PUSH        BC
   563  2366  e5                    PUSH        HL
   564  2367  3ef0                  LD          A,$f0                                  ;DKGRN on BLK
   565  2369  010404                LD          BC,$404                                ; 4 x 4 rectangle
   566  236c  214337                LD          HL,COLRAM_RH_ITEM_IDX                   ;= $60    `
   567  236f  cdcb10                CALL        FILL_CHRCOL_RECT
   568  2372  e1                    POP         HL
   569  2373  c1                    POP         BC
   570  2374  f1                    POP         AF
   571  2375  37                    SCF
   572  2376  c9                    RET
   573  2377  00                    db          $00
   574  2378  00                    db          $00
   575  2379  00                    db          $00
   576  237a  00                    db          $00
   577  237b  00                    db          $00
   578  237c  00                    db          $00
   579  237d  00                    db          $00
   580  237e  00                    db          $00
   581  237f  00                    db          $00
   582  2380  00                    db          $00
   583  2381  00                    db          $00
   584  2382  00                    db          $00
   585  2383  00                    db          $00
   586  2384  00                    db          $00
   587  2385  00                    db          $00
   588  2386  00                    db          $00
   589  2387  00                    db          $00
   590  2388  00                    db          $00
   591  2389  00                    db          $00
   592  238a  00                    db          $00
   593  238b  00                    db          $00
   594  238c  00                    db          $00
   595  238d  00                    db          $00
   596  238e  00                    db          $00
   597  238f  00                    db          $00
   598  2390  00                    db          $00
   599  2391  00                    db          $00
   600  2392  00                    db          $00
   601  2393  00                    db          $00
   602  2394  00                    db          $00
   603  2395  00                    db          $00
   604  2396  00                    db          $00
   605  2397  00                    db          $00
   606  2398  00                    db          $00
   607  2399  00                    db          $00
   608                          SUB_ram_e39a:
   609  239a  cd7016                CALL        SOUND_05
   610  239d  3a873a                LD          A,(BYTE_ram_3a87)
   611  23a0  2a853a                LD          HL,(BYTE_ram_3a85)
   612  23a3  3d                    DEC         A
   613  23a4  c2cd23                JP          NZ,LAB_ram_e3cd
   614  23a7  2d                    DEC         L
   615  23a8  c2b623                JP          NZ,LAB_ram_e3b6
   616  23ab  25                    DEC         H
   617  23ac  ca5a24                JP          Z,LAB_ram_e45a
   618  23af  3e31                  LD          A,$31
   619  23b1  32643a                LD          (RAM_AC),A
   620  23b4  2e04                  LD          L,0x4
   621                          LAB_ram_e3b6:
   622  23b6  3e04                  LD          A,0x4
   623  23b8  32873a                LD          (BYTE_ram_3a87),A
   624  23bb  22853a                LD          (BYTE_ram_3a85),HL
   625  23be  2a833a                LD          HL,(BYTE_ram_3a83)
   626  23c1  012900                LD          BC,$29
   627  23c4  af                    XOR         A
   628  23c5  ed42                  SBC         HL,BC
   629  23c7  22833a                LD          (BYTE_ram_3a83),HL
   630  23ca  c3d723                JP          LAB_ram_e3d7
   631                          LAB_ram_e3cd:
   632  23cd  32873a                LD          (BYTE_ram_3a87),A
   633  23d0  2a833a                LD          HL,(BYTE_ram_3a83)
   634  23d3  2b                    DEC         HL
   635  23d4  22833a                LD          (BYTE_ram_3a83),HL
   636                          LAB_ram_e3d7:
   637  23d7  01c800                LD          BC,$c8
   638  23da  af                    XOR         A
   639  23db  ed42                  SBC         HL,BC
   640  23dd  e5                    PUSH        HL
   641  23de  09                    ADD         HL,BC
   642  23df  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
   643  23e2  cd6029                CALL        UPDATE_MELEE_OBJECTSdb
   644  23e5  e1                    POP         HL
   645  23e6  4d                    LD          C,L
   646  23e7  3a643a                LD          A,(RAM_AC)
   647  23ea  32633a                LD          (MON_FS),A
   648  23ed  3a823a                LD          A,(BYTE_ram_3a82)
   649  23f0  cdac2c                CALL        CHK_ITEM
   650  23f3  3e32                  LD          A,$32
   651  23f5  32633a                LD          (MON_FS),A
   652  23f8  3a693a                LD          A,(TIMER_A)
   653  23fb  c6ff                  ADD         A,$ff
   654  23fd  32893a                LD          (BYTE_ram_3a89),A
   655  2400  c9                    RET
   656                          SUB_ram_e401:
   657  2401  7d                    LD          A,L
   658  2402  e60f                  AND         0xf
   659  2404  47                    LD          B,A
   660  2405  04                    INC         B
   661  2406  cd1d24                CALL        SUB_ram_e41d
   662  2409  4f                    LD          C,A
   663  240a  7d                    LD          A,L
   664  240b  e6f0                  AND         $f0
   665  240d  07                    RLCA
   666  240e  07                    RLCA
   667  240f  07                    RLCA
   668  2410  07                    RLCA
   669  2411  47                    LD          B,A
   670  2412  04                    INC         B
   671  2413  cd1d24                CALL        SUB_ram_e41d
   672  2416  07                    RLCA
   673  2417  07                    RLCA
   674  2418  07                    RLCA
   675  2419  07                    RLCA
   676  241a  81                    ADD         A,C
   677  241b  6f                    LD          L,A
   678  241c  c9                    RET
   679                          SUB_ram_e41d:
   680  241d  cdca3a                CALL        UPDATE_SCR_SAVER_TIMER
   681  2420  e60f                  AND         0xf
   682                          LAB_ram_e422:
   683  2422  90                    SUB         B
   684  2423  30fd                  JR          NC,LAB_ram_e422
   685  2425  80                    ADD         A,B
   686  2426  c9                    RET
   687                          SUB_ram_e427:
   688  2427  7d                    LD          A,L
   689  2428  83                    ADD         A,E
   690  2429  27                    DAA
   691  242a  6f                    LD          L,A
   692  242b  7a                    LD          A,D
   693  242c  8c                    ADC         A,H
   694  242d  27                    DAA
   695  242e  67                    LD          H,A
   696  242f  c9                    RET
   697                          RECALC_PHYS_HEALTH:
   698  2430  7d                    LD          A,L
   699  2431  93                    SUB         E
   700  2432  27                    DAA                                                 ;Normalize BCD
   701  2433  6f                    LD          L,A
   702  2434  7c                    LD          A,H
   703  2435  9a                    SBC         A,D
   704  2436  27                    DAA                                                 ;Normalize BCD
   705  2437  67                    LD          H,A
   706  2438  c9                    RET
   707                          SUB_ram_e439:
   708  2439  af                    XOR         A
   709  243a  cb1c                  RR          H
   710  243c  3008                  JR          NC,LAB_ram_e446
   711  243e  cb1d                  RR          L
   712  2440  7d                    LD          A,L
   713  2441  d630                  SUB         $30
   714  2443  6f                    LD          L,A
   715  2444  1802                  JR          LAB_ram_e448
   716                          LAB_ram_e446:
   717  2446  cb1d                  RR          L
   718                          LAB_ram_e448:
   719  2448  cb5d                  BIT         0x3,L
   720  244a  c8                    RET         Z
   721  244b  7d                    LD          A,L
   722  244c  d603                  SUB         0x3
   723  244e  6f                    LD          L,A
   724  244f  c9                    RET
   725                          SUB_ram_e450:
   726  2450  ed5b833a              LD          DE,(BYTE_ram_3a83)
   727  2454  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
   728  2457  c37d29                JP          SUB_ram_e97d
   729                          LAB_ram_e45a:
   730  245a  cd5024                CALL        SUB_ram_e450
   731  245d  3e32                  LD          A,$32
   732  245f  32643a                LD          (RAM_AC),A
   733  2462  32653a                LD          (RAM_AD),A
   734  2465  3a9b3a                LD          A,(WEAPON_SPRT)
   735  2468  5f                    LD          E,A
   736  2469  1600                  LD          D,0x0
   737  246b  fe00                  CP          0x0
   738  246d  c20f25                JP          NZ,LAB_ram_e50f
   739  2470  ed5b993a              LD          DE,(WEAPON_PHYS)
   740  2474  d9                    EXX
   741  2475  cd4227                CALL        NEW_RIGHT_HAND_ITEM
   742  2478  d9                    EXX
   743  2479  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
   744  247c  cd3924                CALL        SUB_ram_e439
   745  247f  cd3024                CALL        RECALC_PHYS_HEALTH
   746  2482  3003                  JR          NC,LAB_ram_e487
   747  2484  210000                LD          HL,0x0
   748                          LAB_ram_e487:
   749  2487  cd0124                CALL        SUB_ram_e401
   750  248a  6c                    LD          L,H
   751  248b  67                    LD          H,A
   752  248c  cd0124                CALL        SUB_ram_e401
   753  248f  6c                    LD          L,H
   754  2490  67                    LD          H,A
   755  2491  eb                    EX          DE,HL
   756  2492  cd3924                CALL        SUB_ram_e439
   757  2495  eb                    EX          DE,HL
   758  2496  cd2724                CALL        SUB_ram_e427
   759  2499  eb                    EX          DE,HL
   760  249a  cd0124                CALL        SUB_ram_e401
   761  249d  cd2724                CALL        SUB_ram_e427
   762  24a0  ed5ba63a              LD          DE,(NEW_DAMAGE)
   763  24a4  cd3024                CALL        RECALC_PHYS_HEALTH
   764  24a7  3812                  JR          C,LAB_ram_e4bb
   765                          LAB_ram_e4a9:
   766  24a9  eb                    EX          DE,HL
   767  24aa  2aa33a                LD          HL,(CURR_MONSTER_PHYS)
   768  24ad  cd3024                CALL        RECALC_PHYS_HEALTH
   769  24b0  3811                  JR          C,LAB_ram_e4c3
   770  24b2  b5                    OR          L
   771  24b3  280e                  JR          Z,LAB_ram_e4c3
   772  24b5  22a33a                LD          (CURR_MONSTER_PHYS),HL
   773  24b8  c36932                JP          REDRAW_MONSTER_HEALTH
   774                          LAB_ram_e4bb:
   775  24bb  210600                LD          HL,0x6
   776  24be  cd0124                CALL        SUB_ram_e401
   777  24c1  18e6                  JR          LAB_ram_e4a9
   778                          LAB_ram_e4c3:
   779  24c3  d9                    EXX
   780  24c4  210000                LD          HL,0x0
   781  24c7  22a33a                LD          (CURR_MONSTER_PHYS),HL
   782  24ca  cd6932                CALL        REDRAW_MONSTER_HEALTH
   783  24cd  d9                    EXX
   784  24ce  2c                    INC         L
   785  24cf  3e99                  LD          A,$99
   786  24d1  bc                    CP          H
   787  24d2  c2101e                JP          NZ,MONSTER_KILLED
   788  24d5  3e61                  LD          A,$61
   789  24d7  bd                    CP          L
   790  24d8  d2101e                JP          NC,MONSTER_KILLED
   791  24db  3a4134                LD          A,(COLRAM_PHYS_STATS_1000)              ;= $60
   792  24de  cdba25                CALL        SUB_ram_e5ba
   793  24e1  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
   794  24e4  cd3924                CALL        SUB_ram_e439
   795  24e7  7d                    LD          A,L
   796  24e8  b8                    CP          B
   797  24e9  d2101e                JP          NC,MONSTER_KILLED
   798                          LAB_ram_e4ec:
   799  24ec  cdca3a                CALL        UPDATE_SCR_SAVER_TIMER
   800  24ef  d640                  SUB         $40
   801  24f1  3804                  JR          C,INCREASE_MAX_PHYS_HEALTH
   802  24f3  b9                    CP          C
   803  24f4  d2101e                JP          NC,MONSTER_KILLED
   804                          INCREASE_MAX_PHYS_HEALTH:
   805  24f7  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
   806  24fa  7d                    LD          A,L
   807  24fb  c601                  ADD         A,0x1
   808  24fd  27                    DAA                                                 ;Correct for BCD
   809  24fe  6f                    LD          L,A
   810  24ff  7c                    LD          A,H
   811  2500  ce00                  ADC         A,0x0
   812  2502  67                    LD          H,A
   813  2503  22953a                LD          (PLAYER_PHYS_HEALTH_MAX),HL
   814  2506  79                    LD          A,C
   815  2507  d610                  SUB         $10
   816  2509  da101e                JP          C,MONSTER_KILLED
   817  250c  4f                    LD          C,A
   818  250d  18dd                  JR          LAB_ram_e4ec
   819                          LAB_ram_e50f:
   820  250f  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
   821  2512  2600                  LD          H,0x0
   822  2514  6f                    LD          L,A
   823  2515  d9                    EXX
   824  2516  cd4227                CALL        NEW_RIGHT_HAND_ITEM
   825  2519  d9                    EXX
   826  251a  cd3924                CALL        SUB_ram_e439
   827  251d  7d                    LD          A,L
   828  251e  93                    SUB         E
   829  251f  27                    DAA
   830  2520  6f                    LD          L,A
   831  2521  3002                  JR          NC,LAB_ram_e525
   832  2523  2e00                  LD          L,0x0
   833                          LAB_ram_e525:
   834  2525  cd0124                CALL        SUB_ram_e401
   835  2528  eb                    EX          DE,HL
   836  2529  cd3924                CALL        SUB_ram_e439
   837  252c  7d                    LD          A,L
   838  252d  83                    ADD         A,E
   839  252e  27                    DAA
   840  252f  5f                    LD          E,A
   841  2530  cd0124                CALL        SUB_ram_e401
   842  2533  83                    ADD         A,E
   843  2534  27                    DAA
   844  2535  6f                    LD          L,A
   845  2536  3aa53a                LD          A,(BYTE_ram_3aa5)
   846  2539  5f                    LD          E,A
   847  253a  7d                    LD          A,L
   848  253b  93                    SUB         E
   849  253c  27                    DAA
   850  253d  3810                  JR          C,LAB_ram_e54f
   851  253f  6f                    LD          L,A
   852                          MONSTER_TAKES_SPRT_DAMAGE:
   853  2540  3aa23a                LD          A,(CURR_MONSTER_SPRT)
   854  2543  95                    SUB         L
   855  2544  27                    DAA
   856  2545  3810                  JR          C,LAB_ram_e557
   857  2547  280e                  JR          Z,LAB_ram_e557
   858  2549  32a23a                LD          (CURR_MONSTER_SPRT),A
   859  254c  c36932                JP          REDRAW_MONSTER_HEALTH
   860                          LAB_ram_e54f:
   861  254f  210300                LD          HL,0x3
   862  2552  cd0124                CALL        SUB_ram_e401
   863  2555  18e9                  JR          MONSTER_TAKES_SPRT_DAMAGE
   864                          LAB_ram_e557:
   865  2557  f5                    PUSH        AF
   866  2558  af                    XOR         A
   867  2559  32a23a                LD          (CURR_MONSTER_SPRT),A
   868  255c  cd6932                CALL        REDRAW_MONSTER_HEALTH
   869  255f  f1                    POP         AF
   870  2560  3d                    DEC         A
   871  2561  fe86                  CP          $86
   872  2563  3827                  JR          C,ITEM_USED_UP
   873  2565  3a4634                LD          A,(COLRAM_SPRT_STATS_10)                ;= $60
   874  2568  cdba25                CALL        SUB_ram_e5ba
   875  256b  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
   876  256e  b8                    CP          B
   877  256f  301b                  JR          NC,ITEM_USED_UP
   878                          REDUCE_ITEM_BY_30:
   879  2571  cdca3a                CALL        UPDATE_SCR_SAVER_TIMER
   880  2574  d630                  SUB         $30
   881  2576  3803                  JR          C,INCREASE_MAX_SPRT_HEALTH
   882  2578  b9                    CP          C
   883  2579  3011                  JR          NC,ITEM_USED_UP
   884                          INCREASE_MAX_SPRT_HEALTH:
   885  257b  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
   886  257e  c601                  ADD         A,0x1
   887  2580  27                    DAA                                                 ;Correct for BCD
   888  2581  32983a                LD          (PLAYER_SPRT_HEALTH_MAX),A
   889  2584  79                    LD          A,C
   890  2585  d610                  SUB         $10
   891  2587  3803                  JR          C,ITEM_USED_UP
   892  2589  4f                    LD          C,A
   893  258a  18e5                  JR          REDUCE_ITEM_BY_30
   894                          ITEM_USED_UP:
   895  258c  c3101e                JP          MONSTER_KILLED
   896  258f  00                    db          $00
   897  2590  00                    db          $00
   898  2591  00                    db          $00
   899  2592  00                    db          $00
   900  2593  00                    db          $00
   901  2594  00                    db          $00
   902  2595  00                    db          $00
   903  2596  00                    db          $00
   904  2597  00                    db          $00
   905  2598  00                    db          $00
   906  2599  00                    db          $00
   907  259a  00                    db          $00
   908  259b  00                    db          $00
   909  259c  00                    db          $00
   910  259d  00                    db          $00
   911  259e  00                    db          $00
   912  259f  00                    db          $00
   913  25a0  00                    db          $00
   914  25a1  00                    db          $00
   915  25a2  00                    db          $00
   916  25a3  00                    db          $00
   917  25a4  00                    db          $00
   918  25a5  00                    db          $00
   919  25a6  00                    db          $00
   920  25a7  00                    db          $00
   921  25a8  00                    db          $00
   922  25a9  00                    db          $00
   923  25aa  00                    db          $00
   924                          CLEAR_MONSTER_STATS:
   925  25ab  af                    XOR         A                                       ;A  = $fe on entry (usually)
   926                                                                                  ;A  = $00 after
   927                                                                                  ;Reset C & N, Set Z
   928                                                                                  ;
   929  25ac  32783a                LD          (LAST_ITEM_HELD),A                   ;ItemHolder = $00
   930  25af  010304                LD          BC,$403
   931  25b2  213d33                LD          HL,CHRRAM_LEVEL_IDX                     ;= $20
   932  25b5  3e20                  LD          A,$20
   933  25b7  c3cb10                JP          FILL_CHRCOL_RECT
   934                          SUB_ram_e5ba:
   935  25ba  e60f                  AND         0xf
   936  25bc  3c                    INC         A
   937  25bd  3c                    INC         A
   938  25be  47                    LD          B,A
   939  25bf  07                    RLCA
   940  25c0  07                    RLCA
   941  25c1  07                    RLCA
   942  25c2  07                    RLCA
   943  25c3  4f                    LD          C,A
   944  25c4  78                    LD          A,B
   945  25c5  87                    ADD         A,A
   946  25c6  27                    DAA
   947  25c7  87                    ADD         A,A
   948  25c8  27                    DAA
   949  25c9  87                    ADD         A,A
   950  25ca  27                    DAA
   951  25cb  87                    ADD         A,A
   952  25cc  27                    DAA
   953  25cd  47                    LD          B,A
   954  25ce  c9                    RET
   955                          MELEE_ANIM_LOOP:
   956  25cf  cd7016                CALL        SOUND_05
   957  25d2  3a8b3a                LD          A,(MELEE_ANIM_STATE)
   958  25d5  2a8d3a                LD          HL,(MONSTER_ATT_POS_COUNT)
   959  25d8  3d                    DEC         A
   960  25d9  c20026                JP          NZ,LAB_ram_e600
   961  25dc  2d                    DEC         L
   962  25dd  c2eb25                JP          NZ,LAB_ram_e5eb
   963  25e0  25                    DEC         H
   964  25e1  ca3f26                JP          Z,LAB_ram_e63f
   965  25e4  3e32                  LD          A,$32
   966  25e6  32673a                LD          (RAM_AF),A
   967  25e9  2e02                  LD          L,0x2
   968                          LAB_ram_e5eb:
   969  25eb  3e03                  LD          A,0x3
   970  25ed  328b3a                LD          (MELEE_ANIM_STATE),A
   971  25f0  228d3a                LD          (MONSTER_ATT_POS_COUNT),HL
   972  25f3  2a8f3a                LD          HL,(MONSTER_ATT_POS_OFFSET)
   973  25f6  012900                LD          BC,$29
   974  25f9  09                    ADD         HL,BC
   975  25fa  228f3a                LD          (MONSTER_ATT_POS_OFFSET),HL
   976  25fd  c30a26                JP          ANIMATE_MELEE_ROUND
   977                          LAB_ram_e600:
   978  2600  328b3a                LD          (MELEE_ANIM_STATE),A
   979  2603  2a8f3a                LD          HL,(MONSTER_ATT_POS_OFFSET)
   980  2606  23                    INC         HL
   981  2607  228f3a                LD          (MONSTER_ATT_POS_OFFSET),HL
   982                          ANIMATE_MELEE_ROUND:
   983  260a  01c800                LD          BC,$c8
   984  260d  af                    XOR         A
   985  260e  ed42                  SBC         HL,BC
   986  2610  e5                    PUSH        HL
   987  2611  09                    ADD         HL,BC
   988  2612  11203a                LD          DE,BYTE_ram_3a20
   989  2615  cd6029                CALL        UPDATE_MELEE_OBJECTSdb
   990  2618  c1                    POP         BC
   991  2619  0600                  LD          B,0x0
   992  261b  3a673a                LD          A,(RAM_AF)
   993  261e  32633a                LD          (MON_FS),A
   994  2621  3a8a3a                LD          A,(BYTE_ram_3a8a)
   995  2624  cdac2c                CALL        CHK_ITEM
   996  2627  3e32                  LD          A,$32
   997  2629  32633a                LD          (MON_FS),A
   998  262c  3a693a                LD          A,(TIMER_A)
   999  262f  c6ff                  ADD         A,$ff
  1000  2631  328c3a                LD          (BYTE_ram_3a8c),A
  1001  2634  c9                    RET
  1002                          SUB_ram_e635:
  1003  2635  ed5b8f3a              LD          DE,(MONSTER_ATT_POS_OFFSET)
  1004  2639  21203a                LD          HL,BYTE_ram_3a20
  1005  263c  c37d29                JP          SUB_ram_e97d
  1006                          LAB_ram_e63f:
  1007  263f  cd3526                CALL        SUB_ram_e635
  1008  2642  3e31                  LD          A,$31
  1009  2644  32673a                LD          (RAM_AF),A
  1010  2647  32663a                LD          (RAM_AE),A
  1011  264a  3a6c3a                LD          A,(INPUT_HOLDER)
  1012  264d  47                    LD          B,A
  1013  264e  2600                  LD          H,0x0
  1014  2650  3aa83a                LD          A,(WEAPON_VALUE_HOLDER)
  1015  2653  6f                    LD          L,A
  1016  2654  1802                  JR          LAB_ram_e658
  1017                          LAB_ram_e656:
  1018  2656  85                    ADD         A,L
  1019  2657  27                    DAA
  1020                          LAB_ram_e658:
  1021  2658  10fc                  DJNZ        LAB_ram_e656
  1022  265a  6f                    LD          L,A
  1023  265b  3a8a3a                LD          A,(BYTE_ram_3a8a)
  1024  265e  e6fc                  AND         $fc
  1025  2660  fe24                  CP          $24
  1026  2662  202f                  JR          NZ,LAB_ram_e693
  1027  2664  3a733a                LD          A,(SHIELD_SPRT)
  1028  2667  5f                    LD          E,A
  1029  2668  cd3924                CALL        SUB_ram_e439
  1030  266b  55                    LD          D,L
  1031  266c  cd0124                CALL        SUB_ram_e401
  1032  266f  7d                    LD          A,L
  1033  2670  82                    ADD         A,D
  1034  2671  27                    DAA
  1035  2672  93                    SUB         E
  1036  2673  27                    DAA
  1037  2674  3814                  JR          C,LAB_ram_e68a
  1038  2676  5f                    LD          E,A
  1039                          LAB_ram_e677:
  1040  2677  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  1041  267a  93                    SUB         E
  1042  267b  27                    DAA
  1043  267c  daa92f                JP          C,PLAYER_DIES
  1044  267f  caa92f                JP          Z,PLAYER_DIES
  1045  2682  32973a                LD          (PLAYER_SPRT_HEALTH),A
  1046  2685  cd5d3d                CALL        REDRAW_STATS
  1047  2688  1834                  JR          LAB_ram_e6be
  1048                          LAB_ram_e68a:
  1049  268a  210200                LD          HL,0x2
  1050  268d  cd0124                CALL        SUB_ram_e401
  1051  2690  5d                    LD          E,L
  1052  2691  18e4                  JR          LAB_ram_e677
  1053                          LAB_ram_e693:
  1054  2693  cd0124                CALL        SUB_ram_e401
  1055  2696  3aa83a                LD          A,(WEAPON_VALUE_HOLDER)
  1056  2699  85                    ADD         A,L
  1057  269a  27                    DAA
  1058  269b  6f                    LD          L,A
  1059  269c  7c                    LD          A,H
  1060  269d  ce00                  ADC         A,0x0
  1061  269f  27                    DAA
  1062  26a0  67                    LD          H,A
  1063  26a1  ed5b713a              LD          DE,(SHIELD_PHYS)
  1064  26a5  cd3024                CALL        RECALC_PHYS_HEALTH
  1065  26a8  381a                  JR          C,LAB_ram_e6c4
  1066                          LAB_ram_e6aa:
  1067  26aa  eb                    EX          DE,HL
  1068  26ab  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
  1069  26ae  cd3024                CALL        RECALC_PHYS_HEALTH
  1070  26b1  daa92f                JP          C,PLAYER_DIES
  1071  26b4  b5                    OR          L
  1072  26b5  caa92f                JP          Z,PLAYER_DIES
  1073  26b8  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  1074  26bb  cd5d3d                CALL        REDRAW_STATS
  1075                          LAB_ram_e6be:
  1076  26be  cde634                CALL        REDRAW_START
  1077  26c1  c30438                JP          REDRAW_VIEWPORT
  1078                          LAB_ram_e6c4:
  1079  26c4  210300                LD          HL,0x3
  1080  26c7  cd0124                CALL        SUB_ram_e401
  1081  26ca  18de                  JR          LAB_ram_e6aa
  1082                          DO_SWAP_HANDS:
  1083  26cc  217a3a                LD          HL,RIGHT_HAND_ITEM
  1084  26cf  017b3a                LD          BC,LEFT_HAND_ITEM
  1085  26d2  cd622a                CALL        SUB_ram_ea62
  1086  26d5  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1087  26d8  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
  1088  26db  cd6029                CALL        UPDATE_MELEE_OBJECTSdb
  1089  26de  213933                LD          HL,CHRRAM_LEFT_HD_GFX_IDX               ;= $20
  1090  26e1  114333                LD          DE,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1091  26e4  cd9e29                CALL        SUB_ram_e99e
  1092  26e7  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
  1093  26ea  113933                LD          DE,CHRRAM_LEFT_HD_GFX_IDX               ;= $20
  1094  26ed  cd7d29                CALL        SUB_ram_e97d
  1095  26f0  cd4227                CALL        NEW_RIGHT_HAND_ITEM
  1096  26f3  010000                LD          BC,0x0
  1097  26f6  217a3a                LD          HL,RIGHT_HAND_ITEM
  1098  26f9  cd2027                CALL        SUB_ram_e720
  1099  26fc  3a733a                LD          A,(SHIELD_SPRT)
  1100  26ff  91                    SUB         C
  1101  2700  27                    DAA
  1102  2701  32733a                LD          (SHIELD_SPRT),A
  1103  2704  3a713a                LD          A,(SHIELD_PHYS)
  1104  2707  90                    SUB         B
  1105  2708  27                    DAA
  1106  2709  32713a                LD          (SHIELD_PHYS),A
  1107  270c  3a723a                LD          A,(SHIELD_PHYS+1)
  1108  270f  de00                  SBC         A,0x0
  1109  2711  32723a                LD          (SHIELD_PHYS+1),A
  1110  2714  010000                LD          BC,0x0
  1111  2717  217b3a                LD          HL,LEFT_HAND_ITEM
  1112  271a  cd2027                CALL        SUB_ram_e720
  1113  271d  c31228                JP          LAB_ram_e812
  1114                          SUB_ram_e720:
  1115  2720  7e                    LD          A,(HL)
  1116  2721  fe14                  CP          $14
  1117  2723  d0                    RET         NC
  1118  2724  fe10                  CP          $10
  1119  2726  3003                  JR          NC,LAB_ram_e72b
  1120  2728  fe04                  CP          0x4
  1121  272a  d0                    RET         NC
  1122                          LAB_ram_e72b:
  1123  272b  e603                  AND         0x3
  1124  272d  3c                    INC         A
  1125  272e  cdc129                CALL        SUB_ram_e9c1
  1126  2731  7e                    LD          A,(HL)
  1127  2732  e6fc                  AND         $fc
  1128  2734  c0                    RET         NZ
  1129  2735  2600                  LD          H,0x0
  1130  2737  68                    LD          L,B
  1131  2738  cd3924                CALL        SUB_ram_e439
  1132  273b  45                    LD          B,L
  1133  273c  69                    LD          L,C
  1134  273d  cd3924                CALL        SUB_ram_e439
  1135  2740  4d                    LD          C,L
  1136  2741  c9                    RET
  1137                          NEW_RIGHT_HAND_ITEM:
  1138  2742  3a7a3a                LD          A,(RIGHT_HAND_ITEM)
  1139  2745  fe18                  CP          $18                                    ;Less than RED Bow
  1140  2747  3877                  JR          C,LAB_ram_e7c0
  1141  2749  fe34                  CP          $34                                    ;Greater than WHITE Crossbow
  1142  274b  3073                  JR          NC,LAB_ram_e7c0
  1143  274d  010000                LD          BC,0x0                                  ;C = 0
  1144  2750  1e00                  LD          E,0x0                                   ;E = 0
  1145  2752  cb3f                  SRL         A                                       ;Div A by 2
  1146  2754  cb18                  RR          B
  1147  2756  1f                    RRA
  1148  2757  cb10                  RL          B
  1149  2759  cb10                  RL          B
  1150  275b  d606                  SUB         0x6
  1151  275d  2004                  JR          NZ,LAB_ram_e763
  1152  275f  1606                  LD          D,0x6
  1153  2761  1828                  JR          LAB_ram_e78b
  1154                          LAB_ram_e763:
  1155  2763  3d                    DEC         A
  1156  2764  2004                  JR          NZ,LAB_ram_e76a
  1157  2766  1606                  LD          D,0x6
  1158  2768  1834                  JR          LAB_ram_e79e
  1159                          LAB_ram_e76a:
  1160  276a  3d                    DEC         A
  1161  276b  2004                  JR          NZ,LAB_ram_e771
  1162  276d  1616                  LD          D,$16
  1163  276f  181a                  JR          LAB_ram_e78b
  1164                          LAB_ram_e771:
  1165  2771  3d                    DEC         A
  1166  2772  2004                  JR          NZ,LAB_ram_e778
  1167  2774  1620                  LD          D,$20
  1168  2776  1826                  JR          LAB_ram_e79e
  1169                          LAB_ram_e778:
  1170  2778  3d                    DEC         A
  1171  2779  2004                  JR          NZ,LAB_ram_e77f
  1172  277b  1624                  LD          D,$24
  1173  277d  180c                  JR          LAB_ram_e78b
  1174                          LAB_ram_e77f:
  1175  277f  3d                    DEC         A
  1176  2780  2004                  JR          NZ,LAB_ram_e786
  1177  2782  1615                  LD          D,$15
  1178  2784  1818                  JR          LAB_ram_e79e
  1179                          LAB_ram_e786:
  1180  2786  3d                    DEC         A
  1181  2787  1618                  LD          D,$18
  1182  2789  00                    NOP
  1183  278a  00                    NOP
  1184                          LAB_ram_e78b:
  1185  278b  cd8532                CALL        CALC_WEAPON_VALUE
  1186  278e  87                    ADD         A,A
  1187  278f  27                    DAA                                                 ;BCD Correction
  1188  2790  6f                    LD          L,A
  1189  2791  3e00                  LD          A,0x0
  1190  2793  17                    RLA
  1191  2794  67                    LD          H,A
  1192  2795  22993a                LD          (WEAPON_PHYS),HL
  1193  2798  af                    XOR         A
  1194  2799  329b3a                LD          (WEAPON_SPRT),A
  1195  279c  180c                  JR          LAB_ram_e7aa
  1196                          LAB_ram_e79e:
  1197  279e  cd8532                CALL        CALC_WEAPON_VALUE
  1198  27a1  329b3a                LD          (WEAPON_SPRT),A
  1199  27a4  210000                LD          HL,0x0
  1200  27a7  22993a                LD          (WEAPON_PHYS),HL
  1201                          LAB_ram_e7aa:
  1202  27aa  119130                LD          DE,CHRRAM_PHYS_WEAPON_IDX               ;= $20
  1203  27ad  21993a                LD          HL,WEAPON_PHYS
  1204  27b0  0602                  LD          B,0x2
  1205  27b2  cdfd32                CALL        RECALC_AND_REDRAW_BCD
  1206  27b5  119730                LD          DE,CHRRAM_SPRT_WEAPON_IDX               ;= $20
  1207  27b8  219b3a                LD          HL,WEAPON_SPRT
  1208  27bb  0601                  LD          B,0x1
  1209  27bd  c3fd32                JP          RECALC_AND_REDRAW_BCD
  1210                          LAB_ram_e7c0:
  1211  27c0  210000                LD          HL,0x0                                  ;HL = 0
  1212  27c3  af                    XOR         A                                       ;A  = 0
  1213  27c4  22993a                LD          (WEAPON_PHYS),HL
  1214  27c7  329b3a                LD          (WEAPON_SPRT),A
  1215  27ca  18de                  JR          LAB_ram_e7aa
  1216                          DO_PICK_UP:
  1217  27cc  3aa13a                LD          A,(ITEM_HOLDER)
  1218  27cf  47                    LD          B,A
  1219  27d0  3a793a                LD          A,(PLAYER_MAP_POS)
  1220  27d3  b8                    CP          B                                       ;Check difference between
  1221                                                                                  ;item and item location
  1222  27d4  ca3022                JP          Z,NO_ACTION_TAKEN
  1223  27d7  3c                    INC         A
  1224  27d8  ca3022                JP          Z,NO_ACTION_TAKEN
  1225  27db  3d                    DEC         A
  1226  27dc  cdf337                CALL        ITEM_MAP_CHECK
  1227  27df  2863                  JR          Z,LAB_ram_e844
  1228  27e1  fe04                  CP          0x4                                     ;Compare to RING (0x4)
  1229  27e3  3862                  JR          C,CHECK_FOOD_ARROWS                     ;Jump if less than RING (C)
  1230  27e5  fe10                  CP          $10                                    ;Compare to PAVICE ($10)
  1231  27e7  305e                  JR          NC,CHECK_FOOD_ARROWS                    ;Jump if PAVICE or greater (NC)
  1232                          PROCESS_RHA:
  1233  27e9  cd4129                CALL        PICK_UP_F0_ITEM
  1234  27ec  21743a                LD          HL,ARMOR_INV_SLOT                       ;Start with ARMOR slot
  1235  27ef  3d                    DEC         A                                       ;Subtract 1 from A:
  1236                                                                                  ;- Armor
  1237  27f0  2002                  JR          NZ,NOT_ARMOR                            ;Treat as NOT ARMOR
  1238  27f2  23                    INC         HL                                      ;HL = HELMET_INV_SLOT
  1239  27f3  23                    INC         HL                                      ;HL = RING_INV_SLOT
  1240                          NOT_ARMOR:
  1241  27f4  3d                    DEC         A
  1242  27f5  2001                  JR          NZ,NOT_HELMET
  1243  27f7  23                    INC         HL
  1244                          NOT_HELMET:
  1245  27f8  7e                    LD          A,(HL)
  1246  27f9  14                    INC         D
  1247  27fa  ba                    CP          D
  1248  27fb  d29c2a                JP          NC,INPUT_DEBOUNCE
  1249  27fe  08                    EX          AF,AF'
  1250  27ff  7a                    LD          A,D
  1251  2800  77                    LD          (HL),A
  1252  2801  cdc129                CALL        SUB_ram_e9c1
  1253  2804  59                    LD          E,C
  1254  2805  50                    LD          D,B
  1255  2806  08                    EX          AF,AF'
  1256  2807  cdc129                CALL        SUB_ram_e9c1
  1257  280a  7b                    LD          A,E
  1258  280b  91                    SUB         C
  1259  280c  27                    DAA                                                 ;BCD Correction
  1260  280d  4f                    LD          C,A
  1261  280e  7a                    LD          A,D
  1262  280f  90                    SUB         B
  1263  2810  27                    DAA                                                 ;BCD Correction
  1264  2811  47                    LD          B,A
  1265                          LAB_ram_e812:
  1266  2812  3a733a                LD          A,(SHIELD_SPRT)
  1267  2815  81                    ADD         A,C
  1268  2816  27                    DAA                                                 ;BCD Correction
  1269  2817  32733a                LD          (SHIELD_SPRT),A
  1270  281a  3a713a                LD          A,(SHIELD_PHYS)
  1271  281d  80                    ADD         A,B
  1272  281e  27                    DAA                                                 ;BCD Correction
  1273  281f  32713a                LD          (SHIELD_PHYS),A
  1274  2822  3a723a                LD          A,(SHIELD_PHYS+1)
  1275  2825  ce00                  ADC         A,0x0
  1276  2827  27                    DAA                                                 ;BCD Correction
  1277  2828  32723a                LD          (SHIELD_PHYS+1),A
  1278  282b  21713a                LD          HL,SHIELD_PHYS
  1279  282e  116930                LD          DE,CHRRAM_PHYS_SHIELD_IDX               ;= $20
  1280  2831  0602                  LD          B,0x2
  1281  2833  cdfd32                CALL        RECALC_AND_REDRAW_BCD
  1282  2836  21733a                LD          HL,SHIELD_SPRT
  1283  2839  116f30                LD          DE,CHRRAM_SPRT_SHIELD_IDX               ;= $20
  1284  283c  0601                  LD          B,0x1
  1285  283e  cdfd32                CALL        RECALC_AND_REDRAW_BCD
  1286  2841  c3e43d                JP          RHA_REDRAW                              ;Was JP AWAITING_INPUT
  1287                                                                                  ;(c3 9c ea)
  1288                          LAB_ram_e844:
  1289  2844  cce129                CALL        Z,SUB_ram_e9e1
  1290                          CHECK_FOOD_ARROWS:
  1291  2847  fe48                  CP          $48
  1292  2849  384a                  JR          C,CHECK_MAP_NECKLACE_CHARMS             ;CHEST or lower
  1293  284b  fe50                  CP          $50
  1294  284d  3046                  JR          NC,CHECK_MAP_NECKLACE_CHARMS            ;LOCKED CHEST or higher
  1295  284f  cd4129                CALL        PICK_UP_F0_ITEM
  1296  2852  14                    INC         D
  1297  2853  cb12                  RL          D
  1298  2855  14                    INC         D
  1299  2856  fe12                  CP          $12
  1300  2858  202b                  JR          NZ,PICK_UP_ARROWS
  1301  285a  d5                    PUSH        DE
  1302  285b  cd6528                CALL        PICK_UP_FOOD
  1303  285e  d1                    POP         DE
  1304  285f  cd6528                CALL        PICK_UP_FOOD
  1305  2862  c39c2a                JP          INPUT_DEBOUNCE
  1306                          PICK_UP_FOOD:
  1307  2865  3aab3a                LD          A,(FOOD_INV)
  1308  2868  82                    ADD         A,D
  1309  2869  3007                  JR          NC,LAB_ram_e872
  1310  286b  3c                    INC         A
  1311  286c  4f                    LD          C,A
  1312  286d  7a                    LD          A,D
  1313  286e  91                    SUB         C
  1314  286f  57                    LD          D,A
  1315  2870  18f3                  JR          PICK_UP_FOOD
  1316                          LAB_ram_e872:
  1317  2872  32ab3a                LD          (FOOD_INV),A
  1318  2875  2aa93a                LD          HL,(BYTE_ram_3aa9)
  1319  2878  7a                    LD          A,D
  1320  2879  85                    ADD         A,L
  1321  287a  27                    DAA                                                 ;BCD correct
  1322  287b  6f                    LD          L,A
  1323  287c  7c                    LD          A,H
  1324  287d  ce00                  ADC         A,0x0
  1325  287f  27                    DAA                                                 ;BCD correct
  1326  2880  67                    LD          H,A
  1327  2881  22a93a                LD          (BYTE_ram_3aa9),HL
  1328  2884  c9                    RET
  1329                          PICK_UP_ARROWS:
  1330  2885  3aac3a                LD          A,(ARROW_INV)
  1331  2888  82                    ADD         A,D
  1332  2889  fe33                  CP          $33
  1333  288b  3802                  JR          C,ADD_ARROWS_TO_INV
  1334  288d  3e32                  LD          A,$32
  1335                          ADD_ARROWS_TO_INV:
  1336  288f  32ac3a                LD          (ARROW_INV),A
  1337  2892  c39c2a                JP          INPUT_DEBOUNCE
  1338                          CHECK_MAP_NECKLACE_CHARMS:
  1339  2895  fe6c                  CP          $6c                                    ;Red MAP
  1340  2897  2821                  JR          Z,PROCESS_MAP
  1341  2899  fe6d                  CP          $6d                                    ;Yellow MAP
  1342  289b  281d                  JR          Z,PROCESS_MAP
  1343  289d  fede                  CP          $de                                    ;Purple MAP
  1344  289f  2819                  JR          Z,PROCESS_MAP
  1345  28a1  fedf                  CP          $df                                    ;White MAP
  1346  28a3  2815                  JR          Z,PROCESS_MAP
  1347  28a5  00                    db          $00
  1348  28a6  00                    db          $00
  1349  28a7  00                    db          $00
  1350  28a8  00                    db          $00
  1351  28a9  00                    db          $00
  1352  28aa  00                    db          $00
  1353  28ab  00                    db          $00
  1354  28ac  fe5c                  CP          $5c                                    ;WHITE KEY or lower
  1355  28ae  3829                  JR          C,PICK_UP_NON_TREASURE
  1356  28b0  fe64                  CP          $64
  1357  28b2  3025                  JR          NC,PICK_UP_NON_TREASURE                 ;WARRIOR POTION or higher
  1358  28b4  cd4129                CALL        PICK_UP_F0_ITEM
  1359  28b7  c39c2a                JP          INPUT_DEBOUNCE
  1360                          PROCESS_MAP:
  1361  28ba  f5                    PUSH        AF
  1362  28bb  3ab93a                LD          A,(GAME_BOOLEANS)
  1363  28be  cbd7                  SET         0x2,A
  1364  28c0  32b93a                LD          (GAME_BOOLEANS),A
  1365  28c3  f1                    POP         AF
  1366  28c4  cd4129                CALL        PICK_UP_F0_ITEM
  1367  28c7  ed53ad3a              LD          (MAP_INV_SLOT),DE
  1368  28cb  f5                    PUSH        AF
  1369  28cc  3aad3a                LD          A,(MAP_INV_SLOT)
  1370  28cf  cdd83d                CALL        LEVEL_TO_COLRAM_FIX
  1371  28d2  321134                LD          (COLRAM_MAP_IDX),A                      ;= $60    `
  1372  28d5  f1                    POP         AF
  1373  28d6  c39c2a                JP          INPUT_DEBOUNCE
  1374                          PICK_UP_NON_TREASURE:
  1375  28d9  217a3a                LD          HL,RIGHT_HAND_ITEM
  1376  28dc  7e                    LD          A,(HL)
  1377  28dd  32ea37                LD          (ITEM_F0),A                             ;= $60
  1378  28e0  cd622a                CALL        SUB_ram_ea62
  1379  28e3  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1380  28e6  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
  1381  28e9  cd6029                CALL        UPDATE_MELEE_OBJECTSdb
  1382  28ec  215233                LD          HL,CHRRAM_FO_ITEM_IDX                   ;= $20
  1383  28ef  114333                LD          DE,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1384  28f2  cd9e29                CALL        SUB_ram_e99e
  1385  28f5  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
  1386  28f8  115233                LD          DE,CHRRAM_FO_ITEM_IDX                   ;= $20
  1387  28fb  cd7d29                CALL        SUB_ram_e97d
  1388  28fe  215237                LD          HL,COLRAM_FO_ITEM_IDX                   ;= $60    `
  1389  2901  11000f                LD          DE,$f00                                ;BLK on DKGY /
  1390                                                                                  ;BLK on BLK
  1391                                                                                  ;WAS BLK on DKCYN /
  1392                                                                                  ;    BLK on BLK
  1393                                                                                  ;WAS LD DE,$0900
  1394  2904  0ef0                  LD          C,$f0                                  ;Floor color (for compare)
  1395                                                                                  ;DKGRY on BLK
  1396                                                                                  ;WAS DKCYN on BLK
  1397  2906  cd1a29                CALL        RECOLOR_ITEM
  1398  2909  214337                LD          HL,COLRAM_RH_ITEM_IDX                   ;= $60    `
  1399  290c  11f000                LD          DE,$f0                                 ;Floor color (for fill)
  1400                                                                                  ;DKGRY on BLK
  1401                                                                                  ;WAS DKCYN on BLK
  1402  290f  0e00                  LD          C,0x0
  1403  2911  cd1a29                CALL        RECOLOR_ITEM
  1404  2914  cd4227                CALL        NEW_RIGHT_HAND_ITEM
  1405  2917  c39c2a                JP          INPUT_DEBOUNCE
  1406                          RECOLOR_ITEM:
  1407  291a  3e04                  LD          A,0x4
  1408                          LAB_ram_e91c:
  1409  291c  08                    EX          AF,AF'
  1410  291d  0604                  LD          B,0x4
  1411                          LAB_ram_e91f:
  1412  291f  7e                    LD          A,(HL)
  1413  2920  e6f0                  AND         $f0
  1414  2922  bb                    CP          E
  1415  2923  2810                  JR          Z,LAB_ram_e935
  1416  2925  b2                    OR          D
  1417                          LAB_ram_e926:
  1418  2926  77                    LD          (HL),A
  1419  2927  23                    INC         HL
  1420  2928  10f5                  DJNZ        LAB_ram_e91f
  1421  292a  d5                    PUSH        DE
  1422  292b  112400                LD          DE,$24                                 ;Jump ahead 36 cells
  1423                                                                                  ;(40 - 4)
  1424  292e  19                    ADD         HL,DE
  1425  292f  d1                    POP         DE
  1426  2930  08                    EX          AF,AF'
  1427  2931  3d                    DEC         A
  1428  2932  20e8                  JR          NZ,LAB_ram_e91c
  1429  2934  c9                    RET
  1430                          LAB_ram_e935:
  1431  2935  7e                    LD          A,(HL)
  1432  2936  e60f                  AND         0xf
  1433  2938  b1                    OR          C
  1434  2939  18eb                  JR          LAB_ram_e926
  1435                          WAIT_A_TICK:
  1436  293b  010086                LD          BC,$8600                               ;Sleep for 134 "cycles"
  1437  293e  c34b1d                JP          SLEEP                                   ;byte SLEEP(short cycleCount)
  1438                          PICK_UP_F0_ITEM:
  1439  2941  a7                    AND         A                                       ;Reset flags
  1440  2942  08                    EX          AF,AF'                                  ;Save item
  1441  2943  3efe                  LD          A,$fe                                  ;Empty item
  1442  2945  02                    LD          (BC),A
  1443  2946  215233                LD          HL,CHRRAM_FO_ITEM_IDX                   ;= $20
  1444  2949  3e20                  LD          A,$20                                  ;SPACE char
  1445  294b  cd5211                CALL        UPDATE_FO_ITEM
  1446  294e  215237                LD          HL,COLRAM_FO_ITEM_IDX                   ;= $60    `
  1447  2951  3edf                  LD          A,$df                                  ;DKGRN on DKGRY
  1448  2953  cd5211                CALL        UPDATE_FO_ITEM
  1449  2956  08                    EX          AF,AF'                                  ;Restore item
  1450  2957  1f                    RRA                                                 ;Rotate A right, A:0 to carry
  1451  2958  cb1a                  RR          D                                       ;Rotate D right
  1452                                                                                  ;Carry (from A:0) to D:7
  1453  295a  1f                    RRA                                                 ;Rotate A right, A:0 (was A:1) to carry
  1454  295b  cb12                  RL          D                                       ;Rotate D left, carry to D:0
  1455                                                                                  ;D:7 to carry
  1456  295d  cb12                  RL          D                                       ;Rotate D left, carry to D;0
  1457                                                                                  ;D:7 to carry
  1458                                                                                  ;D  = item level
  1459  295f  c9                    RET
  1460                          UPDATE_MELEE_OBJECTSdb:
  1461  2960  3e04                  LD          A,0x4
  1462                          LAB_ram_e962:
  1463  2962  010400                LD          BC,0x4
  1464  2965  edb0                  LDIR                                                ;= "OM"
  1465  2967  3d                    DEC         A
  1466  2968  ca7229                JP          Z,LAB_ram_e972
  1467  296b  012400                LD          BC,$24
  1468  296e  09                    ADD         HL,BC
  1469  296f  c36229                JP          LAB_ram_e962
  1470                          LAB_ram_e972:
  1471  2972  7c                    LD          A,H
  1472  2973  fe34                  CP          $34
  1473  2975  d0                    RET         NC
  1474  2976  018403                LD          BC,$384
  1475  2979  09                    ADD         HL,BC
  1476  297a  c36029                JP          UPDATE_MELEE_OBJECTSdb
  1477                          SUB_ram_e97d:
  1478  297d  3e04                  LD          A,0x4
  1479                          LAB_ram_e97f:
  1480  297f  010400                LD          BC,0x4
  1481  2982  edb0                  LDIR                                                ;= "OM"
  1482  2984  3d                    DEC         A
  1483  2985  ca9129                JP          Z,LAB_ram_e991
  1484  2988  eb                    EX          DE,HL
  1485  2989  012400                LD          BC,$24
  1486  298c  09                    ADD         HL,BC
  1487  298d  eb                    EX          DE,HL
  1488  298e  c37f29                JP          LAB_ram_e97f
  1489                          LAB_ram_e991:
  1490  2991  7a                    LD          A,D
  1491  2992  fe34                  CP          $34
  1492  2994  d0                    RET         NC
  1493  2995  018403                LD          BC,$384
  1494  2998  eb                    EX          DE,HL
  1495  2999  09                    ADD         HL,BC
  1496  299a  eb                    EX          DE,HL
  1497  299b  c37d29                JP          SUB_ram_e97d
  1498                          SUB_ram_e99e:
  1499  299e  3e04                  LD          A,0x4
  1500                          LAB_ram_e9a0:
  1501  29a0  010400                LD          BC,0x4
  1502  29a3  edb0                  LDIR                                                ;= "OM"
  1503  29a5  3d                    DEC         A
  1504  29a6  cab329                JP          Z,LAB_ram_e9b3
  1505  29a9  012400                LD          BC,$24
  1506  29ac  09                    ADD         HL,BC
  1507  29ad  eb                    EX          DE,HL
  1508  29ae  09                    ADD         HL,BC
  1509  29af  eb                    EX          DE,HL
  1510  29b0  c3a029                JP          LAB_ram_e9a0
  1511                          LAB_ram_e9b3:
  1512  29b3  7c                    LD          A,H
  1513  29b4  fe34                  CP          $34
  1514  29b6  d0                    RET         NC
  1515  29b7  018403                LD          BC,$384
  1516  29ba  09                    ADD         HL,BC
  1517  29bb  eb                    EX          DE,HL
  1518  29bc  09                    ADD         HL,BC
  1519  29bd  eb                    EX          DE,HL
  1520  29be  c39e29                JP          SUB_ram_e99e
  1521                          SUB_ram_e9c1:
  1522  29c1  3d                    DEC         A
  1523  29c2  2004                  JR          NZ,LAB_ram_e9c8
  1524  29c4  010105                LD          BC,$501                                ;PHYS = 5
  1525                                                                                  ;SPRT = 1
  1526  29c7  c9                    RET
  1527                          LAB_ram_e9c8:
  1528  29c8  3d                    DEC         A
  1529  29c9  2004                  JR          NZ,LAB_ram_e9cf
  1530  29cb  010408                LD          BC,$804
  1531  29ce  c9                    RET
  1532                          LAB_ram_e9cf:
  1533  29cf  3d                    DEC         A
  1534  29d0  2004                  JR          NZ,LAB_ram_e9d6
  1535  29d2  010812                LD          BC,LAB_ram_1208
  1536  29d5  c9                    RET
  1537                          LAB_ram_e9d6:
  1538  29d6  3d                    DEC         A
  1539  29d7  2004                  JR          NZ,LAB_ram_e9dd
  1540  29d9  011326                LD          BC,BYTE_ram_2613                        ;= $FF
  1541  29dc  c9                    RET
  1542                          LAB_ram_e9dd:
  1543  29dd  010000                LD          BC,0x0
  1544  29e0  c9                    RET
  1545                          SUB_ram_e9e1:
  1546  29e1  3a7a3a                LD          A,(RIGHT_HAND_ITEM)
  1547  29e4  fefe                  CP          $fe
  1548  29e6  2004                  JR          NZ,LAB_ram_e9ec
  1549  29e8  e1                    POP         HL
  1550  29e9  c33022                JP          NO_ACTION_TAKEN
  1551                          LAB_ram_e9ec:
  1552  29ec  3eff                  LD          A,$ff
  1553  29ee  02                    LD          (BC),A
  1554  29ef  0d                    DEC         C
  1555  29f0  0d                    DEC         C
  1556  29f1  7c                    LD          A,H
  1557  29f2  02                    LD          (BC),A
  1558  29f3  0c                    INC         C
  1559  29f4  3efe                  LD          A,$fe
  1560  29f6  02                    LD          (BC),A
  1561  29f7  c9                    RET
  1562                          DO_ROTATE_PACK:
  1563  29f8  217c3a                LD          HL,INV_ITEM_SLOT_1
  1564  29fb  01103a                LD          BC,ITEM_MOVE_COL_BUFFER
  1565  29fe  af                    XOR         A
  1566  29ff  02                    LD          (BC),A
  1567  2a00  cd622a                CALL        SUB_ram_ea62
  1568  2a03  23                    INC         HL
  1569  2a04  017c3a                LD          BC,INV_ITEM_SLOT_1
  1570  2a07  cd622a                CALL        SUB_ram_ea62
  1571  2a0a  1e04                  LD          E,0x4
  1572                          LAB_ram_ea0c:
  1573  2a0c  23                    INC         HL
  1574  2a0d  03                    INC         BC
  1575  2a0e  cd622a                CALL        SUB_ram_ea62
  1576  2a11  1d                    DEC         E
  1577  2a12  c20c2a                JP          NZ,LAB_ram_ea0c
  1578  2a15  21103a                LD          HL,ITEM_MOVE_COL_BUFFER
  1579  2a18  03                    INC         BC
  1580  2a19  cd622a                CALL        SUB_ram_ea62
  1581  2a1c  21b431                LD          HL,DAT_ram_31b4                         ;= $20
  1582  2a1f  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
  1583  2a22  cd6029                CALL        UPDATE_MELEE_OBJECTSdb
  1584  2a25  211131                LD          HL,DAT_ram_3111                         ;= $20
  1585  2a28  11b431                LD          DE,DAT_ram_31b4                         ;= $20
  1586  2a2b  cd9e29                CALL        SUB_ram_e99e
  1587  2a2e  210c31                LD          HL,DAT_ram_310c                         ;= $20
  1588  2a31  111131                LD          DE,DAT_ram_3111                         ;= $20
  1589  2a34  cd9e29                CALL        SUB_ram_e99e
  1590  2a37  21a931                LD          HL,CHHRAM_INV_4_IDX                     ;= $20
  1591  2a3a  110c31                LD          DE,DAT_ram_310c                         ;= $20
  1592  2a3d  cd9e29                CALL        SUB_ram_e99e
  1593  2a40  214c32                LD          HL,DAT_ram_324c                         ;= $20
  1594  2a43  11a931                LD          DE,CHHRAM_INV_4_IDX                     ;= $20
  1595  2a46  cd9e29                CALL        SUB_ram_e99e
  1596  2a49  215132                LD          HL,CHHRAM_INV_6_IDX                     ;= $20
  1597  2a4c  114c32                LD          DE,DAT_ram_324c                         ;= $20
  1598  2a4f  cd9e29                CALL        SUB_ram_e99e
  1599  2a52  219f2a                LD          HL,WAIT_FOR_INPUT                    ; WAIT FOR INPUT label --- UNDO???
  1600  2a55  e5                    PUSH        HL
  1601  2a56  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
  1602  2a59  115132                LD          DE,CHHRAM_INV_6_IDX                     ;= $20
  1603  2a5c  cd7d29                CALL        SUB_ram_e97d
  1604  2a5f  c33b29                JP          WAIT_A_TICK
  1605                          SUB_ram_ea62:
  1606  2a62  56                    LD          D,(HL)
  1607  2a63  0a                    LD          A,(BC)
  1608  2a64  77                    LD          (HL),A
  1609  2a65  7a                    LD          A,D
  1610  2a66  02                    LD          (BC),A
  1611  2a67  c9                    RET
  1612                          DO_SWAP_PACK:
  1613  2a68  217c3a                LD          HL,INV_ITEM_SLOT_1
  1614  2a6b  017a3a                LD          BC,RIGHT_HAND_ITEM
  1615  2a6e  cd622a                CALL        SUB_ram_ea62
  1616  2a71  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1617  2a74  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
  1618  2a77  cd6029                CALL        UPDATE_MELEE_OBJECTSdb
  1619  2a7a  21b431                LD          HL,DAT_ram_31b4                         ;= $20
  1620  2a7d  114333                LD          DE,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1621  2a80  cd9e29                CALL        SUB_ram_e99e
  1622  2a83  219f2a                LD          HL,WAIT_FOR_INPUT                    ; WAIT FOR INPUT label --- UNDO???
  1623  2a86  e5                    PUSH        HL
  1624  2a87  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
  1625  2a8a  11b431                LD          DE,DAT_ram_31b4                         ;= $20
  1626  2a8d  cd7d29                CALL        SUB_ram_e97d
  1627  2a90  cd4227                CALL        NEW_RIGHT_HAND_ITEM
  1628  2a93  c33b29                JP          WAIT_A_TICK
  1629                          UPDATE_VIEWPORT:
  1630  2a96  cde634                CALL        REDRAW_START
  1631  2a99  cd0438                CALL        REDRAW_VIEWPORT
  1632                          INPUT_DEBOUNCE:
  1633  2a9c  cd3b29                CALL        WAIT_A_TICK
  1634                          WAIT_FOR_INPUT:
  1635  2a9f  cd7a1e                CALL        TIMER_UPDATE
  1636  2aa2  cd851e                CALL        BLINK_ROUTINE
  1637  2aa5  00                    NOP
  1638  2aa6  00                    NOP
  1639  2aa7  00                    NOP
  1640  2aa8  00                    NOP
  1641  2aa9  305b                  JR          NC,TIMER_UPDATED_CHECK_INPUT
  1642  2aab  216b3a                LD          HL,TIMER_C
  1643  2aae  34                    INC         (HL)
  1644  2aaf  7e                    LD          A,(HL)
  1645  2ab0  fe15                  CP          $15
  1646  2ab2  da062b                JP          C,TIMER_UPDATED_CHECK_INPUT
  1647  2ab5  af                    XOR         A
  1648  2ab6  77                    LD          (HL),A
  1649                          SCREEN_SAVER_FULL_SCREEN:
  1650  2ab7  210008                LD          HL,$800
  1651                          SCREEN_SAVER_REDRAW_LOOP:
  1652  2aba  110034                LD          DE,COLRAM                               ;= $60
  1653                          RECALC_SCREEN_SAVER_COLORS:
  1654  2abd  1a                    LD          A,(DE)                          ;= $60
  1655  2abe  0f                    RRCA
  1656  2abf  12                    LD          (DE),A                          ;= $60
  1657  2ac0  13                    INC         DE
  1658  2ac1  3e38                  LD          A,$38
  1659  2ac3  ba                    CP          D
  1660  2ac4  20f7                  JR          NZ,RECALC_SCREEN_SAVER_COLORS
  1661  2ac6  25                    DEC         H
  1662  2ac7  2002                  JR          NZ,CHECK_INPUT_DURING_SCREEN_SAVER
  1663  2ac9  2608                  LD          H,0x8
  1664                          CHECK_INPUT_DURING_SCREEN_SAVER:
  1665  2acb  2d                    DEC         L
  1666  2acc  28ec                  JR          Z,SCREEN_SAVER_REDRAW_LOOP
  1667  2ace  014001                LD          BC,$140
  1668  2ad1  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  1669  2ad4  01ff00                LD          BC,$ff
  1670  2ad7  ed78                  IN          A,(C)
  1671  2ad9  3c                    INC         A
  1672  2ada  2019                  JR          NZ,LAB_ram_eaf5
  1673  2adc  0ef7                  LD          C,$f7
  1674  2ade  3e0f                  LD          A,0xf
  1675  2ae0  ed79                  OUT         (C),A                              ;= db
  1676  2ae2  0d                    DEC         C
  1677  2ae3  ed78                  IN          A,(C)                     ;= db
  1678  2ae5  3c                    INC         A
  1679  2ae6  c2f52a                JP          NZ,LAB_ram_eaf5
  1680  2ae9  0c                    INC         C
  1681  2aea  3e0e                  LD          A,0xe
  1682  2aec  ed79                  OUT         (C),A                              ;= db
  1683  2aee  0d                    DEC         C
  1684  2aef  ed78                  IN          A,(C)                     ;= db
  1685  2af1  3c                    INC         A
  1686  2af2  cacb2a                JP          Z,CHECK_INPUT_DURING_SCREEN_SAVER
  1687                          LAB_ram_eaf5:
  1688  2af5  110034                LD          DE,COLRAM                               ;= $60
  1689                          LAB_ram_eaf8:
  1690  2af8  44                    LD          B,H
  1691  2af9  1a                    LD          A,(DE)                          ;= $60
  1692                          LAB_ram_eafa:
  1693  2afa  0f                    RRCA
  1694  2afb  10fd                  DJNZ        LAB_ram_eafa
  1695  2afd  12                    LD          (DE),A                          ;= $60
  1696  2afe  13                    INC         DE                  ;= $60
  1697  2aff  3e38                  LD          A,$38
  1698  2b01  ba                    CP          D
  1699  2b02  20f4                  JR          NZ,LAB_ram_eaf8
  1700  2b04  1896                  JR          INPUT_DEBOUNCE
  1701                          TIMER_UPDATED_CHECK_INPUT:
  1702  2b06  3a653a                LD          A,(RAM_AD)
  1703  2b09  fe32                  CP          $32
  1704  2b0b  2846                  JR          Z,LAB_ram_eb53
  1705  2b0d  3a663a                LD          A,(RAM_AE)
  1706  2b10  fe31                  CP          $31
  1707  2b12  2013                  JR          NZ,LAB_ram_eb27
  1708  2b14  21693a                LD          HL,TIMER_A
  1709  2b17  3a893a                LD          A,(BYTE_ram_3a89)
  1710  2b1a  be                    CP          (HL)
  1711  2b1b  c29f2a                JP          NZ,WAIT_FOR_INPUT
  1712  2b1e  cd5024                CALL        SUB_ram_e450
  1713  2b21  cd9a23                CALL        SUB_ram_e39a
  1714  2b24  c39f2a                JP          WAIT_FOR_INPUT
  1715                          LAB_ram_eb27:
  1716  2b27  21693a                LD          HL,TIMER_A
  1717  2b2a  3a8c3a                LD          A,(BYTE_ram_3a8c)
  1718  2b2d  be                    CP          (HL)
  1719  2b2e  c29f2a                JP          NZ,WAIT_FOR_INPUT
  1720  2b31  cd3526                CALL        SUB_ram_e635
  1721  2b34  cd5024                CALL        SUB_ram_e450
  1722  2b37  cd9a23                CALL        SUB_ram_e39a
  1723  2b3a  cdcf25                CALL        MELEE_ANIM_LOOP
  1724  2b3d  c39f2a                JP          WAIT_FOR_INPUT
  1725                          LAB_ram_eb40:
  1726  2b40  21693a                LD          HL,TIMER_A
  1727  2b43  3a8c3a                LD          A,(BYTE_ram_3a8c)
  1728  2b46  be                    CP          (HL)
  1729  2b47  c29f2a                JP          NZ,WAIT_FOR_INPUT
  1730  2b4a  cd3526                CALL        SUB_ram_e635
  1731  2b4d  cdcf25                CALL        MELEE_ANIM_LOOP
  1732  2b50  c39f2a                JP          WAIT_FOR_INPUT
  1733                          LAB_ram_eb53:
  1734  2b53  3a663a                LD          A,(RAM_AE)
  1735  2b56  fe31                  CP          $31
  1736  2b58  20e6                  JR          NZ,LAB_ram_eb40
  1737  2b5a  cdca3a                CALL        UPDATE_SCR_SAVER_TIMER
  1738  2b5d  3a783a                LD          A,(LAST_ITEM_HELD)
  1739  2b60  a7                    AND         A
  1740  2b61  c2d62b                JP          NZ,LAB_ram_ebd6
  1741  2b64  0604                  LD          B,0x4
  1742  2b66  21e937                LD          HL,ITEM_F1                              ;= $60
  1743  2b69  7e                    LD          A,(HL)                         ;= $60
  1744  2b6a  3c                    INC         A
  1745  2b6b  3c                    INC         A
  1746  2b6c  21ec37                LD          HL,ITEM_FR1                             ;= $60
  1747                          LAB_ram_eb6f:
  1748  2b6f  fe7a                  CP          $7a
  1749  2b71  3008                  JR          NC,LAB_ram_eb7b
  1750  2b73  23                    INC         HL
  1751  2b74  7e                    LD          A,(HL)                         ;= $60
  1752  2b75  3c                    INC         A
  1753  2b76  3c                    INC         A
  1754  2b77  10f6                  DJNZ        LAB_ram_eb6f
  1755  2b79  185b                  JR          LAB_ram_ebd6
  1756                          LAB_ram_eb7b:
  1757  2b7b  3a883a                LD          A,(TIMER_D)
  1758  2b7e  fe05                  CP          0x5
  1759  2b80  3054                  JR          NC,LAB_ram_ebd6
  1760  2b82  cdac3a                CALL        MAKE_RANDOM_BYTE
  1761  2b85  c608                  ADD         A,0x8
  1762  2b87  304d                  JR          NC,LAB_ram_ebd6
  1763  2b89  05                    DEC         B
  1764  2b8a  2012                  JR          NZ,LAB_ram_eb9e
  1765  2b8c  3afd33                LD          A,(DAT_ram_33fd)                        ;= $20
  1766  2b8f  cb57                  BIT         0x2,A
  1767  2b91  2003                  JR          NZ,LAB_ram_eb96
  1768  2b93  a7                    AND         A
  1769  2b94  2040                  JR          NZ,LAB_ram_ebd6
  1770                          LAB_ram_eb96:
  1771  2b96  cd232e                CALL        SUB_ram_ee23
  1772  2b99  cd232e                CALL        SUB_ram_ee23
  1773  2b9c  1822                  JR          LAB_ram_ebc0
  1774                          LAB_ram_eb9e:
  1775  2b9e  05                    DEC         B
  1776  2b9f  200f                  JR          NZ,LAB_ram_ebb0
  1777  2ba1  3af533                LD          A,(DAT_ram_33f5)                        ;= $20
  1778  2ba4  cb57                  BIT         0x2,A
  1779  2ba6  2003                  JR          NZ,LAB_ram_ebab
  1780  2ba8  a7                    AND         A
  1781  2ba9  202b                  JR          NZ,LAB_ram_ebd6
  1782                          LAB_ram_ebab:
  1783  2bab  cd0b2e                CALL        SUB_ram_ee0b
  1784  2bae  1810                  JR          LAB_ram_ebc0
  1785                          LAB_ram_ebb0:
  1786  2bb0  05                    DEC         B
  1787  2bb1  2019                  JR          NZ,LAB_ram_ebcc
  1788  2bb3  3af933                LD          A,(DAT_ram_33f9)                        ;= $20
  1789  2bb6  cb57                  BIT         0x2,A
  1790  2bb8  2003                  JR          NZ,LAB_ram_ebbd
  1791  2bba  a7                    AND         A
  1792  2bbb  2019                  JR          NZ,LAB_ram_ebd6
  1793                          LAB_ram_ebbd:
  1794  2bbd  cd232e                CALL        SUB_ram_ee23
  1795                          LAB_ram_ebc0:
  1796  2bc0  cde634                CALL        REDRAW_START
  1797  2bc3  cd0438                CALL        REDRAW_VIEWPORT
  1798                          LAB_ram_ebc6:
  1799  2bc6  cd5f15                CALL        SUB_ram_cd5f
  1800  2bc9  c33031                JP          SUB_ram_f130
  1801                          LAB_ram_ebcc:
  1802  2bcc  3ae833                LD          A,(WALL_F0_STATE)                       ;= $20
  1803  2bcf  cb57                  BIT         0x2,A
  1804  2bd1  20f3                  JR          NZ,LAB_ram_ebc6
  1805  2bd3  a7                    AND         A
  1806  2bd4  28f0                  JR          Z,LAB_ram_ebc6
  1807                          LAB_ram_ebd6:
  1808  2bd6  01ff00                LD          BC,$ff
  1809  2bd9  ed78                  IN          A,(C)
  1810  2bdb  3c                    INC         A
  1811  2bdc  c2522c                JP          NZ,LAB_ram_ec52
  1812  2bdf  0ef7                  LD          C,$f7
  1813  2be1  3e0f                  LD          A,0xf
  1814  2be3  ed79                  OUT         (C),A                              ;= db
  1815  2be5  0d                    DEC         C
  1816  2be6  ed78                  IN          A,(C)                     ;= db
  1817  2be8  3c                    INC         A
  1818  2be9  200c                  JR          NZ,LAB_ram_ebf7
  1819  2beb  0c                    INC         C
  1820  2bec  3e0e                  LD          A,0xe
  1821  2bee  ed79                  OUT         (C),A                              ;= db
  1822  2bf0  0d                    DEC         C
  1823  2bf1  ed78                  IN          A,(C)                     ;= db
  1824  2bf3  3c                    INC         A
  1825  2bf4  ca9f2a                JP          Z,WAIT_FOR_INPUT
  1826                          LAB_ram_ebf7:
  1827  2bf7  cd362c                CALL        PLAY_DESCENDING_SOUND
  1828  2bfa  21fe37                LD          HL,HC_INPUT_HOLDER                      ;= $6060
  1829                          DISABLE_JOY_04:
  1830  2bfd  0ef7                  LD          C,$f7
  1831  2bff  3e0f                  LD          A,0xf
  1832  2c01  ed79                  OUT         (C),A                              ;= db
  1833  2c03  0d                    DEC         C
  1834  2c04  ed78                  IN          A,(C)                     ;= db
  1835  2c06  77                    LD          (HL),A                 ;= $6060
  1836  2c07  23                    INC         HL
  1837  2c08  0c                    INC         C
  1838                          ENABLE_JOY_04:
  1839  2c09  3e0e                  LD          A,0xe
  1840  2c0b  ed79                  OUT         (C),A                              ;= db
  1841  2c0d  0d                    DEC         C
  1842  2c0e  ed78                  IN          A,(C)                     ;= db
  1843  2c10  77                    LD          (HL),A
  1844  2c11  3a6c3a                LD          A,(INPUT_HOLDER)
  1845  2c14  a7                    AND         A
  1846  2c15  c2b016                JP          NZ,HC_JOY_INPUT_COMPARE
  1847  2c18  3a683a                LD          A,(DUNGEON_LEVEL)
  1848  2c1b  a7                    AND         A
  1849  2c1c  c21020                JP          NZ,GAMEINIT
  1850  2c1f  7e                    LD          A,(HL)
  1851  2c20  3c                    INC         A
  1852  2c21  280e                  JR          Z,TITLE_CHK_FOR_HC_INPUT
  1853                          HC_LEVEL_SELECT_LOOP:
  1854  2c23  fe60                  CP          $60                                    ;K3 pressed on title screen
  1855  2c25  2874                  JR          Z,SET_DIFFICULTY_1
  1856  2c27  fe7c                  CP          $7c
  1857  2c29  2874                  JR          Z,SET_DIFFICULTY_2
  1858  2c2b  fec0                  CP          $c0
  1859  2c2d  2874                  JR          Z,SET_DIFFICULTY_3
  1860  2c2f  185a                  JR          SET_DIFFICULTY_4
  1861                          TITLE_CHK_FOR_HC_INPUT:
  1862  2c31  2b                    DEC         HL
  1863  2c32  7e                    LD          A,(HL)                 ;= $6060
  1864  2c33  3c                    INC         A
  1865  2c34  18ed                  JR          HC_LEVEL_SELECT_LOOP
  1866                          PLAY_DESCENDING_SOUND:
  1867  2c36  af                    XOR         A
  1868  2c37  32693a                LD          (TIMER_A),A
  1869  2c3a  326a3a                LD          (TIMER_B),A
  1870  2c3d  326b3a                LD          (TIMER_C),A
  1871  2c40  d3fc                  OUT         (SPEAKER),A                             ;= db
  1872  2c42  01f000                LD          BC,$f0
  1873  2c45  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  1874  2c48  3c                    INC         A
  1875  2c49  d3fc                  OUT         (SPEAKER),A                             ;= db
  1876  2c4b  01c004                LD          BC,$4c0
  1877  2c4e  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  1878  2c51  c9                    RET
  1879                          LAB_ram_ec52:
  1880  2c52  cd362c                CALL        PLAY_DESCENDING_SOUND
  1881  2c55  21f637                LD          HL,KEY_INPUT_COL0                       ;= $60
  1882  2c58  01ff3e                LD          BC,GFX_POINTERS
  1883  2c5b  1608                  LD          D,0x8
  1884                          SELECT_DIFFICULTY_LOOP:
  1885  2c5d  ed78                  IN          A,(C)
  1886  2c5f  77                    LD          (HL),A                  ;= $20
  1887                                                                                  ;= $60
  1888  2c60  2c                    INC         L
  1889  2c61  cb00                  RLC         B
  1890  2c63  15                    DEC         D
  1891  2c64  20f7                  JR          NZ,SELECT_DIFFICULTY_LOOP
  1892  2c66  3a6c3a                LD          A,(INPUT_HOLDER)
  1893  2c69  a7                    AND         A
  1894  2c6a  c2e03b                JP          NZ,KEY_COMPARE                          ;OLD = e12c ; NEW = fbe0
  1895  2c6d  3a683a                LD          A,(DUNGEON_LEVEL)
  1896  2c70  a7                    AND         A
  1897  2c71  c21020                JP          NZ,GAMEINIT
  1898  2c74  3afc37                LD          A,(KEY_INPUT_COL6)                      ;= $60
  1899  2c77  fefe                  CP          $fe
  1900  2c79  2820                  JR          Z,SET_DIFFICULTY_1                      ;Key 3 pressed on Title Screen
  1901  2c7b  fedf                  CP          $df
  1902  2c7d  ca6a1e                JP          Z,SHOW_AUTHOR                           ;Key A pressed (and held)
  1903                                                                                  ;on title screen
  1904  2c80  3afd37                LD          A,(KEY_INPUT_COL7)                      ;= $60
  1905  2c83  fefe                  CP          $fe
  1906  2c85  2818                  JR          Z,SET_DIFFICULTY_2                      ;Key 2 pressed on Title Screen
  1907  2c87  fefb                  CP          $fb
  1908  2c89  2818                  JR          Z,SET_DIFFICULTY_3                      ;Key 1 pressed on Title Screen
  1909                          SET_DIFFICULTY_4:
  1910  2c8b  3e00                  LD          A,0x0                                   ;Some other key pressed on Title Screen
  1911                          GOTO_GAME_START:
  1912  2c8d  326c3a                LD          (INPUT_HOLDER),A
  1913  2c90  3ab93a                LD          A,(GAME_BOOLEANS)
  1914  2c93  cbc7                  SET         0x0,A
  1915  2c95  32b93a                LD          (GAME_BOOLEANS),A
  1916  2c98  c39620                JP          BLANK_SCRN
  1917                          SET_DIFFICULTY_1:
  1918  2c9b  3e01                  LD          A,0x1
  1919  2c9d  18ee                  JR          GOTO_GAME_START
  1920                          SET_DIFFICULTY_2:
  1921  2c9f  3e02                  LD          A,0x2
  1922  2ca1  18ea                  JR          GOTO_GAME_START
  1923                          SET_DIFFICULTY_3:
  1924  2ca3  3e03                  LD          A,0x3
  1925  2ca5  18e6                  JR          GOTO_GAME_START
  1926  2ca7  00                    NOP
  1927  2ca8  00                    NOP
  1928  2ca9  00                    NOP
  1929  2caa  00                    NOP
  1930  2cab  00                    NOP
  1931                          CHK_ITEM:
  1932  2cac  fefe                  CP          $fe
  1933  2cae  c8                    RET         Z
  1934  2caf  cb3f                  SRL         A
  1935  2cb1  5f                    LD          E,A
  1936  2cb2  daba2c                JP          C,LAB_ram_ecba
  1937  2cb5  1610                  LD          D,$10
  1938  2cb7  c3bc2c                JP          LAB_ram_ecbc
  1939                          LAB_ram_ecba:
  1940  2cba  1630                  LD          D,$30
  1941                          LAB_ram_ecbc:
  1942  2cbc  cb3f                  SRL         A
  1943  2cbe  d2c52c                JP          NC,LAB_ram_ecc5
  1944  2cc1  3e40                  LD          A,$40
  1945  2cc3  82                    ADD         A,D
  1946  2cc4  57                    LD          D,A
  1947                          LAB_ram_ecc5:
  1948  2cc5  cb83                  RES         0x0,E
  1949  2cc7  7b                    LD          A,E
  1950  2cc8  cb27                  SLA         A
  1951  2cca  83                    ADD         A,E
  1952  2ccb  80                    ADD         A,B
  1953  2ccc  42                    LD          B,D
  1954  2ccd  6f                    LD          L,A
  1955  2cce  26ff                  LD          H,$ff
  1956  2cd0  5e                    LD          E,(HL)
  1957  2cd1  23                    INC         HL
  1958  2cd2  56                    LD          D,(HL)
  1959  2cd3  3a633a                LD          A,(MON_FS)
  1960  2cd6  67                    LD          H,A
  1961  2cd7  69                    LD          L,C
  1962  2cd8  c33533                JP          GFX_DRAW
  1963                          DO_OPEN_CLOSE:
  1964  2cdb  3aea37                LD          A,(ITEM_F0)                             ;= $60
  1965  2cde  0e00                  LD          C,0x0                                   ;C  = 0
  1966  2ce0  cb3f                  SRL         A                                       ;Move item LEVEL
  1967                                                                                  ;into C
  1968  2ce2  cb19                  RR          C
  1969  2ce4  cb3f                  SRL         A
  1970  2ce6  cb11                  RL          C
  1971  2ce8  cb11                  RL          C
  1972  2cea  fe11                  CP          $11                                    ;Compare to BOX
  1973                                                                                  ;44,45,46,47 2 @ SRL = 11
  1974  2cec  202d                  JR          NZ,LAB_ram_ed1b
  1975  2cee  79                    LD          A,C                                     ;A = C (item level)
  1976  2cef  a7                    AND         A
  1977  2cf0  2809                  JR          Z,DO_OPEN_BOX
  1978  2cf2  cdca3a                CALL        UPDATE_SCR_SAVER_TIMER
  1979  2cf5  0c                    INC         C
  1980                          LAB_ram_ecf6:
  1981  2cf6  91                    SUB         C
  1982  2cf7  30fd                  JR          NC,LAB_ram_ecf6
  1983  2cf9  81                    ADD         A,C
  1984  2cfa  4f                    LD          C,A
  1985                          DO_OPEN_BOX:
  1986  2cfb  ed5f                  LD          A,R                                     ;Semi-random number into A
  1987  2cfd  e607                  AND         0x7
  1988                          PICK_RANDOM_ITEM:
  1989  2cff  d607                  SUB         0x7
  1990  2d01  30fc                  JR          NC,PICK_RANDOM_ITEM
  1991  2d03  c61d                  ADD         A,$1d                                  ;$1d is +1 above range
  1992  2d05  cb19                  RR          C
  1993  2d07  cb18                  RR          B
  1994  2d09  cb19                  RR          C                                       ;C = C/8
  1995  2d0b  17                    RLA
  1996  2d0c  cb10                  RL          B
  1997  2d0e  17                    RLA
  1998  2d0f  08                    EX          AF,AF'
  1999  2d10  3a793a                LD          A,(PLAYER_MAP_POS)
  2000  2d13  cdf337                CALL        ITEM_MAP_CHECK
  2001  2d16  08                    EX          AF,AF'
  2002  2d17  02                    LD          (BC),A
  2003  2d18  c3962a                JP          UPDATE_VIEWPORT
  2004                          LAB_ram_ed1b:
  2005  2d1b  3a793a                LD          A,(PLAYER_MAP_POS)
  2006  2d1e  2638                  LD          H,$38
  2007  2d20  6f                    LD          L,A
  2008  2d21  3a623a                LD          A,(DIR_FACING_SHORT)
  2009  2d24  3d                    DEC         A
  2010  2d25  280a                  JR          Z,NORTH_OPEN_CLOSE_DOOR                 ;Is facing NORTH
  2011  2d27  3d                    DEC         A
  2012  2d28  2820                  JR          Z,SHIFT_EAST_OPEN_CLOSE_DOOR            ;Is facing EAST
  2013  2d2a  3d                    DEC         A
  2014  2d2b  201e                  JR          NZ,LAB_ram_ed4b                         ;Is facing WEST
  2015  2d2d  7d                    LD          A,L                                     ;Is facing SOUTH
  2016  2d2e  c610                  ADD         A,$10
  2017  2d30  6f                    LD          L,A                                     ;Shift SOUTH and process as NORTH
  2018                          NORTH_OPEN_CLOSE_DOOR:
  2019  2d31  cb76                  BIT         0x6,(HL)                                ;N WALL check
  2020  2d33  ca3022                JP          Z,NO_ACTION_TAKEN                       ;...if no N WALL
  2021  2d36  cb6e                  BIT         0x5,(HL)                                ;N hidden DOOR check
  2022  2d38  2804                  JR          Z,SET_N_DOOR_MASK                       ;...if no N hidden DOOR
  2023  2d3a  3e44                  LD          A,$44                                  ;WALL mask
  2024  2d3c  1802                  JR          OPEN_N_CHECK
  2025                          SET_N_DOOR_MASK:
  2026  2d3e  3e22                  LD          A,$22                                  ;DOOR mask
  2027                          OPEN_N_CHECK:
  2028  2d40  cb7e                  BIT         0x7,(HL)                                ;N DOOR-OPEN check
  2029  2d42  c2c12d                JP          NZ,CLOSE_N_DOOR                         ;...if N DOOR not OPEN
  2030  2d45  cbfe                  SET         0x7,(HL)                                ;Set N door closed on wall map
  2031  2d47  c3632d                JP          SET_F0_DOOR_OPEN
  2032                          SHIFT_EAST_OPEN_CLOSE_DOOR:
  2033  2d4a  2c                    INC         L                                       ;Shift EAST and process as WEST
  2034                          LAB_ram_ed4b:
  2035  2d4b  cb4e                  BIT         0x1,(HL)                                ;W WALL check
  2036  2d4d  ca3022                JP          Z,NO_ACTION_TAKEN                       ;...if no W WALL
  2037  2d50  cb46                  BIT         0x0,(HL)                                ;W DOOR check
  2038  2d52  ca5a2d                JP          Z,SET_W_DOOR_MASK                       ;...if no W DOOR
  2039  2d55  3e44                  LD          A,$44                                  ;WALL mask
  2040  2d57  c35c2d                JP          LAB_ram_ed5c
  2041                          SET_W_DOOR_MASK:
  2042  2d5a  3e22                  LD          A,$22
  2043                          LAB_ram_ed5c:
  2044  2d5c  cb56                  BIT         0x2,(HL)                                ;DOOR-OPEN check
  2045  2d5e  c2c62d                JP          NZ,CLOSE_W_DOOR                         ;...if DOOR-OPEN
  2046  2d61  cbd6                  SET         0x2,(HL)                                ;Set W door closed on wall map
  2047                          SET_F0_DOOR_OPEN:
  2048  2d63  21e833                LD          HL,WALL_F0_STATE                        ;= $20
  2049  2d66  cbd6                  SET         0x2,(HL)                 ;= $20
  2050  2d68  08                    EX          AF,AF'                                  ;Save MASK state from A
  2051                          WAIT_TO_REDRAW_F0_DOOR:
  2052  2d69  dbfd                  IN          A,(VSYNC)                               ;= db
  2053  2d6b  3c                    INC         A
  2054  2d6c  28fb                  JR          Z,WAIT_TO_REDRAW_F0_DOOR
  2055  2d6e  3e00                  LD          A,0x0                                   ;BLK on BLK
  2056                                                                                  ;WAS BLU on BLU
  2057                                                                                  ;WAS LD A,$bb
  2058  2d70  cd0811                CALL        DRAW_DOOR_F0
  2059  2d73  3ae937                LD          A,(ITEM_F1)                             ;= $60
  2060  2d76  018a02                LD          BC,$28a
  2061  2d79  cdac2c                CALL        CHK_ITEM
  2062  2d7c  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
  2063  2d7f  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
  2064  2d82  cdaf2d                CALL        SUB_ram_edaf
  2065  2d85  cdfb15                CALL        SETUP_OPEN_DOOR_SOUND
  2066  2d88  d9                    EXX
  2067  2d89  21583a                LD          HL,BYTE_ram_3a58
  2068  2d8c  112837                LD          DE,DAT_ram_3728                         ;= $60
  2069  2d8f  3e0c                  LD          A,0xc
  2070                          LAB_ram_ed91:
  2071  2d91  08                    EX          AF,AF'
  2072  2d92  d9                    EXX
  2073  2d93  cd0116                CALL        LO_HI_PITCH_SOUND
  2074  2d96  d9                    EXX
  2075  2d97  010800                LD          BC,0x8
  2076  2d9a  edb0                  LDIR                                                ;= $60
  2077  2d9c  011000                LD          BC,$10
  2078  2d9f  ed42                  SBC         HL,BC
  2079  2da1  eb                    EX          DE,HL
  2080  2da2  013000                LD          BC,$30
  2081  2da5  ed42                  SBC         HL,BC
  2082  2da7  eb                    EX          DE,HL
  2083  2da8  08                    EX          AF,AF'
  2084  2da9  3d                    DEC         A
  2085  2daa  ca9f2a                JP          Z,WAIT_FOR_INPUT
  2086  2dad  18e2                  JR          LAB_ram_ed91
  2087                          SUB_ram_edaf:
  2088  2daf  3e0c                  LD          A,0xc
  2089                          LAB_ram_edb1:
  2090  2db1  010800                LD          BC,0x8
  2091  2db4  edb0                  LDIR
  2092  2db6  012000                LD          BC,$20
  2093  2db9  09                    ADD         HL,BC
  2094  2dba  3d                    DEC         A
  2095  2dbb  20f4                  JR          NZ,LAB_ram_edb1
  2096  2dbd  08                    EX          AF,AF'
  2097  2dbe  c30811                JP          DRAW_DOOR_F0
  2098                          CLOSE_N_DOOR:
  2099  2dc1  cbbe                  RES         0x7,(HL)                                ;Set N Door map flag to closed
  2100  2dc3  c3c82d                JP          START_DOOR_CLOSE_ANIM
  2101                          CLOSE_W_DOOR:
  2102  2dc6  cb96                  RES         0x2,(HL)                                ;Set W Door map flag to closed
  2103                          START_DOOR_CLOSE_ANIM:
  2104  2dc8  21e833                LD          HL,WALL_F0_STATE                        ;= $20
  2105  2dcb  cb96                  RES         0x2,(HL)                 ;= $20
  2106  2dcd  08                    EX          AF,AF'
  2107  2dce  3a793a                LD          A,(PLAYER_MAP_POS)
  2108  2dd1  32773a                LD          (PLAYER_PREV_MAP_LOC),A
  2109  2dd4  cd0f16                CALL        SETUP_CLOSE_DOOR_SOUND
  2110  2dd7  d9                    EXX
  2111  2dd8  08                    EX          AF,AF'
  2112  2dd9  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
  2113  2ddc  112000                LD          DE,$20
  2114  2ddf  01080c                LD          BC,$c08
  2115                          DOOR_CLOSE_ANIM_LOOP:
  2116  2de2  77                    LD          (HL),A              ;= $60
  2117  2de3  2c                    INC         L
  2118  2de4  0d                    DEC         C
  2119  2de5  c2e22d                JP          NZ,DOOR_CLOSE_ANIM_LOOP
  2120  2de8  d9                    EXX
  2121  2de9  08                    EX          AF,AF'
  2122  2dea  cd1516                CALL        HI_LO_PITCH_SOUND
  2123  2ded  08                    EX          AF,AF'
  2124  2dee  d9                    EXX
  2125  2def  0e08                  LD          C,0x8
  2126  2df1  19                    ADD         HL,DE
  2127  2df2  10ee                  DJNZ        DOOR_CLOSE_ANIM_LOOP
  2128  2df4  cdab25                CALL        CLEAR_MONSTER_STATS
  2129  2df7  c39f2a                JP          WAIT_FOR_INPUT
  2130  2dfa  010016                LD          BC,$1600
  2131  2dfd  c34b1d                JP          SLEEP                                   ;byte SLEEP(short cycleCount)
  2132                          DO_TURN_LEFT:
  2133  2e00  3a783a                LD          A,(LAST_ITEM_HELD)
  2134  2e03  a7                    AND         A
  2135  2e04  c23022                JP          NZ,NO_ACTION_TAKEN
  2136  2e07  21962a                LD          HL,UPDATE_VIEWPORT
  2137  2e0a  e5                    PUSH        HL
  2138                          SUB_ram_ee0b:
  2139  2e0b  3a623a                LD          A,(DIR_FACING_SHORT)
  2140  2e0e  3d                    DEC         A
  2141  2e0f  c2142e                JP          NZ,LAB_ram_ee14
  2142  2e12  3e04                  LD          A,0x4
  2143                          LAB_ram_ee14:
  2144  2e14  32623a                LD          (DIR_FACING_SHORT),A
  2145  2e17  c9                    RET
  2146                          DO_TURN_RIGHT:
  2147  2e18  3a783a                LD          A,(LAST_ITEM_HELD)
  2148  2e1b  a7                    AND         A
  2149  2e1c  c23022                JP          NZ,NO_ACTION_TAKEN
  2150  2e1f  21962a                LD          HL,UPDATE_VIEWPORT
  2151  2e22  e5                    PUSH        HL
  2152                          SUB_ram_ee23:
  2153  2e23  3a623a                LD          A,(DIR_FACING_SHORT)
  2154  2e26  3c                    INC         A
  2155  2e27  fe05                  CP          0x5
  2156  2e29  c22e2e                JP          NZ,LAB_ram_ee2e
  2157  2e2c  3e01                  LD          A,0x1
  2158                          LAB_ram_ee2e:
  2159  2e2e  32623a                LD          (DIR_FACING_SHORT),A
  2160  2e31  c9                    RET
  2161                          DO_GLANCE_RIGHT:
  2162  2e32  3a783a                LD          A,(LAST_ITEM_HELD)
  2163  2e35  a7                    AND         A
  2164  2e36  c23022                JP          NZ,NO_ACTION_TAKEN
  2165  2e39  cd232e                CALL        SUB_ram_ee23
  2166  2e3c  cde634                CALL        REDRAW_START
  2167  2e3f  cd0438                CALL        REDRAW_VIEWPORT
  2168  2e42  cd481d                CALL        SLEEP_ZERO                              ;byte SLEEP_ZERO(void)
  2169  2e45  c3002e                JP          DO_TURN_LEFT
  2170                          DO_GLANCE_LEFT:
  2171  2e48  3a783a                LD          A,(LAST_ITEM_HELD)
  2172  2e4b  a7                    AND         A
  2173  2e4c  c23022                JP          NZ,NO_ACTION_TAKEN
  2174  2e4f  cd0b2e                CALL        SUB_ram_ee0b
  2175  2e52  cde634                CALL        REDRAW_START
  2176  2e55  cd0438                CALL        REDRAW_VIEWPORT
  2177  2e58  cd481d                CALL        SLEEP_ZERO                              ;byte SLEEP_ZERO(void)
  2178  2e5b  c3182e                JP          DO_TURN_RIGHT
  2179                          DO_USE_ATTACK:
  2180  2e5e  3a7a3a                LD          A,(RIGHT_HAND_ITEM)
  2181  2e61  0600                  LD          B,0x0
  2182  2e63  cb3f                  SRL         A                                       ;Remove "color/level" in bit 0
  2183                                                                                  ;to compare item type, below.
  2184  2e65  cb18                  RR          B                                       ;Push bit 0 from A
  2185                                                                                  ;(via Carry Flag) to B
  2186  2e67  cb3f                  SRL         A                                       ;Remove second "color/level" in bit 1
  2187                                                                                  ;to compare item type, below
  2188  2e69  cb10                  RL          B                                       ;Move bits 0 & 1
  2189                                                                                  ;from A to B...
  2190  2e6b  cb10                  RL          B                                       ;B now has the LEVEL value (0-3)
  2191  2e6d  00                    NOP                                                 ;Was USE_MAP
  2192  2e6e  00                    NOP
  2193  2e6f  00                    NOP
  2194  2e70  00                    NOP
  2195  2e71  00                    NOP
  2196  2e72  fe16                  CP          $16                                    ;Compare to KEY
  2197                                                                                  ;58,59,5A,5B 2 @ SRL = 16
  2198  2e74  ca2130                JP          Z,DO_USE_KEY
  2199  2e77  fe19                  CP          $19                                    ;Compare to PHYS POTION
  2200                                                                                  ;64,65,66,67 2 @ SRL = 19
  2201  2e79  caf12f                JP          Z,DO_USE_PHYS_POTION
  2202  2e7c  fe1a                  CP          $1a                                    ;Compare to SPRT POTION
  2203                                                                                  ;68,69,6A,6B 2 @ SRL = 1A
  2204  2e7e  ca0930                JP          Z,DO_USE_SPRT_POTION
  2205  2e81  fe1c                  CP          $1c                                    ;Compare to CHAOS POTION
  2206                                                                                  ;70,71,72,73 2 @ SRL = 1c
  2207  2e83  c28230                JP          NZ,USE_SOMETHING_ELSE
  2208                          DO_USE_CHAOS_POTION:
  2209  2e86  cd9d2e                CALL        PLAY_USE_PHYS_POTION_SOUND
  2210  2e89  04                    INC         B
  2211  2e8a  05                    DEC         B
  2212  2e8b  2052                  JR          NZ,CHECK_YELLOW_L_POTION                ;If NZ, handle other colors
  2213                                                                                  ;of LARGE POTION
  2214  2e8d  cdbc2e                CALL        TOTAL_HEAL                              ;LARGE Potion is RED
  2215                                                                                  ;so do TOTAL HEAL
  2216                          PROCESS_POTION_UPDATES:
  2217  2e90  cd5d3d                CALL        REDRAW_STATS
  2218  2e93  3a783a                LD          A,(LAST_ITEM_HELD)
  2219  2e96  a7                    AND         A
  2220  2e97  c24e32                JP          NZ,INIT_MELEE_ANIM
  2221  2e9a  c39c2a                JP          INPUT_DEBOUNCE
  2222                          PLAY_USE_PHYS_POTION_SOUND:
  2223  2e9d  d9                    EXX
  2224  2e9e  cd4816                CALL        SOUND_03
  2225  2ea1  cd4816                CALL        SOUND_03
  2226  2ea4  cd4816                CALL        SOUND_03
  2227  2ea7  1801                  JR          CLEAR_RIGHT_HAND
  2228                          SUB_ram_eea9:
  2229  2ea9  d9                    EXX
  2230                          CLEAR_RIGHT_HAND:
  2231  2eaa  3efe                  LD          A,$fe
  2232  2eac  327a3a                LD          (RIGHT_HAND_ITEM),A
  2233  2eaf  11f409                LD          DE,POOF_6                               ;= "    ",$01
  2234  2eb2  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  2235  2eb5  06d0                  LD          B,$d0
  2236  2eb7  cd3533                CALL        GFX_DRAW
  2237  2eba  d9                    EXX
  2238  2ebb  c9                    RET
  2239                          TOTAL_HEAL:
  2240  2ebc  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
  2241  2ebf  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  2242  2ec2  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
  2243  2ec5  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2244  2ec8  c9                    RET
  2245                          REDRAW_STATS_OLD:
  2246  2ec9  21933a                LD          HL,PLAYER_PHYS_HEALTH
  2247  2ecc  114130                LD          DE,CHRRAM_PHYS_HEALTH_1000              ;= $20
  2248  2ecf  0602                  LD          B,0x2
  2249  2ed1  cdfd32                CALL        RECALC_AND_REDRAW_BCD
  2250  2ed4  21973a                LD          HL,PLAYER_SPRT_HEALTH
  2251  2ed7  114730                LD          DE,CHRRAM_SPRT_HEALTH_10                ;= $20
  2252  2eda  0601                  LD          B,0x1
  2253  2edc  c3fd32                JP          RECALC_AND_REDRAW_BCD                   ;Waz JP FUN_ram_f2fd
  2254                                                                                  ;(c3 fd f2)
  2255                          CHECK_YELLOW_L_POTION:
  2256  2edf  05                    DEC         B
  2257  2ee0  200d                  JR          NZ,CHECK_PURPLE_L_POTION
  2258  2ee2  011000                LD          BC,$10                                 ;Set PHYS increase to 10
  2259  2ee5  1e00                  LD          E,0x0                                   ;Set SPRT increase to 0
  2260                          PROCESS_LARGE_POTION:
  2261  2ee7  cd322f                CALL        CALC_CURR_PHYS_HEALTH
  2262  2eea  cd572f                CALL        CALC_MAX_PHYS_HEALTH
  2263  2eed  18a1                  JR          PROCESS_POTION_UPDATES
  2264                          CHECK_PURPLE_L_POTION:
  2265  2eef  05                    DEC         B
  2266  2ef0  2007                  JR          NZ,CHECK_WHITE_L_POTION
  2267  2ef2  010000                LD          BC,0x0                                  ;Set PHYS increase to 0
  2268  2ef5  1e06                  LD          E,0x6                    ;Set SPRT increase to 6
  2269  2ef7  18ee                  JR          PROCESS_LARGE_POTION
  2270                          CHECK_WHITE_L_POTION:
  2271  2ef9  cdac3a                CALL        MAKE_RANDOM_BYTE                        ;Get RANDOM BYTE
  2272                                                                                  ;and put into A
  2273  2efc  e603                  AND         0x3                                     ;Range it to 0-3
  2274  2efe  3d                    DEC         A
  2275  2eff  2007                  JR          NZ,LAB_ram_ef08                         ;If NZ, check for case 1
  2276  2f01  1e00                  LD          E,0x0                    ;Case 0: set SPRT increase to 0
  2277  2f03  012000                LD          BC,$20                                 ;Set PHYS increase to 20
  2278  2f06  18df                  JR          PROCESS_LARGE_POTION                    ;...and reprocess
  2279                          LAB_ram_ef08:
  2280  2f08  3d                    DEC         A
  2281  2f09  2007                  JR          NZ,LAB_ram_ef12
  2282  2f0b  010000                LD          BC,0x0                                  ;Set PHYS increase to 0
  2283  2f0e  1e12                  LD          E,$12                ;Set SPRT increase to 12
  2284  2f10  18d5                  JR          PROCESS_LARGE_POTION
  2285                          LAB_ram_ef12:
  2286  2f12  3d                    DEC         A
  2287  2f13  200a                  JR          NZ,CHECK_CASE_3_WL_POTION
  2288  2f15  cdbc2e                CALL        TOTAL_HEAL                              ;Fill up PHYS and SPRT
  2289  2f18  011000                LD          BC,$10                                 ;Set PHYS increase to 10
  2290  2f1b  1e06                  LD          E,0x6                    ;Set SPRT increase to 6
  2291  2f1d  18c8                  JR          PROCESS_LARGE_POTION
  2292                          CHECK_CASE_3_WL_POTION:
  2293  2f1f  013000                LD          BC,$30                                 ;Set PHYS decrease to 30
  2294  2f22  1e15                  LD          E,$15                                  ;Set SPRT decrease to 15
  2295  2f24  cd732f                CALL        REDUCE_HEALTH_BIG
  2296  2f27  011500                LD          BC,$15
  2297  2f2a  1e07                  LD          E,0x7
  2298  2f2c  cd8e2f                CALL        REDUCE_HEALTH_SMALL
  2299  2f2f  c3902e                JP          PROCESS_POTION_UPDATES
  2300                          CALC_CURR_PHYS_HEALTH:
  2301  2f32  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)                 ;Load current PHYS Health
  2302                                                                                  ;into HL
  2303  2f35  7d                    LD          A,L
  2304  2f36  81                    ADD         A,C
  2305  2f37  27                    DAA                                                 ;Correct 1000s & 100s
  2306                                                                                  ;for BCD
  2307  2f38  6f                    LD          L,A
  2308  2f39  7c                    LD          A,H
  2309  2f3a  88                    ADC         A,B
  2310  2f3b  27                    DAA                                                 ;Correct 10s & 1s
  2311                                                                                  ;for BCD
  2312  2f3c  fe02                  CP          0x2
  2313  2f3e  67                    LD          H,A
  2314  2f3f  2004                  JR          NZ,UPDATE_HEALTH_VALUES
  2315  2f41  2601                  LD          H,0x1
  2316  2f43  2e99                  LD          L,$99                                  ;Max PHYS Health of 199
  2317                          UPDATE_HEALTH_VALUES:
  2318  2f45  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  2319  2f48  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  2320  2f4b  83                    ADD         A,E
  2321  2f4c  27                    DAA                                                 ;Correct for BCD
  2322  2f4d  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2323  2f50  d0                    RET         NC
  2324  2f51  3e99                  LD          A,$99                                  ;Max SPRT Health of 99
  2325  2f53  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2326  2f56  c9                    RET
  2327                          CALC_MAX_PHYS_HEALTH:
  2328  2f57  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
  2329  2f5a  ed4b953a              LD          BC,(PLAYER_PHYS_HEALTH_MAX)
  2330  2f5e  7c                    LD          A,H
  2331  2f5f  b8                    CP          B
  2332  2f60  3807                  JR          C,CALC_MAX_SPRT_HEALTH
  2333  2f62  7d                    LD          A,L
  2334  2f63  b9                    CP          C
  2335  2f64  3803                  JR          C,CALC_MAX_SPRT_HEALTH
  2336  2f66  22953a                LD          (PLAYER_PHYS_HEALTH_MAX),HL
  2337                          CALC_MAX_SPRT_HEALTH:
  2338  2f69  21983a                LD          HL,PLAYER_SPRT_HEALTH_MAX
  2339  2f6c  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  2340  2f6f  be                    CP          (HL)
  2341  2f70  d8                    RET         C
  2342  2f71  77                    LD          (HL),A
  2343  2f72  c9                    RET
  2344                          REDUCE_HEALTH_BIG:
  2345  2f73  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
  2346  2f76  7d                    LD          A,L
  2347  2f77  91                    SUB         C
  2348  2f78  27                    DAA
  2349  2f79  6f                    LD          L,A
  2350  2f7a  7c                    LD          A,H
  2351  2f7b  98                    SBC         A,B
  2352  2f7c  27                    DAA
  2353  2f7d  67                    LD          H,A
  2354  2f7e  3829                  JR          C,PLAYER_DIES
  2355  2f80  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  2356  2f83  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  2357  2f86  93                    SUB         E
  2358  2f87  27                    DAA
  2359  2f88  381f                  JR          C,PLAYER_DIES
  2360  2f8a  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2361  2f8d  c9                    RET
  2362                          REDUCE_HEALTH_SMALL:
  2363  2f8e  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
  2364  2f91  7d                    LD          A,L
  2365  2f92  91                    SUB         C
  2366  2f93  27                    DAA
  2367  2f94  6f                    LD          L,A
  2368  2f95  7c                    LD          A,H
  2369  2f96  98                    SBC         A,B
  2370  2f97  27                    DAA
  2371  2f98  67                    LD          H,A
  2372  2f99  380e                  JR          C,PLAYER_DIES
  2373  2f9b  22953a                LD          (PLAYER_PHYS_HEALTH_MAX),HL
  2374  2f9e  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
  2375  2fa1  93                    SUB         E
  2376  2fa2  27                    DAA
  2377  2fa3  3804                  JR          C,PLAYER_DIES
  2378  2fa5  32983a                LD          (PLAYER_SPRT_HEALTH_MAX),A
  2379  2fa8  c9                    RET
  2380                          PLAYER_DIES:
  2381  2fa9  212834                LD          HL,COLRAM_VIEWPORT_IDX                  ;= $60    `
  2382  2fac  011818                LD          BC,$1818                               ;18 x 18 rectangle
  2383  2faf  af                    XOR         A
  2384  2fb0  cdcb10                CALL        FILL_CHRCOL_RECT
  2385  2fb3  21e731                LD          HL,CHRRAM_YOU_DIED_IDX                  ;= $20
  2386  2fb6  11e52f                LD          DE,YOU_DIED_TXT
  2387  2fb9  3a6c3a                LD          A,(INPUT_HOLDER)
  2388  2fbc  32783a                LD          (LAST_ITEM_HELD),A
  2389  2fbf  07                    RLCA
  2390  2fc0  07                    RLCA
  2391  2fc1  07                    RLCA
  2392  2fc2  07                    RLCA
  2393  2fc3  47                    LD          B,A
  2394  2fc4  cd3533                CALL        GFX_DRAW
  2395  2fc7  210000                LD          HL,0x0
  2396  2fca  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  2397  2fcd  af                    XOR         A
  2398  2fce  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2399  2fd1  326c3a                LD          (INPUT_HOLDER),A
  2400  2fd4  cd5d3d                CALL        REDRAW_STATS
  2401  2fd7  3e32                  LD          A,$32
  2402  2fd9  32653a                LD          (RAM_AD),A
  2403  2fdc  cdd315                CALL        SUB_ram_cdd3
  2404  2fdf  cd481d                CALL        SLEEP_ZERO                              ;byte SLEEP_ZERO(void)
  2405  2fe2  c3b72a                JP          SCREEN_SAVER_FULL_SCREEN
  2406                          YOU_DIED_TXT:
  2407  2fe5  7fa0596f75206469      DB         $7F,$A0,"You died ",$FF
              656420ff          
  2408                          
  2409                          DO_USE_PHYS_POTION:
  2410  2ff1  cd9d2e                CALL        PLAY_USE_PHYS_POTION_SOUND
  2411  2ff4  04                    INC         B                                       ;Change from LEVEL to
  2412                                                                                  ;COLOR value (Level + 1)
  2413  2ff5  60                    LD          H,B
  2414  2ff6  68                    LD          L,B
  2415  2ff7  224134                LD          (COLRAM_PHYS_STATS_1000),HL             ;Update PHYS color (1000s & 100s)
  2416                                                                                  ;to potion level on BLK
  2417  2ffa  224334                LD          (COLRAM_PHYS_STATS_10),HL               ;Update PHYS color (10s & 1s)
  2418                                                                                  ;to potion level on BLK
  2419  2ffd  26d0                  LD          H,$d0                                  ;DKGRN on BLK
  2420  2fff  6c                    LD          L,H
  2421  3000  224634                LD          (COLRAM_SPRT_STATS_10),HL               ;Update SPRT color (10s)
  2422                                                                                  ;to DKGRN on BLACK
  2423  3003  224734                LD          (COLRAM_SPRT_STATS_1),HL                ;Update SPRT color (1s)
  2424                                                                                  ;to DKGRN on BLACK
  2425  3006  c3902e                JP          PROCESS_POTION_UPDATES
  2426                          DO_USE_SPRT_POTION:
  2427  3009  cd9d2e                CALL        PLAY_USE_PHYS_POTION_SOUND
  2428  300c  04                    INC         B                                       ;Change from LEVEL to
  2429                                                                                  ;COLOR value (Level + 1)
  2430  300d  60                    LD          H,B
  2431  300e  68                    LD          L,B
  2432  300f  224634                LD          (COLRAM_SPRT_STATS_10),HL               ;Update SPRT color (10s)
  2433                                                                                  ;to potion level on BLK
  2434  3012  224734                LD          (COLRAM_SPRT_STATS_1),HL                ;Update SPRT color (1s)
  2435                                                                                  ;to potion level on BLK
  2436  3015  26d0                  LD          H,$d0                                  ;DKGRN on BLK
  2437  3017  6c                    LD          L,H
  2438  3018  224134                LD          (COLRAM_PHYS_STATS_1000),HL             ;Update PHYS color (1000s & 100s)
  2439                                                                                  ;to DKGRN on BLK
  2440  301b  224334                LD          (COLRAM_PHYS_STATS_10),HL               ;Update PHYS color (10s & 1s)
  2441                                                                                  ;to DKGRN on BLK
  2442  301e  c3902e                JP          PROCESS_POTION_UPDATES
  2443                          DO_USE_KEY:
  2444  3021  3aea37                LD          A,(ITEM_F0)                             ;= $60
  2445  3024  0e00                  LD          C,0x0
  2446  3026  cb3f                  SRL         A
  2447  3028  cb19                  RR          C
  2448  302a  cb3f                  SRL         A
  2449  302c  cb11                  RL          C
  2450  302e  cb11                  RL          C
  2451  3030  fe14                  CP          $14
  2452  3032  c23022                JP          NZ,NO_ACTION_TAKEN
  2453  3035  78                    LD          A,B
  2454  3036  b9                    CP          C
  2455  3037  da3022                JP          C,NO_ACTION_TAKEN
  2456  303a  79                    LD          A,C
  2457  303b  47                    LD          B,A
  2458  303c  a7                    AND         A
  2459  303d  2809                  JR          Z,LAB_ram_f048
  2460  303f  cdca3a                CALL        UPDATE_SCR_SAVER_TIMER
  2461  3042  0c                    INC         C
  2462                          LAB_ram_f043:
  2463  3043  91                    SUB         C
  2464  3044  30fd                  JR          NC,LAB_ram_f043
  2465  3046  81                    ADD         A,C
  2466  3047  47                    LD          B,A
  2467                          LAB_ram_f048:
  2468  3048  ed5f                  LD          A,R                                     ;Semi-random number into A
  2469  304a  e607                  AND         0x7
  2470                          LAB_ram_f04c:
  2471  304c  2823                  JR          Z,LAB_ram_f071
  2472  304e  d607                  SUB         0x7
  2473                          LAB_ram_f050:
  2474  3050  30fa                  JR          NC,LAB_ram_f04c
  2475  3052  c61d                  ADD         A,$1d
  2476                          LAB_ram_f054:
  2477  3054  cb18                  RR          B
  2478  3056  cb19                  RR          C
  2479  3058  cb18                  RR          B
  2480  305a  17                    RLA
  2481  305b  cb11                  RL          C
  2482  305d  17                    RLA
  2483  305e  08                    EX          AF,AF'
  2484  305f  3a793a                LD          A,(PLAYER_MAP_POS)
  2485  3062  cdf337                CALL        ITEM_MAP_CHECK
  2486  3065  08                    EX          AF,AF'
  2487  3066  02                    LD          (BC),A
  2488  3067  3a783a                LD          A,(LAST_ITEM_HELD)
  2489  306a  a7                    AND         A
  2490  306b  c24e32                JP          NZ,INIT_MELEE_ANIM
  2491  306e  c3962a                JP          UPDATE_VIEWPORT
  2492                          LAB_ram_f071:
  2493  3071  79                    LD          A,C
  2494  3072  fe04                  CP          0x4
  2495  3074  ca7c30                JP          Z,LAB_ram_f07c
  2496  3077  47                    LD          B,A
  2497  3078  3e16                  LD          A,$16
  2498  307a  18d8                  JR          LAB_ram_f054
  2499                          LAB_ram_f07c:
  2500  307c  0603                  LD          B,0x3
  2501  307e  3e1c                  LD          A,$1c
  2502  3080  18d2                  JR          LAB_ram_f054
  2503                          USE_SOMETHING_ELSE:
  2504  3082  08                    EX          AF,AF'
  2505  3083  3ae833                LD          A,(WALL_F0_STATE)                       ;= $20
  2506  3086  a7                    AND         A
  2507  3087  2804                  JR          Z,CHECK_FOR_NON_ITEMS
  2508  3089  cb57                  BIT         0x2,A
  2509  308b  280b                  JR          Z,CHECK_FOR_END_ITEM
  2510                          CHECK_FOR_NON_ITEMS:
  2511  308d  3ae937                LD          A,(ITEM_F1)                             ;= $60
  2512  3090  fefe                  CP          $fe                                    ;Compare to EMPTY
  2513  3092  2804                  JR          Z,CHECK_FOR_END_ITEM
  2514  3094  fe78                  CP          $78                                    ;Compare to MONSTERS
  2515  3096  3007                  JR          NC,CHECK_IF_BOW_XBOW
  2516                          CHECK_FOR_END_ITEM:
  2517  3098  08                    EX          AF,AF'
  2518  3099  feff                  CP          $ff                                    ;Compare to EMPTY-END
  2519  309b  c23022                JP          NZ,NO_ACTION_TAKEN
  2520  309e  08                    EX          AF,AF'
  2521                          CHECK_IF_BOW_XBOW:
  2522  309f  08                    EX          AF,AF'
  2523  30a0  fe06                  CP          0x6                                     ;Compare to BOW
  2524  30a2  201b                  JR          NZ,CHECK_IF_SCROLL_STAFF
  2525                          USE_BOW_XBOW:
  2526  30a4  c5                    PUSH        BC                                      ;Save BC
  2527  30a5  3aac3a                LD          A,(ARROW_INV)                           ;Get Arrow Inventory
  2528  30a8  d601                  SUB         0x1                                     ;Decrease by 1
  2529  30aa  da3022                JP          C,NO_ACTION_TAKEN                       ;If Arrow Inv <1, end
  2530  30ad  32ac3a                LD          (ARROW_INV),A
  2531  30b0  cd3f23                CALL        CHK_ITEM_BREAK
  2532  30b3  c1                    POP         BC
  2533  30b4  3005                  JR          NC,BOW_XBOW_NO_BREAK
  2534  30b6  3efe                  LD          A,$fe                                  ;$fe = EMPTY ITEM
  2535  30b8  327a3a                LD          (RIGHT_HAND_ITEM),A                     ;Put EMPTY ITEM into Right Hand
  2536                          BOW_XBOW_NO_BREAK:
  2537  30bb  1605                  LD          D,0x5
  2538  30bd  182a                  JR          LAB_ram_f0e9
  2539                          CHECK_IF_SCROLL_STAFF:
  2540  30bf  fe07                  CP          0x7                                     ;Compare to SCROLL
  2541  30c1  2010                  JR          NZ,CHECK_OTHERS
  2542                          USE_SCROLL_STAFF:
  2543  30c3  c5                    PUSH        BC
  2544  30c4  cd3f23                CALL        CHK_ITEM_BREAK
  2545  30c7  c1                    POP         BC
  2546  30c8  3005                  JR          NC,SCROLL_STAFF_NO_BREAK
  2547  30ca  3efe                  LD          A,$fe
  2548  30cc  327a3a                LD          (RIGHT_HAND_ITEM),A
  2549                          SCROLL_STAFF_NO_BREAK:
  2550  30cf  1609                  LD          D,0x9                                   ;Use FIREBALL ammo
  2551  30d1  1816                  JR          LAB_ram_f0e9
  2552                          CHECK_OTHERS:
  2553  30d3  fe0b                  CP          0xb                                     ;Compare to STAFF
  2554  30d5  28ec                  JR          Z,USE_SCROLL_STAFF
  2555  30d7  fe0c                  CP          0xc                                     ;Compare to XBOW
  2556  30d9  28c9                  JR          Z,USE_BOW_XBOW
  2557  30db  fe06                  CP          0x6                                     ;Compare to BOW
  2558  30dd  da3022                JP          C,NO_ACTION_TAKEN
  2559  30e0  fe10                  CP          $10                                    ;Compare to LADDER
  2560  30e2  d21331                JP          NC,LAB_ram_f113
  2561  30e5  57                    LD          D,A
  2562  30e6  cda92e                CALL        SUB_ram_eea9
  2563                          LAB_ram_f0e9:
  2564  30e9  cdf230                CALL        SUB_ram_f0f2
  2565  30ec  c33031                JP          SUB_ram_f130
  2566                          SUB_ram_f0ef:
  2567  30ef  cda92e                CALL        SUB_ram_eea9
  2568                          SUB_ram_f0f2:
  2569  30f2  3e03                  LD          A,0x3
  2570  30f4  32873a                LD          (BYTE_ram_3a87),A
  2571  30f7  7a                    LD          A,D
  2572  30f8  cb27                  SLA         A
  2573  30fa  cb27                  SLA         A
  2574  30fc  b0                    OR          B
  2575  30fd  32823a                LD          (BYTE_ram_3a82),A
  2576  3100  210302                LD          HL,$203
  2577  3103  22853a                LD          (BYTE_ram_3a85),HL
  2578  3106  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  2579  3109  22833a                LD          (BYTE_ram_3a83),HL
  2580  310c  7d                    LD          A,L
  2581  310d  32653a                LD          (RAM_AD),A
  2582  3110  c3d723                JP          LAB_ram_e3d7
  2583                          LAB_ram_f113:
  2584  3113  fe11                  CP          $11
  2585  3115  2002                  JR          NZ,LAB_ram_f119
  2586  3117  1805                  JR          LAB_ram_f11e
  2587                          LAB_ram_f119:
  2588  3119  fe14                  CP          $14
  2589  311b  c23022                JP          NZ,NO_ACTION_TAKEN
  2590                          LAB_ram_f11e:
  2591  311e  57                    LD          D,A
  2592  311f  3a783a                LD          A,(LAST_ITEM_HELD)
  2593  3122  a7                    AND         A
  2594  3123  ca3022                JP          Z,NO_ACTION_TAKEN
  2595  3126  af                    XOR         A                                       ;A  = $00
  2596                                                                                  ;Reset C & N, Set Z
  2597  3127  32783a                LD          (LAST_ITEM_HELD),A
  2598  312a  cdef30                CALL        SUB_ram_f0ef
  2599  312d  c39f2a                JP          WAIT_FOR_INPUT
  2600                          SUB_ram_f130:
  2601  3130  3a783a                LD          A,(LAST_ITEM_HELD)
  2602  3133  a7                    AND         A
  2603  3134  c24e32                JP          NZ,INIT_MELEE_ANIM
  2604  3137  3c                    INC         A
  2605  3138  32783a                LD          (LAST_ITEM_HELD),A
  2606  313b  3ae937                LD          A,(ITEM_F1)                             ;= $60
  2607  313e  0600                  LD          B,0x0
  2608  3140  cb3f                  SRL         A
  2609  3142  cb18                  RR          B
  2610  3144  1f                    RRA
  2611  3145  cb10                  RL          B
  2612  3147  cb10                  RL          B
  2613  3149  08                    EX          AF,AF'
  2614  314a  af                    XOR         A
  2615  314b  21683a                LD          HL,DUNGEON_LEVEL
  2616  314e  ed6f                  RLD
  2617  3150  57                    LD          D,A
  2618  3151  cb3f                  SRL         A
  2619  3153  3002                  JR          NC,LAB_ram_f157
  2620  3155  c650                  ADD         A,$50
  2621                          LAB_ram_f157:
  2622  3157  07                    RLCA
  2623  3158  07                    RLCA
  2624  3159  07                    RLCA
  2625  315a  07                    RLCA
  2626  315b  5f                    LD          E,A
  2627  315c  7a                    LD          A,D
  2628  315d  ed6f                  RLD
  2629  315f  57                    LD          D,A
  2630  3160  cb3f                  SRL         A
  2631  3162  83                    ADD         A,E
  2632  3163  c603                  ADD         A,0x3
  2633  3165  27                    DAA
  2634  3166  4f                    LD          C,A
  2635  3167  7a                    LD          A,D
  2636  3168  ed6f                  RLD
  2637  316a  08                    EX          AF,AF'
  2638  316b  d61e                  SUB         $1e
  2639  316d  200e                  JR          NZ,LAB_ram_f17d
  2640  316f  1607                  LD          D,0x7
  2641  3171  210403                LD          HL,$304
  2642  3174  3e3c                  LD          A,$3c
  2643  3176  80                    ADD         A,B
  2644  3177  328a3a                LD          (BYTE_ram_3a8a),A
  2645  317a  c32b32                JP          LAB_ram_f22b
  2646                          LAB_ram_f17d:
  2647  317d  3d                    DEC         A
  2648  317e  200e                  JR          NZ,LAB_ram_f18e
  2649  3180  1603                  LD          D,0x3
  2650  3182  210101                LD          HL,$101
  2651  3185  3e3c                  LD          A,$3c
  2652  3187  80                    ADD         A,B
  2653  3188  328a3a                LD          (BYTE_ram_3a8a),A
  2654  318b  c32b32                JP          LAB_ram_f22b
  2655                          LAB_ram_f18e:
  2656  318e  3d                    DEC         A
  2657  318f  200e                  JR          NZ,LAB_ram_f19f
  2658  3191  1604                  LD          D,0x4
  2659  3193  210200                LD          HL,0x2
  2660  3196  3e24                  LD          A,$24
  2661  3198  80                    ADD         A,B
  2662  3199  328a3a                LD          (BYTE_ram_3a8a),A
  2663  319c  c32b32                JP          LAB_ram_f22b
  2664                          LAB_ram_f19f:
  2665  319f  3d                    DEC         A
  2666  31a0  200d                  JR          NZ,LAB_ram_f1af
  2667  31a2  1605                  LD          D,0x5
  2668  31a4  210302                LD          HL,$203
  2669  31a7  3e3c                  LD          A,$3c
  2670  31a9  80                    ADD         A,B
  2671  31aa  328a3a                LD          (BYTE_ram_3a8a),A
  2672  31ad  187c                  JR          LAB_ram_f22b
  2673                          LAB_ram_f1af:
  2674  31af  3d                    DEC         A
  2675  31b0  200d                  JR          NZ,LAB_ram_f1bf
  2676  31b2  1603                  LD          D,0x3
  2677  31b4  210203                LD          HL,$302
  2678  31b7  3e24                  LD          A,$24
  2679  31b9  80                    ADD         A,B
  2680  31ba  328a3a                LD          (BYTE_ram_3a8a),A
  2681  31bd  186c                  JR          LAB_ram_f22b
  2682                          LAB_ram_f1bf:
  2683  31bf  3d                    DEC         A
  2684  31c0  200d                  JR          NZ,LAB_ram_f1cf
  2685  31c2  1608                  LD          D,0x8
  2686  31c4  210504                LD          HL,$405
  2687  31c7  3e24                  LD          A,$24
  2688  31c9  80                    ADD         A,B
  2689  31ca  328a3a                LD          (BYTE_ram_3a8a),A
  2690  31cd  185c                  JR          LAB_ram_f22b
  2691                          LAB_ram_f1cf:
  2692  31cf  3d                    DEC         A
  2693  31d0  c2e031                JP          NZ,LAB_ram_f1e0
  2694  31d3  1606                  LD          D,0x6
  2695  31d5  210402                LD          HL,$204
  2696  31d8  3e3c                  LD          A,$3c
  2697  31da  80                    ADD         A,B
  2698  31db  328a3a                LD          (BYTE_ram_3a8a),A
  2699  31de  184b                  JR          LAB_ram_f22b
  2700                          LAB_ram_f1e0:
  2701  31e0  3d                    DEC         A
  2702  31e1  200d                  JR          NZ,LAB_ram_f1f0
  2703  31e3  1613                  LD          D,$13
  2704  31e5  210505                LD          HL,$505
  2705  31e8  3e24                  LD          A,$24
  2706  31ea  80                    ADD         A,B
  2707  31eb  328a3a                LD          (BYTE_ram_3a8a),A
  2708  31ee  183b                  JR          LAB_ram_f22b
  2709                          LAB_ram_f1f0:
  2710  31f0  3d                    DEC         A
  2711  31f1  200d                  JR          NZ,LAB_ram_f200
  2712  31f3  1604                  LD          D,0x4
  2713  31f5  210504                LD          HL,$405
  2714  31f8  3e3c                  LD          A,$3c
  2715  31fa  80                    ADD         A,B
  2716  31fb  328a3a                LD          (BYTE_ram_3a8a),A
  2717  31fe  182b                  JR          LAB_ram_f22b
  2718                          LAB_ram_f200:
  2719  3200  3d                    DEC         A
  2720  3201  2025                  JR          NZ,LAB_ram_f228
  2721  3203  1611                  LD          D,$11
  2722  3205  210504                LD          HL,$405
  2723  3208  d9                    EXX
  2724  3209  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
  2725  320c  cd3924                CALL        SUB_ram_e439
  2726  320f  eb                    EX          DE,HL
  2727  3210  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  2728  3213  6f                    LD          L,A
  2729  3214  2600                  LD          H,0x0
  2730  3216  cd3024                CALL        RECALC_PHYS_HEALTH
  2731  3219  d9                    EXX
  2732  321a  3008                  JR          NC,LAB_ram_f224
  2733  321c  3e24                  LD          A,$24
  2734                          LAB_ram_f21e:
  2735  321e  80                    ADD         A,B
  2736  321f  328a3a                LD          (BYTE_ram_3a8a),A
  2737  3222  1807                  JR          LAB_ram_f22b
  2738                          LAB_ram_f224:
  2739  3224  3e3c                  LD          A,$3c
  2740  3226  18f6                  JR          LAB_ram_f21e
  2741                          LAB_ram_f228:
  2742  3228  c33022                JP          NO_ACTION_TAKEN
  2743                          LAB_ram_f22b:
  2744  322b  cd7f32                CALL        SUB_ram_f27f
  2745  322e  e5                    PUSH        HL
  2746  322f  21a23a                LD          HL,CURR_MONSTER_SPRT
  2747  3232  cd9832                CALL        SUB_ram_f298
  2748  3235  e1                    POP         HL
  2749  3236  54                    LD          D,H
  2750  3237  cd7f32                CALL        SUB_ram_f27f
  2751  323a  e5                    PUSH        HL
  2752  323b  21a53a                LD          HL,BYTE_ram_3aa5
  2753  323e  cd9832                CALL        SUB_ram_f298
  2754  3241  e1                    POP         HL
  2755  3242  55                    LD          D,L
  2756  3243  1e00                  LD          E,0x0
  2757  3245  cd8532                CALL        CALC_WEAPON_VALUE
  2758  3248  32a83a                LD          (WEAPON_VALUE_HOLDER),A
  2759  324b  cd6932                CALL        REDRAW_MONSTER_HEALTH
  2760                          INIT_MELEE_ANIM:
  2761  324e  3e03                  LD          A,0x3                                   ;A  = $03
  2762  3250  328b3a                LD          (MELEE_ANIM_STATE),A
  2763  3253  210602                LD          HL,$206                                ;HL = $ce
  2764  3256  228d3a                LD          (MONSTER_ATT_POS_COUNT),HL
  2765  3259  21ea31                LD          HL,$31ea                               ;HL = $0020 db?
  2766                                                                                  ;Always $20 (SPACE char)?
  2767  325c  228f3a                LD          (MONSTER_ATT_POS_OFFSET),HL
  2768  325f  7d                    LD          A,L
  2769  3260  32663a                LD          (RAM_AE),A
  2770  3263  cd0a26                CALL        ANIMATE_MELEE_ROUND
  2771  3266  c39f2a                JP          WAIT_FOR_INPUT
  2772                          REDRAW_MONSTER_HEALTH:
  2773  3269  118930                LD          DE,CHRRAM_MONSTER_PHYS                  ;WAS LD DE,$333d
  2774  326c  21a33a                LD          HL,CURR_MONSTER_PHYS
  2775  326f  0602                  LD          B,0x2
  2776  3271  cdfd32                CALL        RECALC_AND_REDRAW_BCD
  2777  3274  116330                LD          DE,CHRRAM_MONSTER_SPRT                  ;WAS LD DE,$338f
  2778  3277  21a23a                LD          HL,CURR_MONSTER_SPRT
  2779  327a  0601                  LD          B,0x1
  2780  327c  c3fd32                JP          RECALC_AND_REDRAW_BCD
  2781                          SUB_ram_f27f:
  2782  327f  cdca3a                CALL        UPDATE_SCR_SAVER_TIMER
  2783  3282  e607                  AND         0x7
  2784  3284  5f                    LD          E,A
  2785                          CALC_WEAPON_VALUE:
  2786  3285  c5                    PUSH        BC                                      ;Save original weaponLevel
  2787  3286  04                    INC         B                                       ;B = B + 1
  2788  3287  7a                    LD          A,D                                     ;A = D
  2789  3288  1802                  JR          LAB_ram_f28c
  2790                          LAB_ram_f28a:
  2791  328a  82                    ADD         A,D                                     ;A = A + D
  2792  328b  27                    DAA                                                 ;Normalize for BCD
  2793                          LAB_ram_f28c:
  2794  328c  10fc                  DJNZ        LAB_ram_f28a                            ;B = B - 1
  2795  328e  93                    SUB         E                                       ;A = A - E
  2796  328f  27                    DAA                                                 ;Normalize for BCD
  2797  3290  3002                  JR          NC,LAB_ram_f294
  2798  3292  8b                    ADC         A,E                                     ;A = A + E (and CARRY)
  2799  3293  27                    DAA                                                 ;Normalize for BCD
  2800                          LAB_ram_f294:
  2801  3294  81                    ADD         A,C                                     ;A = A + C
  2802  3295  27                    DAA                                                 ;Normalize for BCD
  2803  3296  c1                    POP         BC                                      ;BC = Original weaponLevel
  2804  3297  c9                    RET                                                 ;A = new weaponValue
  2805                          SUB_ram_f298:
  2806  3298  77                    LD          (HL),A
  2807  3299  23                    INC         HL
  2808  329a  87                    ADD         A,A
  2809  329b  27                    DAA
  2810  329c  77                    LD          (HL),A
  2811  329d  23                    INC         HL
  2812  329e  3e00                  LD          A,0x0
  2813  32a0  17                    RLA
  2814  32a1  77                    LD          (HL),A
  2815  32a2  c9                    RET
  2816                          DO_USE_LADDER:
  2817  32a3  3a783a                LD          A,(LAST_ITEM_HELD)
  2818  32a6  a7                    AND         A
  2819  32a7  c23022                JP          NZ,NO_ACTION_TAKEN
  2820  32aa  3aea37                LD          A,(ITEM_F0)                             ;= $60
  2821  32ad  fe42                  CP          $42
  2822  32af  c23022                JP          NZ,NO_ACTION_TAKEN
  2823  32b2  3a793a                LD          A,(PLAYER_MAP_POS)
  2824  32b5  32773a                LD          (PLAYER_PREV_MAP_LOC),A
  2825  32b8  cda333                CALL        BUILD_MAP
  2826  32bb  cdbf15                CALL        SUB_ram_cdbf
  2827  32be  cdc432                CALL        SUB_ram_f2c4
  2828  32c1  c35a1e                JP          RESET_SHIFT_MODE
  2829                          SUB_ram_f2c4:
  2830  32c4  110230                LD          DE,$3002                               ;WAS $33df
  2831  32c7  21683a                LD          HL,DUNGEON_LEVEL
  2832  32ca  3e01                  LD          A,0x1
  2833  32cc  86                    ADD         A,(HL)
  2834  32cd  27                    DAA
  2835  32ce  380c                  JR          C,LAB_ram_f2dc
  2836                          LAB_ram_f2d0:
  2837  32d0  77                    LD          (HL),A
  2838  32d1  0601                  LD          B,0x1
  2839  32d3  cdfd32                CALL        RECALC_AND_REDRAW_BCD
  2840  32d6  cde634                CALL        REDRAW_START
  2841  32d9  c30438                JP          REDRAW_VIEWPORT
  2842                          LAB_ram_f2dc:
  2843  32dc  cda019                CALL        DRAW_BKGD
  2844  32df  215130                LD          HL,DAT_ram_3051                         ;= $20
  2845  32e2  111309                LD          DE,LEVEL_99_LOOP                        ;= "Looks like this dungeon",$01
  2846  32e5  06f0                  LD          B,$f0
  2847  32e7  cd3533                CALL        GFX_DRAW
  2848  32ea  061e                  LD          B,$1e
  2849                          LAB_ram_f2ec:
  2850  32ec  d9                    EXX
  2851  32ed  cd481d                CALL        SLEEP_ZERO                              ;byte SLEEP_ZERO(void)
  2852  32f0  d9                    EXX
  2853  32f1  10f9                  DJNZ        LAB_ram_f2ec
  2854  32f3  3e90                  LD          A,$90
  2855  32f5  21683a                LD          HL,DUNGEON_LEVEL
  2856  32f8  11df33                LD          DE,CHHRAM_LVL_IDX                       ;= $20
  2857  32fb  18d3                  JR          LAB_ram_f2d0
  2858                          RECALC_AND_REDRAW_BCD:
  2859  32fd  d5                    PUSH        DE
  2860  32fe  11503a                LD          DE,$3a50
  2861  3301  78                    LD          A,B
  2862  3302  cb27                  SLA         A
  2863  3304  3d                    DEC         A
  2864  3305  08                    EX          AF,AF'
  2865                          LAB_ram_f306:
  2866  3306  7e                    LD          A,(HL)
  2867  3307  e60f                  AND         0xf                                     ;Wipe upper nybble
  2868  3309  c630                  ADD         A,$30                                  ;Numeric char offset
  2869  330b  12                    LD          (DE),A
  2870  330c  7e                    LD          A,(HL)
  2871  330d  e6f0                  AND         $f0                                    ;Wipe lower nybble
  2872  330f  0f                    RRCA                                                ;Move upper
  2873  3310  0f                    RRCA                                                ;nybble to
  2874  3311  0f                    RRCA                                                ;lower
  2875  3312  0f                    RRCA                                                ;nybble
  2876  3313  c630                  ADD         A,$30                                  ;Numeric char offset
  2877  3315  13                    INC         DE
  2878  3316  12                    LD          (DE),A
  2879  3317  13                    INC         DE
  2880  3318  23                    INC         HL
  2881  3319  10eb                  DJNZ        LAB_ram_f306
  2882  331b  1b                    DEC         DE
  2883  331c  e1                    POP         HL
  2884  331d  08                    EX          AF,AF'
  2885  331e  47                    LD          B,A
  2886                          LAB_ram_f31f:
  2887  331f  1a                    LD          A,(DE)
  2888  3320  fe30                  CP          $30                                    ;Numeric char offset
  2889  3322  2009                  JR          NZ,LAB_ram_f32d
  2890  3324  3620                  LD          (HL),$20                               ;SPACE char for ZERO
  2891  3326  23                    INC         HL                                      ;Move forward one cell
  2892  3327  1b                    DEC         DE                                      ;Move backwards one byte
  2893                                                                                  ;(big endian)
  2894  3328  10f5                  DJNZ        LAB_ram_f31f
  2895  332a  1a                    LD          A,(DE)
  2896  332b  1806                  JR          LAB_ram_f333
  2897                          LAB_ram_f32d:
  2898  332d  77                    LD          (HL),A
  2899  332e  23                    INC         HL                                      ;Move forward one cell
  2900  332f  1b                    DEC         DE                                      ;Move backwards one byte
  2901                                                                                  ;(big endian)
  2902  3330  1a                    LD          A,(DE)
  2903  3331  10fa                  DJNZ        LAB_ram_f32d
  2904                          LAB_ram_f333:
  2905  3333  77                    LD          (HL),A
  2906  3334  c9                    RET
  2907                          GFX_DRAW:
  2908  3335  e5                    PUSH        HL
  2909  3336  0e28                  LD          C,$28                                  ;$28 = +40, down one row
  2910                          LAB_ram_f338:
  2911  3338  1a                    LD          A,(DE)                       ;= "\b",$FF
  2912                                                                                  ;= $FF
  2913  3339  13                    INC         DE
  2914  333a  3c                    INC         A
  2915  333b  2002                  JR          NZ,LAB_ram_f33f                         ;Check for $ff end of graphic char
  2916  333d  e1                    POP         HL
  2917  333e  c9                    RET
  2918                          LAB_ram_f33f:
  2919  333f  3d                    DEC         A                                       ;$00 = no char, move right one column...
  2920  3340  2003                  JR          NZ,LAB_ram_f345
  2921  3342  23                    INC         HL
  2922  3343  18f3                  JR          LAB_ram_f338
  2923                          LAB_ram_f345:
  2924  3345  fe01                  CP          0x1                                     ;$01 = down one row, back to index
  2925  3347  2009                  JR          NZ,LAB_ram_f352
  2926  3349  78                    LD          A,B
  2927  334a  0600                  LD          B,0x0
  2928  334c  e1                    POP         HL
  2929  334d  09                    ADD         HL,BC
  2930  334e  e5                    PUSH        HL
  2931  334f  47                    LD          B,A
  2932  3350  18e6                  JR          LAB_ram_f338
  2933                          LAB_ram_f352:
  2934  3352  fe02                  CP          0x2                                     ;$02 = back up one column
  2935  3354  2003                  JR          NZ,LAB_ram_f359
  2936  3356  2b                    DEC         HL
  2937  3357  18df                  JR          LAB_ram_f338
  2938                          LAB_ram_f359:
  2939  3359  fe03                  CP          0x3                                     ;$03 = down one row, same column
  2940  335b  200a                  JR          NZ,LAB_ram_f367
  2941  335d  78                    LD          A,B
  2942  335e  0600                  LD          B,0x0
  2943  3360  09                    ADD         HL,BC
  2944  3361  e3                    EX          (SP),HL
  2945  3362  09                    ADD         HL,BC
  2946  3363  e3                    EX          (SP),HL
  2947  3364  47                    LD          B,A
  2948  3365  18d1                  JR          LAB_ram_f338
  2949                          LAB_ram_f367:
  2950  3367  fe04                  CP          0x4                                     ;$04 = up one row, same column
  2951  3369  200c                  JR          NZ,LAB_ram_f377
  2952  336b  78                    LD          A,B
  2953  336c  0600                  LD          B,0x0
  2954  336e  ed42                  SBC         HL,BC
  2955  3370  e3                    EX          (SP),HL
  2956  3371  ed42                  SBC         HL,BC
  2957  3373  e3                    EX          (SP),HL
  2958  3374  47                    LD          B,A
  2959  3375  18c1                  JR          LAB_ram_f338
  2960                          LAB_ram_f377:
  2961  3377  fea0                  CP          $a0                                    ;$a0 = reverse FG & BG colors
  2962  3379  200a                  JR          NZ,LAB_ram_f385
  2963  337b  cb08                  RRC         B                                       ;Swap hi and lo nybbles (FG & BG colo...
  2964  337d  cb08                  RRC         B
  2965  337f  cb08                  RRC         B
  2966  3381  cb08                  RRC         B
  2967  3383  18b3                  JR          LAB_ram_f338
  2968                          LAB_ram_f385:
  2969  3385  77                    LD          (HL),A              ;= $20
  2970  3386  24                    INC         H
  2971  3387  24                    INC         H
  2972  3388  24                    INC         H
  2973  3389  24                    INC         H
  2974  338a  3e0f                  LD          A,0xf
  2975  338c  b8                    CP          B
  2976  338d  7e                    LD          A,(HL)                    ;= $60
  2977  338e  3808                  JR          C,LAB_ram_f398
  2978  3390  07                    RLCA
  2979  3391  07                    RLCA
  2980  3392  07                    RLCA
  2981  3393  07                    RLCA
  2982  3394  e6f0                  AND         $f0
  2983  3396  1802                  JR          LAB_ram_f39a
  2984                          LAB_ram_f398:
  2985  3398  e60f                  AND         0xf
  2986                          LAB_ram_f39a:
  2987  339a  b0                    OR          B
  2988  339b  77                    LD          (HL),A                    ;= $60
  2989  339c  25                    DEC         H
  2990  339d  25                    DEC         H
  2991  339e  25                    DEC         H
  2992  339f  25                    DEC         H
  2993  33a0  23                    INC         HL
  2994  33a1  1895                  JR          LAB_ram_f338
  2995                          BUILD_MAP:
  2996  33a3  210038                LD          HL,MAPSPACE_WALLS
  2997  33a6  0600                  LD          B,0x0
  2998                          GENERATE_MAPWALLS_LOOP:
  2999  33a8  cdac3a                CALL        MAKE_RANDOM_BYTE
  3000  33ab  5f                    LD          E,A
  3001  33ac  cdac3a                CALL        MAKE_RANDOM_BYTE
  3002  33af  a3                    AND         E
  3003  33b0  e663                  AND         $63
  3004  33b2  77                    LD          (HL),A
  3005  33b3  2c                    INC         L
  3006  33b4  10f2                  DJNZ        GENERATE_MAPWALLS_LOOP
  3007  33b6  3a793a                LD          A,(PLAYER_MAP_POS)
  3008  33b9  6f                    LD          L,A
  3009  33ba  3642                  LD          (HL),$42
  3010                          GEN_MAP_NW_WALL_LOOP:
  3011  33bc  cdca3a                CALL        UPDATE_SCR_SAVER_TIMER
  3012  33bf  3c                    INC         A
  3013  33c0  28fa                  JR          Z,GEN_MAP_NW_WALL_LOOP
  3014  33c2  3d                    DEC         A
  3015  33c3  32a13a                LD          (ITEM_HOLDER),A
  3016  33c6  6f                    LD          L,A
  3017  33c7  3663                  LD          (HL),$63
  3018  33c9  210039                LD          HL,MAP_LADDER_OFFSET
  3019  33cc  77                    LD          (HL),A
  3020  33cd  2c                    INC         L
  3021  33ce  3642                  LD          (HL),$42                   ;Put ladder object into map
  3022                                                                                  ;(always 1st item after offset)
  3023  33d0  2c                    INC         L
  3024  33d1  3a6c3a                LD          A,(INPUT_HOLDER)
  3025  33d4  47                    LD          B,A
  3026  33d5  3e02                  LD          A,0x2
  3027  33d7  1802                  JR          LAB_ram_f3db
  3028                          LAB_ram_f3d9:
  3029  33d9  87                    ADD         A,A
  3030  33da  27                    DAA
  3031                          LAB_ram_f3db:
  3032  33db  10fc                  DJNZ        LAB_ram_f3d9
  3033  33dd  4f                    LD          C,A
  3034  33de  3a683a                LD          A,(DUNGEON_LEVEL)
  3035  33e1  b9                    CP          C
  3036  33e2  3819                  JR          C,LAB_ram_f3fd
  3037                          GEN_ITEM_MAP:
  3038  33e4  cdca3a                CALL        UPDATE_SCR_SAVER_TIMER
  3039  33e7  3c                    INC         A
  3040  33e8  28fa                  JR          Z,GEN_ITEM_MAP
  3041  33ea  3d                    DEC         A
  3042  33eb  4f                    LD          C,A
  3043  33ec  3aa13a                LD          A,(ITEM_HOLDER)
  3044  33ef  b9                    CP          C
  3045  33f0  28f2                  JR          Z,GEN_ITEM_MAP
  3046  33f2  3a793a                LD          A,(PLAYER_MAP_POS)
  3047  33f5  b9                    CP          C
  3048  33f6  28ec                  JR          Z,GEN_ITEM_MAP
  3049  33f8  71                    LD          (HL),C
  3050  33f9  23                    INC         HL
  3051  33fa  369f                  LD          (HL),$9f                ;Full ITEM_monster range $009f
  3052  33fc  23                    INC         HL
  3053                          LAB_ram_f3fd:
  3054  33fd  0650                  LD          B,$50                                  ;Max 50 items+monstersdb?
  3055                          GEN_RND_ITEM:
  3056  33ff  cdac3a                CALL        MAKE_RANDOM_BYTE
  3057  3402  3c                    INC         A
  3058  3403  28fa                  JR          Z,GEN_RND_ITEM
  3059  3405  3d                    DEC         A
  3060  3406  08                    EX          AF,AF'
  3061  3407  3a683a                LD          A,(DUNGEON_LEVEL)
  3062  340a  a7                    AND         A
  3063  340b  200a                  JR          NZ,LAB_ram_f417
  3064  340d  08                    EX          AF,AF'
  3065  340e  fe01                  CP          0x1
  3066  3410  28ed                  JR          Z,GEN_RND_ITEM
  3067  3412  fe10                  CP          $10
  3068  3414  28e9                  JR          Z,GEN_RND_ITEM
  3069  3416  08                    EX          AF,AF'
  3070                          LAB_ram_f417:
  3071  3417  08                    EX          AF,AF'
  3072  3418  5f                    LD          E,A
  3073  3419  3a793a                LD          A,(PLAYER_MAP_POS)
  3074  341c  bb                    CP          E
  3075  341d  28e0                  JR          Z,GEN_RND_ITEM
  3076  341f  3aa13a                LD          A,(ITEM_HOLDER)
  3077  3422  bb                    CP          E
  3078  3423  28da                  JR          Z,GEN_RND_ITEM
  3079  3425  73                    LD          (HL),E
  3080  3426  2c                    INC         L
  3081  3427  cdca3a                CALL        UPDATE_SCR_SAVER_TIMER
  3082  342a  e6c0                  AND         $c0
  3083  342c  07                    RLCA
  3084  342d  07                    RLCA
  3085  342e  3d                    DEC         A
  3086  342f  2006                  JR          NZ,LAB_ram_f437
  3087  3431  0e05                  LD          C,0x5
  3088  3433  1600                  LD          D,0x0
  3089  3435  182e                  JR          LAB_ram_f465
  3090                          LAB_ram_f437:
  3091  3437  3d                    DEC         A
  3092  3438  200f                  JR          NZ,LAB_ram_f449
  3093  343a  0e05                  LD          C,0x5
  3094  343c  1606                  LD          D,0x6
  3095  343e  3a683a                LD          A,(DUNGEON_LEVEL)
  3096  3441  fe06                  CP          0x6
  3097  3443  3820                  JR          C,LAB_ram_f465
  3098  3445  0e07                  LD          C,0x7
  3099  3447  181c                  JR          LAB_ram_f465
  3100                          LAB_ram_f449:
  3101  3449  3d                    DEC         A
  3102  344a  2006                  JR          NZ,LAB_ram_f452
  3103  344c  0e04                  LD          C,0x4
  3104  344e  1611                  LD          D,$11
  3105  3450  1813                  JR          LAB_ram_f465
  3106                          LAB_ram_f452:
  3107  3452  161e                  LD          D,$1e
  3108  3454  0e05                  LD          C,0x5
  3109  3456  3a683a                LD          A,(DUNGEON_LEVEL)
  3110  3459  fe06                  CP          0x6
  3111  345b  3808                  JR          C,LAB_ram_f465
  3112  345d  0e07                  LD          C,0x7
  3113  345f  fe16                  CP          $16
  3114  3461  3802                  JR          C,LAB_ram_f465
  3115  3463  0e09                  LD          C,0x9
  3116                          LAB_ram_f465:
  3117  3465  cdac3a                CALL        MAKE_RANDOM_BYTE
  3118  3468  e60f                  AND         0xf
  3119                          LAB_ram_f46a:
  3120  346a  91                    SUB         C
  3121  346b  30fd                  JR          NC,LAB_ram_f46a
  3122  346d  81                    ADD         A,C
  3123  346e  82                    ADD         A,D
  3124  346f  4f                    LD          C,A
  3125  3470  3a683a                LD          A,(DUNGEON_LEVEL)
  3126  3473  3c                    INC         A
  3127  3474  3c                    INC         A
  3128  3475  cb3f                  SRL         A
  3129  3477  57                    LD          D,A
  3130  3478  cdca3a                CALL        UPDATE_SCR_SAVER_TIMER
  3131  347b  5f                    LD          E,A
  3132  347c  cdac3a                CALL        MAKE_RANDOM_BYTE
  3133  347f  a3                    AND         E
  3134  3480  e603                  AND         0x3
  3135                          LAB_ram_f482:
  3136  3482  92                    SUB         D
  3137  3483  30fd                  JR          NC,LAB_ram_f482
  3138  3485  82                    ADD         A,D
  3139  3486  1f                    RRA
  3140  3487  1f                    RRA
  3141  3488  cb11                  RL          C
  3142  348a  17                    RLA
  3143  348b  cb11                  RL          C
  3144  348d  71                    LD          (HL),C
  3145  348e  2c                    INC         L
  3146  348f  05                    DEC         B
  3147  3490  c2ff33                JP          NZ,GEN_RND_ITEM
  3148  3493  36ff                  LD          (HL),$ff
  3149  3495  11003b                LD          DE,TEMP_MAP
  3150  3498  210039                LD          HL,MAP_LADDER_OFFSET
  3151  349b  0600                  LD          B,0x0
  3152                          LAB_ram_f49d:
  3153  349d  7e                    LD          A,(HL)
  3154  349e  feff                  CP          $ff
  3155  34a0  281f                  JR          Z,SETUP_MAP_COPY
  3156  34a2  04                    INC         B
  3157  34a3  cdd434                CALL        SUB_ram_f4d4
  3158  34a6  d9                    EXX
  3159  34a7  280e                  JR          Z,LAB_ram_f4b7
  3160  34a9  12                    LD          (DE),A
  3161  34aa  13                    INC         DE
  3162  34ab  23                    INC         HL
  3163  34ac  7e                    LD          A,(HL)
  3164  34ad  fefe                  CP          $fe
  3165  34af  280b                  JR          Z,LAB_ram_f4bc
  3166  34b1  04                    INC         B
  3167  34b2  12                    LD          (DE),A
  3168  34b3  13                    INC         DE
  3169  34b4  23                    INC         HL
  3170  34b5  18e6                  JR          LAB_ram_f49d
  3171                          LAB_ram_f4b7:
  3172  34b7  23                    INC         HL
  3173  34b8  23                    INC         HL
  3174  34b9  05                    DEC         B
  3175  34ba  18e1                  JR          LAB_ram_f49d
  3176                          LAB_ram_f4bc:
  3177  34bc  23                    INC         HL
  3178  34bd  1b                    DEC         DE
  3179  34be  05                    DEC         B
  3180  34bf  18dc                  JR          LAB_ram_f49d
  3181                          SETUP_MAP_COPY:
  3182  34c1  11003b                LD          DE,TEMP_MAP                             ;DE = Temp Map
  3183  34c4  210039                LD          HL,MAP_LADDER_OFFSET                    ;HL = Real Map
  3184  34c7  04                    INC         B
  3185  34c8  05                    DEC         B
  3186  34c9  2806                  JR          Z,MAP_DONE
  3187                          COPY_TEMP_MAP_TO_REAL_MAP:
  3188  34cb  1a                    LD          A,(DE)
  3189  34cc  77                    LD          (HL),A
  3190  34cd  23                    INC         HL
  3191  34ce  13                    INC         DE
  3192  34cf  10fa                  DJNZ        COPY_TEMP_MAP_TO_REAL_MAP               ;Loop while B is not zero
  3193                          MAP_DONE:
  3194  34d1  36ff                  LD          (HL),$ff
  3195  34d3  c9                    RET
  3196                          SUB_ram_f4d4:
  3197  34d4  c5                    PUSH        BC
  3198  34d5  d9                    EXX
  3199  34d6  c1                    POP         BC
  3200  34d7  05                    DEC         B
  3201  34d8  280a                  JR          Z,LAB_ram_f4e4
  3202  34da  21003b                LD          HL,TEMP_MAP
  3203                          LAB_ram_f4dd:
  3204  34dd  be                    CP          (HL)
  3205  34de  c8                    RET         Z
  3206  34df  05                    DEC         B
  3207  34e0  23                    INC         HL
  3208  34e1  23                    INC         HL
  3209  34e2  10f9                  DJNZ        LAB_ram_f4dd
  3210                          LAB_ram_f4e4:
  3211  34e4  05                    DEC         B
  3212  34e5  c9                    RET
  3213                          REDRAW_START:
  3214  34e6  21a137                LD          HL,CALC_WEST_REDRAW_2                            ; CALC_WEST_REDRAW (0xF79B) + 7... UNDO? was 0xF7A1
  3215  34e9  e5                    PUSH        HL
  3216  34ea  21793a                LD          HL,PLAYER_MAP_POS
  3217  34ed  5e                    LD          E,(HL)
  3218  34ee  1638                  LD          D,$38                                  ;DE = Player map position in RAM
  3219  34f0  21e833                LD          HL,WALL_F0_STATE                        ;= $20
  3220  34f3  0e05                  LD          C,0x5
  3221  34f5  3a623a                LD          A,(DIR_FACING_SHORT)
  3222  34f8  3d                    DEC         A
  3223  34f9  cab435                JP          Z,FACING_NORTH
  3224  34fc  3d                    DEC         A
  3225  34fd  caff36                JP          Z,FACING_EAST
  3226  3500  3d                    DEC         A
  3227  3501  ca4936                JP          Z,FACING_SOUTH
  3228  3504  1a                    LD          A,(DE)
  3229  3505  e607                  AND         0x7                                     ;Keep low 3 bits, reset top 5 bits
  3230  3507  77                    LD          (HL),A                   ;= $20
  3231  3508  1d                    DEC         E
  3232  3509  cd9b37                CALL        CALC_WEST_REDRAW
  3233  350c  1d                    DEC         E
  3234  350d  cd9b37                CALL        CALC_WEST_REDRAW
  3235  3510  7b                    LD          A,E
  3236  3511  c610                  ADD         A,$10
  3237  3513  5f                    LD          E,A
  3238  3514  cda035                CALL        REDRAW_VIEW
  3239  3517  2c                    INC         L
  3240  3518  77                    LD          (HL),A                   ;= $20
  3241  3519  1a                    LD          A,(DE)
  3242  351a  e607                  AND         0x7
  3243  351c  cda735                CALL        REDRAW_NORTH
  3244  351f  7b                    LD          A,E
  3245  3520  d610                  SUB         $10
  3246  3522  5f                    LD          E,A
  3247  3523  cda035                CALL        REDRAW_VIEW
  3248  3526  77                    LD          (HL),A                   ;= $20
  3249  3527  7b                    LD          A,E
  3250  3528  d610                  SUB         $10
  3251  352a  5f                    LD          E,A
  3252  352b  1a                    LD          A,(DE)
  3253  352c  e607                  AND         0x7
  3254  352e  cda735                CALL        REDRAW_NORTH
  3255  3531  7b                    LD          A,E
  3256  3532  c621                  ADD         A,$21
  3257  3534  5f                    LD          E,A
  3258  3535  cda035                CALL        REDRAW_VIEW
  3259  3538  77                    LD          (HL),A                   ;= $20
  3260  3539  1a                    LD          A,(DE)
  3261  353a  e607                  AND         0x7
  3262  353c  cda735                CALL        REDRAW_NORTH
  3263  353f  7b                    LD          A,E
  3264  3540  d610                  SUB         $10
  3265  3542  5f                    LD          E,A
  3266  3543  cda035                CALL        REDRAW_VIEW
  3267  3546  2c                    INC         L
  3268  3547  77                    LD          (HL),A                   ;= $20
  3269  3548  7b                    LD          A,E
  3270  3549  d610                  SUB         $10
  3271  354b  5f                    LD          E,A
  3272  354c  1a                    LD          A,(DE)
  3273  354d  e607                  AND         0x7
  3274  354f  cda735                CALL        REDRAW_NORTH
  3275  3552  7b                    LD          A,E
  3276  3553  c621                  ADD         A,$21
  3277  3555  5f                    LD          E,A
  3278  3556  cda035                CALL        REDRAW_VIEW
  3279  3559  2c                    INC         L
  3280  355a  77                    LD          (HL),A                   ;= $20
  3281  355b  cd9b37                CALL        CALC_WEST_REDRAW
  3282  355e  7b                    LD          A,E
  3283  355f  c60e                  ADD         A,0xe
  3284  3561  5f                    LD          E,A
  3285  3562  cda035                CALL        REDRAW_VIEW
  3286  3565  2c                    INC         L
  3287  3566  2c                    INC         L
  3288  3567  77                    LD          (HL),A                    ;= $20
  3289  3568  7b                    LD          A,E
  3290  3569  d61e                  SUB         $1e
  3291  356b  5f                    LD          E,A
  3292  356c  cda035                CALL        REDRAW_VIEW
  3293  356f  2c                    INC         L
  3294  3570  77                    LD          (HL),A                    ;= $20
  3295  3571  7b                    LD          A,E
  3296  3572  d610                  SUB         $10
  3297  3574  5f                    LD          E,A
  3298  3575  cd9b37                CALL        CALC_WEST_REDRAW
  3299  3578  1d                    DEC         E
  3300  3579  1d                    DEC         E
  3301  357a  cda035                CALL        REDRAW_VIEW
  3302  357d  2c                    INC         L
  3303  357e  2c                    INC         L
  3304  357f  77                    LD          (HL),A                    ;= $20
  3305  3580  7b                    LD          A,E
  3306  3581  c613                  ADD         A,$13
  3307  3583  5f                    LD          E,A
  3308  3584  cd9b37                CALL        CALC_WEST_REDRAW
  3309  3587  16ff                  LD          D,$ff
  3310  3589  1ef0                  LD          E,$f0
  3311  358b  ed53603a              LD          (DIR_FACING_FW),DE                      ;DE = 0xFFF0 (WEST)
  3312  358f  0610                  LD          B,$10                                  ;RED on BLK
  3313  3591  21d831                LD          HL,CHRRAM_POINTER_IDX                   ;WAS $31d6
  3314  3594  119a35                LD          DE,WEST_TXT                             ;= "\a",$FF
  3315  3597  c33533                JP          GFX_DRAW
  3316                          WEST_TXT:
  3317  359a  07ff                  db          "\a",$FF
  3318  359c  00                    db          $00
  3319  359d  00                    db          $00
  3320  359e  00                    db          $00
  3321  359f  00                    db          $00
  3322                          REDRAW_VIEW:
  3323  35a0  1a                    LD          A,(DE)
  3324  35a1  e6e0                  AND         $e0
  3325  35a3  07                    RLCA
  3326  35a4  07                    RLCA
  3327  35a5  07                    RLCA
  3328  35a6  c9                    RET
  3329                          REDRAW_NORTH:
  3330  35a7  2c                    INC         L
  3331  35a8  77                    LD          (HL),A
  3332  35a9  47                    LD          B,A
  3333  35aa  7d                    LD          A,L
  3334  35ab  81                    ADD         A,C
  3335  35ac  6f                    LD          L,A
  3336  35ad  70                    LD          (HL),B
  3337  35ae  7d                    LD          A,L
  3338  35af  91                    SUB         C
  3339  35b0  6f                    LD          L,A
  3340  35b1  2c                    INC         L
  3341  35b2  0c                    INC         C
  3342  35b3  c9                    RET
  3343                          FACING_NORTH:
  3344  35b4  cda035                CALL        REDRAW_VIEW
  3345  35b7  77                    LD          (HL),A
  3346  35b8  7b                    LD          A,E
  3347  35b9  d610                  SUB         $10
  3348  35bb  5f                    LD          E,A
  3349  35bc  cda035                CALL        REDRAW_VIEW
  3350  35bf  2c                    INC         L
  3351  35c0  77                    LD          (HL),A
  3352  35c1  7b                    LD          A,E
  3353  35c2  d610                  SUB         $10
  3354  35c4  5f                    LD          E,A
  3355  35c5  cda035                CALL        REDRAW_VIEW
  3356  35c8  2c                    INC         L
  3357  35c9  77                    LD          (HL),A
  3358  35ca  cd9b37                CALL        CALC_WEST_REDRAW
  3359  35cd  1d                    DEC         E
  3360  35ce  cda035                CALL        REDRAW_VIEW
  3361  35d1  cda735                CALL        REDRAW_NORTH
  3362  35d4  1c                    INC         E
  3363  35d5  1c                    INC         E
  3364  35d6  1a                    LD          A,(DE)
  3365  35d7  e607                  AND         0x7
  3366  35d9  77                    LD          (HL),A
  3367  35da  cda035                CALL        REDRAW_VIEW
  3368  35dd  cda735                CALL        REDRAW_NORTH
  3369  35e0  7b                    LD          A,E
  3370  35e1  c60f                  ADD         A,0xf
  3371  35e3  5f                    LD          E,A
  3372  35e4  1a                    LD          A,(DE)
  3373  35e5  e607                  AND         0x7
  3374  35e7  77                    LD          (HL),A
  3375  35e8  1d                    DEC         E
  3376  35e9  cda035                CALL        REDRAW_VIEW
  3377  35ec  cda735                CALL        REDRAW_NORTH
  3378  35ef  1c                    INC         E
  3379  35f0  1c                    INC         E
  3380  35f1  cd9b37                CALL        CALC_WEST_REDRAW
  3381  35f4  cda035                CALL        REDRAW_VIEW
  3382  35f7  cda735                CALL        REDRAW_NORTH
  3383  35fa  7b                    LD          A,E
  3384  35fb  c60f                  ADD         A,0xf
  3385  35fd  5f                    LD          E,A
  3386  35fe  cd9b37                CALL        CALC_WEST_REDRAW
  3387  3601  1d                    DEC         E
  3388  3602  cda035                CALL        REDRAW_VIEW
  3389  3605  2c                    INC         L
  3390  3606  77                    LD          (HL),A
  3391  3607  7b                    LD          A,E
  3392  3608  d620                  SUB         $20
  3393  360a  5f                    LD          E,A
  3394  360b  1a                    LD          A,(DE)
  3395  360c  e607                  AND         0x7
  3396  360e  2c                    INC         L
  3397  360f  2c                    INC         L
  3398  3610  77                    LD          (HL),A
  3399  3611  7b                    LD          A,E
  3400  3612  c622                  ADD         A,$22
  3401  3614  5f                    LD          E,A
  3402  3615  cd9b37                CALL        CALC_WEST_REDRAW
  3403  3618  cda035                CALL        REDRAW_VIEW
  3404  361b  2c                    INC         L
  3405  361c  77                    LD          (HL),A
  3406  361d  7b                    LD          A,E
  3407  361e  d61f                  SUB         $1f
  3408  3620  5f                    LD          E,A
  3409  3621  1a                    LD          A,(DE)
  3410  3622  e607                  AND         0x7
  3411  3624  2c                    INC         L
  3412  3625  2c                    INC         L
  3413  3626  77                    LD          (HL),A
  3414  3627  7b                    LD          A,E
  3415  3628  c62e                  ADD         A,$2e
  3416  362a  5f                    LD          E,A
  3417  362b  cda035                CALL        REDRAW_VIEW
  3418  362e  2c                    INC         L
  3419  362f  77                    LD          (HL),A
  3420  3630  16f0                  LD          D,$f0
  3421  3632  1e01                  LD          E,0x1
  3422  3634  ed53603a              LD          (DIR_FACING_FW),DE
  3423  3638  0610                  LD          B,$10                                  ;RED on BLK
  3424  363a  21d831                LD          HL,CHRRAM_POINTER_IDX                   ;WAS $31d6
  3425  363d  114336                LD          DE,NORTH_TXT                            ;= "\b",$FF
  3426  3640  c33533                JP          GFX_DRAW
  3427                          NORTH_TXT:
  3428  3643  08ff                  db          "\b",$FF
  3429  3645  00                    db          $00
  3430  3646  00                    db          $00
  3431  3647  00                    db          $00
  3432  3648  00                    db          $00
  3433                          FACING_SOUTH:
  3434  3649  7b                    LD          A,E
  3435  364a  c610                  ADD         A,$10
  3436  364c  5f                    LD          E,A
  3437  364d  cda035                CALL        REDRAW_VIEW
  3438  3650  77                    LD          (HL),A                   ;= $20
  3439  3651  7b                    LD          A,E
  3440  3652  c610                  ADD         A,$10
  3441  3654  5f                    LD          E,A
  3442  3655  cda035                CALL        REDRAW_VIEW
  3443  3658  2c                    INC         L
  3444  3659  77                    LD          (HL),A                   ;= $20
  3445  365a  7b                    LD          A,E
  3446  365b  c610                  ADD         A,$10
  3447  365d  5f                    LD          E,A
  3448  365e  cda035                CALL        REDRAW_VIEW
  3449  3661  2c                    INC         L
  3450  3662  77                    LD          (HL),A                   ;= $20
  3451  3663  7b                    LD          A,E
  3452  3664  d60f                  SUB         0xf
  3453  3666  5f                    LD          E,A
  3454  3667  cd9b37                CALL        CALC_WEST_REDRAW
  3455  366a  7b                    LD          A,E
  3456  366b  c610                  ADD         A,$10
  3457  366d  5f                    LD          E,A
  3458  366e  cda035                CALL        REDRAW_VIEW
  3459  3671  cda735                CALL        REDRAW_NORTH
  3460  3674  7b                    LD          A,E
  3461  3675  d611                  SUB         $11
  3462  3677  5f                    LD          E,A
  3463  3678  1a                    LD          A,(DE)
  3464  3679  e607                  AND         0x7
  3465  367b  77                    LD          (HL),A                   ;= $20
  3466  367c  7b                    LD          A,E
  3467  367d  c60f                  ADD         A,0xf
  3468  367f  5f                    LD          E,A
  3469  3680  cda035                CALL        REDRAW_VIEW
  3470  3683  cda735                CALL        REDRAW_NORTH
  3471  3686  7b                    LD          A,E
  3472  3687  d61e                  SUB         $1e
  3473  3689  5f                    LD          E,A
  3474  368a  1a                    LD          A,(DE)
  3475  368b  e607                  AND         0x7
  3476  368d  77                    LD          (HL),A                   ;= $20
  3477  368e  7b                    LD          A,E
  3478  368f  c610                  ADD         A,$10
  3479  3691  5f                    LD          E,A
  3480  3692  cda035                CALL        REDRAW_VIEW
  3481  3695  cda735                CALL        REDRAW_NORTH
  3482  3698  7b                    LD          A,E
  3483  3699  d611                  SUB         $11
  3484  369b  5f                    LD          E,A
  3485  369c  cd9b37                CALL        CALC_WEST_REDRAW
  3486  369f  7b                    LD          A,E
  3487  36a0  c60f                  ADD         A,0xf
  3488  36a2  5f                    LD          E,A
  3489  36a3  cda035                CALL        REDRAW_VIEW
  3490  36a6  cda735                CALL        REDRAW_NORTH
  3491  36a9  7b                    LD          A,E
  3492  36aa  d61e                  SUB         $1e
  3493  36ac  5f                    LD          E,A
  3494  36ad  cd9b37                CALL        CALC_WEST_REDRAW
  3495  36b0  7b                    LD          A,E
  3496  36b1  c610                  ADD         A,$10
  3497  36b3  5f                    LD          E,A
  3498  36b4  cda035                CALL        REDRAW_VIEW
  3499  36b7  2c                    INC         L
  3500  36b8  77                    LD          (HL),A                   ;= $20
  3501  36b9  7b                    LD          A,E
  3502  36ba  c611                  ADD         A,$11
  3503  36bc  5f                    LD          E,A
  3504  36bd  1a                    LD          A,(DE)
  3505  36be  e607                  AND         0x7
  3506  36c0  2c                    INC         L
  3507  36c1  2c                    INC         L
  3508  36c2  77                    LD          (HL),A                    ;= $20
  3509  36c3  7b                    LD          A,E
  3510  36c4  d622                  SUB         $22
  3511  36c6  5f                    LD          E,A
  3512  36c7  cd9b37                CALL        CALC_WEST_REDRAW
  3513  36ca  7b                    LD          A,E
  3514  36cb  c60f                  ADD         A,0xf
  3515  36cd  5f                    LD          E,A
  3516  36ce  cda035                CALL        REDRAW_VIEW
  3517  36d1  2c                    INC         L
  3518  36d2  77                    LD          (HL),A                    ;= $20
  3519  36d3  7b                    LD          A,E
  3520  36d4  c610                  ADD         A,$10
  3521  36d6  5f                    LD          E,A
  3522  36d7  1a                    LD          A,(DE)
  3523  36d8  e607                  AND         0x7
  3524  36da  2c                    INC         L
  3525  36db  2c                    INC         L
  3526  36dc  77                    LD          (HL),A                    ;= $20
  3527  36dd  7b                    LD          A,E
  3528  36de  d61f                  SUB         $1f
  3529  36e0  5f                    LD          E,A
  3530  36e1  cda035                CALL        REDRAW_VIEW
  3531  36e4  2c                    INC         L
  3532  36e5  77                    LD          (HL),A                    ;= $20
  3533  36e6  1610                  LD          D,$10
  3534  36e8  1eff                  LD          E,$ff
  3535  36ea  ed53603a              LD          (DIR_FACING_FW),DE
  3536  36ee  0610                  LD          B,$10                                  ;RED on BLK
  3537  36f0  21d831                LD          HL,CHRRAM_POINTER_IDX                   ;WAS $31d6
  3538  36f3  11f936                LD          DE,SOUTH_TXT                            ;= "\t",$FF
  3539  36f6  c33533                JP          GFX_DRAW
  3540                          SOUTH_TXT:
  3541  36f9  09ff                  db          "\t",$FF
  3542  36fb  00                    db          $00
  3543  36fc  00                    db          $00
  3544  36fd  00                    db          $00
  3545  36fe  00                    db          $00
  3546                          FACING_EAST:
  3547  36ff  1c                    INC         E
  3548  3700  1a                    LD          A,(DE)
  3549  3701  e607                  AND         0x7
  3550  3703  77                    LD          (HL),A                   ;= $20
  3551  3704  1c                    INC         E
  3552  3705  cd9b37                CALL        CALC_WEST_REDRAW
  3553  3708  1c                    INC         E
  3554  3709  cd9b37                CALL        CALC_WEST_REDRAW
  3555  370c  1d                    DEC         E
  3556  370d  cda035                CALL        REDRAW_VIEW
  3557  3710  2c                    INC         L
  3558  3711  77                    LD          (HL),A                   ;= $20
  3559  3712  7b                    LD          A,E
  3560  3713  d60f                  SUB         0xf
  3561  3715  5f                    LD          E,A
  3562  3716  1a                    LD          A,(DE)
  3563  3717  e607                  AND         0x7
  3564  3719  cda735                CALL        REDRAW_NORTH
  3565  371c  7b                    LD          A,E
  3566  371d  c61f                  ADD         A,$1f
  3567  371f  5f                    LD          E,A
  3568  3720  cda035                CALL        REDRAW_VIEW
  3569  3723  77                    LD          (HL),A                   ;= $20
  3570  3724  1c                    INC         E
  3571  3725  1a                    LD          A,(DE)
  3572  3726  e607                  AND         0x7
  3573  3728  cda735                CALL        REDRAW_NORTH
  3574  372b  7b                    LD          A,E
  3575  372c  d612                  SUB         $12
  3576  372e  5f                    LD          E,A
  3577  372f  cda035                CALL        REDRAW_VIEW
  3578  3732  77                    LD          (HL),A                   ;= $20
  3579  3733  7b                    LD          A,E
  3580  3734  d60f                  SUB         0xf
  3581  3736  5f                    LD          E,A
  3582  3737  1a                    LD          A,(DE)
  3583  3738  e607                  AND         0x7
  3584  373a  cda735                CALL        REDRAW_NORTH
  3585  373d  7b                    LD          A,E
  3586  373e  c61f                  ADD         A,$1f
  3587  3740  5f                    LD          E,A
  3588  3741  cda035                CALL        REDRAW_VIEW
  3589  3744  2c                    INC         L
  3590  3745  77                    LD          (HL),A                   ;= $20
  3591  3746  1c                    INC         E
  3592  3747  1a                    LD          A,(DE)
  3593  3748  e607                  AND         0x7
  3594  374a  cda735                CALL        REDRAW_NORTH
  3595  374d  7b                    LD          A,E
  3596  374e  d612                  SUB         $12
  3597  3750  5f                    LD          E,A
  3598  3751  cda035                CALL        REDRAW_VIEW
  3599  3754  2c                    INC         L
  3600  3755  77                    LD          (HL),A                   ;= $20
  3601  3756  7b                    LD          A,E
  3602  3757  d60f                  SUB         0xf
  3603  3759  5f                    LD          E,A
  3604  375a  cd9b37                CALL        CALC_WEST_REDRAW
  3605  375d  1c                    INC         E
  3606  375e  cda035                CALL        REDRAW_VIEW
  3607  3761  2c                    INC         L
  3608  3762  2c                    INC         L
  3609  3763  77                    LD          (HL),A                    ;= $20
  3610  3764  7b                    LD          A,E
  3611  3765  c61e                  ADD         A,$1e
  3612  3767  5f                    LD          E,A
  3613  3768  cda035                CALL        REDRAW_VIEW
  3614  376b  2c                    INC         L
  3615  376c  77                    LD          (HL),A                    ;= $20
  3616  376d  1c                    INC         E
  3617  376e  cd9b37                CALL        CALC_WEST_REDRAW
  3618  3771  7b                    LD          A,E
  3619  3772  c611                  ADD         A,$11
  3620  3774  5f                    LD          E,A
  3621  3775  cda035                CALL        REDRAW_VIEW
  3622  3778  2c                    INC         L
  3623  3779  2c                    INC         L
  3624  377a  77                    LD          (HL),A                    ;= $20
  3625  377b  7b                    LD          A,E
  3626  377c  d622                  SUB         $22
  3627  377e  5f                    LD          E,A
  3628  377f  cd9b37                CALL        CALC_WEST_REDRAW
  3629  3782  1601                  LD          D,0x1
  3630  3784  1e10                  LD          E,$10
  3631  3786  ed53603a              LD          (DIR_FACING_FW),DE
  3632  378a  0610                  LD          B,$10                                  ;RED on BLK
  3633  378c  21d831                LD          HL,CHRRAM_POINTER_IDX                   ;WAS $31d6
  3634  378f  119537                LD          DE,EAST_TXT                             ;= $06,$FF
  3635  3792  c33533                JP          GFX_DRAW
  3636                          EAST_TXT:
  3637  3795  06ff                  db          $06,$FF
  3638  3797  00                    db          $00
  3639  3798  00                    db          $00
  3640  3799  00                    db          $00
  3641  379a  00                    db          $00
  3642                          CALC_WEST_REDRAW:
  3643  379b  1a                    LD          A,(DE)
  3644  379c  e607                  AND         0x7
  3645  379e  2c                    INC         L
  3646  379f  77                    LD          (HL),A
  3647  37a0  c9                    RET
  3648                          CALC_WEST_REDRAW_2:
  3649  37a1  dd21e837              LD          IX,ITEM_F2                              ;= $60
  3650  37a5  ed5b603a              LD          DE,(DIR_FACING_FW)
  3651  37a9  3a793a                LD          A,(PLAYER_MAP_POS)
  3652  37ac  82                    ADD         A,D
  3653  37ad  82                    ADD         A,D
  3654  37ae  cdf337                CALL        ITEM_MAP_CHECK
  3655  37b1  dd7700                LD          (IX+0),A                     ;= $60
  3656  37b4  7c                    LD          A,H
  3657  37b5  92                    SUB         D
  3658  37b6  cdf337                CALL        ITEM_MAP_CHECK
  3659  37b9  dd7701                LD          (IX+1),A                     ;= $60
  3660  37bc  7c                    LD          A,H
  3661  37bd  92                    SUB         D
  3662  37be  cdf337                CALL        ITEM_MAP_CHECK
  3663  37c1  dd7702                LD          (IX+2),A                     ;= $60
  3664  37c4  7c                    LD          A,H
  3665  37c5  82                    ADD         A,D
  3666  37c6  93                    SUB         E
  3667  37c7  cdf337                CALL        ITEM_MAP_CHECK
  3668  37ca  dd7703                LD          (IX+3),A                    ;= $60
  3669  37cd  7c                    LD          A,H
  3670  37ce  83                    ADD         A,E
  3671  37cf  83                    ADD         A,E
  3672  37d0  cdf337                CALL        ITEM_MAP_CHECK
  3673  37d3  dd7704                LD          (IX+4),A                    ;= $60
  3674  37d6  7c                    LD          A,H
  3675  37d7  92                    SUB         D
  3676  37d8  cdf337                CALL        ITEM_MAP_CHECK
  3677  37db  dd7705                LD          (IX+5),A                     ;= $60
  3678  37de  7c                    LD          A,H
  3679  37df  93                    SUB         E
  3680  37e0  93                    SUB         E
  3681  37e1  cdf337                CALL        ITEM_MAP_CHECK
  3682  37e4  dd7706                LD          (IX+6),A                     ;= $60
  3683  37e7  7c                    LD          A,H
  3684  37e8  92                    SUB         D
  3685  37e9  83                    ADD         A,E
  3686  37ea  cdf337                CALL        ITEM_MAP_CHECK
  3687  37ed  dd7707                LD          (IX+7),A                     ;= $60
  3688                          LAB_ram_f7f0:
  3689  37f0  3efe                  LD          A,$fe
  3690  37f2  c9                    RET
  3691                          ITEM_MAP_CHECK:
  3692  37f3  67                    LD          H,A
  3693  37f4  010039                LD          BC,MAP_LADDER_OFFSET
  3694                          LAB_ram_f7f7:
  3695  37f7  0a                    LD          A,(BC)
  3696  37f8  03                    INC         BC
  3697  37f9  03                    INC         BC
  3698  37fa  3c                    INC         A
  3699  37fb  28f3                  JR          Z,LAB_ram_f7f0
  3700  37fd  3d                    DEC         A
  3701  37fe  bc                    CP          H
  3702  37ff  20f6                  JR          NZ,LAB_ram_f7f7
  3703  3801  0d                    DEC         C
  3704  3802  0a                    LD          A,(BC)
  3705  3803  c9                    RET
  3706                          REDRAW_VIEWPORT:
  3707  3804  cda019                CALL        DRAW_BKGD
  3708  3807  01e837                LD          BC,ITEM_F2                              ;BC = ITEM_F2
  3709  380a  11e833                LD          DE,WALL_F0_STATE                        ;DE = wallAheadTemp
  3710  380d  1a                    LD          A,(DE)                   ;A = (wallAheadTemp)
  3711  380e  0f                    RRCA
  3712  380f  d22538                JP          NC,F0_NO_HD                             ;Jump if no hidden door
  3713  3812  08                    EX          AF,AF'
  3714  3813  cdf810                CALL        DRAW_F0_WALL
  3715  3816  08                    EX          AF,AF'
  3716  3817  0f                    RRCA
  3717  3818  d28f39                JP          NC,F0_HD_NO_WALL                        ;Jump if no wall
  3718  381b  0f                    RRCA
  3719  381c  d28f39                JP          NC,F0_HD_NO_WALL                        ;Jump if door closed
  3720                          F0_NO_HD_WALL_OPEN:
  3721  381f  cd1111                CALL        DRAW_WALL_F0_AND_OPEN_DOOR
  3722  3822  c38639                JP          LAB_ram_f986
  3723                          F0_NO_HD:
  3724  3825  0f                    RRCA
  3725  3826  d23338                JP          NC,F0_NO_HD_NO_WALL                     ;Jump if no wall
  3726  3829  0f                    RRCA
  3727  382a  da1f38                JP          C,F0_NO_HD_WALL_OPEN                    ;Jump if door open
  3728  382d  cd0311                CALL        DRAW_F0_WALL_AND_CLOSED_DOOR
  3729  3830  c38f39                JP          F0_HD_NO_WALL
  3730                          F0_NO_HD_NO_WALL:
  3731  3833  13                    INC         DE
  3732  3834  1a                    LD          A,(DE)                   ;= $20
  3733  3835  0f                    RRCA
  3734  3836  d24c38                JP          NC,F1_NO_HD                             ;Jump if no hidden door
  3735  3839  08                    EX          AF,AF'
  3736  383a  cd1811                CALL        DRAW_WALL_F1
  3737  383d  08                    EX          AF,AF'
  3738  383e  0f                    RRCA
  3739  383f  d2c038                JP          NC,F1_HD_NO_WALL                        ;Jump if no wall
  3740  3842  0f                    RRCA
  3741  3843  d2c038                JP          NC,F1_HD_NO_WALL                        ;Jump if door closed
  3742                          F1_NO_HD_WALL_OPEN:
  3743  3846  cd3b11                CALL        DRAW_WALL_F1_AND_OPEN_DOOR
  3744  3849  c3b738                JP          LAB_ram_f8b7
  3745                          F1_NO_HD:
  3746  384c  0f                    RRCA
  3747  384d  d25a38                JP          NC,LAB_ram_f85a
  3748  3850  0f                    RRCA
  3749  3851  da4638                JP          C,F1_NO_HD_WALL_OPEN
  3750  3854  cd2d11                CALL        DRAW_WALL_F1_AND_CLOSED_DOOR
  3751  3857  c3c038                JP          F1_HD_NO_WALL
  3752                          LAB_ram_f85a:
  3753  385a  13                    INC         DE
  3754  385b  1a                    LD          A,(DE)                   ;= $20
  3755  385c  0f                    RRCA
  3756  385d  d26638                JP          NC,CHECK_WALL_F2
  3757                          F2_WALL:
  3758  3860  cd4211                CALL        DRAW_WALL_F2
  3759  3863  c36d38                JP          LAB_ram_f86d
  3760                          CHECK_WALL_F2:
  3761  3866  0f                    RRCA
  3762  3867  da6038                JP          C,F2_WALL
  3763  386a  cd4d11                CALL        DRAW_DOOR_F2_OPEN
  3764                          LAB_ram_f86d:
  3765  386d  11eb33                LD          DE,WALL_F3_STATE                        ;= $20
  3766  3870  1a                    LD          A,(DE)                   ;= $20
  3767  3871  0f                    RRCA
  3768  3872  d27b38                JP          NC,LAB_ram_f87b
  3769                          LAB_ram_f875:
  3770  3875  cdee12                CALL        DRAW_WALL_FL2_EMPTY
  3771  3878  c39238                JP          LAB_ram_f892
  3772                          LAB_ram_f87b:
  3773  387b  0f                    RRCA
  3774  387c  da7538                JP          C,LAB_ram_f875
  3775  387f  13                    INC         DE
  3776  3880  1a                    LD          A,(DE)                    ;= $20
  3777  3881  0f                    RRCA
  3778  3882  d28b38                JP          NC,LAB_ram_f88b
  3779                          LAB_ram_f885:
  3780  3885  cd3913                CALL        DRAW_WALL_L2_C
  3781  3888  c39238                JP          LAB_ram_f892
  3782                          LAB_ram_f88b:
  3783  388b  0f                    RRCA
  3784  388c  da8538                JP          C,LAB_ram_f885
  3785  388f  cd4413                CALL        DRAW_WALL_L2_C_EMPTY
  3786                          LAB_ram_f892:
  3787  3892  11ed33                LD          DE,DAT_ram_33ed                         ;= $20
  3788  3895  1a                    LD          A,(DE)                    ;= $20
  3789  3896  0f                    RRCA
  3790  3897  d2a038                JP          NC,LAB_ram_f8a0
  3791                          LAB_ram_f89a:
  3792  389a  cde314                CALL        DRAW_WALL_FR2
  3793  389d  c3b738                JP          LAB_ram_f8b7
  3794                          LAB_ram_f8a0:
  3795  38a0  0f                    RRCA
  3796  38a1  da9a38                JP          C,LAB_ram_f89a
  3797  38a4  13                    INC         DE
  3798  38a5  1a                    LD          A,(DE)                    ;= $20
  3799  38a6  0f                    RRCA
  3800  38a7  d2b038                JP          NC,LAB_ram_f8b0
  3801                          LAB_ram_f8aa:
  3802  38aa  cd2115                CALL        SUB_ram_cd21
  3803  38ad  c3b738                JP          LAB_ram_f8b7
  3804                          LAB_ram_f8b0:
  3805  38b0  0f                    RRCA
  3806  38b1  daaa38                JP          C,LAB_ram_f8aa
  3807  38b4  cd2c15                CALL        SUB_ram_cd2c
  3808                          LAB_ram_f8b7:
  3809  38b7  3ae837                LD          A,(ITEM_F2)                             ;= $60
  3810  38ba  018a04                LD          BC,$48a
  3811  38bd  cdac2c                CALL        CHK_ITEM
  3812                          F1_HD_NO_WALL:
  3813  38c0  11ef33                LD          DE,DAT_ram_33ef                         ;= $20
  3814  38c3  1a                    LD          A,(DE)                    ;= $20
  3815  38c4  0f                    RRCA
  3816  38c5  d2db38                JP          NC,LAB_ram_f8db
  3817  38c8  08                    EX          AF,AF'
  3818  38c9  cd4012                CALL        DRAW_L1_WALL
  3819  38cc  08                    EX          AF,AF'
  3820  38cd  0f                    RRCA
  3821  38ce  d22339                JP          NC,LAB_ram_f923
  3822  38d1  0f                    RRCA
  3823  38d2  d22339                JP          NC,LAB_ram_f923
  3824                          LAB_ram_f8d5:
  3825  38d5  cd8312                CALL        DRAW_FL1_DOOR
  3826  38d8  c32339                JP          LAB_ram_f923
  3827                          LAB_ram_f8db:
  3828  38db  0f                    RRCA
  3829  38dc  d2e938                JP          NC,LAB_ram_f8e9
  3830  38df  0f                    RRCA
  3831  38e0  dad538                JP          C,LAB_ram_f8d5
  3832  38e3  cd9012                CALL        DRAW_L1
  3833  38e6  c32339                JP          LAB_ram_f923
  3834                          LAB_ram_f8e9:
  3835  38e9  1c                    INC         E
  3836  38ea  1a                    LD          A,(DE)                    ;= $20
  3837  38eb  0f                    RRCA
  3838  38ec  d20239                JP          NC,LAB_ram_f902
  3839  38ef  08                    EX          AF,AF'
  3840  38f0  cdb012                CALL        SUB_ram_cab0
  3841  38f3  08                    EX          AF,AF'
  3842  38f4  0f                    RRCA
  3843  38f5  d22339                JP          NC,LAB_ram_f923
  3844  38f8  0f                    RRCA
  3845  38f9  d22339                JP          NC,LAB_ram_f923
  3846                          LAB_ram_f8fc:
  3847  38fc  cdc512                CALL        SUB_ram_cac5
  3848  38ff  c32339                JP          LAB_ram_f923
  3849                          LAB_ram_f902:
  3850  3902  0f                    RRCA
  3851  3903  d21039                JP          NC,LAB_ram_f910
  3852  3906  0f                    RRCA
  3853  3907  dafc38                JP          C,LAB_ram_f8fc
  3854  390a  cdcb12                CALL        DRAW_L1_DOOR_CLOSED
  3855  390d  c32339                JP          LAB_ram_f923
  3856                          LAB_ram_f910:
  3857  3910  1c                    INC         E
  3858  3911  1a                    LD          A,(DE)                    ;= $20
  3859  3912  0f                    RRCA
  3860  3913  d21c39                JP          NC,LAB_ram_f91c
  3861                          LAB_ram_f916:
  3862  3916  cdbb1f                CALL        DRAW_WALL_FL2_NEW
  3863  3919  c32339                JP          LAB_ram_f923
  3864                          LAB_ram_f91c:
  3865  391c  0f                    RRCA
  3866  391d  da1639                JP          C,LAB_ram_f916
  3867  3920  cdee12                CALL        DRAW_WALL_FL2_EMPTY
  3868                          LAB_ram_f923:
  3869  3923  11f233                LD          DE,DAT_ram_33f2                         ;= $20
  3870  3926  1a                    LD          A,(DE)                    ;= $20
  3871  3927  0f                    RRCA
  3872  3928  d23e39                JP          NC,LAB_ram_f93e
  3873  392b  08                    EX          AF,AF'
  3874  392c  cd2b14                CALL        DRAW_WALL_FR1
  3875  392f  08                    EX          AF,AF'
  3876  3930  0f                    RRCA
  3877  3931  d28639                JP          NC,LAB_ram_f986
  3878  3934  0f                    RRCA
  3879  3935  d28639                JP          NC,LAB_ram_f986
  3880                          LAB_ram_f938:
  3881  3938  cd6d14                CALL        SUB_ram_cc6d
  3882  393b  c38639                JP          LAB_ram_f986
  3883                          LAB_ram_f93e:
  3884  393e  0f                    RRCA
  3885  393f  d24c39                JP          NC,LAB_ram_f94c
  3886  3942  0f                    RRCA
  3887  3943  da3839                JP          C,LAB_ram_f938
  3888  3946  cd7a14                CALL        SUB_ram_cc7a
  3889  3949  c38639                JP          LAB_ram_f986
  3890                          LAB_ram_f94c:
  3891  394c  1c                    INC         E
  3892  394d  1a                    LD          A,(DE)                    ;= $20
  3893  394e  0f                    RRCA
  3894  394f  d26539                JP          NC,LAB_ram_f965
  3895  3952  08                    EX          AF,AF'
  3896  3953  cd9a14                CALL        SUB_ram_cc9a
  3897  3956  08                    EX          AF,AF'
  3898  3957  0f                    RRCA
  3899  3958  d28639                JP          NC,LAB_ram_f986
  3900  395b  0f                    RRCA
  3901  395c  d28639                JP          NC,LAB_ram_f986
  3902                          LAB_ram_f95f:
  3903  395f  cdaf14                CALL        SUB_ram_ccaf
  3904  3962  c38639                JP          LAB_ram_f986
  3905                          LAB_ram_f965:
  3906  3965  0f                    RRCA
  3907  3966  d27339                JP          NC,LAB_ram_f973
  3908  3969  0f                    RRCA
  3909  396a  da5f39                JP          C,LAB_ram_f95f
  3910  396d  cdb514                CALL        SUB_ram_ccb5
  3911  3970  c38639                JP          LAB_ram_f986
  3912                          LAB_ram_f973:
  3913  3973  1c                    INC         E
  3914  3974  1a                    LD          A,(DE)                    ;= $20
  3915  3975  0f                    RRCA
  3916  3976  d27f39                JP          NC,LAB_ram_f97f
  3917                          LAB_ram_f979:
  3918  3979  cdc314                CALL        SUB_ram_ccc3
  3919  397c  c38639                JP          LAB_ram_f986
  3920                          LAB_ram_f97f:
  3921  397f  0f                    RRCA
  3922  3980  da7939                JP          C,LAB_ram_f979
  3923  3983  cdd814                CALL        DRAW_WALL_FR2_EMPTY
  3924                          LAB_ram_f986:
  3925  3986  3ae937                LD          A,(ITEM_F1)                             ;= $60
  3926  3989  018a02                LD          BC,$28a
  3927  398c  cdac2c                CALL        CHK_ITEM
  3928                          F0_HD_NO_WALL:
  3929  398f  11f533                LD          DE,DAT_ram_33f5                         ;= $20
  3930  3992  1a                    LD          A,(DE)                    ;= $20
  3931  3993  0f                    RRCA
  3932  3994  d2aa39                JP          NC,LAB_ram_f9aa
  3933  3997  08                    EX          AF,AF'
  3934  3998  cd5811                CALL        DRAW_WALL_FL0
  3935  399b  08                    EX          AF,AF'
  3936  399c  0f                    RRCA
  3937  399d  d2193a                JP          NC,LAB_ram_fa19
  3938  39a0  0f                    RRCA
  3939  39a1  d2193a                JP          NC,LAB_ram_fa19
  3940                          LAB_ram_f9a4:
  3941  39a4  cd8c11                CALL        DRAW_DOOR_FLO
  3942  39a7  c3193a                JP          LAB_ram_fa19
  3943                          LAB_ram_f9aa:
  3944  39aa  0f                    RRCA
  3945  39ab  d2b839                JP          NC,LAB_ram_f9b8
  3946  39ae  0f                    RRCA
  3947  39af  daa439                JP          C,LAB_ram_f9a4
  3948  39b2  cd9611                CALL        SUB_ram_c996
  3949  39b5  c3193a                JP          LAB_ram_fa19
  3950                          LAB_ram_f9b8:
  3951  39b8  1c                    INC         E
  3952  39b9  1a                    LD          A,(DE)                    ;= $20
  3953  39ba  0f                    RRCA
  3954  39bb  d2c439                JP          NC,LAB_ram_f9c4
  3955                          LAB_ram_f9be:
  3956  39be  cdc511                CALL        SUB_ram_c9c5
  3957  39c1  c3193a                JP          LAB_ram_fa19
  3958                          LAB_ram_f9c4:
  3959  39c4  0f                    RRCA
  3960  39c5  dabe39                JP          C,LAB_ram_f9be
  3961  39c8  1c                    INC         E
  3962  39c9  1a                    LD          A,(DE)                    ;= $20
  3963  39ca  0f                    RRCA
  3964  39cb  d2f039                JP          NC,LAB_ram_f9f0
  3965  39ce  08                    EX          AF,AF'
  3966  39cf  cdd011                CALL        SUB_ram_c9d0
  3967  39d2  cde739                CALL        SUB_ram_f9e7
  3968  39d5  08                    EX          AF,AF'
  3969  39d6  0f                    RRCA
  3970  39d7  d2193a                JP          NC,LAB_ram_fa19
  3971  39da  0f                    RRCA
  3972  39db  d2193a                JP          NC,LAB_ram_fa19
  3973                          LAB_ram_f9de:
  3974  39de  cdf311                CALL        SUB_ram_c9f3
  3975  39e1  cde739                CALL        SUB_ram_f9e7
  3976  39e4  c3193a                JP          LAB_ram_fa19
  3977                          SUB_ram_f9e7:
  3978  39e7  3aeb37                LD          A,(ITEM_FL1)                            ;= $60
  3979  39ea  01d004                LD          BC,$4d0
  3980  39ed  c3ac2c                JP          CHK_ITEM
  3981                          LAB_ram_f9f0:
  3982  39f0  0f                    RRCA
  3983  39f1  d2013a                JP          NC,LAB_ram_fa01
  3984  39f4  0f                    RRCA
  3985  39f5  dade39                JP          C,LAB_ram_f9de
  3986  39f8  cde511                CALL        SUB_ram_c9e5
  3987  39fb  cde739                CALL        SUB_ram_f9e7
  3988  39fe  c3193a                JP          LAB_ram_fa19
  3989                          LAB_ram_fa01:
  3990  3a01  1c                    INC         E
  3991  3a02  0f                    RRCA
  3992  3a03  d20f3a                JP          NC,LAB_ram_fa0f
  3993                          LAB_ram_fa06:
  3994  3a06  cdf911                CALL        SUB_ram_c9f9
  3995  3a09  cde739                CALL        SUB_ram_f9e7
  3996  3a0c  c3193a                JP          LAB_ram_fa19
  3997                          LAB_ram_fa0f:
  3998  3a0f  0f                    RRCA
  3999  3a10  da063a                JP          C,LAB_ram_fa06
  4000  3a13  cda51f                CALL        DRAW_WALL_FL22_EMPTY
  4001  3a16  cde739                CALL        SUB_ram_f9e7
  4002                          LAB_ram_fa19:
  4003  3a19  11f933                LD          DE,DAT_ram_33f9                         ;= $20
  4004  3a1c  1a                    LD          A,(DE)                    ;= $20
  4005  3a1d  0f                    RRCA
  4006  3a1e  d2343a                JP          NC,LAB_ram_fa34
  4007  3a21  08                    EX          AF,AF'
  4008  3a22  cd4f13                CALL        SUB_ram_cb4f
  4009  3a25  08                    EX          AF,AF'
  4010  3a26  0f                    RRCA
  4011  3a27  d2a33a                JP          NC,LAB_ram_faa3
  4012  3a2a  0f                    RRCA
  4013  3a2b  d2a33a                JP          NC,LAB_ram_faa3
  4014                          LAB_ram_fa2e:
  4015  3a2e  cd7413                CALL        DRAW_FRO_DOOR
  4016  3a31  c3a33a                JP          LAB_ram_faa3
  4017                          LAB_ram_fa34:
  4018  3a34  0f                    RRCA
  4019  3a35  d2423a                JP          NC,LAB_ram_fa42
  4020  3a38  0f                    RRCA
  4021  3a39  da2e3a                JP          C,LAB_ram_fa2e
  4022  3a3c  cd7e13                CALL        SUB_ram_cb7e
  4023  3a3f  c3a33a                JP          LAB_ram_faa3
  4024                          LAB_ram_fa42:
  4025  3a42  1c                    INC         E
  4026  3a43  1a                    LD          A,(DE)                    ;= $20
  4027  3a44  0f                    RRCA
  4028  3a45  d2573a                JP          NC,LAB_ram_fa57
  4029                          LAB_ram_fa48:
  4030  3a48  cdae13                CALL        SUB_ram_cbae
  4031  3a4b  c3a33a                JP          LAB_ram_faa3
  4032                          SUB_ram_fa4e:
  4033  3a4e  3aec37                LD          A,(ITEM_FR1)                            ;= $60
  4034  3a51  01e404                LD          BC,$4e4
  4035  3a54  c3ac2c                JP          CHK_ITEM
  4036                          LAB_ram_fa57:
  4037  3a57  0f                    RRCA
  4038  3a58  da483a                JP          C,LAB_ram_fa48
  4039  3a5b  1c                    INC         E
  4040  3a5c  1a                    LD          A,(DE)                    ;= $20
  4041  3a5d  0f                    RRCA
  4042  3a5e  d27a3a                JP          NC,LAB_ram_fa7a
  4043  3a61  08                    EX          AF,AF'
  4044  3a62  cdb913                CALL        SUB_ram_cbb9
  4045  3a65  cd4e3a                CALL        SUB_ram_fa4e
  4046  3a68  08                    EX          AF,AF'
  4047  3a69  0f                    RRCA
  4048  3a6a  d2a33a                JP          NC,LAB_ram_faa3
  4049  3a6d  0f                    RRCA
  4050  3a6e  d2a33a                JP          NC,LAB_ram_faa3
  4051                          LAB_ram_fa71:
  4052  3a71  cdce13                CALL        SUB_ram_cbce
  4053  3a74  cd4e3a                CALL        SUB_ram_fa4e
  4054  3a77  c3a33a                JP          LAB_ram_faa3
  4055                          LAB_ram_fa7a:
  4056  3a7a  0f                    RRCA
  4057  3a7b  d28b3a                JP          NC,LAB_ram_fa8b
  4058  3a7e  0f                    RRCA
  4059  3a7f  da713a                JP          C,LAB_ram_fa71
  4060  3a82  cdd413                CALL        SUB_ram_cbd4
  4061  3a85  cd4e3a                CALL        SUB_ram_fa4e
  4062  3a88  c3a33a                JP          LAB_ram_faa3
  4063                          LAB_ram_fa8b:
  4064  3a8b  1c                    INC         E
  4065  3a8c  0f                    RRCA
  4066  3a8d  d2993a                JP          NC,LAB_ram_fa99
  4067                          LAB_ram_fa90:
  4068  3a90  cde213                CALL        SUB_ram_cbe2
  4069  3a93  cd4e3a                CALL        SUB_ram_fa4e
  4070  3a96  c3a33a                JP          LAB_ram_faa3
  4071                          LAB_ram_fa99:
  4072  3a99  0f                    RRCA
  4073  3a9a  da903a                JP          C,LAB_ram_fa90
  4074  3a9d  cd2014                CALL        DRAW_WALL_FR222_EMPTY
  4075  3aa0  cd4e3a                CALL        SUB_ram_fa4e
  4076                          LAB_ram_faa3:
  4077  3aa3  3aea37                LD          A,(ITEM_F0)                             ;= $60
  4078  3aa6  018a00                LD          BC,$8a
  4079  3aa9  c3ac2c                JP          CHK_ITEM
  4080                          MAKE_RANDOM_BYTE:
  4081  3aac  c5                    PUSH        BC
  4082  3aad  e5                    PUSH        HL
  4083  3aae  0605                  LD          B,0x5                                   ;Run data randomizer 5x
  4084  3ab0  2a913a                LD          HL,(RNDHOLD_AA)
  4085                          RANDOM_BYTE_LOOP:
  4086  3ab3  cb25                  SLA         L                                       ;L x 2
  4087  3ab5  cb14                  RL          H
  4088  3ab7  3808                  JR          C,FINISH_BYTE_LOOP
  4089  3ab9  3e87                  LD          A,$87
  4090  3abb  ad                    XOR         L
  4091  3abc  6f                    LD          L,A
  4092  3abd  3e1d                  LD          A,$1d
  4093  3abf  ac                    XOR         H
  4094  3ac0  67                    LD          H,A
  4095                          FINISH_BYTE_LOOP:
  4096  3ac1  10f0                  DJNZ        RANDOM_BYTE_LOOP
  4097  3ac3  22913a                LD          (RNDHOLD_AA),HL
  4098  3ac6  7c                    LD          A,H
  4099  3ac7  e1                    POP         HL
  4100  3ac8  c1                    POP         BC
  4101  3ac9  c9                    RET
  4102                          UPDATE_SCR_SAVER_TIMER:
  4103  3aca  c5                    PUSH        BC
  4104  3acb  e5                    PUSH        HL
  4105  3acc  2a9c3a                LD          HL,(TIMER_E)
  4106  3acf  44                    LD          B,H
  4107  3ad0  4d                    LD          C,L
  4108  3ad1  cb21                  SLA         C
  4109  3ad3  cb10                  RL          B
  4110  3ad5  cb21                  SLA         C
  4111  3ad7  cb10                  RL          B
  4112  3ad9  09                    ADD         HL,BC
  4113  3ada  7c                    LD          A,H
  4114  3adb  ad                    XOR         L
  4115  3adc  32883a                LD          (TIMER_D),A
  4116  3adf  44                    LD          B,H
  4117  3ae0  4d                    LD          C,L
  4118  3ae1  cb21                  SLA         C
  4119  3ae3  cb10                  RL          B
  4120  3ae5  cb21                  SLA         C
  4121  3ae7  cb10                  RL          B
  4122  3ae9  09                    ADD         HL,BC
  4123  3aea  011300                LD          BC,$13
  4124  3aed  09                    ADD         HL,BC
  4125  3aee  229c3a                LD          (TIMER_E),HL
  4126  3af1  e1                    POP         HL
  4127  3af2  c1                    POP         BC
  4128  3af3  c9                    RET
  4129                          MINOTAUR_DEAD:
  4130  3af4  cda019                CALL        DRAW_BKGD
  4131  3af7  215030                LD          HL,DAT_ram_3050                         ;= $20
  4132  3afa  115b19                LD          DE,THE_END_PART_A                       ;WAS LD DE, 0xC25D
  4133  3afd  0610                  LD          B,$10                                  ;RED on BLK
  4134  3aff  cd3533                CALL        GFX_DRAW
  4135  3b02  21a030                LD          HL,DAT_ram_30a0                         ;= $20
  4136  3b05  cd3533                CALL        GFX_DRAW
  4137  3b08  cdac3a                CALL        MAKE_RANDOM_BYTE
  4138  3b0b  e603                  AND         0x3
  4139  3b0d  c60a                  ADD         A,0xa
  4140  3b0f  47                    LD          B,A
  4141  3b10  00                    db          $00
  4142  3b11  00                    db          $00
  4143  3b12  00                    db          $00
  4144  3b13  00                    db          $00
  4145  3b14  00                    db          $00
  4146  3b15  00                    db          $00
  4147  3b16  00                    db          $00
  4148  3b17  00                    db          $00
  4149  3b18  00                    db          $00
  4150  3b19  3a6c3a                LD          A,(INPUT_HOLDER)
  4151  3b1c  07                    RLCA
  4152  3b1d  07                    RLCA
  4153  3b1e  07                    RLCA
  4154  3b1f  07                    RLCA
  4155  3b20  47                    LD          B,A
  4156  3b21  af                    XOR         A
  4157  3b22  326c3a                LD          (INPUT_HOLDER),A
  4158  3b25  11ff0d                LD          DE,MINOTAUR                             ;= $04,$04,$04,$04
  4159  3b28  21da32                LD          HL,DAT_ram_32da                         ;= $20
  4160  3b2b  cd3533                CALL        GFX_DRAW
  4161  3b2e  cdbc2e                CALL        TOTAL_HEAL
  4162  3b31  cd5d3d                CALL        REDRAW_STATS
  4163  3b34  0602                  LD          B,0x2                                   ;Was LD B,0x6
  4164                          MINOTAUR_DEAD_SOUND_LOOP:
  4165  3b36  d9                    EXX
  4166  3b37  cd5f15                CALL        SUB_ram_cd5f
  4167  3b3a  cd7b15                CALL        END_OF_GAME_SOUND
  4168  3b3d  d9                    EXX
  4169  3b3e  10f6                  DJNZ        MINOTAUR_DEAD_SOUND_LOOP
  4170  3b40  c3b72a                JP          SCREEN_SAVER_FULL_SCREEN
  4171  3b43  00                    db          $00
  4172  3b44  00                    db          $00
  4173  3b45  00                    db          $00
  4174  3b46  00                    db          $00
  4175  3b47  00                    db          $00
  4176  3b48  00                    db          $00
  4177  3b49  00                    db          $00
  4178  3b4a  00                    db          $00
  4179  3b4b  00                    db          $00
  4180  3b4c  00                    db          $00
  4181  3b4d  00                    db          $00
  4182  3b4e  00                    db          $00
  4183  3b4f  00                    db          $00
  4184  3b50  00                    db          $00
  4185  3b51  00                    db          $00
  4186  3b52  00                    db          $00
  4187  3b53  00                    db          $00
  4188  3b54  00                    db          $00
  4189  3b55  00                    db          $00
  4190  3b56  00                    db          $00
  4191  3b57  00                    db          $00
  4192  3b58  00                    db          $00
  4193  3b59  00                    db          $00
  4194  3b5a  00                    db          $00
  4195  3b5b  00                    db          $00
  4196  3b5c  00                    db          $00
  4197  3b5d  00                    db          $00
  4198  3b5e  00                    db          $00
  4199  3b5f  00                    db          $00
  4200  3b60  00                    db          $00
  4201  3b61  00                    db          $00
  4202  3b62  00                    db          $00
  4203  3b63  00                    db          $00
  4204  3b64  00                    db          $00
  4205  3b65  00                    db          $00
  4206  3b66  00                    db          $00
  4207  3b67  00                    db          $00
  4208  3b68  00                    db          $00
  4209  3b69  00                    db          $00
  4210  3b6a  00                    db          $00
  4211                          DO_REST:
  4212  3b6b  3a783a                LD          A,(LAST_ITEM_HELD)                   ;Load food inventory into A
  4213  3b6e  a7                    AND         A
  4214  3b6f  c23022                JP          NZ,NO_ACTION_TAKEN                      ;If food is empty, do nothing
  4215                          CHK_NEEDS_HEALING:
  4216  3b72  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)             ;HL = max PHYS health
  4217  3b75  ed5b933a              LD          DE,(PLAYER_PHYS_HEALTH)                 ;DE = current PHYS health
  4218  3b79  cd3024                CALL        RECALC_PHYS_HEALTH
  4219  3b7c  b5                    OR          L
  4220  3b7d  200d                  JR          NZ,HEAL_PLAYER_PHYS_HEALTH
  4221  3b7f  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
  4222  3b82  4f                    LD          C,A
  4223  3b83  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  4224  3b86  b9                    CP          C
  4225  3b87  ca9c2a                JP          Z,INPUT_DEBOUNCE
  4226  3b8a  182a                  JR          HEAL_PLAYER_SPRT_HEALTH
  4227                          HEAL_PLAYER_PHYS_HEALTH:
  4228  3b8c  2aa93a                LD          HL,(BYTE_ram_3aa9)
  4229  3b8f  110100                LD          DE,0x1
  4230  3b92  cd3024                CALL        RECALC_PHYS_HEALTH
  4231  3b95  da9c2a                JP          C,INPUT_DEBOUNCE
  4232  3b98  22a93a                LD          (BYTE_ram_3aa9),HL
  4233  3b9b  21ab3a                LD          HL,FOOD_INV
  4234  3b9e  35                    DEC         (HL)
  4235  3b9f  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
  4236  3ba2  cd2724                CALL        SUB_ram_e427
  4237  3ba5  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  4238  3ba8  cd5d3d                CALL        REDRAW_STATS
  4239  3bab  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
  4240  3bae  4f                    LD          C,A
  4241  3baf  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  4242  3bb2  b9                    CP          C
  4243  3bb3  ca723b                JP          Z,CHK_NEEDS_HEALING
  4244                          HEAL_PLAYER_SPRT_HEALTH:
  4245  3bb6  2aa93a                LD          HL,(BYTE_ram_3aa9)
  4246  3bb9  110100                LD          DE,0x1
  4247  3bbc  cd3024                CALL        RECALC_PHYS_HEALTH
  4248  3bbf  da9c2a                JP          C,INPUT_DEBOUNCE
  4249  3bc2  22a93a                LD          (BYTE_ram_3aa9),HL
  4250  3bc5  21ab3a                LD          HL,FOOD_INV
  4251  3bc8  35                    DEC         (HL)
  4252  3bc9  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  4253  3bcc  c601                  ADD         A,0x1
  4254  3bce  27                    DAA
  4255  3bcf  32973a                LD          (PLAYER_SPRT_HEALTH),A
  4256  3bd2  cd5d3d                CALL        REDRAW_STATS
  4257  3bd5  189b                  JR          CHK_NEEDS_HEALING
  4258  3bd7  00                    db          $00
  4259  3bd8  00                    db          $00
  4260  3bd9  00                    db          $00
  4261  3bda  00                    db          $00
  4262  3bdb  00                    db          $00
  4263  3bdc  00                    db          $00
  4264  3bdd  00                    db          $00
  4265  3bde  00                    db          $00
  4266  3bdf  00                    db          $00
  4267                          KEY_COMPARE:
  4268  3be0  3a663a                LD          A,(RAM_AE)
  4269  3be3  fe31                  CP          $31                                    ;Compare to "1" db?
  4270  3be5  c29f2a                JP          NZ,WAIT_FOR_INPUT
  4271                          KEY_COL_0:
  4272  3be8  21f637                LD          HL,KEY_INPUT_COL0                       ;= $60
  4273  3beb  7e                    LD          A,(HL)                  ;A = Key Column 0
  4274  3bec  fefe                  CP          $fe                                    ;If Key Row = 0 "="
  4275  3bee  ca3022                JP          Z,NO_ACTION_TAKEN
  4276  3bf1  fefd                  CP          $fd                                    ;If Key Row = 1 "BKSP"
  4277  3bf3  ca3022                JP          Z,NO_ACTION_TAKEN
  4278  3bf6  fefb                  CP          $fb                                    ;If Key Row = 2 ":"
  4279  3bf8  ca3022                JP          Z,NO_ACTION_TAKEN
  4280  3bfb  fef7                  CP          $f7                                    ;If Key Row = 3 "RET"
  4281  3bfd  ca3022                JP          Z,NO_ACTION_TAKEN
  4282  3c00  feef                  CP          $ef                                    ;If Key Row = 4 ";"
  4283  3c02  ca322e                JP          Z,DO_GLANCE_RIGHT
  4284  3c05  fedf                  CP          $df                                    ;If Key Row = 5 "."
  4285  3c07  ca182e                JP          Z,DO_TURN_RIGHT
  4286                          KEY_COL_1:
  4287  3c0a  2c                    INC         L
  4288  3c0b  7e                    LD          A,(HL)                  ;A = Key Column 1
  4289  3c0c  fefe                  CP          $fe                                    ;If Key Row = 0 "-"
  4290  3c0e  ca3022                JP          Z,NO_ACTION_TAKEN
  4291  3c11  fefd                  CP          $fd                                    ;If Key Row = 1 "/"
  4292  3c13  ca3022                JP          Z,NO_ACTION_TAKEN
  4293  3c16  fefb                  CP          $fb                                    ;If Key Row = 2 "0"
  4294  3c18  ca3022                JP          Z,NO_ACTION_TAKEN
  4295  3c1b  fef7                  CP          $f7                                    ;If Key Row = 3 "P"
  4296  3c1d  ca3022                JP          Z,NO_ACTION_TAKEN
  4297  3c20  feef                  CP          $ef                                    ;If Key Row = 4 "L"
  4298  3c22  ca9e21                JP          Z,DO_MOVE_FW_CHK_WALLS
  4299  3c25  fedf                  CP          $df                                    ;If Key Row = 5 ","
  4300  3c27  cad021                JP          Z,DO_JUMP_BACK
  4301                          KEY_COL_2:
  4302  3c2a  2c                    INC         L
  4303  3c2b  7e                    LD          A,(HL)                  ;A = Key Column 2
  4304  3c2c  fefe                  CP          $fe                                    ;If Key Row = 0 "9"
  4305  3c2e  ca3022                JP          Z,NO_ACTION_TAKEN
  4306  3c31  fefd                  CP          $fd                                    ;If Key Row = 1 "O"
  4307  3c33  ca3022                JP          Z,NO_ACTION_TAKEN
  4308  3c36  fefb                  CP          $fb                                    ;If Key Row = 2 "K"
  4309  3c38  ca9e21                JP          Z,DO_MOVE_FW_CHK_WALLS
  4310  3c3b  fef7                  CP          $f7                                    ;If Key Row = 3 "M"
  4311  3c3d  ca002e                JP          Z,DO_TURN_LEFT
  4312  3c40  feef                  CP          $ef                                    ;If Key Row = 4 "N"
  4313  3c42  ca5e2e                JP          Z,DO_USE_ATTACK
  4314  3c45  fedf                  CP          $df                                    ;If Key Row = 5 "J"
  4315  3c47  ca482e                JP          Z,DO_GLANCE_LEFT
  4316                          KEY_COL_3:
  4317  3c4a  2c                    INC         L
  4318  3c4b  7e                    LD          A,(HL)                  ;A = Key Column 3
  4319  3c4c  fefe                  CP          $fe                                    ;If Key Row = 0 "8"
  4320  3c4e  ca3022                JP          Z,NO_ACTION_TAKEN
  4321  3c51  fefd                  CP          $fd                                    ;If Key Row = 1 "I"
  4322  3c53  ca3022                JP          Z,NO_ACTION_TAKEN
  4323  3c56  fefb                  CP          $fb                                    ;If Key Row = 2 "7"
  4324  3c58  ca3022                JP          Z,NO_ACTION_TAKEN
  4325  3c5b  fef7                  CP          $f7                                    ;If Key Row = 3 "U"
  4326  3c5d  ca3022                JP          Z,NO_ACTION_TAKEN
  4327  3c60  feef                  CP          $ef                                    ;If Key Row = 4 "H"
  4328  3c62  cadb2c                JP          Z,DO_OPEN_CLOSE
  4329  3c65  fedf                  CP          $df                                    ;If Key Row = 5 "B"
  4330  3c67  ca3022                JP          Z,NO_ACTION_TAKEN
  4331                          KEY_COL_4:
  4332  3c6a  2c                    INC         L
  4333  3c6b  7e                    LD          A,(HL)                  ;A = Key Column 4
  4334  3c6c  fefe                  CP          $fe                                    ;If Key Row = 0 "6"
  4335  3c6e  ca3022                JP          Z,NO_ACTION_TAKEN
  4336  3c71  fefd                  CP          $fd                                    ;If Key Row = 1 "Y"
  4337  3c73  ca4d22                JP          Z,USE_MAP
  4338  3c76  fefb                  CP          $fb                                    ;If Key Row = 2 "G"
  4339  3c78  ca3022                JP          Z,NO_ACTION_TAKEN
  4340  3c7b  fef7                  CP          $f7                                    ;If Key Row = 3 "V"
  4341  3c7d  ca3022                JP          Z,NO_ACTION_TAKEN
  4342  3c80  feef                  CP          $ef                                    ;If Key Row = 4 "C"
  4343  3c82  ca2b22                JP          Z,DO_COUNT_ARROWS
  4344  3c85  fedf                  CP          $df                                    ;If Key Row = 5 "F"
  4345  3c87  ca6b3b                JP          Z,DO_REST
  4346                          KEY_COL_5:
  4347  3c8a  2c                    INC         L
  4348  3c8b  7e                    LD          A,(HL)                  ;A = Key Column 5
  4349  3c8c  fefe                  CP          $fe                                    ;If Key Row = 0 "5"
  4350  3c8e  ca3022                JP          Z,NO_ACTION_TAKEN
  4351  3c91  fefd                  CP          $fd                                    ;If Key Row = 1 "T"
  4352  3c93  ca303d                JP          Z,DO_TELEPORT
  4353  3c96  fefb                  CP          $fb                                    ;If Key Row = 2 "4"
  4354  3c98  ca3022                JP          Z,NO_ACTION_TAKEN
  4355  3c9b  fef7                  CP          $f7                                    ;If Key Row = 3 "R"
  4356  3c9d  ca682a                JP          Z,DO_SWAP_PACK
  4357  3ca0  feef                  CP          $ef                                    ;If Key Row = 4 "D"
  4358  3ca2  caa332                JP          Z,DO_USE_LADDER
  4359  3ca5  fedf                  CP          $df                                    ;If Key Row = 5 "X"
  4360  3ca7  ca1422                JP          Z,DO_COUNT_FOOD
  4361                          KEY_COL_6:
  4362  3caa  2c                    INC         L
  4363  3cab  7e                    LD          A,(HL)                  ;A = Key Column 6
  4364  3cac  fefe                  CP          $fe                                    ;If Key Row = 0 "3"
  4365  3cae  ca3022                JP          Z,NO_ACTION_TAKEN
  4366  3cb1  fefd                  CP          $fd                                    ;If Key Row = 1 "E"
  4367  3cb3  cacc26                JP          Z,DO_SWAP_HANDS
  4368  3cb6  fefb                  CP          $fb                                    ;If Key Row = 2 "S"
  4369  3cb8  caf829                JP          Z,DO_ROTATE_PACK
  4370  3cbb  fef7                  CP          $f7                                    ;If Key Row = 3 "Z"
  4371  3cbd  ca671f                JP          Z,WIPE_WALLS
  4372  3cc0  feef                  CP          $ef                                    ;If Key Row = 4 "SPC"
  4373  3cc2  ca3022                JP          Z,NO_ACTION_TAKEN
  4374  3cc5  fedf                  CP          $df                                    ;If Key Row = 5 "A"
  4375  3cc7  ca3022                JP          Z,NO_ACTION_TAKEN
  4376                          KEY_COL_7:
  4377  3cca  2c                    INC         L
  4378  3ccb  7e                    LD          A,(HL)                  ;A = Key Column 7
  4379  3ccc  fefe                  CP          $fe                                    ;If Key Row = 0 "2"
  4380  3cce  ca3022                JP          Z,NO_ACTION_TAKEN
  4381  3cd1  fefd                  CP          $fd                                    ;If Key Row = 1 "W"
  4382  3cd3  cacc27                JP          Z,DO_PICK_UP
  4383  3cd6  fefb                  CP          $fb                                    ;If Key Row = 2 "1"
  4384  3cd8  ca3022                JP          Z,NO_ACTION_TAKEN
  4385  3cdb  fef7                  CP          $f7                                    ;If Key Row = 3 "Q"
  4386  3cdd  caee3c                JP          Z,MAX_HEALTH_ARROWS_FOOD
  4387  3ce0  feef                  CP          $ef                                    ;If Key Row = 4 "SHFT"
  4388  3ce2  ca3022                JP          Z,NO_ACTION_TAKEN
  4389  3ce5  fedf                  CP          $df                                    ;If Key Row = 5 "CTRL"
  4390  3ce7  ca3022                JP          Z,NO_ACTION_TAKEN
  4391  3cea  c33022                JP          NO_ACTION_TAKEN
  4392  3ced  00                    NOP
  4393                          MAX_HEALTH_ARROWS_FOOD:
  4394  3cee  21933a                LD          HL,PLAYER_PHYS_HEALTH
  4395  3cf1  3e99                  LD          A,$99
  4396  3cf3  77                    LD          (HL),A
  4397  3cf4  23                    INC         HL
  4398  3cf5  77                    LD          (HL),A
  4399  3cf6  23                    INC         HL
  4400  3cf7  77                    LD          (HL),A
  4401  3cf8  23                    INC         HL
  4402  3cf9  77                    LD          (HL),A
  4403  3cfa  23                    INC         HL
  4404  3cfb  77                    LD          (HL),A
  4405  3cfc  23                    INC         HL
  4406  3cfd  77                    LD          (HL),A
  4407  3cfe  21ab3a                LD          HL,FOOD_INV
  4408  3d01  77                    LD          (HL),A
  4409  3d02  23                    INC         HL
  4410  3d03  77                    LD          (HL),A
  4411  3d04  cd153e                CALL        PLAY_POWER_UP_SOUND
  4412  3d07  cd5d3d                CALL        REDRAW_STATS
  4413  3d0a  c39c2a                JP          INPUT_DEBOUNCE
  4414  3d0d  00                    db          $00
  4415  3d0e  00                    db          $00
  4416  3d0f  00                    db          $00
  4417  3d10  00                    db          $00
  4418  3d11  00                    db          $00
  4419  3d12  00                    db          $00
  4420  3d13  00                    db          $00
  4421  3d14  00                    db          $00
  4422  3d15  00                    db          $00
  4423  3d16  00                    db          $00
  4424  3d17  00                    db          $00
  4425  3d18  00                    db          $00
  4426  3d19  00                    db          $00
  4427  3d1a  00                    db          $00
  4428  3d1b  00                    db          $00
  4429  3d1c  00                    db          $00
  4430  3d1d  00                    db          $00
  4431  3d1e  00                    db          $00
  4432  3d1f  00                    db          $00
  4433  3d20  00                    db          $00
  4434  3d21  00                    db          $00
  4435  3d22  00                    db          $00
  4436  3d23  00                    db          $00
  4437  3d24  00                    db          $00
  4438  3d25  00                    db          $00
  4439  3d26  00                    db          $00
  4440  3d27  00                    db          $00
  4441  3d28  00                    db          $00
  4442  3d29  00                    db          $00
  4443  3d2a  00                    db          $00
  4444  3d2b  00                    db          $00
  4445  3d2c  00                    db          $00
  4446  3d2d  00                    db          $00
  4447  3d2e  00                    db          $00
  4448  3d2f  00                    db          $00
  4449                          DO_TELEPORT:
  4450  3d30  3a0039                LD          A,(MAP_LADDER_OFFSET)
  4451  3d33  32793a                LD          (PLAYER_MAP_POS),A
  4452  3d36  cdf03d                CALL        PLAY_TELEPORT_SOUND
  4453  3d39  c3962a                JP          UPDATE_VIEWPORT
  4454  3d3c  00                    db          $00
  4455  3d3d  00                    db          $00
  4456  3d3e  00                    db          $00
  4457  3d3f  00                    db          $00
  4458  3d40  00                    db          $00
  4459  3d41  00                    db          $00
  4460  3d42  00                    db          $00
  4461  3d43  00                    db          $00
  4462  3d44  00                    db          $00
  4463  3d45  00                    db          $00
  4464  3d46  00                    db          $00
  4465  3d47  00                    db          $00
  4466  3d48  00                    db          $00
  4467  3d49  00                    db          $00
  4468  3d4a  00                    db          $00
  4469  3d4b  00                    db          $00
  4470  3d4c  00                    db          $00
  4471  3d4d  00                    db          $00
  4472  3d4e  00                    db          $00
  4473  3d4f  00                    db          $00
  4474  3d50  00                    db          $00
  4475  3d51  00                    db          $00
  4476  3d52  00                    db          $00
  4477  3d53  00                    db          $00
  4478  3d54  00                    db          $00
  4479  3d55  00                    db          $00
  4480  3d56  00                    db          $00
  4481  3d57  00                    db          $00
  4482  3d58  00                    db          $00
  4483  3d59  00                    db          $00
  4484  3d5a  00                    db          $00
  4485  3d5b  00                    db          $00
  4486  3d5c  00                    db          $00
  4487                          REDRAW_STATS:
  4488  3d5d  cd001f                CALL        DRAW_ICON_BAR
  4489  3d60  21933a                LD          HL,PLAYER_PHYS_HEALTH
  4490  3d63  114130                LD          DE,CHRRAM_PHYS_HEALTH_1000              ;= $20
  4491  3d66  0602                  LD          B,0x2
  4492  3d68  cdfd32                CALL        RECALC_AND_REDRAW_BCD
  4493  3d6b  21973a                LD          HL,PLAYER_SPRT_HEALTH
  4494  3d6e  114730                LD          DE,CHRRAM_SPRT_HEALTH_10                ;= $20
  4495  3d71  0601                  LD          B,0x1
  4496  3d73  c3fd32                JP          RECALC_AND_REDRAW_BCD
  4497                          CHECK_RING:
  4498  3d76  f5                    PUSH        AF
  4499  3d77  3a763a                LD          A,(RING_INV_SLOT)
  4500  3d7a  cdd83d                CALL        LEVEL_TO_COLRAM_FIX
  4501  3d7d  321734                LD          (COLRAM_RING_IDX),A                     ;= $60    `
  4502  3d80  f1                    POP         AF
  4503  3d81  c9                    RET
  4504  3d82  00                    db          $00
  4505  3d83  00                    db          $00
  4506  3d84  00                    db          $00
  4507  3d85  00                    db          $00
  4508  3d86  00                    db          $00
  4509  3d87  00                    db          $00
  4510  3d88  00                    db          $00
  4511  3d89  00                    db          $00
  4512  3d8a  00                    db          $00
  4513  3d8b  00                    db          $00
  4514  3d8c  00                    db          $00
  4515  3d8d  00                    db          $00
  4516  3d8e  00                    db          $00
  4517  3d8f  00                    db          $00
  4518  3d90  00                    db          $00
  4519  3d91  00                    db          $00
  4520  3d92  00                    db          $00
  4521  3d93  00                    db          $00
  4522  3d94  00                    db          $00
  4523  3d95  00                    db          $00
  4524  3d96  00                    db          $00
  4525  3d97  00                    db          $00
  4526                          CHECK_HELMET:
  4527  3d98  f5                    PUSH        AF
  4528  3d99  3a753a                LD          A,(HELMET_INV_SLOT)
  4529  3d9c  cdd83d                CALL        LEVEL_TO_COLRAM_FIX
  4530  3d9f  321534                LD          (COLRAM_HELMET_IDX),A                   ;= $60    `
  4531  3da2  f1                    POP         AF
  4532  3da3  c9                    RET
  4533  3da4  00                    db          $00
  4534  3da5  00                    db          $00
  4535  3da6  00                    db          $00
  4536  3da7  00                    db          $00
  4537  3da8  00                    db          $00
  4538  3da9  00                    db          $00
  4539  3daa  00                    db          $00
  4540  3dab  00                    db          $00
  4541  3dac  00                    db          $00
  4542  3dad  00                    db          $00
  4543  3dae  00                    db          $00
  4544  3daf  00                    db          $00
  4545  3db0  00                    db          $00
  4546  3db1  00                    db          $00
  4547  3db2  00                    db          $00
  4548  3db3  00                    db          $00
  4549  3db4  00                    db          $00
  4550  3db5  00                    db          $00
  4551  3db6  00                    db          $00
  4552  3db7  00                    db          $00
  4553                          CHECK_ARMOR:
  4554  3db8  f5                    PUSH        AF
  4555  3db9  3a743a                LD          A,(ARMOR_INV_SLOT)
  4556  3dbc  cdd83d                CALL        LEVEL_TO_COLRAM_FIX
  4557  3dbf  321334                LD          (COLRAM_ARMOR_IDX),A                    ;= $60    `
  4558  3dc2  f1                    POP         AF
  4559  3dc3  c9                    RET
  4560  3dc4  00                    db          $00
  4561  3dc5  00                    db          $00
  4562  3dc6  00                    db          $00
  4563  3dc7  00                    db          $00
  4564  3dc8  00                    db          $00
  4565  3dc9  00                    db          $00
  4566  3dca  00                    db          $00
  4567  3dcb  00                    db          $00
  4568  3dcc  00                    db          $00
  4569  3dcd  00                    db          $00
  4570  3dce  00                    db          $00
  4571  3dcf  00                    db          $00
  4572  3dd0  00                    db          $00
  4573  3dd1  00                    db          $00
  4574  3dd2  00                    db          $00
  4575  3dd3  00                    db          $00
  4576  3dd4  00                    db          $00
  4577  3dd5  00                    db          $00
  4578  3dd6  00                    db          $00
  4579  3dd7  00                    db          $00
  4580                          LEVEL_TO_COLRAM_FIX:
  4581  3dd8  87                    ADD         A,A
  4582  3dd9  d601                  SUB         0x1
  4583  3ddb  cb27                  SLA         A
  4584  3ddd  cb27                  SLA         A
  4585  3ddf  cb27                  SLA         A
  4586  3de1  cb27                  SLA         A
  4587  3de3  c9                    RET
  4588                          RHA_REDRAW:
  4589  3de4  cd763d                CALL        CHECK_RING
  4590  3de7  cd983d                CALL        CHECK_HELMET
  4591  3dea  cdb83d                CALL        CHECK_ARMOR
  4592  3ded  c39c2a                JP          INPUT_DEBOUNCE
  4593                          PLAY_TELEPORT_SOUND:
  4594  3df0  012002                LD          BC,$220
  4595  3df3  111800                LD          DE,$18
  4596  3df6  cd3c22                CALL        PLAY_SOUND_LOOP
  4597  3df9  011001                LD          BC,$110
  4598  3dfc  111800                LD          DE,$18
  4599  3dff  cd3c22                CALL        PLAY_SOUND_LOOP
  4600  3e02  018800                LD          BC,$88
  4601  3e05  111800                LD          DE,$18
  4602  3e08  cd3c22                CALL        PLAY_SOUND_LOOP
  4603  3e0b  014400                LD          BC,$44
  4604  3e0e  111800                LD          DE,$18
  4605  3e11  cd3c22                CALL        PLAY_SOUND_LOOP
  4606  3e14  c9                    RET
  4607                          PLAY_POWER_UP_SOUND:
  4608  3e15  012002                LD          BC,$220
  4609  3e18  111800                LD          DE,$18
  4610  3e1b  cd3c22                CALL        PLAY_SOUND_LOOP
  4611  3e1e  010002                LD          BC,$200
  4612  3e21  111800                LD          DE,$18
  4613  3e24  cd3c22                CALL        PLAY_SOUND_LOOP
  4614  3e27  01e001                LD          BC,$1e0
  4615  3e2a  111800                LD          DE,$18
  4616  3e2d  cd3c22                CALL        PLAY_SOUND_LOOP
  4617  3e30  01c001                LD          BC,$1c0
  4618  3e33  116000                LD          DE,$60
  4619  3e36  cd3c22                CALL        PLAY_SOUND_LOOP
  4620  3e39  c9                    RET
  4621  3e3a  00                    db          $00
  4622  3e3b  00                    db          $00
  4623  3e3c  00                    db          $00
  4624  3e3d  00                    db          $00
  4625  3e3e  00                    db          $00
  4626  3e3f  00                    db          $00
  4627  3e40  00                    db          $00
  4628  3e41  00                    db          $00
  4629  3e42  00                    db          $00
  4630  3e43  00                    db          $00
  4631  3e44  00                    db          $00
  4632  3e45  00                    db          $00
  4633  3e46  00                    db          $00
  4634  3e47  00                    db          $00
  4635  3e48  00                    db          $00
  4636  3e49  00                    db          $00
  4637  3e4a  00                    db          $00
  4638  3e4b  00                    db          $00
  4639  3e4c  00                    db          $00
  4640  3e4d  00                    db          $00
  4641  3e4e  00                    db          $00
  4642  3e4f  00                    db          $00
  4643  3e50  00                    db          $00
  4644  3e51  00                    db          $00
  4645  3e52  00                    db          $00
  4646  3e53  00                    db          $00
  4647  3e54  00                    db          $00
  4648  3e55  00                    db          $00
  4649  3e56  00                    db          $00
  4650  3e57  00                    db          $00
  4651  3e58  00                    db          $00
  4652  3e59  00                    db          $00
  4653  3e5a  00                    db          $00
  4654  3e5b  00                    db          $00
  4655  3e5c  00                    db          $00
  4656  3e5d  00                    db          $00
  4657  3e5e  00                    db          $00
  4658  3e5f  00                    db          $00
  4659  3e60  00                    db          $00
  4660  3e61  00                    db          $00
  4661  3e62  00                    db          $00
  4662  3e63  00                    db          $00
  4663  3e64  00                    db          $00
  4664  3e65  00                    db          $00
  4665  3e66  00                    db          $00
  4666  3e67  00                    db          $00
  4667  3e68  00                    db          $00
  4668  3e69  00                    db          $00
  4669  3e6a  00                    db          $00
  4670  3e6b  00                    db          $00
  4671  3e6c  00                    db          $00
  4672  3e6d  00                    db          $00
  4673  3e6e  00                    db          $00
  4674  3e6f  00                    db          $00
  4675  3e70  00                    db          $00
  4676  3e71  00                    db          $00
  4677  3e72  00                    db          $00
  4678  3e73  00                    db          $00
  4679  3e74  00                    db          $00
  4680  3e75  00                    db          $00
  4681  3e76  00                    db          $00
  4682  3e77  00                    db          $00
  4683  3e78  00                    db          $00
  4684  3e79  00                    db          $00
  4685  3e7a  00                    db          $00
  4686  3e7b  00                    db          $00
  4687  3e7c  00                    db          $00
  4688  3e7d  00                    db          $00
  4689  3e7e  00                    db          $00
  4690  3e7f  00                    db          $00
  4691  3e80  00                    db          $00
  4692  3e81  00                    db          $00
  4693  3e82  00                    db          $00
  4694  3e83  00                    db          $00
  4695  3e84  00                    db          $00
  4696  3e85  00                    db          $00
  4697  3e86  00                    db          $00
  4698  3e87  00                    db          $00
  4699  3e88  00                    db          $00
  4700  3e89  00                    db          $00
  4701  3e8a  00                    db          $00
  4702  3e8b  00                    db          $00
  4703  3e8c  00                    db          $00
  4704  3e8d  00                    db          $00
  4705  3e8e  00                    db          $00
  4706  3e8f  00                    db          $00
  4707  3e90  00                    db          $00
  4708  3e91  00                    db          $00
  4709  3e92  00                    db          $00
  4710  3e93  00                    db          $00
  4711  3e94  00                    db          $00
  4712  3e95  00                    db          $00
  4713  3e96  00                    db          $00
  4714  3e97  00                    db          $00
  4715  3e98  00                    db          $00
  4716  3e99  00                    db          $00
  4717  3e9a  00                    db          $00
  4718  3e9b  00                    db          $00
  4719  3e9c  00                    db          $00
  4720  3e9d  00                    db          $00
  4721  3e9e  00                    db          $00
  4722  3e9f  00                    db          $00
  4723  3ea0  00                    db          $00
  4724  3ea1  00                    db          $00
  4725  3ea2  00                    db          $00
  4726  3ea3  00                    db          $00
  4727  3ea4  00                    db          $00
  4728  3ea5  00                    db          $00
  4729  3ea6  00                    db          $00
  4730  3ea7  00                    db          $00
  4731  3ea8  00                    db          $00
  4732  3ea9  00                    db          $00
  4733  3eaa  00                    db          $00
  4734  3eab  00                    db          $00
  4735  3eac  00                    db          $00
  4736  3ead  00                    db          $00
  4737  3eae  00                    db          $00
  4738  3eaf  00                    db          $00
  4739  3eb0  00                    db          $00
  4740  3eb1  00                    db          $00
  4741  3eb2  00                    db          $00
  4742  3eb3  00                    db          $00
  4743  3eb4  00                    db          $00
  4744  3eb5  00                    db          $00
  4745  3eb6  00                    db          $00
  4746  3eb7  00                    db          $00
  4747  3eb8  00                    db          $00
  4748  3eb9  00                    db          $00
  4749  3eba  00                    db          $00
  4750  3ebb  00                    db          $00
  4751  3ebc  00                    db          $00
  4752  3ebd  00                    db          $00
  4753  3ebe  00                    db          $00
  4754  3ebf  00                    db          $00
  4755  3ec0  00                    db          $00
  4756  3ec1  00                    db          $00
  4757  3ec2  00                    db          $00
  4758  3ec3  00                    db          $00
  4759  3ec4  00                    db          $00
  4760  3ec5  00                    db          $00
  4761  3ec6  00                    db          $00
  4762  3ec7  00                    db          $00
  4763  3ec8  00                    db          $00
  4764  3ec9  00                    db          $00
  4765  3eca  00                    db          $00
  4766  3ecb  00                    db          $00
  4767  3ecc  00                    db          $00
  4768  3ecd  00                    db          $00
  4769  3ece  00                    db          $00
  4770  3ecf  00                    db          $00
  4771  3ed0  00                    db          $00
  4772  3ed1  00                    db          $00
  4773  3ed2  00                    db          $00
  4774  3ed3  00                    db          $00
  4775  3ed4  00                    db          $00
  4776  3ed5  00                    db          $00
  4777  3ed6  00                    db          $00
  4778  3ed7  00                    db          $00
  4779  3ed8  00                    db          $00
  4780  3ed9  00                    db          $00
  4781  3eda  00                    db          $00
  4782  3edb  00                    db          $00
  4783  3edc  00                    db          $00
  4784  3edd  00                    db          $00
  4785  3ede  00                    db          $00
  4786  3edf  00                    db          $00
  4787  3ee0  00                    db          $00
  4788  3ee1  00                    db          $00
  4789  3ee2  00                    db          $00
  4790  3ee3  00                    db          $00
  4791  3ee4  00                    db          $00
  4792  3ee5  00                    db          $00
  4793  3ee6  00                    db          $00
  4794  3ee7  00                    db          $00
  4795  3ee8  00                    db          $00
  4796  3ee9  00                    db          $00
  4797  3eea  00                    db          $00
  4798  3eeb  00                    db          $00
  4799  3eec  00                    db          $00
  4800  3eed  00                    db          $00
  4801  3eee  00                    db          $00
  4802  3eef  00                    db          $00
  4803  3ef0  00                    db          $00
  4804  3ef1  00                    db          $00
  4805  3ef2  00                    db          $00
  4806  3ef3  00                    db          $00
  4807  3ef4  00                    db          $00
  4808  3ef5  00                    db          $00
  4809  3ef6  00                    db          $00
  4810  3ef7  00                    db          $00
  4811  3ef8  00                    db          $00
  4812  3ef9  00                    db          $00
  4813  3efa  00                    db          $00
  4814  3efb  00                    db          $00
  4815  3efc  00                    db          $00
  4816  3efd  00                    db          $00
  4817  3efe  00                    db          $00
  4818                          GFX_POINTERS:
  4819  3eff  00                    db          0h
  4820                          GFX_PTR_BUCKLER:
  4821  3f00  520a                  dw        BUCKLER                                 ;= $01,$01,$01,$01,$01
  4822                          GFX_PTR_BUCKLER_S:
  4823  3f02  650a                  dw        BUCKLER_S                               ;= $01,$01
  4824                          GFX_PTR_BUCKLER_T:
  4825  3f04  6a0a                  dw        BUCKLER_T                               ;= $00,$87,$FF
  4826                          GFX_PTR_RING:
  4827  3f06  080a                  dw        RING                                    ;= $01,$01,$01,$01,$01,$01,$01
  4828                          GFX_PTR_RING_S:
  4829  3f08  120a                  dw        RING_S                                  ;= $01,$01,$01
  4830                          GFX_PTR_RING_T:
  4831  3f0a  180a                  dw        RING_T                                  ;= $00,".",$FF
  4832                          GFX_PTR_HELMET:
  4833  3f0c  8b0a                  dw        HELMET                                  ;= $01,$01,$01,$01,$01,$01
  4834                          GFX_PTR_HELMET_S:
  4835  3f0e  990a                  dw        HELMET_S                                ;= $01,$01,$01
  4836                          GFX_PTR_HELMET_T:
  4837  3f10  a30a                  dw        HELMET_T                                ;= $00,"^",$FF
  4838                          GFX_PTR_ARMOR:
  4839  3f12  b20b                  dw        ARMOR                                   ;= $01,$01,$01,$01,$01
  4840                          GFX_PTR_ARMOR_S:
  4841  3f14  ca0b                  dw        ARMOR_S                                 ;= $01,$01
  4842                          GFX_PTR_ARMOR_T:
  4843  3f16  db0b                  dw        ARMOR_T                                 ;= $00,$A0,$C7,$D9,$01
  4844                          GFX_PTR_PAVISE:
  4845  3f18  e50b                  dw        PAVICE                                  ;= $01,$01,$01,$01,$01
  4846                          GFX_PTR_PAVISE_S:
  4847  3f1a  fd0b                  dw        PAVICE_S                                ;= $01,$01
  4848                          GFX_PTR_PAVISE_T:
  4849  3f1c  0b0c                  dw        PAVICE_T                                ;= $00,$7F,$01
  4850                          GFX_PTR_ARROW_L:
  4851  3f1e  1b0a                  dw        ARROW_FLYING_LEFT                       ;= $01,$01,$01,$01,$01,$01
  4852                          GFX_PTR_ARROW_R:
  4853  3f20  240a                  dw        ARROW_FLYING_RIGHT                      ;= $01,$01,$01,$01,$01,$01
  4854                          GFX_PTR_ARROW_L_2:
  4855  3f22  1b0a                  dw        ARROW_FLYING_LEFT                       ;= $01,$01,$01,$01,$01,$01
  4856                          GFX_PTR_BOW:
  4857  3f24  c10a                  dw        BOW                                     ;= $01,$01,$01,$01,$01
  4858                          GFX_PTR_BOW_S:
  4859  3f26  d50a                  dw        BOW_S                                   ;= $01,$01
  4860                          GFX_PTR_BOW_T:
  4861  3f28  e00a                  dw        BOW_T                                   ;= $00,"{",$FF
  4862                          GFX_PTR_SCROLL:
  4863  3f2a  9a18                  dw        SCROLL                                  ;= $01,$01,$01,$01,$01
  4864                          GFX_PTR_SCROLL_S:
  4865  3f2c  b518                  dw        SCROLL_S                                ;= $01,$01
  4866                          GFX_PTR_SCROLL_NEW_T:
  4867  3f2e  bf18                  dw        SCROLL_T                                ;= $00,"H",$FF
  4868                          GFX_PTR_AXE:
  4869  3f30  e30a                  dw        AXE                                     ;= $01,$01,$01,$01,$01
  4870                          GFX_PTR_AXE_S:
  4871  3f32  f80a                  dw        AXE_S                                   ;= $01,$01
  4872                          GFX_PTR_AXE_T:
  4873  3f34  080b                  dw        AXE_T                                   ;= $00,$11,$FF
  4874                          GFX_PTR_FIREBALL:
  4875  3f36  eb0c                  dw        FIREBALL                                ;= $01,$01,$01,$01,$01
  4876                          GFX_PTR_FIREBALL_S:
  4877  3f38  fc0c                  dw        FIREBALL_S                              ;= $01,$01
  4878                          GFX_PTR_FIREBALL_T:
  4879  3f3a  010d                  dw        FIREBALL_T                              ;= $00,$D3,$FF
  4880                          GFX_PTR_MACE:
  4881  3f3c  bb0c                  dw        MACE                                    ;= $01,$01,$01,$01,$01
  4882                          GFX_PTR_MACE_S:
  4883  3f3e  d60c                  dw        MACE_S                                  ;= $01,$01
  4884                          GFX_PTR_MACE_T:
  4885  3f40  e80c                  dw        MACE_T                                  ;= $00,"T",$FF
  4886                          GFX_PTR_STAFF:
  4887  3f42  7b18                  dw        STAFF                                   ;= $01,$01,$01,$01,$01
  4888                          GFX_PTR_STAFF_S:
  4889  3f44  8e18                  dw        STAFF_S                                 ;= $01,$01
  4890                          GFX_PTR_STAFF_T:
  4891  3f46  9718                  dw        STAFF_T                                 ;= $00,"\\",$FF
  4892                          GFX_PTR_CROSSBOW:
  4893  3f48  c218                  dw        CROSSBOW                                ;= $01,$01,$01,$01,$01
  4894                          GFX_PTR_CROSSBOW_S:
  4895  3f4a  e518                  dw        CROSSBOW_S                              ;= $01,$01
  4896                          GFX_PTR_CROSSBOW_T:
  4897  3f4c  ed18                  dw        CROSSBOW_T                              ;= $A0,$91,$A0,$D8,$02,$04,$90,$FF
  4898  3f4e  5600                  dw        EXCL_MARK_GFX
  4899  3f50  5600                  dw        EXCL_MARK_GFX
  4900  3f52  5600                  dw        EXCL_MARK_GFX
  4901  3f54  5600                  dw        EXCL_MARK_GFX
  4902  3f56  5600                  dw        EXCL_MARK_GFX
  4903  3f58  5600                  dw        EXCL_MARK_GFX
  4904                          GFX_PTR_ARROW_R_2:
  4905  3f5a  240a                  dw        ARROW_FLYING_RIGHT                      ;= $01,$01,$01,$01,$01,$01
  4906  3f5c  5600                  dw        EXCL_MARK_GFX
  4907  3f5e  5600                  dw        EXCL_MARK_GFX
  4908                          GFX_PTR_LADDER:
  4909  3f60  8e0c                  dw        LADDER                                  ;= $01,$01,$01,$01,$01
  4910                          GFX_PTR_LADDER_S:
  4911  3f62  a70c                  dw        LADDER_S                                ;= $01,$01
  4912                          GFX_PTR_LADDER_T:
  4913  3f64  b70c                  dw        LADDER_T                                ;= $00,$CD,$97,$FF
  4914                          GFX_PTR_CHEST:
  4915  3f66  5f0b                  dw        CHEST                                   ;= $01,$01,$01,$01,$01
  4916                          GFX_PTR_CHEST_S:
  4917  3f68  9d0b                  dw        CHEST_S                                 ;= $01,$E0,$1F,$1F,$B0,$01
  4918                          GFX_PTR_CHEST_T:
  4919  3f6a  af0b                  dw        CHEST_T                                 ;= $00,$FC,$FF
  4920                          GFX_PTR_FOOD:
  4921  3f6c  0b0b                  dw        FOOD                                    ;= $01,$01,$01,$01,$01
  4922                          GFX_PTR_FOOD_S:
  4923  3f6e  220b                  dw        FOOD_S                                  ;= $01,$01
  4924                          GFX_PTR_FOOD_T:
  4925  3f70  2c0b                  dw        FOOD_T                                  ;= $00,"#",$FF
  4926                          GFX_PTR_QUIVER:
  4927  3f72  2d0a                  dw        QUIVER                                  ;= $01,$01,$01,$01,$01,$01
  4928                          GFX_PTR_QUIVER_S:
  4929  3f74  440a                  dw        QUIVER_S                                ;= $01,$01
  4930                          GFX_PTR_QUIVER_T:
  4931  3f76  4f0a                  dw        QUIVER_T                                ;= $00,$F0,$FF
  4932                          GFX_PTR_LOCK_CHEST:
  4933  3f78  7e0b                  dw        LOCKED_CHEST                            ;= $01,$01,$01,$01,$01
  4934                          GFX_PTR_LOCK_CHEST_S:
  4935  3f7a  9d0b                  dw        CHEST_S                                 ;= $01,$E0,$1F,$1F,$B0,$01
  4936                          GFX_PTR_LOCK_CHEST_T:
  4937  3f7c  af0b                  dw        CHEST_T                                 ;= $00,$FC,$FF
  4938  3f7e  5600                  dw        EXCL_MARK_GFX
  4939  3f80  5600                  dw        EXCL_MARK_GFX
  4940  3f82  5600                  dw        EXCL_MARK_GFX
  4941                          GFX_PTR_KEY:
  4942  3f84  a60a                  dw        KEY                                     ;= $01,$01,$01,$01,$01,$01
  4943                          GFX_PTR_KEY_S:
  4944  3f86  b80a                  dw        KEY_S                                   ;= $01,$01,$01
  4945                          GFX_PTR_KEY_T:
  4946  3f88  be0a                  dw        KEY_T                                   ;= $FF,"-",$FF
  4947                          GFX_PTR_AMULET:
  4948  3f8a  630c                  dw        AMULET                                  ;= $01,$01,$01,$01,$01
  4949                          GFX_PTR_AMULET_S:
  4950  3f8c  7b0c                  dw        AMULET_S                                ;= $01,$01
  4951                          GFX_PTR_AMULET_T:
  4952  3f8e  8b0c                  dw        AMULET_T                                ;= $00,"&",$FF
  4953                          GFX_PTR_CHALICE:
  4954  3f90  6d0a                  dw        CHALICE                                 ;= $01,$01,$01,$01,$01,$01
  4955                          GFX_PTR_CHALICE_S:
  4956  3f92  800a                  dw        CHALICE_S                               ;= $01,$01
  4957                          GFX_PTR_CHALICE_T:
  4958  3f94  880a                  dw        CHALICE_T                               ;= $00,"Y",$FF
  4959                          GFX_PTR_WARRIOR_POTION:
  4960  3f96  f518                  dw        WARRIOR_POTION                          ;= $01,$01,$01,$01,$01
  4961                          GFX_PTR_WARRIOR_POTION_S:
  4962  3f98  3419                  dw        WARRIOR_POTION_S                        ;= $01,$01
  4963                          GFX_PTR_WARRIOR_POTION_T:
  4964  3f9a  5519                  dw        POTION_T                                ;= $00,"U",$02,$04,"_",$FF
  4965                          GFX_PTR_MAGE_POTION:
  4966  3f9c  0a19                  dw        MAGE_POTION                             ;= $01,$01,$01,$01,$01
  4967                          GFX_PTR_MAGE_POTION_S:
  4968  3f9e  3f19                  dw        MAGE_POTION_S                           ;= $01,$01
  4969                          GFX_PTR_MAGE_POTION_T:
  4970  3fa0  5519                  dw        POTION_T                                ;= $00,"U",$02,$04,"_",$FF
  4971                          GFX_PTR_MAP:
  4972  3fa2  2f0b                  dw        MAP                                     ;= $01,$01,$01,$01,$01
  4973                          GFX_PTR_MAP_S:
  4974  3fa4  4e0b                  dw        MAP_S                                   ;= $01,$01
  4975                          GFX_PTR_MAP_T:
  4976  3fa6  5c0b                  dw        MAP_T                                   ;= $00,$D5,$FF
  4977                          GFX_PTR_CHAOS_POTION:
  4978  3fa8  1f19                  dw        CHAOS_POTION                            ;= $01,$01,$01,$01,$01
  4979                          GFX_PTR_CHAOS_POTION_S:
  4980  3faa  4a19                  dw        CHAOS_POTION_S                          ;= $01,$01
  4981                          GFX_PTR_CHAOS_POTION_T:
  4982  3fac  5519                  dw        POTION_T                                ;= $00,"U",$02,$04,"_",$FF
  4983  3fae  5600                  dw        EXCL_MARK_GFX
  4984  3fb0  5600                  dw        EXCL_MARK_GFX
  4985  3fb2  5600                  dw        EXCL_MARK_GFX
  4986                          GFX_END_PT1:
  4987  3fb4  0008                  dw        NO_GFX                                  ;= $FF
  4988                          GFX_PTR_SKELETON:
  4989  3fb6  b50e                  dw        SKELETON                                ;= $04,$04,$04,$04
  4990                          GFX_PTR_SKELETON_S:
  4991  3fb8  f30e                  dw        SKELETON_S                              ;= $04,$04,$04
  4992  3fba  0008                  dw        NO_GFX                                  ;= $FF
  4993                          GFX_PTR_SNAKE:
  4994  3fbc  5c0e                  dw        SNAKE                                   ;= $04,$04,$04
  4995                          GFX_PTR_SNAKE_S:
  4996  3fbe  9d0e                  dw        SNAKE_S                                 ;= $04,$04,$04
  4997  3fc0  0008                  dw        NO_GFX                                  ;= $FF
  4998                          GFX_PTR_SPIDER:
  4999  3fc2  200d                  dw        SPIDER                                  ;= $04,$04
  5000                          GFX_PTR_SPIDER_S:
  5001  3fc4  510d                  dw        SPIDER_S                                ;= $04,$04,$04,$04
  5002  3fc6  0008                  dw        NO_GFX                                  ;= $FF
  5003                          GFX_PTR_MIMIC:
  5004  3fc8  6a0d                  dw        MIMIC                                   ;= $04,$02,$D7,$96,$00,$00,$96,$C9,$01
  5005                          GFX_PTR_MIMIC_S:
  5006  3fca  9d0d                  dw        MIMIC_S                                 ;= $01,$E0,$1F,$1F,$B0,$01
  5007  3fcc  0008                  dw        NO_GFX                                  ;= $FF
  5008                          GFX_PTR_MALOCCHIO:
  5009  3fce  af0d                  dw        MALOCCHIO                               ;= $04,$04,$04,$04
  5010                          GFX_PTR_MALOCCHIO_S:
  5011  3fd0  e50d                  dw        MALOCCHIO_S                             ;= $04,$04,$04,$04
  5012  3fd2  0008                  dw        NO_GFX                                  ;= $FF
  5013                          GFX_PTR_DRAGON:
  5014  3fd4  0108                  dw        DRAGON                                  ;= $04,$04,$04,$04
  5015                          GFX_PTR_DRAGON_S:
  5016  3fd6  6d08                  dw        DRAGON_S                                ;= $04,$04,$04,$C9,$C9,$C0,$C0,$01
  5017                          GFX_PTR_END_A:
  5018  3fd8  0008                  dw        NO_GFX                                  ;= $FF
  5019                          GFX_PTR_MUMMY:
  5020  3fda  090f                  dw        MUMMY                                   ;= $04,$04,$04,$04
  5021                          GFX_PTR_MUMMY_S:
  5022  3fdc  6c0f                  dw        MUMMY_S                                 ;= $04,$04,$04
  5023                          GFX_PTR_END_B:
  5024  3fde  0008                  dw        NO_GFX                                  ;= $FF
  5025                          GFX_PTR_NECRO:
  5026  3fe0  850f                  dw        NECROMANCER                             ;= $04,$04,$04,$04
  5027                          GFX_PTR_NECRO_S:
  5028  3fe2  e00f                  dw        NECROMANCER_S                           ;= $04,$04,$04
  5029                          GFX_PTR_END_C:
  5030  3fe4  0008                  dw        NO_GFX                                  ;= $FF
  5031                          GFX_PTR_GRYPHON:
  5032  3fe6  0118                  dw        GRYPHON                                 ;= $04,$04,$04,$04
  5033                          GFX_PTR_GRYPHON_S:
  5034  3fe8  6118                  dw        GRYPHON_S                               ;= $04,$04,$04,$B8,$B8,$B0,$01
  5035                          GFX_PTR_END_D:
  5036  3fea  0008                  dw        NO_GFX                                  ;= $FF
  5037                          GFX_PTR_MINOTAUR:
  5038  3fec  ff0d                  dw        MINOTAUR                                ;= $04,$04,$04,$04
  5039                          GFX_PTR_MINOTAUR_S:
  5040  3fee  460e                  dw        MINOTAUR_S                              ;= $04,$04,$04,$04
  5041                          
  5042  3ff0  0000000000000000      defs         $4000 - $, $00
              0000000000000000  
  5043                          
  5044                              ; db        $00
  5045                              ; db        $00
  5046                              ; db        $00
  5047                              ; db        $00
  5048                              ; db        $00
  5049                              ; db        $00
  5050                              ; db        $00
  5051                              ; db        $00
  5052                              ; db        $00
  5053                              ; db        $00
  5054                              ; db        $00
  5055                              ; db        $00
  5056                              ; db        $00
  5057                              ; db        $00
  5058                              ; db        $00
  5059                              ; db        $00
  5060                          
  5061                          ;    ds 16, $00
  5062                          
src/asterion.asm:
    20                          
