src/asterion.asm:
     1                          INCLUDE "aquarius.inc"
src/aquarius.inc:
     1                          ; Aquarius SYSROM Routines
     2                          SLEEP_ZERO EQU $1d48
     3                          SLEEP EQU $1d4b
     4                          FILL_FULL_1024 EQU $1e59
     5                          
     6                          ; CHRRAM - Character RAM
     7                          CHRRAM EQU $3000
     8                          
     9                          ; COLRAM: Color RAM
    10                          COLRAM EQU $3400
    11                          
    12                          ; Aquarius IO ports
    13                          MODEM_A EQU $7E
    14                          MODEM_B EQU $7F
    15                          CONTROL_PADS EQU $F6
    16                          PSG EQU $F7
    17                          SPEAKER EQU $FC
    18                          VSYNC EQU $FD
    19                          PRINTER EQU $FE
    20                          KEYBOARD EQU $FF
    21                          
src/asterion.asm:
     2                          INCLUDE "asterion.inc"
src/asterion.inc:
     1                          ; CHRRAM - Character RAM
     2                          CHRRAM_LEVEL_IND_L EQU $3001
     3                          CHRRAM_LEVEL_IND_R EQU $3004
     4                          CHRRAM_SHIFT_MODE_IDX EQU $3005
     5                          CHRRAM_LADDER_IDX EQU $3007
     6                          CHRRAM_ITEM_IDX EQU $3009
     7                          CHRRAM_MONSTER_IDX EQU $300b
     8                          CHRRAM_DOOR_IDX EQU $300d
     9                          CHRRAM_MAP_IDX EQU $3011
    10                          CHRRAM_ARMOR_IDX EQU $3013
    11                          CHRRAM_HELMET_IDX EQU $3015
    12                          CHRRAM_RING_IDX EQU $3017
    13                          IDX_VIEWPORT_CHRRAM EQU $3028
    14                          DAT_ram_3050 EQU $3050
    15                          CHRRAM_WALL_F0_IDX EQU $30cc
    16                          DAT_ram_3168 EQU $3168
    17                          CHRRAM_L1_DOOR_IDX EQU $316d
    18                          DAT_ram_3177 EQU $3177
    19                          DAT_ram_317a EQU $317a
    20                          DAT_ram_317f EQU $317f
    21                          DAT_ram_3191 EQU $3191
    22                          DAT_ram_3196 EQU $3196
    23                          DAT_ram_31a1 EQU $31a1
    24                          DAT_ram_31a6 EQU $31a6
    25                          CHRRAM_POINTER_IDX EQU $31d8
    26                          DAT_ram_3259 EQU $3259
    27                          DAT_ram_3266 EQU $3266
    28                          DAT_ram_326e EQU $326e
    29                          DAT_ram_3280 EQU $3280
    30                          DAT_ram_3297 EQU $3297
    31                          
    32                          ; CHRRAM Spare 24
    33                          WALL_F0_STATE EQU $33e8
    34                          WALL_F1_STATE EQU $33e9
    35                          WALL_F2_STATE EQU $33ea
    36                          WALL_F3_STATE EQU $33eb
    37                          DAT_ram_33ec EQU $33ec
    38                          DAT_ram_33ed EQU $33ed
    39                          DAT_ram_33ee EQU $33ee
    40                          DAT_ram_33ef EQU $33ef
    41                          DAT_ram_33f0 EQU $33f0
    42                          DAT_ram_33f1 EQU $33f1
    43                          DAT_ram_33f2 EQU $33f2
    44                          DAT_ram_33f3 EQU $33f3
    45                          DAT_ram_33f4 EQU $33f4
    46                          DAT_ram_33f5 EQU $33f5
    47                          DAT_ram_33f6 EQU $33f6
    48                          DAT_ram_33f7 EQU $33f7
    49                          DAT_ram_33f9 EQU $33f9
    50                          DAT_ram_33fa EQU $33fa
    51                          DAT_ram_33fb EQU $33fb
    52                          DAT_ram_33fd EQU $33fd
    53                          
    54                          ; COLRAM: Color RAM
    55                          COLRAM_LEVEL_IDX_L EQU $3401
    56                          COLRAM_FLOOR_IDX_10 EQU $3402
    57                          COLRAM_FLOOR_IDX_1 EQU $3403
    58                          COLRAM_LEVEL_IDX_R EQU $3404
    59                          COLRAM_ARMOR_IDX EQU $3413
    60                          COLRAM_HELMET_IDX EQU $3415
    61                          COLRAM_RING_IDX EQU $3417
    62                          COLRAM_PHYS_STATS_1000 EQU $3441
    63                          COLRAM_SPRT_STATS_10 EQU $3446
    64                          DAT_ram_3568 EQU $3568
    65                          COLRAM_F0_DOOR_IDX EQU $3570
    66                          DAT_ram_357f EQU $357f
    67                          DAT_ram_3590 EQU $3590
    68                          DAT_ram_3591 EQU $3591
    69                          DAT_ram_35a6 EQU $35a6
    70                          DAT_ram_35a7 EQU $35a7
    71                          DAT_ram_35d8 EQU $35d8
    72                          DAT_ram_35e0 EQU $35e0
    73                          DAT_ram_35e1 EQU $35e1
    74                          DAT_ram_35f6 EQU $35f6
    75                          DAT_ram_35f7 EQU $35f7
    76                          DAT_ram_3608 EQU $3608
    77                          DAT_ram_361f EQU $361f
    78                          DAT_ram_3728 EQU $3728
    79                          
    80                          ; COLRAM Spare 24
    81                          ITEM_F2 EQU $37e8
    82                          ITEM_F1 EQU $37e9
    83                          ITEM_F0 EQU $37ea
    84                          ITEM_FL1 EQU $37eb
    85                          ITEM_FR1 EQU $37ec
    86                          ITEM_R1 EQU $37ed
    87                          ITEM_L1 EQU $37ee
    88                          ITEM_B1 EQU $37ef
    89                          KEY_INPUT_COL0 EQU $37f6
    90                          KEY_INPUT_COL1 EQU $37f7
    91                          KEY_INPUT_COL2 EQU $37f8
    92                          KEY_INPUT_COL3 EQU $37f9
    93                          KEY_INPUT_COL4 EQU $37fa
    94                          KEY_INPUT_COL5 EQU $37fb
    95                          KEY_INPUT_COL6 EQU $37fc
    96                          KEY_INPUT_COL7 EQU $37fd
    97                          HC_INPUT_HOLDER EQU $37fe
    98                          
    99                          ; Aquarius Built-In 2k RAM Space
   100                          MAPSPACE_WALLS EQU $3800
   101                          MAP_LADDER_OFFSET EQU $3900
   102                          LADDER_POS EQU $3901
   103                          MAP_ITEM_SPACE EQU $3902
   104                          BYTE_ram_3903 EQU $3903
   105                          BYTE_ram_3904 EQU $3904
   106                          BYTE_ram_3905 EQU $3905
   107                          BYTE_ram_3906 EQU $3906
   108                          ITEM_MOVE_CHR_BUFFER EQU $3a00
   109                          ITEM_MOVE_COL_BUFFER EQU $3a10
   110                          BYTE_ram_3a20 EQU $3a20
   111                          BYTE_ram_3a58 EQU $3a58
   112                          DIR_FACING_FW EQU $3a60
   113                          DIR_FACING_BW EQU $3a61
   114                          DIR_FACING_SHORT EQU $3a62
   115                          MON_FS EQU $3a63
   116                          RAM_AC EQU $3a64
   117                          RAM_AD EQU $3a65
   118                          RAM_AE EQU $3a66
   119                          RAM_AF EQU $3a67
   120                          DUNGEON_LEVEL EQU $3a68
   121                          TIMER_A EQU $3a69
   122                          TIMER_B EQU $3a6a
   123                          TIMER_C EQU $3a6b
   124                          TIMER_D EQU $3a88
   125                          TIMER_E EQU $3a9c
   126                          
   127                          INPUT_HOLDER EQU $3a6c
   128                          SHIELD_PHYS EQU $3a71
   129                          SHIELD_SPRT EQU $3a73
   130                          ARMOR_INV_SLOT EQU $3a74
   131                          HELMET_INV_SLOT EQU $3a75
   132                          RING_INV_SLOT EQU $3a76
   133                          PLAYER_PREV_MAP_LOC EQU $3a77
   134                          LAST_ITEM_HELD EQU $3a78
   135                          PLAYER_MAP_POS EQU $3a79
   136                          RIGHT_HAND_ITEM EQU $3a7a
   137                          LEFT_HAND_ITEM EQU $3a7b
   138                          INV_ITEM_SLOT_1 EQU $3a7c
   139                          INV_ITEM_SLOT_2 EQU $3a7d
   140                          INV_ITEM_SLOT_3 EQU $3a7e
   141                          BYTE_ram_3a82 EQU $3a82
   142                          BYTE_ram_3a83 EQU $3a83
   143                          BYTE_ram_3a85 EQU $3a85
   144                          BYTE_ram_3a87 EQU $3a87
   145                          
   146                          BYTE_ram_3a89 EQU $3a89
   147                          BYTE_ram_3a8a EQU $3a8a
   148                          MELEE_ANIM_STATE EQU $3a8b
   149                          BYTE_ram_3a8c EQU $3a8c
   150                          MONSTER_ATT_POS_COUNT EQU $3a8d
   151                          MONSTER_ATT_POS_OFFSET EQU $3a8f
   152                          RNDHOLD_AA EQU $3a91
   153                          PLAYER_PHYS_HEALTH EQU $3a93
   154                          PLAYER_PHYS_HEALTH_MAX EQU $3a95
   155                          PLAYER_SPRT_HEALTH EQU $3a97
   156                          PLAYER_SPRT_HEALTH_MAX EQU $3a98
   157                          WEAPON_PHYS EQU $3a99
   158                          WEAPON_SPRT EQU $3a9b
   159                          BYTE_ram_3a9e EQU $3a9e
   160                          BYTE_ram_3aa0 EQU $3aa0
   161                          ITEM_HOLDER EQU $3aa1
   162                          CURR_MONSTER_SPRT EQU $3aa2
   163                          CURR_MONSTER_PHYS EQU $3aa3
   164                          BYTE_ram_3aa5 EQU $3aa5
   165                          NEW_DAMAGE EQU $3aa6
   166                          WEAPON_VALUE_HOLDER EQU $3aa8
   167                          BYTE_ram_3aa9 EQU $3aa9
   168                          FOOD_INV EQU $3aab
   169                          ARROW_INV EQU $3aac
   170                          MAP_INV_SLOT EQU $3aad
   171                          SND_CYCLE_HOLDER EQU $3ab3
   172                          PITCH_UP_BOOL EQU $3ab5
   173                          SOUND_REPEAT_COUNT EQU $3ab8
   174                          GAME_BOOLEANS EQU $3ab9
   175                          NEXT_BLINK_CHECK EQU $3aba
   176                          TEMP_MAP EQU $3b00
   177                          BYTE_ram_3ffd EQU $3ffd
   178                          
   179                          ; Missing items
   180                          BYTE_ram_2400 EQU $2400
   181                          BYTE_ram_2613 EQU $2613
   182                          DAT_ram_303f EQU $303f
   183                          DAT_ram_3051 EQU $3051
   184                          DAT_ram_30a0 EQU $30a0
   185                          DAT_ram_30c8 EQU $30c8
   186                          DAT_ram_30df EQU $30df
   187                          DAT_ram_310c EQU $310c
   188                          DAT_ram_3111 EQU $3111
   189                          DAT_ram_3150 EQU $3150
   190                          DAT_ram_316c EQU $316c
   191                          DAT_ram_3178 EQU $3178
   192                          DAT_ram_317c EQU $317c
   193                          DAT_ram_31af EQU $31af
   194                          DAT_ram_31b4 EQU $31b4
   195                          DAT_ram_3200 EQU $3200
   196                          DAT_ram_3230 EQU $3230
   197                          DAT_ram_324c EQU $324c
   198                          DAT_ram_32da EQU $32da
   199                          DAT_ram_335c EQU $335c
   200                          DAT_ram_33c0 EQU $33c0
   201                          DAT_ram_34b4 EQU $34b4
   202                          DAT_ram_34c8 EQU $34c8
   203                          DAT_ram_34dc EQU $34dc
   204                          DAT_ram_351a EQU $351a
   205                          DAT_ram_352d EQU $352d
   206                          DAT_ram_3547 EQU $3547
   207                          DAT_ram_3550 EQU $3550
   208                          DAT_ram_356c EQU $356c
   209                          DAT_ram_3577 EQU $3577
   210                          DAT_ram_3578 EQU $3578
   211                          DAT_ram_357a EQU $357a
   212                          DAT_ram_357c EQU $357c
   213                          DAT_ram_35ba EQU $35ba
   214                          DAT_ram_35c0 EQU $35c0
   215                          DAT_ram_35c6 EQU $35c6
   216                          DAT_ram_35c8 EQU $35c8
   217                          DAT_ram_35ca EQU $35ca
   218                          DAT_ram_35cc EQU $35cc
   219                          LAB_ram_1208 EQU $1208
   220                          LAB_ram_efef EQU $efef
   221                          CHHRAM_INV_4_IDX EQU $31a9
   222                          CHHRAM_INV_6_IDX EQU $3251
   223                          CHHRAM_LVL_IDX EQU $33df
   224                          CHRRAM_AUTHORS_IDX EQU $3348
   225                          CHRRAM_F1_WALL_IDX EQU $3170
   226                          CHRRAM_FL1_WALL_IDX EQU $3147
   227                          CHRRAM_FO_ITEM_IDX EQU $3352
   228                          CHRRAM_LEFT_HAND_ITEM_IDX EQU $3271
   229                          CHRRAM_LEFT_HD_GFX_IDX EQU $3339
   230                          CHRRAM_LEVEL_IDX EQU $333d
   231                          CHRRAM_MONSTER_PHYS EQU $3089
   232                          CHRRAM_MONSTER_POOF_IDX EQU $323b
   233                          CHRRAM_MONSTER_SPRT EQU $3063
   234                          CHRRAM_PHYS_HEALTH_1000 EQU $3041
   235                          CHRRAM_PHYS_SHIELD_IDX EQU $3069
   236                          CHRRAM_PHYS_WEAPON_IDX EQU $3091
   237                          CHRRAM_RH_POOF_IDX EQU $336c
   238                          CHRRAM_RIGHT_HAND_ITEM_IDX EQU $327b
   239                          CHRRAM_RIGHT_HD_GFX_IDX EQU $3343
   240                          CHRRAM_SPRT_HEALTH_10 EQU $3047
   241                          CHRRAM_SPRT_SHIELD_IDX EQU $306f
   242                          CHRRAM_SPRT_WEAPON_IDX EQU $3097
   243                          CHRRAM_STATS_TOP EQU $3019
   244                          CHRRAM_YOU_DIED_IDX EQU $31e7
   245                          COLRAM_F0_WALL_MAP_IDX EQU $34cc
   246                          COLRAM_F1_DOOR_IDX EQU $35c2
   247                          COLRAM_FL00_WALL_IDX EQU $34a3
   248                          COLRAM_FL2_PLUS_WALL_IDX EQU $35be
   249                          COLRAM_FL2_WALL_IDX EQU $35bc
   250                          COLRAM_FL22_WALL_IDX EQU $35b8
   251                          COLRAM_FO_ITEM_IDX EQU $3752
   252                          COLRAM_L1_DOOR_IDX EQU $356d
   253                          COLRAM_MAP_IDX EQU $3411
   254                          COLRAM_PHYS_STATS_10 EQU $3443
   255                          COLRAM_RH_ITEM_IDX EQU $3743
   256                          COLRAM_SHIFT_MODE_IDX EQU $3405
   257                          COLRAM_SPRT_STATS_1 EQU $3447
   258                          COLRAM_VIEWPORT_IDX EQU $3428
   259                          HC_LAST_INPUT EQU $37ff
   260                          IDX_HEALTH_SPACER EQU $3045
   261                          
src/asterion.asm:
     3                          
     4                          org $c000
     5                          
     6                          include "asterion_gfx.asm"
src/asterion_gfx.asm:
     1                          ; ASTERION_GFX.ASM
     2                          ; Updated 22 SEP 2025 by Sean P. Harrington
     3                          ;
     4                          
     5                          ; Maze of Asterion Grpahics Draw Routine -
     6                          ;   The routine that draws character-based graphics in Maze of Asterion is labelled GFX_DRAW .
     7                          ;   -   Register B expects the FG/BG color value
     8                          ;   -   Register HL expects the CHRRAM screen address to start drawing
     9                          ;       - Indexed starting points for ITEMS and MONSTERS within the VIEWPORT
    10                          ;       - Indexed starting points for LEFT and RIGHT hands and inventory items
    11                          ;       - Any other indexed locations (always starting in CHRRAM!!!)
    12                          ;   -   Register DE expects the GFX start address (typically through the GFX_POINTERS table)
    13                          ;   A graphic in Maze of Asterion is a block of AQUASCII characters, $FF terminated, with six defined “control” characters:
    14                          ;   -   $00 = empty character (move right one column, NOT a space character!)
    15                          ;   -   $01 = return character (move down and back to index)
    16                          ;   -   $02 = backspace character (move left one column)
    17                          ;   -   $03 = linefeed (move down one row)
    18                          ;   -   $04 = previous line (move up one row)
    19                          ;   -   $A0 = reverse colors (swap FG/BG)
    20                          
    21                          
    22                          
    23                          ; NO_GFX is a label used for an "empty" graphic, since it's only character is the end of graphic code, $FF
    24                          NO_GFX:
    25  0000  ff                    db          $FF
    26                          
    27                          ; ITEMS:
    28                          ;   - Items range from OBJECT INDEX $00 to $77, and OBJECT TYPE $00 to $1D
    29                          ;   - OBJECT TYPE is the OBJECT INDEX bit-shifted RIGHT two times to remove the 2 bits of object level
    30                          ;   - Items (if visible in the maze) have three sizes, depending on how far away they are from the PLAYER's position:
    31                          ;       - Tiny (i.e. MAP_T): These items are either two spaces forward, or one space diagonal right or left forward from the player. These graphics are usually only a single character wide.
    32                          ;       - Small (i.e. MAP_S): These items are one space forward from the player. These graphics are usually 2x2 characters in size.
    33                          ;       - Regular (i.e. MAP): These items are in the same space as the player. These graphics are usually 4x4 characters in size, and this is the size used for items in the player's inventory pack.
    34                          ;
    35                          
    36                          ; =================================
    37                          ; BUCKLER -
    38                          ;   OBJECT TYPE:  $00
    39                          ;   OBJECT INDEX:
    40                          ;       $00 - RED BUCKLER (Starting item, HARDEST level)
    41                          ;       $01 - YELLOW BUCKLER (Starting item, HARD level)
    42                          ;       $02 - MAGENTA BUCKLER (Starting item, MEDIUM level)
    43                          ;       $03 - WHITE BUCKLER (Starting item, EASIEST level)
    44                          ; The BUCKLER is a small shield item that can be picked up and swapped to the LEFT HAND for protection.
    45                          ;
    46                          BUCKLER:
    47  0001  0101010101            db          $01,$01,$01,$01,$01
    48  0006  d7fcc901              db          $D7,$FC,$C9,$01
    49  000a  a098a07f9901          db          $A0,$98,$A0,$7F,$99,$01
    50  0010  c7afd9ff              db          $C7,$AF,$D9,$FF
    51                          BUCKLER_S:
    52  0014  0101                  db          $01,$01
    53  0016  0096ff                db          $00,$96,$FF
    54                          BUCKLER_T:
    55  0019  0087ff                db          $00,$87,$FF
    56                          
    57                          ; =================================
    58                          ; RING -
    59                          ;   OBJECT TYPE:  $01
    60                          ;   OBJECT INDEX:
    61                          ;       $04 - RED RING
    62                          ;       $05 - YELLOW RING
    63                          ;       $06 - MAGENTA RING
    64                          ;       $07 - WHITE RING
    65                          ; The RING is an enchantment item that increases protection. Once picked up they are worn immediately and cannot be removed. They are not kept in inventory. If another RING of greater level it is picked up and worn, and the old RING disappears.
    66                          ;
    67                          RING:
    68  001c  01010101010101        db          $01,$01,$01,$01,$01,$01,$01
    69  0023  006fff                db          $00,"o",$FF
    70                          RING_S:
    71  0026  010101                db          $01,$01,$01
    72  0029  00c6ff                db          $00,$C6,$FF
    73                          RING_T:
    74  002c  002eff                db          $00,".",$FF
    75                          
    76                          ; =================================
    77                          ; HELMET -
    78                          ;   OBJECT TYPE:  $02
    79                          ;   OBJECT INDEX:
    80                          ;       $08 - RED HELMET
    81                          ;       $09 - YELLOW HELMET
    82                          ;       $0A - MAGENTA HELMET
    83                          ;       $0B - WHITE HELMET
    84                          ; The HELMET is an enchantment item that increases protection. Once picked up they are worn immediately and cannot be removed. They are not kept in inventory. If another HELMET of greater level it is picked up and worn, and the old HELMET disappears.
    85                          ;
    86                          HELMET:
    87  002f  010101010101          db          $01,$01,$01,$01,$01,$01
    88  0035  00c0c101              db          $00,$C0,$C1,$01
    89  0039  00bfefff              db          $00,$BF,$EF,$FF
    90                          HELMET_S:
    91  003d  010101                db          $01,$01,$01
    92  0040  0400d201              db          $04,$00,$D2,$01
    93  0044  00a3ff                db          $00,$A3,$FF
    94                          HELMET_T:
    95  0047  005eff                db          $00,"^",$FF
    96                          
    97                          ; =================================
    98                          ; ARMOR -
    99                          ;   OBJECT TYPE:  $03
   100                          ;   OBJECT INDEX:
   101                          ;       $0C - RED ARMOR
   102                          ;       $0D - YELLOW ARMOR
   103                          ;       $0E - MAGENTA ARMOR
   104                          ;       $0F - WHITE ARMOR
   105                          ; The ARMOR is an enchantment item that increases protection. Once picked up they are worn immediately and cannot be removed. They are not kept in inventory. If another ARMOR of greater level it is picked up and worn, and the old ARMOR disappears.
   106                          ;
   107                          ARMOR:
   108  004a  0101010101            db          $01,$01,$01,$01,$01
   109  004f  a0c9c7d9d7a001        db          $A0,$C9,$C7,$D9,$D7,$A0,$01
   110  0056  ea7f7fb501            db          $EA,$7F,$7F,$B5,$01
   111  005b  a0c38888a097ff        db          $A0,$C3,$88,$88,$A0,$97,$FF
   112                          ARMOR_S:
   113  0062  0101                  db          $01,$01
   114  0064  c7a0c7d9a0d901        db          $C7,$A0,$C7,$D9,$A0,$D9,$01
   115  006b  007f7f01              db          $00,$7F,$7F,$01
   116  006f  00d9c7ff              db          $00,$D9,$C7,$FF
   117                          ARMOR_T:
   118  0073  00a0c7d901            db          $00,$A0,$C7,$D9,$01
   119  0078  0097a0c3ff            db          $00,$97,$A0,$C3,$FF
   120                          
   121                          ; =================================
   122                          ; PAVICE -
   123                          ;   OBJECT TYPE:  $04
   124                          ;   OBJECT INDEX:
   125                          ;       $00 - RED PAVICE
   126                          ;       $01 - YELLOW PAVICE
   127                          ;       $02 - MAGENTA PAVICE
   128                          ;       $03 - WHITE PAVICE
   129                          ; The PAVICE is a large shield item that can be picked up and swapped to the LEFT HAND for protection.
   130                          ;
   131                          PAVICE:
   132  007d  0101010101            db          $01,$01,$01,$01,$01
   133  0082  e8f0f0b401            db          $E8,$F0,$F0,$B4,$01
   134  0087  ea7f7fb501            db          $EA,$7F,$7F,$B5,$01
   135  008c  ea7f7fb501            db          $EA,$7F,$7F,$B5,$01
   136  0091  00efbfff              db          $00,$EF,$BF,$FF
   137                          PAVICE_S:
   138  0095  0101                  db          $01,$01
   139  0097  00f4f801              db          $00,$F4,$F8,$01
   140  009b  007f7f01              db          $00,$7F,$7F,$01
   141  009f  00aba7ff              db          $00,$AB,$A7,$FF
   142                          PAVICE_T:
   143  00a3  007f01                db          $00,$7F,$01
   144  00a6  00c2ff                db          $00,$C2,$FF
   145                          
   146                          ; =================================
   147                          ; ARROW_FLYING_RIGHT -
   148                          ;   OBJECT TYPE:  $05
   149                          ;   OBJECT INDEX: $14
   150                          ; The ARROW_FLYING_RIGHT is the object used in animation when a MONSTER performs a PHYSICAL attack on the PLAYER. Note that this item/object does not appear in the maze and cannot be picked up.
   151                          ;
   152                          ARROW_FLYING_RIGHT:
   153  00a9  010101010101          db          $01,$01,$01,$01,$01,$01
   154  00af  ac9aff                db          $AC,$9A,$FF
   155                          
   156                          ; =================================
   157                          ; BOW -
   158                          ;   OBJECT TYPE:  $06
   159                          ;   OBJECT INDEX:
   160                          ;       $18 - RED BOW (Starting item, all levels)
   161                          ;       $19 - YELLOW BOW
   162                          ;       $1A - MAGENTA BOW
   163                          ;       $1B - WHITE BOW
   164                          ; The BOW is a basic WEAPON that can be used with ARROWS by the PLAYER to make a PHYSICAL attack on a MONSTER.
   165                          ;
   166                          BOW:
   167  00b2  0101010101            db          $01,$01,$01,$01,$01
   168  00b7  d7aca38e01            db          $D7,$AC,$A3,$8E,$01
   169  00bc  d600ca01              db          $D6,$00,$CA,$01
   170  00c0  b5ca01                db          $B5,$CA,$01
   171  00c3  9f00ff                db          $9F,$00,$FF
   172                          BOW_S:
   173  00c6  0101                  db          $01,$01
   174  00c8  d7acc901              db          $D7,$AC,$C9,$01
   175  00cc  d6ca01                db          $D6,$CA,$01
   176  00cf  c7ff                  db          $C7,$FF
   177                          BOW_T:
   178  00d1  007bff                db          $00,"{",$FF
   179                          
   180                          ; =================================
   181                          ; SCROLL -
   182                          ;   OBJECT TYPE:  $07
   183                          ;   OBJECT INDEX:
   184                          ;       $1C - RED SCROLL
   185                          ;       $1D - YELLOW SCROLL
   186                          ;       $1E - MAGENTA SCROLL
   187                          ;       $1F - WHITE SCROLL
   188                          ; The SCROLL is a WEAPON that can be used by the PLAYER to make a MAGICAL attack on a MONSTER.
   189                          ;
   190                          SCROLL:
   191  00d4  0101010101            db          $01,$01,$01,$01,$01
   192  00d9  0990900901            db          "\t",$90,$90,"\t",$01
   193  00de  128f8e1201            db          $12,$8F,$8E,$12,$01
   194  00e3  129e9f1201            db          $12,$9E,$9F,$12,$01
   195  00e8  08a08080a008ff        db          "\b",$A0,$80,$80,$A0,"\b",$FF
   196                          SCROLL_S:
   197  00ef  0101                  db          $01,$01
   198  00f1  00cddd01              db          $00,$CD,$DD,$01
   199  00f5  00cdddff              db          $00,$CD,$DD,$FF
   200                          SCROLL_T:
   201  00f9  0048ff                db          $00,"H",$FF
   202                          
   203                          ; =================================
   204                          ; AXE -
   205                          ;   OBJECT TYPE:  $08
   206                          ;   OBJECT INDEX:
   207                          ;       $20 - RED AXE
   208                          ;       $21 - YELLOW AXE
   209                          ;       $22 - MAGENTA AXE
   210                          ;       $23 - WHITE AXE
   211                          ; The AXE is a WEAPON that can be thrown by the PLAYER to make a PHYSICAL attack on a MONSTER. Once used, it (usually) relocates to another part of the maze.
   212                          ;
   213                          AXE:
   214  00fc  0101010101            db          $01,$01,$01,$01,$01
   215  0101  007fb701              db          $00,$7F,$B7,$01
   216  0105  00d99801              db          $00,$D9,$98,$01
   217  0109  0000b501              db          $00,$00,$B5,$01
   218  010d  000099ff              db          $00,$00,$99,$FF
   219                          AXE_S:
   220  0111  0101                  db          $01,$01
   221  0113  00a0d7a0b701          db          $00,$A0,$D7,$A0,$B7,$01
   222  0119  00009801              db          $00,$00,$98,$01
   223  011d  0000b5ff              db          $00,$00,$B5,$FF
   224                          AXE_T:
   225  0121  0011ff                db          $00,$11,$FF
   226                          
   227                          ; =================================
   228                          ; FIREBALL -
   229                          ;   OBJECT TYPE:  $09
   230                          ;   OBJECT INDEX:
   231                          ;       $24 - RED FIREBALL
   232                          ;       $25 - YELLOW FIREBALL
   233                          ;       $26 - MAGENTA FIREBALL
   234                          ;       $27 - WHITE FIREBALL
   235                          ; The FIREBALL is a WEAPON that can be thrown by the PLAYER to make a MAGICAL attack on a MONSTER. Once used, it disappears.
   236                          ;
   237                          FIREBALL:
   238  0124  0101010101            db          $01,$01,$01,$01,$01
   239  0129  bab9e101              db          $BA,$B9,$E1,$01
   240  012d  b8beb901              db          $B8,$BE,$B9,$01
   241  0131  a8e1b6ff              db          $A8,$E1,$B6,$FF
   242                          FIREBALL_S:
   243  0135  0101                  db          $01,$01
   244  0137  00d1ff                db          $00,$D1,$FF
   245                          FIREBALL_T:
   246  013a  00d3ff                db          $00,$D3,$FF
   247                          
   248                          ; =================================
   249                          ; MACE -
   250                          ;   OBJECT TYPE:  $0A
   251                          ;   OBJECT INDEX:
   252                          ;       $28 - RED MACE
   253                          ;       $29 - YELLOW MACE
   254                          ;       $2A - MAGENTA MACE
   255                          ;       $2B - WHITE MACE
   256                          ; The MACE is a WEAPON that can be thrown by the PLAYER to make a PHYSICAL attack on a MONSTER. Once used, it (usually) relocates to another part of the maze.
   257                          ;
   258                          MACE:
   259  013d  0101010101            db          $01,$01,$01,$01,$01
   260  0142  009e8e01              db          $00,$9E,$8E,$01
   261  0146  00a0c3a09701          db          $00,$A0,$C3,$A0,$97,$01
   262  014c  00a0c3a09701          db          $00,$A0,$C3,$A0,$97,$01
   263  0152  00a099a098ff          db          $00,$A0,$99,$A0,$98,$FF
   264                          MACE_S:
   265  0158  0101                  db          $01,$01
   266  015a  00e0b001              db          $00,$E0,$B0,$01
   267  015e  00a091a08101          db          $00,$A0,$91,$A0,$81,$01
   268  0164  00a0c3a097ff          db          $00,$A0,$C3,$A0,$97,$FF
   269                          MACE_T:
   270  016a  0054ff                db          $00,"T",$FF
   271                          
   272                          ; =================================
   273                          ; STAFF -
   274                          ;   OBJECT TYPE:  $0B
   275                          ;   OBJECT INDEX:
   276                          ;       $2C - RED STAFF
   277                          ;       $2D - YELLOW STAFF
   278                          ;       $2E - MAGENTA STAFF
   279                          ;       $2F - WHITE STAFF
   280                          ; The STAFF is an advanced WEAPON that can be used by the PLAYER to make a MAGICAL attack on a MONSTER.
   281                          ;
   282                          STAFF:
   283  016d  0101010101            db          $01,$01,$01,$01,$01
   284  0172  d501                  db          $D5,$01
   285  0174  00da01                db          $00,$DA,$01
   286  0177  0000da01              db          $00,$00,$DA,$01
   287  017b  000000daff            db          $00,$00,$00,$DA,$FF
   288                          STAFF_S:
   289  0180  0101                  db          $01,$01
   290  0182  00d301                db          $00,$D3,$01
   291  0185  0000daff              db          $00,$00,$DA,$FF
   292                          STAFF_T:
   293  0189  005cff                db          $00,"\\",$FF
   294                          
   295                          ; =================================
   296                          ; CROSSBOW -
   297                          ;   OBJECT TYPE:  $0C
   298                          ;   OBJECT INDEX:
   299                          ;       $30 - RED CROSSBOW
   300                          ;       $31 - YELLOW CROSSBOW
   301                          ;       $32 - MAGENTA CROSSBOW
   302                          ;       $33 - WHITE CROSSBOW
   303                          ; The CROSSBOW is an advanced WEAPON that can be used with ARROWS by the PLAYER to make a PHYSICAL attack on a MONSTER.
   304                          ;
   305                          CROSSBOW:
   306  018c  0101010101            db          $01,$01,$01,$01,$01
   307  0191  000090f001            db          $00,$00,$90,$F0,$01
   308  0196  000cb7a091a001        db          $00,"\f",$B7,$A0,$91,$A0,$01
   309  019d  a091a0b7eda091a0      db          $A0,$91,$A0,$B7,$ED,$A0,$91,$A0,$01
              01                
   310  01a6  a099a09090a0d7a0      db          $A0,$99,$A0,$90,$90,$A0,$D7,$A0,$FF
              ff                
   311                          CROSSBOW_S:
   312  01af  0101                  db          $01,$01
   313  01b1  d7dc01                db          $D7,$DC,$01
   314  01b4  cd0dff                db          $CD,"\r",$FF
   315                          CROSSBOW_T:
   316  01b7  a091a0d8020490ff      db          $A0,$91,$A0,$D8,$02,$04,$90,$FF
   317                          
   318                          ; =================================
   319                          ; UNKNOWN ITEM -
   320                          ;   OBJECT TYPE:  $0D
   321                          ;   OBJECT INDEX: $34
   322                          ; The purpose of this item is unknown, but maybe used for the flying animation for AXE or MACE. Note that this item/object does not appear in the maze and cannot be picked up.
   323                          
   324                          ; =================================
   325                          ; UNKNOWN ITEM -
   326                          ;   OBJECT TYPE:  $0E
   327                          ;   OBJECT INDEX: $38
   328                          ; The purpose of this item is unknown, but maybe used for the flying animation for AXE or MACE. Note that this item/object does not appear in the maze and cannot be picked up.
   329                          
   330                          ; =================================
   331                          ; ARROW_FLYING_LEFT -
   332                          ;   OBJECT TYPE:  $0F
   333                          ;   OBJECT INDEX: $3C
   334                          ; The ARROW_FLYING_LEFTT is the object used in animation when the PLAYER performs a PHYSICAL attack on a MONSTER. Note that this item/object does not appear in the maze and cannot be picked up.
   335                          ;
   336                          ARROW_FLYING_LEFT:
   337  01bf  010101010101          db          $01,$01,$01,$01,$01,$01
   338  01c5  9bacff                db          $9B,$AC,$FF
   339                          
   340                          ; =================================
   341                          ; LADDDER -
   342                          ;   OBJECT TYPE:  $10
   343                          ;   OBJECT INDEX: $42 (MAGENTA LADDER)
   344                          ; The LADDER is the object that allows progressing to the next lower level of the maze. Note that this item/object cannot be picked up and only shows up in the MAGENTA form.
   345                          ;
   346                          LADDER:
   347  01c8  0101010101            db          $01,$01,$01,$01,$01
   348  01cd  ea0000b501            db          $EA,$00,$00,$B5,$01
   349  01d2  eaafafb501            db          $EA,$AF,$AF,$B5,$01
   350  01d7  fafcfcf501            db          $FA,$FC,$FC,$F5,$01
   351  01dc  abf0f0a7ff            db          $AB,$F0,$F0,$A7,$FF
   352                          LADDER_S:
   353  01e1  0101                  db          $01,$01
   354  01e3  00b4e801              db          $00,$B4,$E8,$01
   355  01e7  d7b7ebc901            db          $D7,$B7,$EB,$C9,$01
   356  01ec  c7afafd9ff            db          $C7,$AF,$AF,$D9,$FF
   357                          LADDER_T:
   358  01f1  00cd97ff              db          $00,$CD,$97,$FF
   359                          
   360                          ; =================================
   361                          ; CHEST -
   362                          ;   OBJECT TYPE:  $11
   363                          ;   OBJECT INDEX:
   364                          ;       $44 - RED CHEST
   365                          ;       $45 - YELLOW CHEST
   366                          ;       $46 - MAGENTA CHEST
   367                          ;       $47 - WHITE CHEST
   368                          ; The CHEST is an ITEM that can be picked up or opened when on the ground in front of the PLAYER. When opened, it disappears and becomes a TREASURE item, a POTION, a KEY, or a MAP. Note that the CHEST can also be thrown as a WEAPON for a PHYSICAL attack, but does not inflict much damage.
   369                          ;
   370                          CHEST:
   371  01f5  0101010101            db          $01,$01,$01,$01,$01
   372  01fa  9088889001            db          $90,$88,$88,$90,$01
   373  01ff  a090888890a001        db          $A0,$90,$88,$88,$90,$A0,$01
   374  0206  a0819090a09101        db          $A0,$81,$90,$90,$A0,$91,$01
   375  020d  a0d7fcfcc9a0ff        db          $A0,$D7,$FC,$FC,$C9,$A0,$FF
   376                          CHEST_S:
   377  0214  01e01f1fb001          db          $01,$E0,$1F,$1F,$B0,$01
   378  021a  a099a080809801        db          $A0,$99,$A0,$80,$80,$98,$01
   379  0221  a20000a1ff            db          $A2,$00,$00,$A1,$FF
   380                          CHEST_T:
   381  0226  00fcff                db          $00,$FC,$FF
   382                          
   383                          ; =================================
   384                          ; FOOD -
   385                          ;   OBJECT TYPE:  $12
   386                          ;   OBJECT INDEX:
   387                          ;       $48 - RED FOOD
   388                          ;       $49 - YELLOW FOOD
   389                          ;       $4A - MAGENTA FOOD
   390                          ;       $4B - WHITE FOOD
   391                          ; The FOOD is an ITEM that can be picked up and added to the PLAYER's rations, a separate inventory. Picking FOOD up causes it to disappear.
   392                          ;
   393                          FOOD:
   394  0229  0101010101            db          $01,$01,$01,$01,$01
   395  022e  e41ff601              db          $E4,$1F,$F6,$01
   396  0232  a0c3cbdba09701        db          $A0,$C3,$CB,$DB,$A0,$97,$01
   397  0239  00bba01fa0a9ff        db          $00,$BB,$A0,$1F,$A0,$A9,$FF
   398                          FOOD_S:
   399  0240  0101                  db          $01,$01
   400  0242  e0beb001              db          $E0,$BE,$B0,$01
   401  0246  00e9a7ff              db          $00,$E9,$A7,$FF
   402                          FOOD_T:
   403  024a  0023ff                db          $00,"#",$FF
   404                          
   405                          ; =================================
   406                          ; QUIVER -
   407                          ;   OBJECT TYPE:  $13
   408                          ;   OBJECT INDEX:
   409                          ;       $4C - RED QUIVER
   410                          ;       $4D - YELLOW QUIVER
   411                          ;       $4E - MAGENTA QUIVER
   412                          ;       $4F - WHITE QUIVER
   413                          ; The QUIVER is an ITEM that can be picked up and added to the PLAYER's arrows, a separate inventory. Picking QUIVER up causes it to disappear.
   414                          ;
   415                          QUIVER:
   416  024d  010101010101          db          $01,$01,$01,$01,$01,$01
   417  0253  7f7fa0d7a00601        db          $7F,$7F,$A0,$D7,$A0,$06,$01
   418  025a  a2acb2e901            db          $A2,$AC,$B2,$E9,$01
   419  025f  0000a2a1ff            db          $00,$00,$A2,$A1,$FF
   420                          QUIVER_S:
   421  0264  0101                  db          $01,$01
   422  0266  00afbdb001            db          $00,$AF,$BD,$B0,$01
   423  026b  0000a2ff              db          $00,$00,$A2,$FF
   424                          QUIVER_T:
   425  026f  00f0ff                db          $00,$F0,$FF
   426                          
   427                          ; =================================
   428                          ; LOCKED_CHEST -
   429                          ;   OBJECT TYPE:  $14
   430                          ;   OBJECT INDEX:
   431                          ;       $50 - RED LOCKED_CHEST
   432                          ;       $51 - YELLOW LOCKED_CHEST
   433                          ;       $52 - MAGENTA LOCKED_CHEST
   434                          ;       $53 - WHITE LOCKED_CHEST
   435                          ; The LOCKED_CHEST is an ITEM that can be picked up or unlocked/opened with a KEY of similar or greater level when on the ground in front of the PLAYER. When unlocked/opened, it disappears and becomes a TREASURE item, a POTION, a KEY, or a MAP. Note that the LOCKED_CHEST can also be thrown as a WEAPON for a PHYSICAL attack, but does not inflict much damage.
   436                          ; A tiny or small LOCKED_CHEST looks like a regular CHEST from afar, so it uses those graphics.
   437                          ;
   438                          LOCKED_CHEST:
   439  0272  0101010101            db          $01,$01,$01,$01,$01
   440  0277  9088889001            db          $90,$88,$88,$90,$01
   441  027c  a090888890a001        db          $A0,$90,$88,$88,$90,$A0,$01
   442  0283  a081cbdba09101        db          $A0,$81,$CB,$DB,$A0,$91,$01
   443  028a  a0d7fcfcc9a0ff        db          $A0,$D7,$FC,$FC,$C9,$A0,$FF
   444                          
   445                          ; =================================
   446                          ; UNKNOWN ITEM -
   447                          ;   OBJECT TYPE:  $15
   448                          ;   OBJECT INDEX: $54
   449                          ; The purpose of this item is unknown, but maybe used for the flying animation for FIREBALL. Note that this item/object does not appear in the maze and cannot be picked up.
   450                          
   451                          ; =================================
   452                          ; KEY -
   453                          ;   OBJECT TYPE:  $16
   454                          ;   OBJECT INDEX:
   455                          ;       $58 - RED KEY
   456                          ;       $59 - YELLOW KEY
   457                          ;       $5A - MAGENTA KEY
   458                          ;       $5B - WHITE KEY
   459                          ; The KEY is an ITEM that can be picked up or used to unlock/open a LOCKED_CHEST of similar or lesser level when the LOCKED_CHEST is on the ground in front of the PLAYER. When used it disappears.
   460                          ;
   461                          KEY:
   462  0291  010101010101          db          $01,$01,$01,$01,$01,$01
   463  0297  9090b8c901            db          $90,$90,$B8,$C9,$01
   464  029c  10a080a0a9d9ff        db          $10,$A0,$80,$A0,$A9,$D9,$FF
   465                          KEY_S:
   466  02a3  010101                db          $01,$01,$01
   467  02a6  bcc5ff                db          $BC,$C5,$FF
   468                          KEY_T:
   469  02a9  ff2dff                db          $FF,"-",$FF
   470                          
   471                          ; =================================
   472                          ; AMULET -
   473                          ;   OBJECT TYPE:  $17
   474                          ;   OBJECT INDEX:
   475                          ;       $5C - RED AMULET
   476                          ;       $5D - YELLOW AMULET
   477                          ;       $5E - MAGENTA AMULET
   478                          ;       $5F - WHITE AMULET
   479                          ; The AMULET is a TREASURE item that increases the PLAYER's score. When picked up it disappears. Note in future versions of this game, the score will be removed, and picking up an AMULET will perform other functions.
   480                          ;
   481                          AMULET:
   482  02ac  0101010101            db          $01,$01,$01,$01,$01
   483  02b1  d7acc901              db          $D7,$AC,$C9,$01
   484  02b5  c7acc8c901            db          $C7,$AC,$C8,$C9,$01
   485  02ba  d7acd9d601            db          $D7,$AC,$D9,$D6,$01
   486  02bf  c7ac05d9ff            db          $C7,$AC,$05,$D9,$FF
   487                          AMULET_S:
   488  02c4  0101                  db          $01,$01
   489  02c6  00d7c901              db          $00,$D7,$C9,$01
   490  02ca  00c7c8c901            db          $00,$C7,$C8,$C9,$01
   491  02cf  00cbf1a5ff            db          $00,$CB,$F1,$A5,$FF
   492                          AMULET_T:
   493  02d4  0026ff                db          $00,"&",$FF
   494                          
   495                          ; =================================
   496                          ; CHALICE -
   497                          ;   OBJECT TYPE:  $18
   498                          ;   OBJECT INDEX:
   499                          ;       $60 - RED CHALICE
   500                          ;       $61 - YELLOW CHALICE
   501                          ;       $62 - MAGENTA CHALICE
   502                          ;       $63 - WHITE CHALICE
   503                          ; The CHALICE is a TREASURE item that increases the PLAYER's score. When picked up it disappears. Note in future versions of this game, the score will be removed, and picking up an CHALICE will perform other functions.
   504                          ;
   505                          CHALICE:
   506  02d7  010101010101          db          $01,$01,$01,$01,$01,$01
   507  02dd  a0c3a0899701          db          $A0,$C3,$A0,$89,$97,$01
   508  02e3  009f01                db          $00,$9F,$01
   509  02e6  e00eb0ff              db          $E0,$0E,$B0,$FF
   510                          CHALICE_S:
   511  02ea  0101                  db          $01,$01
   512  02ec  009f01                db          $00,$9F,$01
   513  02ef  00ccff                db          $00,$CC,$FF
   514                          CHALICE_T:
   515  02f2  0059ff                db          $00,"Y",$FF
   516                          
   517                          ; =================================
   518                          ; WARRIOR_POTION -
   519                          ;   OBJECT TYPE:  $19
   520                          ;   OBJECT INDEX:
   521                          ;       $64 - RED WARRIOR_POTION
   522                          ;       $65 - YELLOW WARRIOR_POTION
   523                          ;       $66 - MAGENTA WARRIOR_POTION
   524                          ;       $67 - WHITE WARRIOR_POTION
   525                          ; The WARRIOR_POTION is a potion that can be picked up or used. When used, it disappears and usually affects the PLAYER's PHYSICAL traits. It removes any other currently active POTION effect. Note all potions use the POTION_T for their tiny view.
   526                          ;
   527                          WARRIOR_POTION:
   528  02f5  0101010101            db          $01,$01,$01,$01,$01
   529  02fa  002bd401              db          $00,"+",$D4,$01
   530  02fe  00110f01              db          $00,$11,$0F,$01
   531  0302  00cddd01              db          $00,$CD,$DD,$01
   532  0306  00c7d9ff              db          $00,$C7,$D9,$FF
   533                          WARRIOR_POTION_S:
   534  030a  0101                  db          $01,$01
   535  030c  00d401                db          $00,$D4,$01
   536  030f  001401                db          $00,$14,$01
   537  0312  00c2ff                db          $00,$C2,$FF
   538                          POTION_T:
   539  0315  005502045fff          db          $00,"U",$02,$04,"_",$FF
   540                          
   541                          ; =================================
   542                          ; MAGE_POTION -
   543                          ;   OBJECT TYPE:  $1A
   544                          ;   OBJECT INDEX:
   545                          ;       $68 - RED MAGE_POTION
   546                          ;       $69 - YELLOW MAGE_POTION
   547                          ;       $6A - MAGENTA MAGE_POTION
   548                          ;       $6B - WHITE MAGE_POTION
   549                          ; The MAGE_POTION is a potion that can be picked up or used. When used, it disappears and usually affects the PLAYER's SPIRITUAL traits. It removes any other currently active POTION effect. Note all potions use the POTION_T for their tiny view.
   550                          ;
   551                          MAGE_POTION:
   552  031b  0101010101            db          $01,$01,$01,$01,$01
   553  0320  002bd501              db          $00,"+",$D5,$01
   554  0324  00110f01              db          $00,$11,$0F,$01
   555  0328  00cddd01              db          $00,$CD,$DD,$01
   556  032c  00c7d9ff              db          $00,$C7,$D9,$FF
   557                          MAGE_POTION_S:
   558  0330  0101                  db          $01,$01
   559  0332  00d501                db          $00,$D5,$01
   560  0335  001401                db          $00,$14,$01
   561  0338  00c2ff                db          $00,$C2,$FF
   562                          
   563                          ; =================================
   564                          ; MAP -
   565                          ;   OBJECT TYPE:  $1B
   566                          ;   OBJECT INDEX:
   567                          ;       $6C - RED MAP
   568                          ;       $6D - YELLOW MAP
   569                          ;       $6E - MAGENTA MAP
   570                          ;       $6F - WHITE MAP
   571                          ; The MAP is an ITEM that can be picked up or used to view the floorplan of the current maze level.
   572                          ;
   573                          MAP:
   574  033b  0101010101            db          $01,$01,$01,$01,$01
   575  0340  f01fc89801            db          $F0,$1F,$C8,$98,$01
   576  0345  12c8ccb501            db          $12,$C8,$CC,$B5,$01
   577  034a  a0b5a0cdcc1201        db          $A0,$B5,$A0,$CD,$CC,$12,$01
   578  0351  a099a0cca01ffca0      db          $A0,$99,$A0,$CC,$A0,$1F,$FC,$A0,$FF
              ff                
   579                          MAP_S:
   580  035a  0101                  db          $01,$01
   581  035c  00d701                db          $00,$D7,$01
   582  035f  c7a0d5a0c901          db          $C7,$A0,$D5,$A0,$C9,$01
   583  0365  00d9ff                db          $00,$D9,$FF
   584                          MAP_T:
   585  0368  00d5ff                db          $00,$D5,$FF
   586                          
   587                          ; =================================
   588                          ; CHAOS_POTION -
   589                          ;   OBJECT TYPE:  $1C
   590                          ;   OBJECT INDEX:
   591                          ;       $70 - RED CHAOS_POTION
   592                          ;       $71 - YELLOW CHAOS_POTION
   593                          ;       $72 - MAGENTA CHAOS_POTION
   594                          ;       $73 - WHITE CHAOS_POTION
   595                          ; The CHAOS_POTION is a potion that can be picked up or used. When used, it disappears and can randomly affects the PLAYER's SPIRITUAL, HEALTH, or PHYSICAL traits. It removes any other currently active POTION effect. Note all potions use the POTION_T for their tiny view.
   596                          ;
   597                          CHAOS_POTION:
   598  036b  0101010101            db          $01,$01,$01,$01,$01
   599  0370  003f3f01              db          $00,"??",$01
   600  0374  00110f01              db          $00,$11,$0F,$01
   601  0378  00cddd01              db          $00,$CD,$DD,$01
   602  037c  00c7d9ff              db          $00,$C7,$D9,$FF
   603                          CHAOS_POTION_S:
   604  0380  0101                  db          $01,$01
   605  0382  003f01                db          $00,"?",$01
   606  0385  001401                db          $00,$14,$01
   607  0388  00c2ff                db          $00,$C2,$FF
   608                          
   609                          ; =================================
   610                          ; UNKNOWN ITEM -
   611                          ;   OBJECT TYPE:  $1D
   612                          ;   OBJECT INDEX: $74
   613                          ; The purpose of this item is unknown, but maybe used for the text for the PLAYER's death sequence.
   614                          ;
   615                          EXCL_MARK_GFX:
   616  038b  21ff                  db          "!",$FF
   617                          
   618                          
   619                          ; MONSTERS
   620                          ;   - Monsters range from OBJECT INDEX $78 to $9F, and OBJECT TYPE $1E to $27
   621                          ;   - OBJECT TYPE is the OBJECT INDEX bit-shifted RIGHT two times to remove the 2 bits of object level
   622                          ;   - Monsters have two sizes, depending on how far away they are from the PLAYER's position:
   623                          ;       - Small (i.e. SKELETON_S): These monsters are two spaces forward, or one space diagonal left or right forward from the player. These graphics are usually 4x4 characters in size.
   624                          ;       - Regular (i.e. SKELETON): These items are one space forward from the player. These graphics are usually 8x8 characters in size.
   625                          ;
   626                          
   627                          ; =================================
   628                          ; SKELETON -
   629                          ;   OBJECT TYPE:  $1E
   630                          ;   OBJECT INDEX:
   631                          ;       $78 - RED SKELETON
   632                          ;       $79 - YELLOW SKELETON
   633                          ;       $7A - MAGENTA SKELETON
   634                          ;       $7B - WHITE SKELETON
   635                          ; The SKELETON is a basic monster.
   636                          ;
   637                          SKELETON:
   638  038d  04040404              db          $04,$04,$04,$04
   639  0391  028a00eeed01          db          $02,$8A,$00,$EE,$ED,$01
   640  0397  02d600a017a0a701      db          $02,$D6,$00,$A0,$17,$A0,$A7,$01
   641  039f  02d6e0acb9e401        db          $02,$D6,$E0,$AC,$B9,$E4,$01
   642  03a6  0223a6e2e6a2b401      db          $02,"#",$A6,$E2,$E6,$A2,$B4,$01
   643  03ae  02d600f8edb02301      db          $02,$D6,$00,$F8,$ED,$B0,"#",$01
   644  03b6  02d6e8a100e501        db          $02,$D6,$E8,$A1,$00,$E5,$01
   645  03bd  02d6a2e400ba01        db          $02,$D6,$A2,$E4,$00,$BA,$01
   646  03c4  02d600a6a8f1ff        db          $02,$D6,$00,$A6,$A8,$F1,$FF
   647                          SKELETON_S:
   648  03cb  040404                db          $04,$04,$04
   649  03ce  08e2a501              db          "\b",$E2,$A5,$01
   650  03d2  cdb8b7b401            db          $CD,$B8,$B7,$B4,$01
   651  03d7  d6b8a9b001            db          $D6,$B8,$A9,$B0,$01
   652  03dc  d6a2e8b1ff            db          $D6,$A2,$E8,$B1,$FF
   653                          
   654                          ; =================================
   655                          ; SNAKE -
   656                          ;   OBJECT TYPE:  $1F
   657                          ;   OBJECT INDEX:
   658                          ;       $7C - RED SNAKE
   659                          ;       $7D - YELLOW SNAKE
   660                          ;       $7E - MAGENTA SNAKE
   661                          ;       $7F - WHITE SNAKE
   662                          ; The SNAKE is a basic monster.
   663                          ;
   664                          SNAKE:
   665  03e1  040404                db          $04,$04,$04
   666  03e4  02b8bef7bdb001        db          $02,$B8,$BE,$F7,$BD,$B0,$01
   667  03eb  021111e2e9ea01        db          $02,$11,$11,$E2,$E9,$EA,$01
   668  03f2  02d7ade1b7b601        db          $02,$D7,$AD,$E1,$B7,$B6,$01
   669  03f9  028d00b6fae0f001      db          $02,$8D,$00,$B6,$FA,$E0,$F0,$01
   670  0401  0202b8a6fbb2faf1      db          $02,$02,$B8,$A6,$FB,$B2,$FA,$F1,$A4,$E9,$01
              a4e901            
   671  040c  0202b5a2eab2b2b4      db          $02,$02,$B5,$A2,$EA,$B2,$B2,$B4,$E0,$E6,$01
              e0e601            
   672  0417  0202a2aca3e6f2ae      db          $02,$02,$A2,$AC,$A3,$E6,$F2,$AE,$E1,$BB,$FF
              e1bbff            
   673                          SNAKE_S:
   674  0422  040404                db          $04,$04,$04
   675  0425  00fef901              db          $00,$FE,$F9,$01
   676  0429  0022a085a09701        db          $00,"\"",$A0,$85,$A0,$97,$01
   677  0430  b8b6f6e401            db          $B8,$B6,$F6,$E4,$01
   678  0435  e5e7f9e6ff            db          $E5,$E7,$F9,$E6,$FF
   679                          
   680                          ; =================================
   681                          ; SPIDER -
   682                          ;   OBJECT TYPE:  $20
   683                          ;   OBJECT INDEX:
   684                          ;       $80 - RED SPIDER
   685                          ;       $81 - YELLOW SPIDER
   686                          ;       $82 - MAGENTA SPIDER
   687                          ;       $83 - WHITE SPIDER
   688                          ; The SPIDER is a basic monster.
   689                          ;
   690                          SPIDER:
   691  043a  0404                  db          $04,$04
   692  043c  00befd01              db          $00,$BE,$FD,$01
   693  0440  a099a0f7ee9801        db          $A0,$99,$A0,$F7,$EE,$98,$01
   694  0447  02b6b9fbf7e6e901      db          $02,$B6,$B9,$FB,$F7,$E6,$E9,$01
   695  044f  02f7e6eebdb9fb01      db          $02,$F7,$E6,$EE,$BD,$B9,$FB,$01
   696  0457  0212d6a0178ca0d6      db          $02,$12,$D6,$A0,$17,$8C,$A0,$D6,$12,$01
              1201              
   697  0461  02a099a0c76027d9      db          $02,$A0,$99,$A0,$C7,"`'",$D9,$98,$FF
              98ff              
   698                          SPIDER_S:
   699  046b  04040404              db          $04,$04,$04,$04
   700  046f  00d7c901              db          $00,$D7,$C9,$01
   701  0473  d79585c901            db          $D7,$95,$85,$C9,$01
   702  0478  4da0178ca04d01        db          "M",$A0,$17,$8C,$A0,"M",$01
   703  047f  58602758ff            db          "X`'X",$FF
   704                          
   705                          ; =================================
   706                          ; MIMIC -
   707                          ;   OBJECT TYPE:  $21
   708                          ;   OBJECT INDEX:
   709                          ;       $84 - RED MIMIC
   710                          ;       $85 - YELLOW MIMIC
   711                          ;       $86 - MAGENTA MIMIC
   712                          ;       $87 - WHITE MIMIC
   713                          ; The MIMIC is a basic monster.
   714                          ;
   715                          MIMIC:
   716  0484  0402d796000096c9      db          $04,$02,$D7,$96,$00,$00,$96,$C9,$01
              01                
   717  048d  0212f01f1ff01201      db          $02,$12,$F0,$1F,$1F,$F0,$12,$01
   718  0495  02d611a0178ca00f      db          $02,$D6,$11,$A0,$17,$8C,$A0,$0F,$D6,$01
              d601              
   719  049f  02c7a0188d188da0      db          $02,$C7,$A0,$18,$8D,$18,$8D,$A0,$D9,$01
              d901              
   720  04a9  a0819090a09101        db          $A0,$81,$90,$90,$A0,$91,$01
   721  04b0  a0d7fcfcc9a0ff        db          $A0,$D7,$FC,$FC,$C9,$A0,$FF
   722                          MIMIC_S:
   723  04b7  01e01f1fb001          db          $01,$E0,$1F,$1F,$B0,$01
   724  04bd  a099a080809801        db          $A0,$99,$A0,$80,$80,$98,$01
   725  04c4  a20000a1ff            db          $A2,$00,$00,$A1,$FF
   726                          
   727                          ; =================================
   728                          ; MALOCCHIO -
   729                          ;   OBJECT TYPE:  $22
   730                          ;   OBJECT INDEX:
   731                          ;       $88 - RED MIMIC
   732                          ;       $89 - YELLOW MIMIC
   733                          ;       $8A - MAGENTA MIMIC
   734                          ;       $8B - WHITE MIMIC
   735                          ; The MALOCCHIO is a basic monster.
   736                          ;
   737                          MALOCCHIO:
   738  04c9  04040404              db          $04,$04,$04,$04
   739  04cd  02a8b0b600b6b001      db          $02,$A8,$B0,$B6,$00,$B6,$B0,$01
   740  04d5  02b4e5beeeb8e101      db          $02,$B4,$E5,$BE,$EE,$B8,$E1,$01
   741  04dd  02e27ff6f87fb101      db          $02,$E2,$7F,$F6,$F8,$7F,$B1,$01
   742  04e5  02a5a014141414a0      db          $02,$A5,$A0,$14,$14,$14,$14,$A0,$EA,$01
              ea01              
   743  04ef  02e8ab7f7fa7b401      db          $02,$E8,$AB,$7F,$7F,$A7,$B4,$01
   744  04f7  02c7a40000a8d9ff      db          $02,$C7,$A4,$00,$00,$A8,$D9,$FF
   745                          MALOCCHIO_S:
   746  04ff  04040404              db          $04,$04,$04,$04
   747  0503  00b6b8e001            db          $00,$B6,$B8,$E0,$01
   748  0508  e3bee9f101            db          $E3,$BE,$E9,$F1,$01
   749  050d  b9a08484a0e401        db          $B9,$A0,$84,$84,$A0,$E4,$01
   750  0514  a2a6a1a5ff            db          $A2,$A6,$A1,$A5,$FF
   751                          
   752                          ; =================================
   753                          ; DRAGON -
   754                          ;   OBJECT TYPE:  $23
   755                          ;   OBJECT INDEX:
   756                          ;       $8C - RED DRAGON
   757                          ;       $8D - YELLOW DRAGON
   758                          ;       $8E - MAGENTA DRAGON
   759                          ;       $8F - WHITE DRAGON
   760                          ; The DRAGON is an advanced monster.
   761                          ;
   762                          DRAGON:
   763  0519  04040404              db          $04,$04,$04,$04
   764  051d  02b0e000c0a0c2a0      db          $02,$B0,$E0,$00,$C0,$A0,$C2,$A0,$C1,$01
              c101              
   765  0527  0202a099a0c9d798      db          $02,$02,$A0,$99,$A0,$C9,$D7,$98,$A0,$95,$95,$85,$A0,$81,$01
              a0959585a08101    
   766  0536  0202a0c3a4a81285      db          $02,$02,$A0,$C3,$A4,$A8,$12,$85,$86,$85,$A0,$97,$01
              8685a09701        
   767  0543  02a0178ca52094a0      db          $02,$A0,$17,$8C,$A5," ",$94,$A0,$94,$A5,$01
              94a501            
   768  054e  0202d7f6f97f7f7f      db          $02,$02,$D7,$F6,$F9,$7F,$7F,$7F,$7F,$B4,$01
              7fb401            
   769  0559  0202a0b595862084      db          $02,$02,$A0,$B5,$95,$86," ",$84," ",$B0,$A0,$99,$01
              20b0a09901        
   770  0566  0202a0c3d7a094a0      db          $02,$02,$A0,$C3,$D7,$A0,$94,$A0,$C9,$A0,$DB,$18,$A2,$C3,$01
              c9a0db18a2c301    
   771  0575  0218008d0000e899      db          $02,$18,$00,$8D,$00,$00,$E8,$99,$01
              01                
   772  057e  009eec1fbfa1ff        db          $00,$9E,$EC,$1F,$BF,$A1,$FF
   773                          DRAGON_S:
   774  0585  040404c9c9c0c001      db          $04,$04,$04,$C9,$C9,$C0,$C0,$01
   775  058d  eda5a09595a001        db          $ED,$A5,$A0,$95,$95,$A0,$01
   776  0594  a092a0f9a0caa0a7      db          $A0,$92,$A0,$F9,$A0,$CA,$A0,$A7,$01
              01                
   777  059d  babfefe901            db          $BA,$BF,$EF,$E9,$01
   778  05a2  d9d907abff            db          $D9,$D9,"\a",$AB,$FF
   779                          
   780                          ; =================================
   781                          ; MUMMY -
   782                          ;   OBJECT TYPE:  $24
   783                          ;   OBJECT INDEX:
   784                          ;       $90 - RED MUMMY
   785                          ;       $91 - YELLOW MUMMY
   786                          ;       $92 - MAGENTA MUMMY
   787                          ;       $93 - WHITE MUMMY
   788                          ; The MUMMY is an advanced monster.
   789                          ;
   790                          MUMMY:
   791  05a7  04040404              db          $04,$04,$04,$04
   792  05ab  d7fcc901              db          $D7,$FC,$C9,$01
   793  05af  0202d7c995a093a0      db          $02,$02,$D7,$C9,$95,$A0,$93,$A0,$B4,$00,$D7,$C9,$01
              b400d7c901        
   794  05bc  0202a097a084a094      db          $02,$02,$A0,$97,$A0,$84,$A0,$94,$84,$94,$A0,$84,$A0,$D9,$A0,$97,$01
              8494a084a0d9a097  
              01                
   795  05cd  0202a0b5f8c98494      db          $02,$02,$A0,$B5,$F8,$C9,$84,$94,$D2,$D6,$A0,$01
              d2d6a001          
   796  05d9  0202a0c3a00095a0      db          $02,$02,$A0,$C3,$A0,$00,$95,$A0,$84,$94,$7F,$12,$A0,$01
              84947f12a001      
   797  05e7  0202a091bf94e094      db          $02,$02,$A0,$91,$BF,$94,$E0,$94,$AA,$91,$A0,$01
              aa91a001          
   798  05f3  0295a095a00011a0      db          $02,$95,$A0,$95,$A0,$00,$11,$A0,$95,$A0,$01
              95a001            
   799  05fe  02a0d9a0850027a0      db          $02,$A0,$D9,$A0,$85,$00,"'",$A0,$85,$A0,$C9,$FF
              85a0c9ff          
   800                          MUMMY_S:
   801  060a  040404                db          $04,$04,$04
   802  060d  1ceab11a01            db          $1C,$EA,$B1,$1A,$01
   803  0612  11efbf0f01            db          $11,$EF,$BF,$0F,$01
   804  0617  d6a0d9c7a06001        db          $D6,$A0,$D9,$C7,$A0,"`",$01
   805  061e  e0b5eab0ff            db          $E0,$B5,$EA,$B0,$FF
   806                          
   807                          ; =================================
   808                          ; NECROMANCER -
   809                          ;   OBJECT TYPE:  $25
   810                          ;   OBJECT INDEX:
   811                          ;       $94 - RED NECROMANCER
   812                          ;       $95 - YELLOW NECROMANCER
   813                          ;       $96 - MAGENTA NECROMANCER
   814                          ;       $97 - WHITE NECROMANCER
   815                          ; The NECROMANCER is an advanced monster.
   816                          ;
   817                          NECROMANCER:
   818  0623  04040404              db          $04,$04,$04,$04
   819  0627  02d7d0a0110fa0d0      db          $02,$D7,$D0,$A0,$11,$0F,$A0,$D0,$C9,$01
              c901              
   820  0631  0202d78dd1a4a4d1      db          $02,$02,$D7,$8D,$D1,$A4,$A4,$D1,$18,$C9,$01
              18c901            
   821  063c  0202d6e9a0d9a09c      db          $02,$02,$D6,$E9,$A0,$D9,$A0,$9C,$D7,$A0,$C7,$A0,$B6,$D6,$01
              d7a0c7a0b6d601    
   822  064b  020212faefa0c2a0      db          $02,$02,$12,$FA,$EF,$A0,$C2,$A0,$7F,$BF,$F5,$12,$01
              7fbff51201        
   823  0658  0202c7a7e2afedb1      db          $02,$02,$C7,$A7,$E2,$AF,$ED,$B1,$AB,$D9,$01
              abd901            
   824  0663  7fa0d6a07ffd01        db          $7F,$A0,$D6,$A0,$7F,$FD,$01
   825  066a  02a09920192020a0      db          $02,$A0,$99," ",$19,"  ",$A0,$98,$01,$02,$C7,$A0,$88," ",$90,$F0,$A0,$D9,$FF
              980102c7a0882090  
              f0a0d9ff          
   826                          NECROMANCER_S:
   827  067e  040404                db          $04,$04,$04
   828  0681  0be2db0c01            db          "\v",$E2,$DB,"\f",$01
   829  0686  9fa0c9d7a09f01        db          $9F,$A0,$C9,$D7,$A0,$9F,$01
   830  068d  00129901              db          $00,$12,$99,$01
   831  0691  00fd91ff              db          $00,$FD,$91,$FF
   832                          
   833                          ; =================================
   834                          ; GRYPHON -
   835                          ;   OBJECT TYPE:  $26
   836                          ;   OBJECT INDEX:
   837                          ;       $98 - RED GRYPHON
   838                          ;       $99 - YELLOW GRYPHON
   839                          ;       $9A - MAGENTA GRYPHON
   840                          ;       $9B - WHITE GRYPHON
   841                          ; The GRYPHON is an advanced monster.
   842                          ;
   843                          GRYPHON:
   844  0695  04040404              db          $04,$04,$04,$04
   845  0699  02889088f001          db          $02,$88,$90,$88,$F0,$01
   846  069f  0202bea0aca0ed95      db          $02,$02,$BE,$A0,$AC,$A0,$ED,$95,$A0,$85,$A0,$F5,$01
              a085a0f501        
   847  06ac  0202a0959595a0b5      db          $02,$02,$A0,$95,$95,$95,$A0,$B5,$86,$91,$01
              869101            
   848  06b7  0202a0959595a0c3      db          $02,$02,$A0,$95,$95,$95,$A0,$C3,$95,$E5,$A0,$C7,$A0,$B0,$01
              95e5a0c7a0b001    
   849  06c6  0202a09595a0a1ef      db          $02,$02,$A0,$95,$95,$A0,$A1,$EF,$F4,$EF,$F5,$A0,",",$A0,$01
              f4eff5a02ca001    
   850  06d5  020212b97ff57ff5      db          $02,$02,$12,$B9,$7F,$F5,$7F,$F5,"\r",$C7,$01
              0dc701            
   851  06e0  0202b6eaf7e77feb      db          $02,$02,$B6,$EA,$F7,$E7,$7F,$EB,$F5,$01
              f501              
   852  06ea  02028bc7bfb6efed      db          $02,$02,$8B,$C7,$BF,$B6,$EF,$ED,$EB,$E5,$FF
              ebe5ff            
   853                          GRYPHON_S:
   854  06f5  040404b8b8b001        db          $04,$04,$04,$B8,$B8,$B0,$01
   855  06fc  a09595a012c901        db          $A0,$95,$95,$A0,$12,$C9,$01
   856  0703  e1a0d9d9a08d01        db          $E1,$A0,$D9,$D9,$A0,$8D,$01
   857  070a  28e7e7e5ff            db          "(",$E7,$E7,$E5,$FF
   858                          
   859                          ; =================================
   860                          ; MINOTAUR -
   861                          ;   OBJECT TYPE:  $27
   862                          ;   OBJECT INDEX:
   863                          ;       $9C - RED MINOTAUR
   864                          ;       $9D - YELLOW MINOTAUR
   865                          ;       $9E - MAGENTA MINOTAUR
   866                          ;       $9F - WHITE MINOTAUR
   867                          ; The MINOTAUR is an boss level monster. Killing a MINOTAUR completes the game.
   868                          ;
   869                          MINOTAUR:
   870  070f  04040404              db          $04,$04,$04,$04
   871  0713  e8a1e901              db          $E8,$A1,$E9,$01
   872  0717  ebefefa101            db          $EB,$EF,$EF,$A1,$01
   873  071c  0202e0b8b4fbb1e4      db          $02,$02,$E0,$B8,$B4,$FB,$B1,$E4,$F0,$01
              f001              
   874  0726  0202f6e6fef4e8ed      db          $02,$02,$F6,$E6,$FE,$F4,$E8,$ED,$FD,$ED,$01
              fded01            
   875  0731  0202e9b5bfe1eafb      db          $02,$02,$E9,$B5,$BF,$E1,$EA,$FB,$FE,$FB,$01
              fefb01            
   876  073c  0202a1e0fe7ffdb9      db          $02,$02,$A1,$E0,$FE,$7F,$FD,$B9,$AD,$A1,$01
              ada101            
   877  0747  02a27fb4feb70102      db          $02,$A2,$7F,$B4,$FE,$B7,$01,$02,$BE,$B6,$00,$A2,$BE,$B4,$FF
              beb600a2beb4ff    
   878                          MINOTAUR_S:
   879  0756  04040404              db          $04,$04,$04,$04
   880  075a  00edbe01              db          $00,$ED,$BE,$01
   881  075e  d7e6b9d201            db          $D7,$E6,$B9,$D2,$01
   882  0763  0a8eedc201            db          "\n",$8E,$ED,$C2,$01
   883  0768  001683ff              db          $00,$16,$83,$FF
   884                          
   885                          
   886                          ; OTHER GRAPHICS
   887                          
   888                          ; STATS
   889                          ;   Stats labels are shown in the right side of the screen to identify a player's health and other statistics in real-time.
   890                          ;
   891                          STATS_TXT:
   892  076c  50485953d6535052      db          "PHYS",$D6,"SPRT",$FF
              54ff              
   893  0776  d600000000486561      db          $D6,$00,$00,$00,$00,"Health",$01
              6c746801          
   894  0782  d600000000536869      db          $D6,$00,$00,$00,$00,"Shield",$01
              656c6401          
   895  078e  d600000000576561      db          $D6,$00,$00,$00,$00,"Weapon",$FF
              706f6eff          
   896                          
   897                          ; COMPASS
   898                          ;   The compass is the right side of the screen, and points in the direction that the PLAYER is currently facing.
   899                          ;
   900                          COMPASS:
   901  079a  d76ec901              db          $D7,"n",$C9,$01
   902  079e  77086501              db          "w\be",$01
   903  07a2  c773d9ff              db          $C7,"s",$D9,$FF
   904                          
   905                          ; POOF Animation
   906                          ;   The POOF animation is played when a MONSTER or ITEM disappears.
   907                          ;       - For MONSTERS, it is when they are killed by the player. Their graphic is replaced with the POOF Animation, and then the empty maze space is rerendered as blank.
   908                          ;       = For ITEMS, they can disappear if they break or are used up (like a POTION). This occurs in the PLAYER's RIGHT HAND.
   909                          ;
   910                          POOF_1:
   911  07a6  d7c901                db          $D7,$C9,$01
   912  07a9  c7d9ff                db          $C7,$D9,$FF
   913                          POOF_2:
   914  07ac  d1d101                db          $D1,$D1,$01
   915  07af  d1d1ff                db          $D1,$D1,$FF
   916                          POOF_3:
   917  07b2  d1d1d1d101            db          $D1,$D1,$D1,$D1,$01
   918  07b7  d1d0d0d101            db          $D1,$D0,$D0,$D1,$01
   919  07bc  d1d0d0d101            db          $D1,$D0,$D0,$D1,$01
   920  07c1  d1d1d1d1ff            db          $D1,$D1,$D1,$D1,$FF
   921                          POOF_4:
   922  07c6  0100d0d001            db          $01,$00,$D0,$D0,$01
   923  07cb  00d0d0ff              db          $00,$D0,$D0,$FF
   924                          POOF_5:
   925  07cf  d0d0d0d001            db          $D0,$D0,$D0,$D0,$01
   926  07d4  d00000d001            db          $D0,$00,$00,$D0,$01
   927  07d9  d00000d001            db          $D0,$00,$00,$D0,$01
   928  07de  d0d0d0d0ff            db          $D0,$D0,$D0,$D0,$FF
   929                          POOF_6:
   930  07e3  2020202001            db          "    ",$01
   931  07e8  2020202001            db          "    ",$01
   932  07ed  2020202001            db          "    ",$01
   933  07f2  20202020ff            db          "    ",$FF
   934                          
   935                          ; AUTHORS
   936                          ;   The Author's credits can be viewed on the TITLE SCREEN when the A (About) key is pressed on the keyboard.
   937                          ;
   938                          AUTHORS:
   939  07f7  2020204f72696769      db          "   Originally programmed by Tom Loughry ",$01
              6e616c6c79207072  
              6f6772616d6d6564  
              20627920546f6d20  
              4c6f756768727920  
              01                
   940  0820  20204e6577204746      db          "  New GFX & routines by Sean Harrington ",$FF
              58202620726f7574  
              696e657320627920  
              5365616e20486172  
              72696e67746f6e20  
              ff                
   941                          
   942                          ; LEVEL_99_LOOP
   943                          ;   The level 99 overflow text is shown when the player completes maze level 99 without killing the MINOTAUR. Their level is set back to 90, and they continue playing.
   944                          ;
   945                          LEVEL_99_LOOP:
   946  0849  4c6f6f6b73206c69      db          "Looks like this dungeon",$01
              6b65207468697320  
              64756e67656f6e01  
   947  0861  697320746f6f2073      db          "is too small for you",$01
              6d616c6c20666f72  
              20796f7501        
   948  0876  736f207765207769      db          "so we will put you back",$01
              6c6c207075742079  
              6f75206261636b01  
   949  088e  696e746f2061206e      db          "into a new floor #90.",$FF
              657720666c6f6f72  
              202339302eff      
   950                          
   951                          ; THE END
   952                          ;   The end of game text is displayed when you defeat the MINOTAUR.
   953                          ;
   954                          THE_END_PART_A:
   955  08a4  204173746572696f      db          " Asterion, the minotaur ",$FF
              6e2c20746865206d  
              696e6f7461757220  
              ff                
   956                          THE_END_PART_B:
   957  08bd  2069732064656164      db          " is dead. ",$FF
              2e20ff            
   958                          
   959                          ; YOU_DIED
   960                          ;   The end of game text is displayed when the PLAYER dies.
   961                          ;
   962                          YOU_DIED_TXT:
   963  08c8  7fa0596f75206469      DB         $7F,$A0,"You died ",$FF
              656420ff          
   964                          
   965                          ; Characters for the pointer on the COMPASS
   966                          WEST_TXT:
   967  08d4  07ff                  db          "\a",$FF
   968                          NORTH_TXT:
   969  08d6  08ff                  db          "\b",$FF
   970                          SOUTH_TXT:
   971  08d8  09ff                  db          "\t",$FF
   972                          EAST_TXT:
   973  08da  06ff                  db          $06,$FF
   974                          
   975                          
src/asterion.asm:
     7                          include "asterion_func_low.asm"
src/asterion_func_low.asm:
     1                          SUB_ram_c869:
     2  08dc  112900                LD          DE,$29                                 ;GRN on DKCYN
     3                                                                                  ;(bottom of closed door)
     4                          SUB_ram_c86c:
     5  08df  77                    LD          (HL),A
     6  08e0  37                    SCF
     7  08e1  3f                    CCF
     8  08e2  ed52                  SBC         HL,DE
     9                          SUB_ram_c871:
    10  08e4  77                    LD          (HL),A
    11  08e5  37                    SCF
    12  08e6  3f                    CCF
    13  08e7  ed52                  SBC         HL,DE
    14  08e9  77                    LD          (HL),A
    15  08ea  ed52                  SBC         HL,DE
    16  08ec  77                    LD          (HL),A
    17  08ed  c9                    RET
    18  08ee  112900                LD          DE,$29                                 ;GRN on DKCYN
    19                                                                                  ;(bottom of closed door)
    20                          SUB_ram_c87e:
    21  08f1  77                    LD          (HL),A
    22  08f2  19                    ADD         HL,DE
    23                          LAB_ram_c880:
    24  08f3  77                    LD          (HL),A
    25  08f4  19                    ADD         HL,DE
    26  08f5  77                    LD          (HL),A
    27  08f6  19                    ADD         HL,DE
    28  08f7  77                    LD          (HL),A
    29  08f8  c9                    RET
    30                          SUB_ram_c886:
    31  08f9  77                    LD          (HL),A
    32  08fa  19                    ADD         HL,DE
    33  08fb  77                    LD          (HL),A
    34  08fc  23                    INC         HL
    35  08fd  77                    LD          (HL),A
    36  08fe  19                    ADD         HL,DE
    37  08ff  23                    INC         HL
    38  0900  77                    LD          (HL),A
    39  0901  2b                    DEC         HL
    40  0902  77                    LD          (HL),A
    41  0903  2b                    DEC         HL
    42  0904  77                    LD          (HL),A
    43  0905  c9                    RET
    44                          SUB_ram_c893:
    45  0906  77                    LD          (HL),A
    46  0907  19                    ADD         HL,DE
    47  0908  77                    LD          (HL),A
    48  0909  2b                    DEC         HL
    49  090a  77                    LD          (HL),A
    50  090b  19                    ADD         HL,DE
    51  090c  23                    INC         HL
    52  090d  77                    LD          (HL),A
    53  090e  2b                    DEC         HL
    54  090f  77                    LD          (HL),A
    55  0910  2b                    DEC         HL
    56  0911  77                    LD          (HL),A
    57  0912  c9                    RET
    58                          SUB_ram_c8a0:
    59  0913  77                    LD          (HL),A
    60  0914  23                    INC         HL
    61  0915  77                    LD          (HL),A
    62  0916  23                    INC         HL
    63  0917  77                    LD          (HL),A
    64  0918  19                    ADD         HL,DE
    65  0919  2b                    DEC         HL
    66  091a  77                    LD          (HL),A
    67  091b  2b                    DEC         HL
    68  091c  77                    LD          (HL),A
    69  091d  19                    ADD         HL,DE
    70  091e  77                    LD          (HL),A
    71  091f  c9                    RET
    72                          SUB_ram_c8ad:
    73  0920  77                    LD          (HL),A
    74  0921  23                    INC         HL
    75  0922  77                    LD          (HL),A
    76  0923  23                    INC         HL
    77  0924  77                    LD          (HL),A
    78  0925  19                    ADD         HL,DE
    79  0926  2b                    DEC         HL
    80  0927  77                    LD          (HL),A
    81  0928  23                    INC         HL
    82  0929  77                    LD          (HL),A
    83  092a  19                    ADD         HL,DE
    84  092b  77                    LD          (HL),A
    85  092c  c9                    RET
    86                          DRAW_ROW:
    87  092d  77                    LD          (HL),A
    88  092e  05                    DEC         B
    89  092f  c8                    RET         Z
    90  0930  23                    INC         HL
    91  0931  c32d09                JP          DRAW_ROW
    92  0934  112800                LD          DE,$28                                 ;DE = 40 (next line) / $28
    93                          DRAW_CELL:
    94  0937  77                    LD          (HL),A
    95  0938  0d                    DEC         C
    96  0939  c8                    RET         Z
    97  093a  19                    ADD         HL,DE                                   ;Goto next row
    98  093b  c33709                JP          DRAW_CELL
    99                          FILL_CHRCOL_RECT:
   100  093e  112800                LD          DE,$28                                 ;DE = 40 / $28 (next row)
   101                          DRAW_CHRCOLS:
   102  0941  e5                    PUSH        HL
   103  0942  c5                    PUSH        BC
   104  0943  cd2d09                CALL        DRAW_ROW
   105  0946  c1                    POP         BC
   106  0947  e1                    POP         HL
   107  0948  0d                    DEC         C
   108  0949  c8                    RET         Z
   109  094a  19                    ADD         HL,DE
   110  094b  c34109                JP          DRAW_CHRCOLS
   111                          DRAW_F0_WALL:
   112  094e  21cc34                LD          HL,COLRAM_F0_WALL_MAP_IDX               ;= $60    `
   113  0951  011010                LD          BC,$1010                               ;16 x 16 rectangle
   114  0954  3e44                  LD          A,$44                                  ;BLU on BLU
   115  0956  c33e09                JP          FILL_CHRCOL_RECT
   116                          DRAW_F0_WALL_AND_CLOSED_DOOR:
   117  0959  cd4e09                CALL        DRAW_F0_WALL
   118  095c  3e22                  LD          A,$22                                  ;GRN on GRN
   119                          DRAW_DOOR_F0:
   120  095e  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
   121  0961  010c08                LD          BC,$80c                                ;8 x 12 rectangle
   122  0964  c33e09                JP          FILL_CHRCOL_RECT
   123                          DRAW_WALL_F0_AND_OPEN_DOOR:
   124  0967  cd4e09                CALL        DRAW_F0_WALL
   125  096a  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
   126                                                                                  ;WAS BLK on DKBLU
   127                                                                                  ;WAS LD A,0xb
   128  096c  c35e09                JP          DRAW_DOOR_F0
   129                          DRAW_WALL_F1:
   130  096f  217031                LD          HL,CHRRAM_F1_WALL_IDX                   ;= $20
   131  0972  010808                LD          BC,$808                                ;8 x 8 rectangle
   132  0975  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   133                                                                                  ;WAS d134 / $86 crosshatch char
   134                                                                                  ;WAS LD A, $86
   135  0977  cd3e09                CALL        FILL_CHRCOL_RECT
   136  097a  0e08                  LD          C,0x8
   137  097c  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
   138  097f  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   139  0981  c34109                JP          DRAW_CHRCOLS
   140                          DRAW_WALL_F1_AND_CLOSED_DOOR:
   141  0984  cd6f09                CALL        DRAW_WALL_F1
   142  0987  3e2d                  LD          A,$2d                                  ;GRN on DKGRN
   143                          DRAW_DOOR_F1_OPEN:
   144  0989  21c235                LD          HL,COLRAM_F1_DOOR_IDX                   ;= $60    `
   145  098c  010604                LD          BC,$406                                ;4 x 6 rectangle
   146  098f  c33e09                JP          FILL_CHRCOL_RECT
   147                          DRAW_WALL_F1_AND_OPEN_DOOR:
   148  0992  cd6f09                CALL        DRAW_WALL_F1
   149  0995  3e00                  LD          A,0x0                                   ;BLK on BLK
   150  0997  c38909                JP          DRAW_DOOR_F1_OPEN
   151                          DRAW_WALL_F2:
   152  099a  010404                LD          BC,$404                                ;4 x 4 rectangle
   153  099d  21c235                LD          HL,COLRAM_F1_DOOR_IDX                   ;= $60    `
   154  09a0  3eff                  LD          A,$ff                                  ;DKGRY on DKGRY
   155                                                                                  ;WAS BLK on DKBLU
   156                                                                                  ;WAS LD A,0xb
   157  09a2  c33e09                JP          FILL_CHRCOL_RECT
   158                          DRAW_DOOR_F2_OPEN:
   159  09a5  21c235                LD          HL,COLRAM_F1_DOOR_IDX                   ;= $60    `
   160  09a8  3e00                  LD          A,0x0                                   ;BLK on BLK
   161                          UPDATE_FO_ITEM:
   162  09aa  010404                LD          BC,$404                                ;4 x 4 rectangle
   163  09ad  c33e09                JP          FILL_CHRCOL_RECT
   164                          DRAW_WALL_FL0:
   165  09b0  21a334                LD          HL,COLRAM_FL00_WALL_IDX                 ;= $60    `
   166  09b3  3e40                  LD          A,$40                                  ;BLU on BLK
   167                                                                                  ;WAS BLU on CYN
   168                                                                                  ;WAS LD A,$46
   169  09b5  cddc08                CALL        SUB_ram_c869
   170  09b8  1b                    DEC         DE
   171  09b9  19                    ADD         HL,DE
   172  09ba  3e04                  LD          A,0x4                                   ;BLK on BLU
   173  09bc  cdf908                CALL        SUB_ram_c886
   174  09bf  19                    ADD         HL,DE
   175  09c0  011004                LD          BC,$410                                ;Jump into COLRAM and down one row
   176  09c3  cd4109                CALL        DRAW_CHRCOLS
   177  09c6  19                    ADD         HL,DE
   178  09c7  cd1309                CALL        SUB_ram_c8a0
   179  09ca  19                    ADD         HL,DE
   180  09cb  3ef4                  LD          A,$f4                                  ;DKGRY on BLU
   181                                                                                  ;WAS DKCYN on BLU
   182                                                                                  ;WAS LD A,$94
   183  09cd  1b                    DEC         DE
   184  09ce  cddf08                CALL        SUB_ram_c86c
   185  09d1  3ec0                  LD          A,$c0
   186  09d3  21c033                LD          HL,DAT_ram_33c0                         ;= $20
   187  09d6  cddf08                CALL        SUB_ram_c86c
   188  09d9  212830                LD          HL,IDX_VIEWPORT_CHRRAM                  ;= $20
   189  09dc  3ec1                  LD          A,$c1
   190  09de  13                    INC         DE
   191  09df  13                    INC         DE
   192  09e0  c3f108                JP          SUB_ram_c87e
   193  09e3  c9                    RET
   194                          DRAW_DOOR_FLO:
   195  09e4  cdb009                CALL        DRAW_WALL_FL0
   196  09e7  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
   197                                                                                  ;WAS DKCYN on DKBLU
   198                                                                                  ;WAS LD A,$9b
   199  09e9  08                    EX          AF,AF'
   200  09ea  3e04                  LD          A,0x4                                   ;BLK on BLU
   201                                                                                  ;WAS DKBLU on BLU
   202                                                                                  ;LD A,$b4
   203  09ec  c3f709                JP          LAB_ram_c99e
   204                          SUB_ram_c996:
   205  09ef  cdb009                CALL        DRAW_WALL_FL0
   206  09f2  3ef2                  LD          A,$f2                                  ;DKGRY on GRN
   207                                                                                  ;WAS DKCYN on GRN
   208                                                                                  ;WAS LD A,$92
   209  09f4  08                    EX          AF,AF'
   210  09f5  3e24                  LD          A,$24                                  ;GRN on BLU
   211                          LAB_ram_c99e:
   212  09f7  211a35                LD          HL,DAT_ram_351a                         ;= $60    `
   213  09fa  cde408                CALL        SUB_ram_c871
   214  09fd  1b                    DEC         DE
   215  09fe  19                    ADD         HL,DE
   216  09ff  08                    EX          AF,AF'
   217  0a00  cdf908                CALL        SUB_ram_c886
   218  0a03  19                    ADD         HL,DE
   219  0a04  010c03                LD          BC,$30c
   220  0a07  cd4109                CALL        DRAW_CHRCOLS
   221  0a0a  19                    ADD         HL,DE
   222  0a0b  cd1309                CALL        SUB_ram_c8a0
   223  0a0e  19                    ADD         HL,DE
   224  0a0f  1b                    DEC         DE
   225  0a10  cde408                CALL        SUB_ram_c871
   226  0a13  21c830                LD          HL,DAT_ram_30c8                         ;= $20
   227  0a16  3ec1                  LD          A,$c1
   228  0a18  13                    INC         DE
   229  0a19  13                    INC         DE
   230  0a1a  c3f308                JP          LAB_ram_c880
   231  0a1d  c9                    RET
   232                          SUB_ram_c9c5:
   233  0a1e  21c834                LD          HL,DAT_ram_34c8                         ;= $60    `
   234  0a21  3e04                  LD          A,0x4                                   ;BLK on BLU
   235  0a23  011004                LD          BC,$410                                ;4 x 10 rectangle
   236  0a26  c33e09                JP          FILL_CHRCOL_RECT
   237                          SUB_ram_c9d0:
   238  0a29  216831                LD          HL,DAT_ram_3168                         ;= $20
   239  0a2c  010804                LD          BC,$408                                ;4 x 8 rectangle
   240  0a2f  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   241                                                                                  ;WAS d134 / $86 crosshatch char
   242                                                                                  ;WAS LD A, $86
   243  0a31  cd3e09                CALL        FILL_CHRCOL_RECT
   244  0a34  216835                LD          HL,DAT_ram_3568                         ;= $60
   245  0a37  0e08                  LD          C,0x8
   246  0a39  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   247  0a3b  c34109                JP          DRAW_CHRCOLS
   248                          SUB_ram_c9e5:
   249  0a3e  cd290a                CALL        SUB_ram_c9d0
   250  0a41  3edd                  LD          A,$dd                                  ;DKGRN on DKGRN
   251                          LAB_ram_c9ea:
   252  0a43  21ba35                LD          HL,DAT_ram_35ba                         ;= $60    `
   253  0a46  010602                LD          BC,$206                                ;2 x 6 rectangle
   254  0a49  c34109                JP          DRAW_CHRCOLS
   255                          SUB_ram_c9f3:
   256  0a4c  cd290a                CALL        SUB_ram_c9d0
   257  0a4f  af                    XOR         A
   258  0a50  c3430a                JP          LAB_ram_c9ea
   259                          SUB_ram_c9f9:
   260  0a53  216831                LD          HL,DAT_ram_3168                         ;= $20
   261  0a56  3ec1                  LD          A,$c1
   262  0a58  77                    LD          (HL),A                    ;= $20
   263  0a59  112800                LD          DE,$28
   264  0a5c  19                    ADD         HL,DE
   265  0a5d  23                    INC         HL
   266  0a5e  77                    LD          (HL),A                    ;= $20
   267  0a5f  215932                LD          HL,DAT_ram_3259                         ;= $20
   268  0a62  3ec0                  LD          A,$c0
   269  0a64  77                    LD          (HL),A                    ;= $20
   270  0a65  19                    ADD         HL,DE
   271  0a66  2b                    DEC         HL
   272  0a67  77                    LD          (HL),A                    ;= $20
   273  0a68  216835                LD          HL,DAT_ram_3568                         ;= $60
   274  0a6b  3ebf                  LD          A,$bf                                  ;DKBLU on DKGRY
   275                                                                                  ;WAS DKBLU on DKCYN
   276                                                                                  ;WAS LD A,$b9
   277  0a6d  77                    LD          (HL),A                    ;= $60
   278  0a6e  19                    ADD         HL,DE
   279  0a6f  23                    INC         HL
   280  0a70  77                    LD          (HL),A                    ;= $60
   281  0a71  2b                    DEC         HL
   282  0a72  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   283                                                                                  ;WAS BLK on DKBLU
   284                                                                                  ;WAS LD A,0xb
   285  0a74  77                    LD          (HL),A                    ;= $60
   286  0a75  010402                LD          BC,$204                                ;2 x 4 rectangle
   287  0a78  19                    ADD         HL,DE             ;= $60    `
   288  0a79  cd4109                CALL        DRAW_CHRCOLS
   289  0a7c  19                    ADD         HL,DE
   290  0a7d  77                    LD          (HL),A                    ;= $60
   291  0a7e  23                    INC         HL
   292  0a7f  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   293                                                                                  ;WAS DKCYN on DKBLU
   294                                                                                  ;WAS LD A,$9b
   295  0a81  77                    LD          (HL),A                    ;= $60
   296  0a82  19                    ADD         HL,DE
   297  0a83  2b                    DEC         HL
   298  0a84  77                    LD          (HL),A                    ;= $60
   299  0a85  21ba35                LD          HL,DAT_ram_35ba                         ;= $60    `
   300  0a88  0e04                  LD          C,0x4
   301  0a8a  3e00                  LD          A,0x0
   302  0a8c  c34109                JP          DRAW_CHRCOLS
   303                          DRAW_WALL_FL22:
   304  0a8f  21b835                LD          HL,COLRAM_FL22_WALL_IDX                 ;= $60    `
   305  0a92  010404                LD          BC,$404                                ;4 x 4 rectangle
   306  0a95  3eff                  LD          A,$ff                                  ;DKGRY on DKGRY
   307  0a97  c33e09                JP          FILL_CHRCOL_RECT
   308                          DRAW_L1_WALL:
   309  0a9a  214731                LD          HL,CHRRAM_FL1_WALL_IDX                  ;= $20
   310  0a9d  3ec1                  LD          A,$c1                                  ;LEFT angle CHR
   311  0a9f  cddc08                CALL        SUB_ram_c869
   312  0aa2  1b                    DEC         DE
   313  0aa3  19                    ADD         HL,DE
   314  0aa4  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   315                                                                                  ;WAS d134 / $86 crosshatch char
   316                                                                                  ;WAS LD A, $86
   317  0aa6  cdf908                CALL        SUB_ram_c886
   318  0aa9  19                    ADD         HL,DE
   319  0aaa  010804                LD          BC,$408                                ;4 x 8 rectangle
   320  0aad  cd4109                CALL        DRAW_CHRCOLS
   321  0ab0  19                    ADD         HL,DE
   322  0ab1  cd1309                CALL        SUB_ram_c8a0
   323  0ab4  19                    ADD         HL,DE
   324  0ab5  3ec0                  LD          A,$c0                                  ;RIGHT angle CHR
   325  0ab7  1b                    DEC         DE
   326  0ab8  cddf08                CALL        SUB_ram_c86c
   327  0abb  214735                LD          HL,DAT_ram_3547                         ;= $60    `
   328  0abe  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
   329                                                                                  ;WAS DKBLU on CYN
   330                                                                                  ;WAS LD A,$b6
   331  0ac0  cddc08                CALL        SUB_ram_c869
   332  0ac3  1b                    DEC         DE
   333  0ac4  19                    ADD         HL,DE
   334  0ac5  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   335  0ac7  cdf908                CALL        SUB_ram_c886
   336  0aca  19                    ADD         HL,DE
   337  0acb  010804                LD          BC,$408                                ;Jump to COLRAM + 32 cells
   338  0ace  cd4109                CALL        DRAW_CHRCOLS
   339  0ad1  19                    ADD         HL,DE
   340  0ad2  cd1309                CALL        SUB_ram_c8a0
   341  0ad5  19                    ADD         HL,DE
   342  0ad6  3efb                  LD          A,$fb                                  ;DKGRY on DKBLU
   343                                                                                  ;WAS DKCYN on DKBLU
   344                                                                                  ;WAS LD A,$9b
   345  0ad8  1b                    DEC         DE
   346  0ad9  c3df08                JP          SUB_ram_c86c
   347  0adc  c9                    RET
   348                          DRAW_FL1_DOOR:
   349  0add  cd9a0a                CALL        DRAW_L1_WALL
   350  0ae0  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
   351                                                                                  ;WAS DKCYN on BLK
   352                                                                                  ;WAS LD A,$90
   353  0ae2  f5                    PUSH        AF
   354  0ae3  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
   355  0ae5  f5                    PUSH        AF
   356  0ae6  3e0b                  LD          A,0xb                                   ;BLK on DKGRY
   357                                                                                  ;WAS BLK on DKBLU
   358                                                                                  ;WAS LD A,0xb
   359  0ae8  c3f60a                JP          DRAW_L1_DOOR
   360                          DRAW_L1:
   361  0aeb  cd9a0a                CALL        DRAW_L1_WALL
   362  0aee  3efd                  LD          A,$fd                                  ;DKGRY on DKGRN
   363                                                                                  ;WAS DKCYN on DKGRN
   364                                                                                  ;WAS LD A,$9d
   365  0af0  f5                    PUSH        AF
   366  0af1  3e2d                  LD          A,$2d                                  ;GRN on DKGRN
   367  0af3  f5                    PUSH        AF
   368  0af4  3edb                  LD          A,$db                                  ;DKGRN on DKBLU
   369                          DRAW_L1_DOOR:
   370  0af6  216d35                LD          HL,COLRAM_L1_DOOR_IDX                   ;= $60    `
   371  0af9  010702                LD          BC,$207                                ;2 x 7 rectangle
   372  0afc  cd780b                CALL        SUB_ram_cb1c
   373  0aff  216d31                LD          HL,CHRRAM_L1_DOOR_IDX                   ;= $20
   374  0b02  3ec1                  LD          A,$c1                                  ;LEFT ANGLE CHR
   375  0b04  77                    LD          (HL),A              ;= $20
   376  0b05  112900                LD          DE,$29
   377  0b08  19                    ADD         HL,DE
   378  0b09  77                    LD          (HL),A                    ;= $20
   379  0b0a  c9                    RET
   380                          SUB_ram_cab0:
   381  0b0b  216c35                LD          HL,DAT_ram_356c                         ;= $60    `
   382  0b0e  010804                LD          BC,$408                                ;4 x 8 rectangle
   383  0b11  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   384  0b13  cd3e09                CALL        FILL_CHRCOL_RECT
   385  0b16  216c31                LD          HL,DAT_ram_316c                         ;= $20
   386  0b19  0e08                  LD          C,0x8
   387  0b1b  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   388                                                                                  ;WAS d134 / $86 crosshatch char
   389                                                                                  ;WAS LD A, $86
   390  0b1d  c34109                JP          DRAW_CHRCOLS
   391                          SUB_ram_cac5:
   392  0b20  cd0b0b                CALL        SUB_ram_cab0
   393  0b23  af                    XOR         A
   394  0b24  c32c0b                JP          DRAW_L1_DOOR_2
   395                          DRAW_L1_DOOR_CLOSED:
   396  0b27  cd0b0b                CALL        SUB_ram_cab0
   397  0b2a  3edd                  LD          A,$dd                                  ;DKGRN on DKGRN
   398                          DRAW_L1_DOOR_2:
   399  0b2c  21bc35                LD          HL,COLRAM_FL2_WALL_IDX                  ;= $60    `
   400  0b2f  010602                LD          BC,$206                                ;2 x 6 rectangle
   401  0b32  c34109                JP          DRAW_CHRCOLS
   402                          DRAW_WALL_FL2:
   403  0b35  21bc35                LD          HL,COLRAM_FL2_WALL_IDX                  ;= $60    `
   404  0b38  010402                LD          BC,$204                                ;2 x 4 rectangle
   405  0b3b  3e11                  LD          A,$11                                  ;BLK on DKGRY
   406  0b3d  cd3e09                CALL        FILL_CHRCOL_RECT
   407  0b40  0e04                  LD          C,0x4
   408  0b42  21be35                LD          HL,COLRAM_FL2_PLUS_WALL_IDX             ;= $60    `
   409  0b45  3e22                  LD          A,$22                                  ;BLK on DKGRY
   410                                                                                  ;WAS BLK on DKBLU
   411                                                                                  ;WAS LD A,0xb
   412  0b47  c34109                JP          DRAW_CHRCOLS
   413                          DRAW_WALL_FL2_EMPTY:
   414  0b4a  21bc35                LD          HL,COLRAM_FL2_WALL_IDX                  ;= $60    `
   415  0b4d  010404                LD          BC,$404                                ;4 x 4 rectangle
   416  0b50  3e00                  LD          A,0x0                                   ;BLK on BLK
   417  0b52  c33e09                JP          FILL_CHRCOL_RECT
   418                          DRAW_WALL_L2:
   419  0b55  3eca                  LD          A,$ca                                  ;Right slash char
   420  0b57  f5                    PUSH        AF
   421  0b58  3e20                  LD          A,$20                                  ;GRN on BLK
   422  0b5a  f5                    PUSH        AF
   423  0b5b  217031                LD          HL,CHRRAM_F1_WALL_IDX                   ;= $20
   424  0b5e  3ec1                  LD          A,$c1                                  ;Left angle char
   425  0b60  010402                LD          BC,$204                                ;2 x 4 rectangle
   426  0b63  cd780b                CALL        SUB_ram_cb1c
   427  0b66  3e0f                  LD          A,0xf                                   ;FL2 Bottom Color
   428                                                                                  ;BLK on DKGRY
   429                                                                                  ;WAS DKCYN on DKBLU
   430                                                                                  ;WAS LD A,$9b
   431  0b68  f5                    PUSH        AF
   432  0b69  3e0f                  LD          A,0xf                                   ;FL2 Wall Color
   433                                                                                  ;BLK on DKGRY
   434                                                                                  ;WAS BLK on DKBLU
   435                                                                                  ;WAS LD A,0xb
   436  0b6b  f5                    PUSH        AF
   437  0b6c  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
   438  0b6f  3ef0                  LD          A,$f0                                  ;FL2 Top Color
   439                                                                                  ;DKGRY on BLK
   440                                                                                  ;WAS DKBLU on CYN
   441                                                                                  ;WAS LD A,$b6
   442  0b71  010402                LD          BC,$204                                ;2 x 4 rectangle
   443  0b74  cd780b                CALL        SUB_ram_cb1c
   444  0b77  c9                    RET
   445                          SUB_ram_cb1c:
   446  0b78  dde1                  POP         IX
   447  0b7a  77                    LD          (HL),A
   448  0b7b  112900                LD          DE,$29                                 ;EDIT MEdb?
   449  0b7e  19                    ADD         HL,DE
   450  0b7f  77                    LD          (HL),A
   451  0b80  2b                    DEC         HL
   452  0b81  1b                    DEC         DE
   453  0b82  f1                    POP         AF
   454  0b83  77                    LD          (HL),A
   455  0b84  19                    ADD         HL,DE
   456  0b85  cd4109                CALL        DRAW_CHRCOLS
   457  0b88  19                    ADD         HL,DE
   458  0b89  77                    LD          (HL),A
   459  0b8a  19                    ADD         HL,DE
   460  0b8b  f1                    POP         AF
   461  0b8c  77                    LD          (HL),A
   462  0b8d  37                    SCF
   463  0b8e  3f                    CCF
   464  0b8f  ed52                  SBC         HL,DE
   465  0b91  23                    INC         HL
   466  0b92  77                    LD          (HL),A
   467  0b93  dde9                  JP          (IX)
   468                          DRAW_WALL_L2_C:
   469  0b95  21c035                LD          HL,DAT_ram_35c0                         ;= $60    `
   470  0b98  010402                LD          BC,$204                                ;2 x 4 rectangle
   471  0b9b  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   472                                                                                  ;WAS BLK on DKBLU
   473                                                                                  ;WAS LD A,0xb
   474  0b9d  c33e09                JP          FILL_CHRCOL_RECT
   475                          DRAW_WALL_L2_C_EMPTY:
   476  0ba0  21c035                LD          HL,DAT_ram_35c0                         ;= $60    `
   477  0ba3  010402                LD          BC,$204                                ;2 x 4 rectangle
   478  0ba6  3e00                  LD          A,0x0                                   ;BLK on BLK
   479  0ba8  c33e09                JP          FILL_CHRCOL_RECT
   480                          SUB_ram_cb4f:
   481  0bab  3ef4                  LD          A,$f4                                  ;DKGRY on BLU
   482                                                                                  ;WAS DKCYN on BLU
   483                                                                                  ;WAS LD A,$94
   484  0bad  f5                    PUSH        AF
   485  0bae  011004                LD          BC,$410
   486  0bb1  3e04                  LD          A,0x4                                   ;BLK on BLU
   487  0bb3  f5                    PUSH        AF
   488  0bb4  3e40                  LD          A,$40                                  ;BLU on BLK
   489                                                                                  ;WAS BLU on CYN
   490                                                                                  ;WAS LD A, $46
   491  0bb6  21b434                LD          HL,DAT_ram_34b4                         ;= $60    `
   492  0bb9  cdab0c                CALL        SUB_ram_cc4d
   493  0bbc  213f30                LD          HL,DAT_ram_303f                         ;= $20
   494  0bbf  3ec0                  LD          A,$c0                                  ;Right angle char
   495  0bc1  112700                LD          DE,$27
   496  0bc4  cdf108                CALL        SUB_ram_c87e
   497  0bc7  215c33                LD          HL,DAT_ram_335c                         ;= $20
   498  0bca  3c                    INC         A
   499  0bcb  13                    INC         DE
   500  0bcc  13                    INC         DE
   501  0bcd  c3f108                JP          SUB_ram_c87e
   502                          DRAW_FRO_DOOR:
   503  0bd0  cdab0b                CALL        SUB_ram_cb4f
   504  0bd3  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
   505                                                                                  ;WAS DKCYN on DKBLU
   506                                                                                  ;WAS LD A,$9b
   507  0bd5  08                    EX          AF,AF'
   508  0bd6  3e04                  LD          A,0x4                                   ;BLK on BLU
   509                                                                                  ;WAS DKBLU on BLU
   510                                                                                  ;WAS LDA A,$b4
   511  0bd8  c3e30b                JP          LAB_ram_cb86
   512                          SUB_ram_cb7e:
   513  0bdb  cdab0b                CALL        SUB_ram_cb4f
   514  0bde  3ef2                  LD          A,$f2                                  ;DKGRY on GRN
   515                                                                                  ;WAS DKCYN on GRN
   516                                                                                  ;WAS LD A,$92
   517  0be0  08                    EX          AF,AF'
   518  0be1  3e24                  LD          A,$24                                  ;GRN on BLU
   519                          LAB_ram_cb86:
   520  0be3  212d35                LD          HL,DAT_ram_352d                         ;= $60    `
   521  0be6  1b                    DEC         DE
   522  0be7  1b                    DEC         DE
   523  0be8  cde408                CALL        SUB_ram_c871
   524  0beb  13                    INC         DE
   525  0bec  19                    ADD         HL,DE
   526  0bed  08                    EX          AF,AF'
   527  0bee  cd0609                CALL        SUB_ram_c893
   528  0bf1  19                    ADD         HL,DE
   529  0bf2  010c03                LD          BC,$30c
   530  0bf5  cd4109                CALL        DRAW_CHRCOLS
   531  0bf8  19                    ADD         HL,DE
   532  0bf9  cd2009                CALL        SUB_ram_c8ad
   533  0bfc  19                    ADD         HL,DE
   534  0bfd  13                    INC         DE
   535  0bfe  cde408                CALL        SUB_ram_c871
   536  0c01  21df30                LD          HL,DAT_ram_30df                         ;= $20
   537  0c04  3ec0                  LD          A,$c0                                  ;Right angle char
   538  0c06  1b                    DEC         DE
   539  0c07  1b                    DEC         DE
   540  0c08  c3f308                JP          LAB_ram_c880
   541                          SUB_ram_cbae:
   542  0c0b  21dc34                LD          HL,DAT_ram_34dc                         ;= $60    `
   543  0c0e  3e04                  LD          A,0x4                                   ;BLK on BLU
   544  0c10  011004                LD          BC,$410                                ;4 x 10 rectangle
   545  0c13  c33e09                JP          FILL_CHRCOL_RECT
   546                          SUB_ram_cbb9:
   547  0c16  217c31                LD          HL,DAT_ram_317c                         ;= $20
   548  0c19  010804                LD          BC,$408
   549  0c1c  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   550                                                                                  ;WAS d134 / $86 crosshatch char
   551                                                                                  ;WAS LD A, $86
   552  0c1e  cd3e09                CALL        FILL_CHRCOL_RECT
   553  0c21  217c35                LD          HL,DAT_ram_357c                         ;= $60    `
   554  0c24  0e08                  LD          C,0x8
   555  0c26  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   556  0c28  c34109                JP          DRAW_CHRCOLS
   557                          SUB_ram_cbce:
   558  0c2b  cd160c                CALL        SUB_ram_cbb9
   559  0c2e  af                    XOR         A
   560  0c2f  c3370c                JP          LAB_ram_cbd9
   561                          SUB_ram_cbd4:
   562  0c32  cd160c                CALL        SUB_ram_cbb9
   563  0c35  3edd                  LD          A,$dd                                  ;DKGRN on DKGRNdb?
   564                          LAB_ram_cbd9:
   565  0c37  21cc35                LD          HL,DAT_ram_35cc                         ;= $60    `
   566  0c3a  010602                LD          BC,$206                                ;2 x 6 rectangledb?
   567  0c3d  c34109                JP          DRAW_CHRCOLS
   568                          SUB_ram_cbe2:
   569  0c40  217f31                LD          HL,DAT_ram_317f                         ;= $20
   570  0c43  3ec0                  LD          A,$c0                                  ;Right angle char
   571  0c45  77                    LD          (HL),A                    ;= $20
   572  0c46  112800                LD          DE,$28
   573  0c49  19                    ADD         HL,DE
   574  0c4a  2b                    DEC         HL
   575  0c4b  77                    LD          (HL),A                    ;= $20
   576  0c4c  216e32                LD          HL,DAT_ram_326e                         ;= $20
   577  0c4f  3ec1                  LD          A,$c1                                  ;Left angle char
   578  0c51  77                    LD          (HL),A                    ;= $20
   579  0c52  19                    ADD         HL,DE
   580  0c53  23                    INC         HL
   581  0c54  77                    LD          (HL),A                    ;= $20
   582  0c55  217f35                LD          HL,DAT_ram_357f                         ;= $60
   583  0c58  3ebf                  LD          A,$bf                                  ;DKBLU on DKGRY
   584                                                                                  ;WAS DKBLU on DKCYN
   585                                                                                  ;WAS LD A,$b9
   586  0c5a  77                    LD          (HL),A                    ;= $60
   587  0c5b  19                    ADD         HL,DE
   588  0c5c  2b                    DEC         HL
   589  0c5d  77                    LD          (HL),A                    ;= $60
   590  0c5e  23                    INC         HL
   591  0c5f  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   592                                                                                  ;WAS BLK on DKBLU
   593                                                                                  ;WAS LD A,0xb
   594  0c61  77                    LD          (HL),A                    ;= $60
   595  0c62  010402                LD          BC,$204                                ;2 x 4 rectangle
   596  0c65  19                    ADD         HL,DE
   597  0c66  2b                    DEC         HL                        ;= $60    `
   598  0c67  cd4109                CALL        DRAW_CHRCOLS
   599  0c6a  19                    ADD         HL,DE
   600  0c6b  23                    INC         HL
   601  0c6c  77                    LD          (HL),A                    ;= $60
   602  0c6d  2b                    DEC         HL
   603  0c6e  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   604                                                                                  ;WAS DKCYN on DKBLU
   605                                                                                  ;WAS LD A,$9b
   606  0c70  77                    LD          (HL),A                    ;= $60
   607  0c71  19                    ADD         HL,DE
   608  0c72  23                    INC         HL
   609  0c73  77                    LD          (HL),A                    ;= $60
   610  0c74  21cc35                LD          HL,DAT_ram_35cc                         ;= $60    `
   611  0c77  0e04                  LD          C,0x4
   612  0c79  3e00                  LD          A,0x0
   613  0c7b  c34109                JP          DRAW_CHRCOLS
   614                          DRAW_WALL_FR222_EMPTY:
   615  0c7e  21cc35                LD          HL,DAT_ram_35cc                         ;= $60    `
   616  0c81  010404                LD          BC,$404                                ;4 x 4 rectangle
   617  0c84  3e00                  LD          A,0x0                                   ;BLK on BLK
   618  0c86  c33e09                JP          FILL_CHRCOL_RECT
   619                          DRAW_WALL_FR1:
   620  0c89  3ec1                  LD          A,$c1
   621  0c8b  f5                    PUSH        AF
   622  0c8c  010804                LD          BC,$408                                ;4 x 8 rectangle
   623  0c8f  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   624                                                                                  ;WAS d134 / $86 crosshatch char
   625                                                                                  ;WAS LD A, $86
   626  0c91  f5                    PUSH        AF
   627  0c92  3ec0                  LD          A,$c0                                  ;Right angle char
   628  0c94  215031                LD          HL,DAT_ram_3150                         ;= $20
   629  0c97  cdab0c                CALL        SUB_ram_cc4d
   630  0c9a  3efb                  LD          A,$fb                                  ;DKGRY on DKBLU
   631                                                                                  ;WAS DKCYN on DKBLU
   632                                                                                  ;WAS LD $9b
   633  0c9c  f5                    PUSH        AF
   634  0c9d  0e08                  LD          C,0x8
   635  0c9f  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   636  0ca1  f5                    PUSH        AF
   637  0ca2  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
   638                                                                                  ;WAS DKBLU on CYN
   639                                                                                  ;WAS LD A,$b6
   640  0ca4  215035                LD          HL,DAT_ram_3550                         ;= $60    `
   641  0ca7  cdab0c                CALL        SUB_ram_cc4d
   642  0caa  c9                    RET
   643                          SUB_ram_cc4d:
   644  0cab  dde1                  POP         IX
   645  0cad  112700                LD          DE,$27
   646  0cb0  cddf08                CALL        SUB_ram_c86c
   647  0cb3  13                    INC         DE
   648  0cb4  19                    ADD         HL,DE
   649  0cb5  f1                    POP         AF
   650  0cb6  cd0609                CALL        SUB_ram_c893
   651  0cb9  19                    ADD         HL,DE
   652  0cba  2b                    DEC         HL
   653  0cbb  cd4109                CALL        DRAW_CHRCOLS
   654  0cbe  19                    ADD         HL,DE
   655  0cbf  23                    INC         HL
   656  0cc0  cd2009                CALL        SUB_ram_c8ad
   657  0cc3  19                    ADD         HL,DE
   658  0cc4  f1                    POP         AF
   659  0cc5  13                    INC         DE
   660  0cc6  cddf08                CALL        SUB_ram_c86c
   661  0cc9  dde9                  JP          (IX)
   662                          SUB_ram_cc6d:
   663  0ccb  cd890c                CALL        DRAW_WALL_FR1
   664  0cce  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
   665                                                                                  ;WAS DKCYN on BLK
   666                                                                                  ;WAS LD A,$90
   667  0cd0  f5                    PUSH        AF
   668  0cd1  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
   669  0cd3  f5                    PUSH        AF
   670  0cd4  3e0b                  LD          A,0xb                                   ;BLK on DKBLU
   671  0cd6  c3e40c                JP          LAB_ram_cc85
   672                          SUB_ram_cc7a:
   673  0cd9  cd890c                CALL        DRAW_WALL_FR1
   674  0cdc  3efd                  LD          A,$fd                                  ;DKGRY on DKGRN
   675                                                                                  ;WAS DKCYN on DKGRN
   676                                                                                  ;WAS LD A,$9d
   677  0cde  f5                    PUSH        AF
   678  0cdf  3e2d                  LD          A,$2d                                  ;GRN on DKGRN
   679  0ce1  f5                    PUSH        AF
   680  0ce2  3edb                  LD          A,$db                                  ;DKGRN on DKBLU
   681                          LAB_ram_cc85:
   682  0ce4  217a35                LD          HL,DAT_ram_357a                         ;= $60    `
   683  0ce7  010702                LD          BC,$207                                ;2 x 7 rectangle
   684  0cea  cd670d                CALL        SUB_ram_cd07
   685  0ced  217a31                LD          HL,DAT_ram_317a                         ;= $20
   686  0cf0  3ec0                  LD          A,$c0                                  ;Right angle char
   687  0cf2  77                    LD          (HL),A                    ;= $20
   688  0cf3  112700                LD          DE,$27
   689  0cf6  19                    ADD         HL,DE
   690  0cf7  77                    LD          (HL),A                    ;= $20
   691  0cf8  c9                    RET
   692                          SUB_ram_cc9a:
   693  0cf9  217835                LD          HL,DAT_ram_3578                         ;= $60    `
   694  0cfc  010804                LD          BC,$408                                ;4 x 8 rectangle
   695  0cff  3e4b                  LD          A,$4b                                  ;BLU on DKBLU
   696  0d01  cd3e09                CALL        FILL_CHRCOL_RECT
   697  0d04  217831                LD          HL,DAT_ram_3178                         ;= $20
   698  0d07  0e08                  LD          C,0x8
   699  0d09  3e20                  LD          A,$20                                  ;Change to SPACE 32 / $20
   700                                                                                  ;WAS d134 / $86 crosshatch char
   701                                                                                  ;WAS LD A, $86
   702  0d0b  c34109                JP          DRAW_CHRCOLS
   703                          SUB_ram_ccaf:
   704  0d0e  cdf90c                CALL        SUB_ram_cc9a
   705  0d11  af                    XOR         A
   706  0d12  c31a0d                JP          LAB_ram_ccba
   707                          SUB_ram_ccb5:
   708  0d15  cdf90c                CALL        SUB_ram_cc9a
   709  0d18  3edd                  LD          A,$dd                                  ;DKGRN on DKGRN
   710                          LAB_ram_ccba:
   711  0d1a  21ca35                LD          HL,DAT_ram_35ca                         ;= $60    `
   712  0d1d  010602                LD          BC,$206                                ;2 x 6 rectangle
   713  0d20  c34109                JP          DRAW_CHRCOLS
   714                          SUB_ram_ccc3:
   715  0d23  21ca35                LD          HL,DAT_ram_35ca                         ;= $60    `
   716  0d26  010402                LD          BC,$204                                ;2 x 4 rectangle
   717  0d29  3e00                  LD          A,0x0                                   ;BLK on BLK
   718  0d2b  cd3e09                CALL        FILL_CHRCOL_RECT
   719  0d2e  0e04                  LD          C,0x4
   720  0d30  21c835                LD          HL,DAT_ram_35c8                         ;= $60    `
   721  0d33  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   722                                                                                  ;WAS BLK on DKBLU
   723                                                                                  ;WAS LD A, 0xb
   724  0d35  c34109                JP          DRAW_CHRCOLS
   725                          DRAW_WALL_FR2_EMPTY:
   726  0d38  21c835                LD          HL,DAT_ram_35c8                         ;= $60    `
   727  0d3b  010404                LD          BC,$404                                ;4 x 4 rectangle
   728  0d3e  3e00                  LD          A,0x0                                   ;BLK on BLK
   729  0d40  c33e09                JP          FILL_CHRCOL_RECT
   730                          DRAW_WALL_FR2:
   731  0d43  3e0f                  LD          A,0xf                                   ;FR2 Bottom
   732                                                                                  ;BLK on DKGRY
   733                                                                                  ;WAS DKCYN on DKBLU
   734                                                                                  ;WAS LD A,$9b
   735  0d45  f5                    PUSH        AF
   736  0d46  3e0f                  LD          A,0xf                                   ;FR2 Wall
   737                                                                                  ;BLK on DKGRY
   738                                                                                  ;WAS BLK on DKBLU
   739                                                                                  ;WAS LD A,0xb
   740  0d48  f5                    PUSH        AF
   741  0d49  3ef0                  LD          A,$f0                                  ;FR2 Top
   742                                                                                  ;DKGRY on BLK
   743                                                                                  ;WAS DKBLU on CYN
   744                                                                                  ;WAS LD A,$b6
   745  0d4b  217735                LD          HL,DAT_ram_3577                         ;= $60    `
   746  0d4e  010402                LD          BC,$204                                ;2 x 4 rectangle
   747  0d51  cd670d                CALL        SUB_ram_cd07
   748  0d54  216632                LD          HL,DAT_ram_3266                         ;= $20
   749  0d57  3eda                  LD          A,$da                                  ;Left slash char
   750  0d59  77                    LD          (HL),A                    ;= $20
   751  0d5a  19                    ADD         HL,DE
   752  0d5b  77                    LD          (HL),A                    ;= $20
   753  0d5c  217731                LD          HL,DAT_ram_3177                         ;= $20
   754  0d5f  3ec0                  LD          A,$c0                                  ;Right angle char
   755  0d61  77                    LD          (HL),A                    ;= $20
   756  0d62  1b                    DEC         DE
   757  0d63  1b                    DEC         DE
   758  0d64  19                    ADD         HL,DE
   759  0d65  77                    LD          (HL),A                    ;= $20
   760  0d66  c9                    RET
   761                          SUB_ram_cd07:
   762  0d67  dde1                  POP         IX
   763  0d69  77                    LD          (HL),A
   764  0d6a  112700                LD          DE,$27
   765  0d6d  19                    ADD         HL,DE
   766  0d6e  77                    LD          (HL),A
   767  0d6f  23                    INC         HL
   768  0d70  f1                    POP         AF
   769  0d71  77                    LD          (HL),A
   770  0d72  19                    ADD         HL,DE
   771  0d73  13                    INC         DE
   772  0d74  cd4109                CALL        DRAW_CHRCOLS
   773  0d77  13                    INC         DE
   774  0d78  19                    ADD         HL,DE
   775  0d79  77                    LD          (HL),A
   776  0d7a  2b                    DEC         HL
   777  0d7b  f1                    POP         AF
   778  0d7c  77                    LD          (HL),A
   779  0d7d  19                    ADD         HL,DE
   780  0d7e  77                    LD          (HL),A
   781  0d7f  dde9                  JP          (IX)
   782                          SUB_ram_cd21:
   783  0d81  21c635                LD          HL,DAT_ram_35c6                         ;= $60    `
   784  0d84  010402                LD          BC,$204                                ;2 x 4 rectangle
   785  0d87  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
   786                                                                                  ;WAS BLK on DKBLU
   787                                                                                  ;WAS LD A,0xb
   788  0d89  c33e09                JP          FILL_CHRCOL_RECT
   789                          SUB_ram_cd2c:
   790  0d8c  21c635                LD          HL,DAT_ram_35c6                         ;= $60    `
   791  0d8f  010402                LD          BC,$204                                ;2 x 4 rectangle
   792  0d92  3e00                  LD          A,0x0                                   ;BLK on BLK
   793  0d94  c33e09                JP          FILL_CHRCOL_RECT
   794  0d97  3e08                  LD          A,0x8
   795  0d99  32b83a                LD          (SOUND_REPEAT_COUNT),A
   796  0d9c  47                    LD          B,A
   797                          LAB_ram_cd3d:
   798  0d9d  c5                    PUSH        BC
   799  0d9e  cdbd0e                CALL        SOUND_04
   800  0da1  cd480e                CALL        SUB_ram_cde7
   801  0da4  cd950e                CALL        SOUND_02
   802  0da7  cd810e                CALL        SOUND_01
   803  0daa  c1                    POP         BC
   804  0dab  10f0                  DJNZ        LAB_ram_cd3d
   805  0dad  c9                    RET
   806  0dae  3e07                  LD          A,0x7
   807  0db0  32b83a                LD          (SOUND_REPEAT_COUNT),A
   808  0db3  47                    LD          B,A
   809                          LAB_ram_cd54:
   810  0db4  c5                    PUSH        BC
   811  0db5  cd950e                CALL        SOUND_02
   812  0db8  cda90e                CALL        SOUND_03
   813  0dbb  c1                    POP         BC
   814  0dbc  10f6                  DJNZ        LAB_ram_cd54
   815  0dbe  c9                    RET
   816                          SUB_ram_cd5f:
   817  0dbf  3e0a                  LD          A,0xa
   818  0dc1  32b83a                LD          (SOUND_REPEAT_COUNT),A
   819  0dc4  47                    LD          B,A
   820                          LAB_ram_cd65:
   821  0dc5  c5                    PUSH        BC
   822  0dc6  cdbd0e                CALL        SOUND_04
   823  0dc9  cdd10e                CALL        SOUND_05
   824  0dcc  c1                    POP         BC
   825  0dcd  10f6                  DJNZ        LAB_ram_cd65
   826  0dcf  c3200e                JP          SUB_ram_cdbf
   827                          POOF_SOUND:
   828  0dd2  3e07                  LD          A,0x7
   829  0dd4  32b83a                LD          (SOUND_REPEAT_COUNT),A
   830  0dd7  0601                  LD          B,0x1
   831  0dd9  c3e20d                JP          DOINK_SOUND
   832                          END_OF_GAME_SOUND:
   833  0ddc  3e04                  LD          A,0x4                                   ;Was LD A,0x7
   834  0dde  32b83a                LD          (SOUND_REPEAT_COUNT),A
   835  0de1  47                    LD          B,A
   836                          DOINK_SOUND:
   837  0de2  c5                    PUSH        BC
   838  0de3  cd950e                CALL        SOUND_02
   839  0de6  cd480e                CALL        SUB_ram_cde7
   840  0de9  cda90e                CALL        SOUND_03
   841  0dec  c1                    POP         BC
   842  0ded  10f3                  DJNZ        DOINK_SOUND
   843  0def  c9                    RET
   844  0df0  cd480e                CALL        SUB_ram_cde7
   845  0df3  cd480e                CALL        SUB_ram_cde7
   846  0df6  cd480e                CALL        SUB_ram_cde7
   847  0df9  cd480e                CALL        SUB_ram_cde7
   848  0dfc  cd480e                CALL        SUB_ram_cde7
   849  0dff  cd480e                CALL        SUB_ram_cde7
   850  0e02  cd480e                CALL        SUB_ram_cde7
   851  0e05  cd480e                CALL        SUB_ram_cde7
   852  0e08  cd480e                CALL        SUB_ram_cde7
   853  0e0b  cd480e                CALL        SUB_ram_cde7
   854  0e0e  cd480e                CALL        SUB_ram_cde7
   855  0e11  cdd10e                CALL        SOUND_05
   856  0e14  cdd10e                CALL        SOUND_05
   857  0e17  cdd10e                CALL        SOUND_05
   858  0e1a  cdd10e                CALL        SOUND_05
   859  0e1d  c3d10e                JP          SOUND_05
   860                          SUB_ram_cdbf:
   861  0e20  3e00                  LD          A,0x0
   862  0e22  f5                    PUSH        AF
   863  0e23  014000                LD          BC,$40
   864  0e26  111500                LD          DE,$15
   865  0e29  210004                LD          HL,$400
   866  0e2c  3e00                  LD          A,0x0
   867  0e2e  32b53a                LD          (PITCH_UP_BOOL),A
   868  0e31  c3e50e                JP          PLAY_PITCH_CHANGE
   869                          SUB_ram_cdd3:
   870  0e34  3e00                  LD          A,0x0
   871  0e36  f5                    PUSH        AF
   872  0e37  01a000                LD          BC,$a0
   873  0e3a  110800                LD          DE,0x8
   874  0e3d  210008                LD          HL,$800
   875  0e40  3e00                  LD          A,0x0
   876  0e42  32b53a                LD          (PITCH_UP_BOOL),A
   877  0e45  c3e50e                JP          PLAY_PITCH_CHANGE
   878                          SUB_ram_cde7:
   879  0e48  3e00                  LD          A,0x0
   880  0e4a  f5                    PUSH        AF
   881  0e4b  01a000                LD          BC,$a0
   882  0e4e  110100                LD          DE,0x1
   883  0e51  210200                LD          HL,0x2
   884  0e54  3e00                  LD          A,0x0
   885  0e56  32b53a                LD          (PITCH_UP_BOOL),A
   886  0e59  c3e50e                JP          PLAY_PITCH_CHANGE
   887                          SETUP_OPEN_DOOR_SOUND:
   888  0e5c  110f00                LD          DE,0xf
   889  0e5f  218005                LD          HL,$580
   890                          LO_HI_PITCH_SOUND:
   891  0e62  010800                LD          BC,0x8
   892  0e65  3e00                  LD          A,0x0
   893  0e67  f5                    PUSH        AF
   894  0e68  3e01                  LD          A,0x1
   895  0e6a  32b53a                LD          (PITCH_UP_BOOL),A
   896  0e6d  c3e50e                JP          PLAY_PITCH_CHANGE
   897                          SETUP_CLOSE_DOOR_SOUND:
   898  0e70  210500                LD          HL,0x5
   899  0e73  110c00                LD          DE,0xc
   900                          HI_LO_PITCH_SOUND:
   901  0e76  010e00                LD          BC,0xe                                  ;H
   902  0e79  af                    XOR         A
   903  0e7a  f5                    PUSH        AF
   904  0e7b  32b53a                LD          (PITCH_UP_BOOL),A
   905  0e7e  c3e50e                JP          PLAY_PITCH_CHANGE
   906                          SOUND_01:
   907  0e81  3e00                  LD          A,0x0
   908  0e83  f5                    PUSH        AF
   909  0e84  013000                LD          BC,$30
   910  0e87  110200                LD          DE,0x2
   911  0e8a  210001                LD          HL,$100
   912  0e8d  3e01                  LD          A,0x1
   913  0e8f  32b53a                LD          (PITCH_UP_BOOL),A
   914  0e92  c3e50e                JP          PLAY_PITCH_CHANGE
   915                          SOUND_02:
   916  0e95  3e00                  LD          A,0x0
   917  0e97  f5                    PUSH        AF
   918  0e98  011a00                LD          BC,$1a
   919  0e9b  111000                LD          DE,$10
   920  0e9e  210003                LD          HL,$300
   921  0ea1  3e01                  LD          A,0x1
   922  0ea3  32b53a                LD          (PITCH_UP_BOOL),A
   923  0ea6  c3e50e                JP          PLAY_PITCH_CHANGE
   924                          SOUND_03:
   925  0ea9  3e00                  LD          A,0x0
   926  0eab  f5                    PUSH        AF
   927  0eac  012a00                LD          BC,$2a
   928  0eaf  110a00                LD          DE,0xa
   929  0eb2  210400                LD          HL,0x4
   930  0eb5  3e00                  LD          A,0x0
   931  0eb7  32b53a                LD          (PITCH_UP_BOOL),A
   932  0eba  c3e50e                JP          PLAY_PITCH_CHANGE
   933                          SOUND_04:
   934  0ebd  3e00                  LD          A,0x0
   935  0ebf  f5                    PUSH        AF
   936  0ec0  012000                LD          BC,$20
   937  0ec3  110200                LD          DE,0x2
   938  0ec6  215500                LD          HL,$55
   939  0ec9  3e01                  LD          A,0x1
   940  0ecb  32b53a                LD          (PITCH_UP_BOOL),A
   941  0ece  c3e50e                JP          PLAY_PITCH_CHANGE
   942                          SOUND_05:
   943  0ed1  3e00                  LD          A,0x0
   944  0ed3  f5                    PUSH        AF
   945  0ed4  013000                LD          BC,$30
   946  0ed7  110100                LD          DE,0x1
   947  0eda  210100                LD          HL,0x1
   948  0edd  3e00                  LD          A,0x0
   949  0edf  32b53a                LD          (PITCH_UP_BOOL),A
   950  0ee2  c3e50e                JP          PLAY_PITCH_CHANGE
   951                          PLAY_PITCH_CHANGE:
   952  0ee5  22b33a                LD          (SND_CYCLE_HOLDER),HL
   953                          PLAY_PITCH_CHANGE_LOOP:
   954  0ee8  2b                    DEC         HL
   955  0ee9  7c                    LD          A,H
   956  0eea  b5                    OR          L                                       ;Clear flags
   957  0eeb  c2e80e                JP          NZ,PLAY_PITCH_CHANGE_LOOP
   958  0eee  f1                    POP         AF
   959  0eef  d3fc                  OUT         (SPEAKER),A                             ;= db
   960  0ef1  ee01                  XOR         0x1
   961  0ef3  f5                    PUSH        AF
   962  0ef4  0b                    DEC         BC
   963  0ef5  78                    LD          A,B
   964  0ef6  b1                    OR          C
   965  0ef7  c2ff0e                JP          NZ,INCREASE_PITCH
   966  0efa  f1                    POP         AF
   967  0efb  2ab33a                LD          HL,(SND_CYCLE_HOLDER)
   968  0efe  c9                    RET
   969                          INCREASE_PITCH:
   970  0eff  21b53a                LD          HL,PITCH_UP_BOOL
   971  0f02  cb46                  BIT         0x0,(HL)
   972  0f04  ca0f0f                JP          Z,DECREASE_PITCH
   973  0f07  2ab33a                LD          HL,(SND_CYCLE_HOLDER)
   974  0f0a  ed52                  SBC         HL,DE
   975  0f0c  c3e50e                JP          PLAY_PITCH_CHANGE
   976                          DECREASE_PITCH:
   977  0f0f  2ab33a                LD          HL,(SND_CYCLE_HOLDER)
   978  0f12  19                    ADD         HL,DE
   979  0f13  c3e50e                JP          PLAY_PITCH_CHANGE
   980                          HC_JOY_INPUT_COMPARE:
   981  0f16  3a663a                LD          A,(RAM_AE)
   982  0f19  fe31                  CP          $31                                    ;Compare to "1" db?
   983  0f1b  c2092a                JP          NZ,WAIT_FOR_INPUT
   984  0f1e  2afe37                LD          HL,(HC_INPUT_HOLDER)                    ;= $6060
   985  0f21  3ef3                  LD          A,$f3                                  ;Compare to JOY disc UUL
   986  0f23  bd                    CP          L
   987  0f24  ca1121                JP          Z,DO_MOVE_FW_CHK_WALLS
   988  0f27  bc                    CP          H
   989  0f28  ca1121                JP          Z,DO_MOVE_FW_CHK_WALLS
   990  0f2b  3efb                  LD          A,$fb                                  ;Compare to JOY disc UP
   991  0f2d  bd                    CP          L
   992  0f2e  ca1121                JP          Z,DO_MOVE_FW_CHK_WALLS
   993  0f31  bc                    CP          H
   994  0f32  ca1121                JP          Z,DO_MOVE_FW_CHK_WALLS
   995  0f35  3eeb                  LD          A,$eb                                  ;Compare to JOY disc UUR
   996  0f37  bc                    CP          H
   997  0f38  ca1121                JP          Z,DO_MOVE_FW_CHK_WALLS
   998  0f3b  bd                    CP          L
   999  0f3c  ca1121                JP          Z,DO_MOVE_FW_CHK_WALLS
  1000  0f3f  3ee9                  LD          A,$e9                                  ;Compare to JOY disc UR
  1001  0f41  bd                    CP          L
  1002  0f42  caae2d                JP          Z,DO_TURN_RIGHT
  1003  0f45  bc                    CP          H
  1004  0f46  caae2d                JP          Z,DO_TURN_RIGHT
  1005  0f49  3ef9                  LD          A,$f9                                  ;Compare to JOY disc RUR
  1006  0f4b  bd                    CP          L
  1007  0f4c  caae2d                JP          Z,DO_TURN_RIGHT
  1008  0f4f  bc                    CP          H
  1009  0f50  caae2d                JP          Z,DO_TURN_RIGHT
  1010  0f53  3efd                  LD          A,$fd                                  ;Compare to JOY disc RIGHT
  1011  0f55  bd                    CP          L
  1012  0f56  caae2d                JP          Z,DO_TURN_RIGHT
  1013  0f59  bc                    CP          H
  1014  0f5a  caae2d                JP          Z,DO_TURN_RIGHT
  1015  0f5d  3ee7                  LD          A,$e7                                  ;Compare to JOY disc LUL
  1016  0f5f  bd                    CP          L
  1017  0f60  ca962d                JP          Z,DO_TURN_LEFT
  1018  0f63  bc                    CP          H
  1019  0f64  ca962d                JP          Z,DO_TURN_LEFT
  1020  0f67  3ee3                  LD          A,$e3                                  ;Compare to JOY disc UL
  1021  0f69  bd                    CP          L
  1022  0f6a  ca962d                JP          Z,DO_TURN_LEFT
  1023  0f6d  bc                    CP          H
  1024  0f6e  ca962d                JP          Z,DO_TURN_LEFT
  1025  0f71  3ef7                  LD          A,$f7                                  ;Compare to JOY disc LEFT
  1026  0f73  bd                    CP          L
  1027  0f74  ca962d                JP          Z,DO_TURN_LEFT
  1028  0f77  bc                    CP          H
  1029  0f78  ca962d                JP          Z,DO_TURN_LEFT
  1030  0f7b  3ef6                  LD          A,$f6                                  ;Compare to JOY disc LDL
  1031  0f7d  bd                    CP          L
  1032  0f7e  cade2d                JP          Z,DO_GLANCE_LEFT
  1033  0f81  bc                    CP          H
  1034  0f82  cade2d                JP          Z,DO_GLANCE_LEFT
  1035  0f85  3ee6                  LD          A,$e6                                  ;Compare to JOY disc DL
  1036  0f87  bd                    CP          L
  1037  0f88  cade2d                JP          Z,DO_GLANCE_LEFT
  1038  0f8b  bc                    CP          H
  1039  0f8c  cade2d                JP          Z,DO_GLANCE_LEFT
  1040  0f8f  3eed                  LD          A,$ed                                  ;Compare to JOY disc RDR
  1041  0f91  bd                    CP          L
  1042  0f92  cac82d                JP          Z,DO_GLANCE_RIGHT
  1043  0f95  bc                    CP          H
  1044  0f96  cac82d                JP          Z,DO_GLANCE_RIGHT
  1045  0f99  3eec                  LD          A,$ec                                  ;Compare to JOY disc DR
  1046  0f9b  bd                    CP          L
  1047  0f9c  cac82d                JP          Z,DO_GLANCE_RIGHT
  1048  0f9f  bc                    CP          H
  1049  0fa0  cac82d                JP          Z,DO_GLANCE_RIGHT
  1050  0fa3  3efc                  LD          A,$fc                                  ;Compare to JOY disc DDR
  1051  0fa5  bd                    CP          L
  1052  0fa6  ca4321                JP          Z,DO_JUMP_BACK
  1053  0fa9  bc                    CP          H
  1054  0faa  ca4321                JP          Z,DO_JUMP_BACK
  1055  0fad  3efe                  LD          A,$fe                                  ;Compare to JOY disc DOWN
  1056  0faf  bd                    CP          L
  1057  0fb0  ca4321                JP          Z,DO_JUMP_BACK
  1058  0fb3  bc                    CP          H
  1059  0fb4  ca4321                JP          Z,DO_JUMP_BACK
  1060  0fb7  3eee                  LD          A,$ee                                  ;Compare to JOY disc DDL
  1061  0fb9  bd                    CP          L
  1062  0fba  ca4321                JP          Z,DO_JUMP_BACK
  1063  0fbd  bc                    CP          H
  1064  0fbe  ca4321                JP          Z,DO_JUMP_BACK
  1065  0fc1  3edf                  LD          A,$df                                  ;Compare to JOY K4
  1066  0fc3  bd                    CP          L
  1067  0fc4  ca2411                JP          Z,TOGGLE_SHIFT_MODE
  1068  0fc7  bc                    CP          H
  1069  0fc8  ca2411                JP          Z,TOGGLE_SHIFT_MODE
  1070  0fcb  3ab93a                LD          A,(GAME_BOOLEANS)
  1071  0fce  cb4f                  BIT         0x1,A
  1072  0fd0  c20810                JP          NZ,DO_HC_SHIFT_ACTIONS
  1073                          DO_HC_BUTTON_ACTIONS:
  1074  0fd3  3ebf                  LD          A,$bf                                  ;Compare to JOY K1
  1075  0fd5  bd                    CP          L
  1076  0fd6  caf42d                JP          Z,DO_USE_ATTACK
  1077  0fd9  bc                    CP          H
  1078  0fda  caf42d                JP          Z,DO_USE_ATTACK
  1079  0fdd  3e7b                  LD          A,$7b                                  ;Compare to JOY K2
  1080  0fdf  bd                    CP          L
  1081  0fe0  ca652c                JP          Z,DO_OPEN_CLOSE
  1082  0fe3  bc                    CP          H
  1083  0fe4  ca652c                JP          Z,DO_OPEN_CLOSE
  1084  0fe7  3e5f                  LD          A,$5f                                  ;Compare to JOY K3
  1085  0fe9  bd                    CP          L
  1086  0fea  ca2427                JP          Z,DO_PICK_UP
  1087  0fed  bc                    CP          H
  1088  0fee  ca2427                JP          Z,DO_PICK_UP
  1089  0ff1  3e7d                  LD          A,$7d                                  ;Compare to JOY K5
  1090  0ff3  bd                    CP          L
  1091  0ff4  cad229                JP          Z,DO_SWAP_PACK
  1092  0ff7  bc                    CP          H
  1093  0ff8  cad229                JP          Z,DO_SWAP_PACK
  1094  0ffb  3e7e                  LD          A,$7e                                  ;Compare to JOY K6
  1095  0ffd  bd                    CP          L
  1096  0ffe  ca6229                JP          Z,DO_ROTATE_PACK
  1097  1001  bc                    CP          H
  1098  1002  ca6229                JP          Z,DO_ROTATE_PACK
  1099  1005  c3a521                JP          NO_ACTION_TAKEN
  1100                          DO_HC_SHIFT_ACTIONS:
  1101  1008  3ebf                  LD          A,$bf                                  ;Compare to JOY K1
  1102  100a  bd                    CP          L
  1103  100b  ca6432                JP          Z,DO_USE_LADDER
  1104  100e  bc                    CP          H
  1105  100f  ca6432                JP          Z,DO_USE_LADDER
  1106  1012  3e7b                  LD          A,$7b                                  ;Compare to JOY K2
  1107  1014  bd                    CP          L
  1108  1015  ca8721                JP          Z,DO_COUNT_FOOD
  1109  1018  bc                    CP          H
  1110  1019  ca8721                JP          Z,DO_COUNT_FOOD
  1111  101c  3e5f                  LD          A,$5f                                  ;Compare to JOY K3
  1112  101e  bd                    CP          L
  1113  101f  ca9f21                JP          Z,DO_COUNT_ARROWS
  1114  1022  bc                    CP          H
  1115  1023  ca9f21                JP          Z,DO_COUNT_ARROWS
  1116  1026  3e7d                  LD          A,$7d                                  ;Compare to JOY K5
  1117  1028  bd                    CP          L
  1118  1029  ca1526                JP          Z,DO_SWAP_HANDS
  1119  102c  bc                    CP          H
  1120  102d  ca1526                JP          Z,DO_SWAP_HANDS
  1121  1030  3e7e                  LD          A,$7e                                  ;Compare to JOY K6
  1122  1032  bd                    CP          L
  1123  1033  ca193b                JP          Z,DO_REST
  1124  1036  bc                    CP          H
  1125  1037  ca193b                JP          Z,DO_REST
  1126  103a  3ecc                  LD          A,$cc                                  ;Compare to K4 + DR chord
  1127  103c  bd                    CP          L
  1128  103d  ca953c                JP          Z,MAX_HEALTH_ARROWS_FOOD
  1129  1040  bc                    CP          H
  1130  1041  ca953c                JP          Z,MAX_HEALTH_ARROWS_FOOD
  1131  1044  3ec6                  LD          A,$c6                                  ;Compare to K4 + DL chord
  1132  1046  bd                    CP          L
  1133  1047  cab43c                JP          Z,DO_TELEPORT
  1134  104a  bc                    CP          H
  1135  104b  cab43c                JP          Z,DO_TELEPORT
  1136  104e  c3a521                JP          NO_ACTION_TAKEN
  1137                          DRAW_BKGD:
  1138  1051  3e20                  LD          A,$20                                  ;Set VIEWPORT fill chars to SPACE
  1139  1053  212830                LD          HL,$3028
  1140  1056  011818                LD          BC,$1818                               ;24 x 24 cells
  1141  1059  cd3e09                CALL        FILL_CHRCOL_RECT
  1142  105c  0e08                  LD          C,0x8                                   ;8 rows of ceiling
  1143  105e  212834                LD          HL,$3428
  1144  1061  3ef0                  LD          A,$f0                                  ;DKGRY on BLK
  1145  1063  cd4109                CALL        DRAW_CHRCOLS
  1146  1066  0e06                  LD          C,0x6                                   ;6 more rows of ceiling
  1147  1068  19                    ADD         HL,DE
  1148  1069  3e00                  LD          A,0x0                                   ;BLK on BLK
  1149  106b  cd4109                CALL        DRAW_CHRCOLS
  1150  106e  0e0a                  LD          C,0xa                                   ;10 rows of floor
  1151  1070  19                    ADD         HL,DE
  1152  1071  3edf                  LD          A,$df                                  ;DKGRN on DKGRY
  1153  1073  cd4109                CALL        DRAW_CHRCOLS
  1154  1076  3aa33a                LD          A,(CURR_MONSTER_PHYS)
  1155  1079  fe00                  CP          0x0
  1156  107b  ca8a10                JP          Z,NOT_IN_BATTLE
  1157  107e  3aa23a                LD          A,(CURR_MONSTER_SPRT)
  1158  1081  fe00                  CP          0x0
  1159  1083  ca8a10                JP          Z,NOT_IN_BATTLE
  1160  1086  cd2832                CALL        REDRAW_MONSTER_HEALTH
  1161  1089  c9                    RET
  1162                          NOT_IN_BATTLE:
  1163  108a  c9                    RET
  1164                          WIPE_VARIABLE_SPACE:
  1165  108b  3e00                  LD          A,0x0
  1166  108d  210039                LD          HL,$3900
  1167  1090  06ff                  LD          B,$ff
  1168                          CLEAR_MAP_SPACE:
  1169  1092  77                    LD          (HL),A
  1170  1093  23                    INC         HL
  1171  1094  77                    LD          (HL),A
  1172  1095  23                    INC         HL
  1173  1096  77                    LD          (HL),A
  1174  1097  23                    INC         HL
  1175  1098  10f8                  DJNZ        CLEAR_MAP_SPACE
  1176  109a  21623a                LD          HL,$3a62
  1177  109d  22ba3a                LD          (NEXT_BLINK_CHECK),HL
  1178  10a0  c9                    RET
  1179                          DRAW_WHITE_MAP:
  1180  10a1  217400                LD          HL,$74
  1181  10a4  cd8d22                CALL        MAP_ITEM_MONSTER
  1182                          UPDATE_ITEM_CELLS:
  1183  10a7  ca0122                JP          Z,DRAW_PURPLE_MAP
  1184  10aa  0a                    LD          A,(BC)
  1185  10ab  0c                    INC         C
  1186  10ac  0c                    INC         C
  1187  10ad  d9                    EXX
  1188  10ae  16b6                  LD          D,$b6
  1189  10b0  cda122                CALL        UPDATE_COLRAM_FROM_OFFSET
  1190  10b3  d9                    EXX
  1191  10b4  cd9022                CALL        FIND_NEXT_ITEM_MONSTER_LOOP
  1192  10b7  c3a710                JP          UPDATE_ITEM_CELLS
  1193  10ba  c30122                JP          DRAW_PURPLE_MAP
  1194                          PLAY_POOF_ANIM:
  1195  10bd  e5                    PUSH        HL                                      ;Save HL register value
  1196  10be  11a607                LD          DE,POOF_1                               ;DE = Start of POOF animation graphic
  1197  10c1  0670                  LD          B,$70                                  ;Set color to WHT on BLK
  1198  10c3  d9                    EXX                                                 ;Swap BC DE HL with BC' DE' HL'
  1199  10c4  cdd20d                CALL        POOF_SOUND
  1200  10c7  d9                    EXX                                                 ;Swap BC DE HL with BC' DE' HL'
  1201  10c8  cdfa32                CALL        GFX_DRAW
  1202  10cb  e1                    POP         HL                  ;Restore DE register value
  1203  10cc  cdfc10                CALL        TOGGLE_ITEM_POOF_AND_WAIT
  1204  10cf  e5                    PUSH        HL
  1205  10d0  cdfa32                CALL        GFX_DRAW
  1206  10d3  e1                    POP         HL
  1207  10d4  d5                    PUSH        DE
  1208  10d5  112900                LD          DE,$29
  1209  10d8  ed52                  SBC         HL,DE
  1210  10da  d1                    POP         DE                              ;= $D7,$C9,$01
  1211  10db  cdfc10                CALL        TOGGLE_ITEM_POOF_AND_WAIT
  1212  10de  e5                    PUSH        HL
  1213  10df  cdfa32                CALL        GFX_DRAW
  1214  10e2  e1                    POP         HL
  1215  10e3  e5                    PUSH        HL
  1216  10e4  0680                  LD          B,$80
  1217  10e6  cdfa32                CALL        GFX_DRAW
  1218  10e9  cdfc10                CALL        TOGGLE_ITEM_POOF_AND_WAIT
  1219  10ec  e1                    POP         HL
  1220  10ed  e5                    PUSH        HL
  1221  10ee  cdfa32                CALL        GFX_DRAW
  1222  10f1  cdfc10                CALL        TOGGLE_ITEM_POOF_AND_WAIT
  1223  10f4  06d0                  LD          B,$d0
  1224  10f6  e1                    POP         HL
  1225  10f7  cdfa32                CALL        GFX_DRAW
  1226  10fa  08                    EX          AF,AF'
  1227  10fb  c9                    RET
  1228                          TOGGLE_ITEM_POOF_AND_WAIT:
  1229  10fc  d9                    EXX
  1230  10fd  010032                LD          BC,DAT_ram_3200                         ;= $20
  1231  1100  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  1232  1103  d9                    EXX
  1233  1104  c9                    RET
  1234                          MONSTER_KILLED:
  1235  1105  213b32                LD          HL,CHRRAM_MONSTER_POOF_IDX              ;= $20
  1236  1108  cdbd10                CALL        PLAY_POOF_ANIM
  1237  110b  3a793a                LD          A,(PLAYER_MAP_POS)                      ;A  = Player position in map
  1238  110e  2a603a                LD          HL,(DIR_FACING_FW)                      ;HL = FW adjustment value
  1239  1111  84                    ADD         A,H                                     ;A  = Player position in map
  1240                                                                                  ;one step forward
  1241  1112  cdcf37                CALL        ITEM_MAP_CHECK                          ;Upon return,
  1242                                                                                  ;A  = itemNum one step forward
  1243                                                                                  ;BC = itemMapRAMLocation
  1244  1115  fe9f                  CP          $9f                                    ;Check to see if it is
  1245                                                                                  ;the Minotaur ($9f)
  1246  1117  cad33a                JP          Z,MINOTAUR_DEAD
  1247  111a  3efe                  LD          A,$fe                                  ;A  = $fe (empty item space)
  1248  111c  02                    LD          (BC),A                                  ;itemMapLocRAM = $fe (empty)
  1249  111d  cded24                CALL        CLEAR_MONSTER_STATS
  1250  1120  e1                    POP         HL
  1251  1121  c3002a                JP          UPDATE_VIEWPORT
  1252                          TOGGLE_SHIFT_MODE:
  1253  1124  3ab93a                LD          A,(GAME_BOOLEANS)
  1254  1127  cb4f                  BIT         0x1,A                                   ;NZ if SHIFT MODE
  1255  1129  c23911                JP          NZ,RESET_SHIFT_MODE
  1256                          SET_SHIFT_MODE:
  1257  112c  cbcf                  SET         0x1,A                                   ;Set SHIFT MODE boolean
  1258  112e  32b93a                LD          (GAME_BOOLEANS),A
  1259  1131  3ed0                  LD          A,$d0                                  ;DKGRN on BLK
  1260  1133  320534                LD          (COLRAM_SHIFT_MODE_IDX),A               ;= $60    `
  1261  1136  c3062a                JP          INPUT_DEBOUNCE
  1262                          RESET_SHIFT_MODE:
  1263  1139  3ab93a                LD          A,(GAME_BOOLEANS)                       ;Reset SHIFT MODE boolean
  1264  113c  cb8f                  RES         0x1,A
  1265  113e  32b93a                LD          (GAME_BOOLEANS),A
  1266  1141  3ef0                  LD          A,$f0
  1267  1143  320534                LD          (COLRAM_SHIFT_MODE_IDX),A               ;= $60    `
  1268  1146  c3062a                JP          INPUT_DEBOUNCE
  1269                          SHOW_AUTHOR:
  1270  1149  214833                LD          HL,CHRRAM_AUTHORS_IDX                   ;= $20
  1271  114c  11f707                LD          DE,AUTHORS                              ;= "   Originally programmed by Tom L...
  1272  114f  0620                  LD          B,$20
  1273  1151  cdfa32                CALL        GFX_DRAW
  1274  1154  3eff                  LD          A,$ff
  1275  1156  c3092a                JP          WAIT_FOR_INPUT
  1276                          TIMER_UPDATE:
  1277  1159  2a693a                LD          HL,(TIMER_A)
  1278  115c  010100                LD          BC,0x1
  1279  115f  09                    ADD         HL,BC
  1280  1160  22693a                LD          (TIMER_A),HL
  1281  1163  c9                    RET
  1282                          BLINK_ROUTINE:
  1283  1164  f5                    PUSH        AF
  1284  1165  3ab93a                LD          A,(GAME_BOOLEANS)
  1285  1168  cb47                  BIT         0x0,A
  1286  116a  ca7511                JP          Z,STILL_ON_TITLE
  1287  116d  c37311                JP          BLINK_EXIT_AF
  1288                          BLINK_EXIT_ALL:
  1289  1170  d1                    POP         DE
  1290  1171  e1                    POP         HL
  1291                          BLINK_EXIT_BCAF:
  1292  1172  c1                    POP         BC
  1293                          BLINK_EXIT_AF:
  1294  1173  f1                    POP         AF
  1295  1174  c9                    RET
  1296                          STILL_ON_TITLE:
  1297  1175  c5                    PUSH        BC
  1298  1176  3a6a3a                LD          A,(TIMER_B)
  1299  1179  47                    LD          B,A
  1300  117a  3aba3a                LD          A,(NEXT_BLINK_CHECK)
  1301  117d  b8                    CP          B
  1302  117e  c27211                JP          NZ,BLINK_EXIT_BCAF
  1303  1181  ed5f                  LD          A,R
  1304  1183  32ba3a                LD          (NEXT_BLINK_CHECK),A
  1305  1186  e5                    PUSH        HL
  1306  1187  d5                    PUSH        DE
  1307  1188  cdae11                CALL        DO_CLOSE_EYES
  1308  118b  010080                LD          BC,$8000
  1309  118e  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  1310  1191  cd9711                CALL        DO_OPEN_EYES
  1311  1194  c37011                JP          BLINK_EXIT_ALL
  1312                          DO_OPEN_EYES:
  1313  1197  11d632                LD          DE,$32d6
  1314  119a  210000                LD          HL,TS_EYES_OPEN_CHR                    ; Pinned to TITLE_SCREEN (0xD800) + 726; WAS 0xdad6
  1315  119d  014400                LD          BC,$44
  1316  11a0  edb0                  LDIR
  1317  11a2  11d636                LD          DE,$36d6
  1318  11a5  210000                LD          HL,TS_EYES_OPTN_COL                    ; Pinned to TITLE_SCREEN (0XD800) + 1750; WAS 0xded6
  1319  11a8  014400                LD          BC,$44
  1320  11ab  edb0                  LDIR
  1321  11ad  c9                    RET
  1322                          DO_CLOSE_EYES:
  1323  11ae  21d632                LD          HL,$32d6
  1324  11b1  01d0d1                LD          BC,$d1d0                    ; Value, not an address
  1325  11b4  70                    LD          (HL),B
  1326  11b5  23                    INC         HL
  1327  11b6  70                    LD          (HL),B
  1328  11b7  111a00                LD          DE,$1a
  1329  11ba  19                    ADD         HL,DE
  1330  11bb  70                    LD          (HL),B
  1331  11bc  2b                    DEC         HL
  1332  11bd  70                    LD          (HL),B
  1333  11be  21fe32                LD          HL,$32fe
  1334  11c1  71                    LD          (HL),C
  1335  11c2  23                    INC         HL
  1336  11c3  70                    LD          (HL),B
  1337  11c4  19                    ADD         HL,DE
  1338  11c5  70                    LD          (HL),B
  1339  11c6  2b                    DEC         HL
  1340  11c7  71                    LD          (HL),C
  1341  11c8  21d636                LD          HL,$36d6
  1342  11cb  010ff0                LD          BC,$f00f                    ; Value, not an address
  1343  11ce  70                    LD          (HL),B
  1344  11cf  23                    INC         HL
  1345  11d0  71                    LD          (HL),C
  1346  11d1  19                    ADD         HL,DE
  1347  11d2  71                    LD          (HL),C
  1348  11d3  2b                    DEC         HL
  1349  11d4  70                    LD          (HL),B
  1350  11d5  21fe36                LD          HL,$36fe
  1351  11d8  70                    LD          (HL),B
  1352  11d9  23                    INC         HL
  1353  11da  70                    LD          (HL),B
  1354  11db  19                    ADD         HL,DE
  1355  11dc  70                    LD          (HL),B
  1356  11dd  2b                    DEC         HL
  1357  11de  70                    LD          (HL),B
  1358  11df  c9                    RET
  1359                          DRAW_ICON_BAR:
  1360  11e0  f5                    PUSH        AF
  1361  11e1  e5                    PUSH        HL
  1362  11e2  210130                LD          HL,CHRRAM_LEVEL_IND_L                   ;= $20
  1363  11e5  3685                  LD          (HL),$85           ;Right side halftone CHR
  1364  11e7  23                    INC         HL
  1365  11e8  23                    INC         HL
  1366  11e9  23                    INC         HL
  1367  11ea  3695                  LD          (HL),$95           ;Left side halftone CHR
  1368  11ec  23                    INC         HL
  1369  11ed  3608                  LD          (HL),0x8         ;Up arrow CHR
  1370  11ef  23                    INC         HL
  1371  11f0  23                    INC         HL
  1372  11f1  3648                  LD          (HL),$48            ;Ladder (H) CHR
  1373  11f3  23                    INC         HL
  1374  11f4  23                    INC         HL
  1375  11f5  36d3                  LD          (HL),$d3              ;Item CHR
  1376  11f7  23                    INC         HL
  1377  11f8  23                    INC         HL
  1378  11f9  3693                  LD          (HL),$93           ;Monster CHR
  1379  11fb  23                    INC         HL
  1380  11fc  23                    INC         HL
  1381  11fd  3685                  LD          (HL),$85              ;Right side halftone CHR
  1382  11ff  23                    INC         HL
  1383  1200  23                    INC         HL
  1384  1201  23                    INC         HL
  1385  1202  23                    INC         HL                                      ;Map CHR
  1386  1203  36d1                  LD          (HL),$d1               ;= $20
  1387  1205  23                    INC         HL
  1388  1206  23                    INC         HL                                      ;Armor CHR
  1389  1207  369d                  LD          (HL),$9d             ;= $20
  1390  1209  23                    INC         HL
  1391  120a  23                    INC         HL                                      ;Helmet CHR
  1392  120b  360e                  LD          (HL),0xe             ;= $20
  1393  120d  23                    INC         HL
  1394  120e  23                    INC         HL                                      ;Ring (o) CHR
  1395  120f  366f                  LD          (HL),$6f              ;= $20
  1396  1211  e1                    POP         HL
  1397  1212  f1                    POP         AF
  1398  1213  c9                    RET
  1399                          DRAW_COMPASS:
  1400  1214  f5                    PUSH        AF                                      ;DKBLU on BLK
  1401  1215  c5                    PUSH        BC
  1402  1216  e5                    PUSH        HL
  1403  1217  d5                    PUSH        DE
  1404  1218  06b0                  LD          B,$b0
  1405  121a  21af31                LD          HL,DAT_ram_31af                         ;= $20
  1406  121d  119a07                LD          DE,COMPASS                              ;= $D7,"n",$C9,$01
  1407  1220  cdfa32                CALL        GFX_DRAW
  1408  1223  21d835                LD          HL,DAT_ram_35d8                         ;= $60
  1409  1226  3610                  LD          (HL),$10                 ;= $60
  1410  1228  d1                    POP         DE
  1411  1229  e1                    POP         HL
  1412  122a  c1                    POP         BC
  1413  122b  f1                    POP         AF
  1414  122c  c9                    RET
  1415                          WIPE_WALLS:
  1416  122d  f5                    PUSH        AF
  1417  122e  c5                    PUSH        BC
  1418  122f  e5                    PUSH        HL
  1419  1230  210038                LD          HL,$3800
  1420  1233  010000                LD          BC,0x0
  1421  1236  3e00                  LD          A,0x0
  1422                          WIPE_WALLS_LOOP:
  1423  1238  77                    LD          (HL),A
  1424  1239  23                    INC         HL
  1425  123a  10fc                  DJNZ        WIPE_WALLS_LOOP
  1426  123c  e1                    POP         HL
  1427  123d  c1                    POP         BC
  1428  123e  f1                    POP         AF
  1429  123f  cd002a                CALL        UPDATE_VIEWPORT
  1430  1242  c3062a                JP          INPUT_DEBOUNCE
  1431                          DRAW_WALL_FL22_EMPTY:
  1432  1245  21b835                LD          HL,COLRAM_FL22_WALL_IDX                 ;= $60    `
  1433  1248  010404                LD          BC,$404                                ;4 x 4 rectangle
  1434  124b  3e00                  LD          A,0x0                                   ;BLK on BLK
  1435  124d  cd3e09                CALL        FILL_CHRCOL_RECT
  1436  1250  213032                LD          HL,DAT_ram_3230                         ;= $20
  1437  1253  010104                LD          BC,$401                                ;4 x 1 rectangle
  1438  1256  3e20                  LD          A,$20                                  ;SPACE char
  1439  1258  c33e09                JP          FILL_CHRCOL_RECT
  1440                          DRAW_WALL_FL2_NEW:
  1441  125b  213432                LD          HL,$3234                               ;Bottom CHARRAM IDX of FL2
  1442  125e  010104                LD          BC,$401                                ;4 x 1 rectangle
  1443  1261  3e90                  LD          A,$90                                  ;Thin base line char
  1444  1263  cd3e09                CALL        FILL_CHRCOL_RECT
  1445  1266  21bc35                LD          HL,$35bc
  1446  1269  010402                LD          BC,$204                                ;2 x 4 rectangle
  1447  126c  3e0f                  LD          A,0xf                                   ;BLK on DKGRY
  1448  126e  cd3e09                CALL        FILL_CHRCOL_RECT
  1449  1271  0e04                  LD          C,0x4
  1450  1273  21be35                LD          HL,$35be
  1451  1276  3e0f                  LD          A,0xf
  1452  1278  c34109                JP          DRAW_CHRCOLS
  1453                          FIX_ICON_COLORS:
  1454  127b  210134                LD          HL,COLRAM_LEVEL_IDX_L                   ;= $60
  1455  127e  3a6c3a                LD          A,(INPUT_HOLDER)
  1456  1281  87                    ADD         A,A
  1457  1282  d601                  SUB         0x1
  1458  1284  77                    LD          (HL),A              ;= $60
  1459  1285  2c                    INC         L
  1460  1286  77                    LD          (HL),A             ;= $60
  1461  1287  2c                    INC         L
  1462  1288  77                    LD          (HL),A              ;= $60
  1463  1289  2c                    INC         L
  1464  128a  77                    LD          (HL),A              ;= $60
  1465  128b  210534                LD          HL,COLRAM_SHIFT_MODE_IDX                ;= $60    `
  1466  128e  010013                LD          BC,$1300
  1467  1291  2b                    DEC         HL
  1468                          ICON_GREY_FILL_LOOP:
  1469  1292  23                    INC         HL
  1470  1293  36f0                  LD          (HL),$f0
  1471  1295  10fb                  DJNZ        ICON_GREY_FILL_LOOP
  1472  1297  c9                    RET
  1473                          
src/asterion.asm:
     8  1298  0000000000000000     defs         $1800 - $, $00
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
     9                          
    10                          TITLE_SCREEN:
    11  1800  2020202020202020  INCBIN "asterion_title.scr"
              2020e0fcfcb02020  
              2020202020202020  
              2020202020202020  
              e0f0202020202020  
              20202020202020e8  
              fffcbfa3a3efb4ff  
              20eab5e8ffb4eaff  
              80b4ffeab520ffe8  
              bfabb5c420202020  
              20202020202020fe  
              8ffff5f5fdffffff  
              20eab5fe8ffdeab5  
              dbc3ffeab520ffaa  
              fd1fb02020202020  
              d02020202020e8ff  
              ffffb0ebb4f5ffff  
              b0eaffffffffffff  
              ffa1ffeaf520ffe0  
              a2abfd20202020d0  
              d1d1d0202020fea5  
              20aafdf0f0fef7aa  
              ffffffa520aaffb5  
              ebf5ffa2efffffea  
              fdfebf2020d0d1d1  
              20d0d0d1d0202020  
              d020a2afafa3effd  
              b0436f6d70757465  
              722053797374656d  
              a2a320d0d1d0d020  
              d1d1d1d0d0d0d1d0  
              d0d0d020d0d0d0d0  
              d020d0d0d0d0d0d0  
              20d0d020d0d0d0d0  
              d0d1d0d0d1d0d1d1  
              d0d1d020d1d1d020  
              d0d1d0d1d0d1d0d0  
              d0d1d0d1d1d0d1d1  
              d1d0d1d0d020d0d0  
              20d0d1d020d0d1d0  
              2020d0d1d020d0d1  
              d0d0d0d1d1d0d1d1  
              d1d1d0d1d1d0d1d1  
              d1d1d0d1d1d0d0d0  
              d1d020d0d1d12020  
              202020d0d1d0d0d0  
              d1d1d0d0d1d1d1d0  
              d0d1d0d0d1d0d0d1  
              d1d1d1d1d1d1d0d1  
              d020d0d1d0202020  
              eafffcffb0feffb0  
              fefdb5fdffb4d0d0  
              e8fff5e0fffffcff  
              fffdfdffb4fffdff  
              eab5faffb0ffffb4  
              e0b5ffeab5faebb5  
              a1fae5bfd0a1d0d0  
              e0b7ffeaf5d0a1ea  
              b5e0bfd0a1fae0ff  
              eaf5ffeaf5faeab5  
              eab5ffeab5fffeb5  
              e8bfeaffffd04f46  
              eafdffaaffffb4ea  
              b5eaffffd0ffffa5  
              eaffb5d0ffffeab5  
              eab5ffeab5ffebb5  
              ffa5b2fdd0b0d0d0  
              eab7ffe0d0ebb5ea  
              b5a2fd20b0ffeab5  
              eab7ffeab7ffeab5  
              eab5ffeab5ffeab5  
              bfffa5bfffa5d0d0  
              eab5ffaaffffa1ea  
              b5d0bfffa5ffa2ff  
              eab5ebffa1ffeab5  
              d0d0d1d1d1d1d1d0  
              d0d1d1d0d0d0d0d0  
              d1d1d0d0d0d0d0d0  
              d0d0d0d0d0d0d0d0  
              d1d1d1d1d1d1d120  
              d12020d0d0d1d1d1  
              d1d0d0d0d0d0d0d0  
              d0d0d0d0d0d0d0d0  
              d0d0d0d0d0d0d1d1  
              d1d1d0d0d020d0d0  
              20d02020d0d1d0d1  
              d1d1d15072657373  
              d133d1666f72d145  
              415359d1d1d1d1d1  
              d0d1d1d020202020  
              d020202020d020c6  
              d0d1d15072657373  
              d132d1666f72d14d  
              454449554dd1d1d1  
              20c6d020202020d0  
              2020202020d02020  
              d0d1d15072657373  
              d131d1666f72d148  
              415244d1d1d1d1d0  
              2020d02020202020  
              202020d02020d0d0  
              d1d0d15072657373  
              d134d1666f72d148  
              415244455354d0d1  
              d0d0202020202020  
              20202020202020d0  
              d0d0d0d1d1d1d0d1  
              d1d1d1d1d1d1d1d0  
              d1d1d1d1d1d1d020  
              202020d020202020  
              20202020d0202020  
              d0d0d1d0d1d0d1d0  
              d0d1d0d0d0d1d0d1  
              d0d0d0d1d0d120d0  
              2020d02020202020  
              2043616e20796f75  
              20636f6e71756572  
              20746865206d696e  
              6f746175722cd041  
              73746572696f6e3f  
              2020202020202020  
              2020202020202020  
              2020202020202020  
              2020202020202020  
              2020202020202020  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              7030303030303030  
              3030404040403030  
              3030303030303030  
              3030303030303030  
              4040303030303030  
              3030303030303040  
              404041434d4d4040  
              3040404040404040  
              4040404040304040  
              4040404030303030  
              3030303030303040  
              0440e1133dd34040  
              3040404004404040  
              0440404040304040  
              4040403030303030  
              b030303030304040  
              40404e1e133d4040  
              4040404040404040  
              4040404040304040  
              40404030303030b0  
              0ff0b03030304040  
              30404e4e41434040  
              4040404030404040  
              4040404040404040  
              4040403030b0f00f  
              0fbf0f0fb0303030  
              f030404040404040  
              4080808080808080  
              8030808080808080  
              404030b00f0fbf0f  
              0f0fbfbfbf0ff0f0  
              f0f0f030f0f0f0f0  
              f030f0f0f0f0f0f0  
              30f0f030f0f0f0f0  
              f00f0fbfbfbf0f0f  
              f0f00f0fbfbfbf0f  
              b0f0f0f0f0f0f0f0  
              f0f0b0f0f0f0f0f0  
              f0b0f0f0f030b00f  
              0fbfbfbf0f0ff0f0  
              3030f0f00f0fbfbf  
              bf0f0ff0f0f0f0f0  
              f00f0f0f0f0f0ff0  
              f0f0f0f0f0b00fbf  
              bfbf0f0f0ff03030  
              303030f0f00f0fbf  
              bfbf0f0f0ff00f0f  
              0f0f0f0f0f0f0f0f  
              0ff0f0f00f0fbfbf  
              bf0f0f0ff0303030  
              303f3030303f303f  
              3f3f3f3f303f0f0f  
              3f303f3f30303f30  
              303f3f303f303f30  
              3f3f3f3f303f3f30  
              30303f303030303f  
              3f3f3f300f3f0f0f  
              3f3f3f3f3f0f3f3f  
              3f3f3f0f3f3f3f3f  
              30303f3030303030  
              30303f30303f303f  
              3f3f3f303f0f3f3f  
              3f3f303f3f3f3f3f  
              3f3f3f3f0f303f3f  
              3f3f30f030303030  
              30303f30303f303f  
              303f3f300f3f0f0f  
              3f3f303f0f3f3f3f  
              3f3f3f3f3f303f3f  
              3f303f3030303030  
              303030303030303f  
              30303f30303f0f0f  
              3f3f303f303f3f3f  
              3f0f30303f303f3f  
              3f3f3f3f303f3030  
              f0f0f0f00f0f0f0f  
              0ff00f0f0f0f0f0f  
              0f0f0f0f0f0f0f0f  
              0f0f0f0f0f0f0f0f  
              0ff0f0f0f00ff030  
              f03030f0f0f0f0f0  
              0f0f0f0f0f0f0f0f  
              0f0f0f0f0f0f0f0f  
              0f0f0f0f0f0f0ff0  
              f0f0f0f0f030f0b0  
              30f03030f0f0bfbf  
              f00f0f1f1f1f1f1f  
              0f010f1f1f1f0f1f  
              1f1f1f0f0f0f0ff0  
              bfbff0f030303030  
              f030303030f03040  
              bf0f0f3f3f3f3f3f  
              0ff30f3f3f3f0f3f  
              3f3f3f3f3f0f0f0f  
              3040b030303030f0  
              3030303030f03030  
              0ff00f5f5f5f5f5f  
              0ff50f5f5f5f0f5f  
              5f5f5f0f0f0ff00f  
              3030f03030303030  
              303030f03030f0f0  
              f0f0f07f7f7f7f7f  
              0ff70f7f7f7f0f7f  
              7f7f7f7f7f7ff0f0  
              f0f0303030303030  
              30303030303030f0  
              f0f0f0f0f0f0f0f0  
              f0f0f0f0f0f0f0f0  
              f0f0f0f0f0f0f030  
              303030f030303030  
              30303030f0303030  
              f0f0f0f0f0f0f0f0  
              f0f0f0f0f0f0f0f0  
              f0f0f0f0f0f030f0  
              3030f03030303030  
              30d0d0d030d0d0d0  
              30d0d0d0d0d0d0d0  
              30d0d0d030d0d0d0  
              d0d0d0d0d0d0f020  
              20202020202020d0  
              3030303030303030  
              3030303030303030  
              3030303030303030  
              3030303030303030  
              3030303030303030  
              0000000000000000  
              0000000000000000  
              0000000000000000  
    12                          
    13                          TS_EYES_OPEN_CHR EQU TITLE_SCREEN + 726
    14                          TITLE_SCREEN_COL EQU TITLE_SCREEN + 1024
    15                          TS_EYES_OPTN_COL EQU TITLE_SCREEN + 1750
    16                          
    17                          include "scramblecode.asm"
src/scramblecode.asm:
     1                          ; Aquarius SCRAMBLECODE include file
     2                          SCRAMBLECODE:
     3  2000  3e5b5e00              DB 0x3e,0x5b,0x5e,0x00
     4  2004  009c00b0              DB 0x00,0x9c,0x00,0xb0
     5  2008  006c0064              DB 0x00,0x6c,0x00,0x64
     6  200c  00a85e70              DB 0x00,0xa8,0x5e,0x70
     7                          
src/asterion.asm:
    18                          
    19                          include "asterion_high_rom.asm"
src/asterion_high_rom.asm:
     1                          GAMEINIT:
     2  2010  31ff3f                LD          SP,$3fff                      ;Set SP to top of BANK0 RAM
     3  2013  cd8b10                CALL        WIPE_VARIABLE_SPACE                     ;Wipe variable space first...
     4  2016  3602                  LD          (HL),0x2              ;($3a62) = 0x2
     5  2018  2c                    INC         L                                       ;HL = $3a63
     6  2019  3e32                  LD          A,$32                                  ;A = $32
     7  201b  77                    LD          (HL),A                          ;($3a63) = $32
     8  201c  2c                    INC         L                                       ;HL = $3a64
     9  201d  77                    LD          (HL),A                          ;($3a64) = $32
    10  201e  2c                    INC         L                                       ;HL = $3a65
    11  201f  77                    LD          (HL),A                          ;($3a65) = $32
    12  2020  2c                    INC         L                                       ;HL = $3a66
    13  2021  3d                    DEC         A                                       ;A = $31
    14  2022  77                    LD          (HL),A                          ;($3a66) = $31
    15  2023  2c                    INC         L                                       ;HL = $3a67
    16  2024  77                    LD          (HL),A                          ;($3a67) = $31
    17  2025  2c                    INC         L                                       ;HL = $3a68
    18  2026  0612                  LD          B,$12                                  ;B = $12
    19  2028  af                    XOR         A                                       ;A = 0x0, F = $44 (Z and P set)
    20                          LAB_ram_e029:
    21  2029  77                    LD          (HL),A                   ;($3a68) = $00
    22  202a  2c                    INC         L                                       ;HL = $3a69 to $3a7a,
    23                                                                                  ;A = 0x0, F = $28
    24  202b  10fc                  DJNZ        LAB_ram_e029                            ;Loop if Not Z (B is decremented)
    25  202d  3e18                  LD          A,$18                                  ;A = $18 (HL = $3a7a, B = 0x0)
    26  202f  77                    LD          (HL),A                         ;($3a7a) = $18
    27  2030  23                    INC         HL                                      ;HL = $3a7b
    28  2031  3efe                  LD          A,$fe                                  ;A = $fe
    29  2033  0610                  LD          B,$10                                  ;B = $10
    30                          LAB_ram_e035:
    31  2035  77                    LD          (HL),A                         ;= $60
    32  2036  23                    INC         HL
    33  2037  10fc                  DJNZ        LAB_ram_e035                            ;Loop if Not Z (B is decremented)
    34  2039  0620                  LD          B,$20                                  ;Set fill CHR to SPACE 32/$20
    35  203b  210030                LD          HL,CHRRAM                               ;HL = $3000 (Start of CHRRAM)
    36  203e  cd591e                CALL        FILL_FULL_1024                          ;byte FILL_FULL_1024(word chrColValue...
    37  2041  215e00                LD          HL,$5e                                 ;HL = $005e
    38  2044  229c3a                LD          (TIMER_E),HL                            ;($3a9c) = $0053
    39  2047  ed5f                  LD          A,R                                     ;Semi-random number into A
    40  2049  67                    LD          H,A
    41  204a  22913a                LD          (RNDHOLD_AA),HL
    42  204d  017f00                LD          BC,$7f
    43  2050  3e07                  LD          A,0x7
    44  2052  ed79                  OUT         (C),A                          ;= db
    45  2054  0d                    DEC         C
    46  2055  3e3f                  LD          A,$3f
    47  2057  ed79                  OUT         (C),A                          ;= db
    48  2059  0606                  LD          B,0x6                                   ;BLK on CYN
    49  205b  210034                LD          HL,COLRAM                               ;= $60
    50  205e  cd591e                CALL        FILL_FULL_1024                          ;byte FILL_FULL_1024(word chrColValue...
    51  2061  cd362c                CALL        CHK_ITEM
    52  2064  cd6a20                CALL        DRAW_TITLE
    53  2067  c3062a                JP          INPUT_DEBOUNCE
    54                          DRAW_TITLE:
    55  206a  110030                LD          DE,CHRRAM                               ;= $20
    56  206d  210018                LD          HL,TITLE_SCREEN                    ; Pinned to TITLE_SCREEN ; WAS 0xD800
    57  2070  01e803                LD          BC,$3e8
    58  2073  edb0                  LDIR                                                ;= $20
    59  2075  110034                LD          DE,COLRAM                               ;= $60
    60  2078  210000                LD          HL,TITLE_SCREEN_COL                    ; Pinned to TITLE_SCREEN ; WAS 0xD800 + 1024
    61  207b  01e803                LD          BC,$3e8
    62  207e  edb0                  LDIR                                                ;= $60
    63                                                                                  ;= $70
    64  2080  c9                    RET
    65                          BLANK_SCRN:
    66  2081  210030                LD          HL,CHRRAM                               ;= $20
    67  2084  0620                  LD          B,$20                                  ;SPACE char
    68  2086  cd591e                CALL        FILL_FULL_1024                          ;byte FILL_FULL_1024(word chrColValue...
    69  2089  210034                LD          HL,COLRAM                               ;= $60
    70  208c  06d0                  LD          B,$d0                                  ;DKGRN on BLK
    71  208e  cd591e                CALL        FILL_FULL_1024                          ;byte FILL_FULL_1024(word chrColValue...
    72  2091  116c07                LD          DE,STATS_TXT                            ;DE = STATS_TXT
    73  2094  211930                LD          HL,CHRRAM_STATS_TOP                     ;HL = CHRRAM_STATS_TOP
    74  2097  06d0                  LD          B,$d0                                  ;DKGRN on BLK
    75  2099  cdfa32                CALL        GFX_DRAW
    76  209c  214530                LD          HL,IDX_HEALTH_SPACER                    ;= $20
    77  209f  cdfa32                CALL        GFX_DRAW
    78  20a2  213000                LD          HL,$30                                 ;Set starting PHYS HEALTH = 30
    79  20a5  1e15                  LD          E,$15                                  ;Set starting SPRT HEALTH = 15
    80  20a7  22933a                LD          (PLAYER_PHYS_HEALTH),HL
    81  20aa  22953a                LD          (PLAYER_PHYS_HEALTH_MAX),HL
    82  20ad  7b                    LD          A,E
    83  20ae  32973a                LD          (PLAYER_SPRT_HEALTH),A
    84  20b1  32983a                LD          (PLAYER_SPRT_HEALTH_MAX),A
    85  20b4  cdc03c                CALL        REDRAW_STATS
    86  20b7  212000                LD          HL,$20
    87  20ba  22a93a                LD          (BYTE_ram_3aa9),HL
    88  20bd  3e14                  LD          A,$14
    89  20bf  32ab3a                LD          (FOOD_INV),A                            ;Set starting FOOD_INV  = 14
    90  20c2  32ac3a                LD          (ARROW_INV),A                           ;Set starting ARROW INV = 14
    91  20c5  0610                  LD          B,$10                                  ;RED on BLK
    92  20c7  217132                LD          HL,CHRRAM_LEFT_HAND_ITEM_IDX            ;= $20
    93  20ca  11b200                LD          DE,BOW                                  ;= $01,$01,$01,$01,$01
    94  20cd  cdfa32                CALL        GFX_DRAW
    95  20d0  cd7b12                CALL        FIX_ICON_COLORS
    96  20d3  cd1412                CALL        DRAW_COMPASS
    97  20d6  3d                    DEC         A
    98  20d7  47                    LD          B,A
    99  20d8  3e03                  LD          A,0x3
   100  20da  90                    SUB         B
   101  20db  327a3a                LD          (RIGHT_HAND_ITEM),A
   102  20de  0f                    RRCA
   103  20df  dae720                JP          C,LAB_ram_e103
   104  20e2  0610                  LD          B,$10                                  ;Right hand RED SHIELD_L
   105  20e4  c3e920                JP          ADJUST_SHIELD_LEVEL
   106                          LAB_ram_e103:
   107  20e7  0630                  LD          B,$30
   108                          ADJUST_SHIELD_LEVEL:
   109  20e9  0f                    RRCA
   110  20ea  d2f120                JP          NC,LAB_ram_e10c
   111  20ed  3e40                  LD          A,$40
   112  20ef  80                    ADD         A,B
   113  20f0  47                    LD          B,A
   114                          LAB_ram_e10c:
   115  20f1  3e18                  LD          A,$18                                  ;Left hand RED BOW
   116  20f3  327b3a                LD          (LEFT_HAND_ITEM),A
   117  20f6  217b32                LD          HL,CHRRAM_RIGHT_HAND_ITEM_IDX           ;= $20
   118  20f9  110100                LD          DE,BUCKLER                              ;= $01,$01,$01,$01,$01
   119  20fc  cdfa32                CALL        GFX_DRAW
   120  20ff  cd7833                CALL        BUILD_MAP
   121  2102  cd200e                CALL        SUB_ram_cdbf
   122  2105  cd8532                CALL        SUB_ram_f2c4
   123  2108  cdda34                CALL        REDRAW_START
   124  210b  cde237                CALL        REDRAW_VIEWPORT
   125  210e  c31526                JP          DO_SWAP_HANDS
   126                          
   127                          DO_MOVE_FW_CHK_WALLS:
   128  2111  3ae833                LD          A,(WALL_F0_STATE)                       ;= $20
   129  2114  fe00                  CP          0x0                                     ;Check for no wall in F0
   130  2116  ca1e21                JP          Z,FW_WALLS_CLEAR_CHK_MONSTER
   131  2119  cb57                  BIT         0x2,A                                   ;Check for closed door
   132  211b  caa521                JP          Z,NO_ACTION_TAKEN
   133                          FW_WALLS_CLEAR_CHK_MONSTER:
   134  211e  3ae937                LD          A,(ITEM_F1)                             ;= $60
   135  2121  3c                    INC         A
   136  2122  3c                    INC         A
   137  2123  fe7a                  CP          $7a                                    ;Check for monster in F1
   138  2125  d2a521                JP          NC,NO_ACTION_TAKEN                      ;Monster in your way!
   139                                                                                  ;Do nothing.
   140  2128  ed4b603a              LD          BC,(DIR_FACING_FW)                      ;Way is clear!
   141                                                                                  ;Move forward.
   142  212c  ed439e3a              LD          (BYTE_ram_3a9e),BC
   143  2130  3a623a                LD          A,(DIR_FACING_SHORT)
   144  2133  32a03a                LD          (BYTE_ram_3aa0),A
   145  2136  3a793a                LD          A,(PLAYER_MAP_POS)
   146  2139  32773a                LD          (PLAYER_PREV_MAP_LOC),A
   147  213c  80                    ADD         A,B
   148  213d  32793a                LD          (PLAYER_MAP_POS),A
   149  2140  c3002a                JP          UPDATE_VIEWPORT
   150                          DO_JUMP_BACK:
   151  2143  21793a                LD          HL,PLAYER_MAP_POS
   152  2146  3a773a                LD          A,(PLAYER_PREV_MAP_LOC)
   153  2149  be                    CP          (HL)
   154  214a  ca7421                JP          Z,LAB_ram_e201
   155  214d  08                    EX          AF,AF'
   156  214e  2a9e3a                LD          HL,(BYTE_ram_3a9e)
   157  2151  3a613a                LD          A,(DIR_FACING_BW)
   158  2154  ed44                  NEG                                                 ;Negate A
   159  2156  bc                    CP          H
   160  2157  caa521                JP          Z,NO_ACTION_TAKEN
   161  215a  08                    EX          AF,AF'
   162  215b  32793a                LD          (PLAYER_MAP_POS),A
   163  215e  22603a                LD          (DIR_FACING_FW),HL
   164  2161  3aa03a                LD          A,(BYTE_ram_3aa0)
   165  2164  32623a                LD          (DIR_FACING_SHORT),A
   166  2167  3a783a                LD          A,(LAST_ITEM_HELD)
   167  216a  a7                    AND         A
   168  216b  ca002a                JP          Z,UPDATE_VIEWPORT
   169  216e  cded24                CALL        CLEAR_MONSTER_STATS
   170  2171  c30d32                JP          INIT_MELEE_ANIM
   171                          LAB_ram_e201:
   172  2174  010005                LD          BC,$500
   173  2177  112000                LD          DE,$20
   174  217a  cdb121                CALL        PLAY_SOUND_LOOP
   175  217d  3a783a                LD          A,(LAST_ITEM_HELD)
   176  2180  a7                    AND         A
   177  2181  ca092a                JP          Z,WAIT_FOR_INPUT
   178  2184  c30d32                JP          INIT_MELEE_ANIM
   179                          DO_COUNT_FOOD:
   180  2187  3aab3a                LD          A,(FOOD_INV)
   181                          COUNT_INV:
   182  218a  57                    LD          D,A
   183  218b  14                    INC         D
   184  218c  af                    XOR         A
   185                          PLAY_INV_COUNT_BLIPS:
   186  218d  15                    DEC         D
   187  218e  ca062a                JP          Z,INPUT_DEBOUNCE
   188  2191  08                    EX          AF,AF'
   189  2192  010024                LD          BC,BYTE_ram_2400                        ;= $FF
   190  2195  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
   191  2198  08                    EX          AF,AF'
   192  2199  d3fc                  OUT         (SPEAKER),A                             ;= db
   193  219b  3d                    DEC         A
   194  219c  c38d21                JP          PLAY_INV_COUNT_BLIPS
   195                          DO_COUNT_ARROWS:
   196  219f  3aac3a                LD          A,(ARROW_INV)
   197  21a2  c38a21                JP          COUNT_INV
   198                          NO_ACTION_TAKEN:
   199  21a5  010005                LD          BC,$500
   200  21a8  112000                LD          DE,$20
   201  21ab  cdb121                CALL        PLAY_SOUND_LOOP
   202  21ae  c3092a                JP          WAIT_FOR_INPUT
   203                          PLAY_SOUND_LOOP:
   204  21b1  1b                    DEC         DE
   205  21b2  7b                    LD          A,E
   206  21b3  b2                    OR          D
   207  21b4  c8                    RET         Z
   208  21b5  d3fc                  OUT         (SPEAKER),A                             ;Send sound to speaker
   209  21b7  60                    LD          H,B
   210  21b8  69                    LD          L,C
   211                          LAB_ram_e244:
   212  21b9  2b                    DEC         HL
   213  21ba  7d                    LD          A,L
   214  21bb  b4                    OR          H
   215  21bc  c2b921                JP          NZ,LAB_ram_e244
   216  21bf  c3b121                JP          PLAY_SOUND_LOOP
   217                          USE_MAP:
   218  21c2  3ab93a                LD          A,(GAME_BOOLEANS)
   219  21c5  cb57                  BIT         0x2,A                                   ;See if HAVE MAP bit is set
   220  21c7  caa521                JP          Z,NO_ACTION_TAKEN
   221  21ca  3aad3a                LD          A,(MAP_INV_SLOT)
   222  21cd  a7                    AND         A
   223  21ce  ca0d32                JP          Z,INIT_MELEE_ANIM
   224  21d1  d9                    EXX                                                 ;Swap BC  DE  HL
   225                                                                                  ;with BC' DE' HL'
   226  21d2  011818                LD          BC,$1818                               ;24 x 24
   227  21d5  212830                LD          HL,IDX_VIEWPORT_CHRRAM                  ;= $20
   228  21d8  3e20                  LD          A,$20                                  ;SPACE character fill
   229  21da  cd3e09                CALL        FILL_CHRCOL_RECT                        ;Fill map CHARs with SPACES
   230  21dd  cda90e                CALL        SOUND_03
   231  21e0  011818                LD          BC,$1818                               ;24 x 24
   232  21e3  212834                LD          HL,COLRAM_VIEWPORT_IDX                  ;= $60    `
   233  21e6  3eb0                  LD          A,$b0                                  ;DKBLU on BLK
   234                                                                                  ;Was DKGN on BLK
   235  21e8  cd3e09                CALL        FILL_CHRCOL_RECT                        ;Fill map colors
   236  21eb  d9                    EXX                                                 ;Swap BC  DE  HL
   237                                                                                  ;with BC' DE' HL'
   238  21ec  f5                    PUSH        AF
   239  21ed  3aad3a                LD          A,(MAP_INV_SLOT)
   240  21f0  47                    LD          B,A
   241  21f1  f1                    POP         AF
   242  21f2  05                    DEC         B
   243  21f3  ca2222                JP          Z,DRAW_RED_MAP                          ;Walls and player
   244  21f6  05                    DEC         B
   245  21f7  ca1a22                JP          Z,DRAW_YELLOW_MAP                       ;Walls, player, and ladder
   246  21fa  05                    DEC         B
   247  21fb  ca0122                JP          Z,DRAW_PURPLE_MAP                       ;Walls, player, ladder,
   248                                                                                  ;and monsters
   249  21fe  c3a110                JP          DRAW_WHITE_MAP                          ;Walls, player, ladder,
   250                                                                                  ;monsters, and items
   251                          DRAW_PURPLE_MAP:
   252  2201  21a878                LD          HL,$78a8                               ;Item range for monsters:
   253                                                                                  ;78 - skeleton
   254                                                                                  ;a8 - db?
   255  2204  cd8d22                CALL        MAP_ITEM_MONSTER
   256                          UPDATE_MONSTER_CELLS:
   257  2207  ca1a22                JP          Z,DRAW_YELLOW_MAP
   258  220a  0a                    LD          A,(BC)
   259  220b  0c                    INC         C
   260  220c  0c                    INC         C
   261  220d  d9                    EXX                                                 ;Swap BC  DE  HL
   262                                                                                  ;with BC' DE' HL'
   263  220e  16b1                  LD          D,$b1                                  ;Set current map position color
   264                                                                                  ;to $b1 DKBLU on RED
   265                                                                                  ;was DKGRN on YEL
   266  2210  cda122                CALL        UPDATE_COLRAM_FROM_OFFSET
   267  2213  d9                    EXX                                                 ;Swap BC  DE  HL
   268                                                                                  ;with BC' DE' HL'
   269  2214  cd9022                CALL        FIND_NEXT_ITEM_MONSTER_LOOP
   270  2217  c30722                JP          UPDATE_MONSTER_CELLS
   271                          DRAW_YELLOW_MAP:
   272  221a  16b5                  LD          D,$b5                                  ;Set current map position color
   273                                                                                  ;to $b5, DKBLU on PUR
   274                                                                                  ;was DKGRN on PUR
   275  221c  3aa13a                LD          A,(ITEM_HOLDER)
   276  221f  cda122                CALL        UPDATE_COLRAM_FROM_OFFSET
   277                          DRAW_RED_MAP:
   278  2222  011810                LD          BC,$1018                               ;16 x 20
   279  2225  11ff37                LD          DE,HC_LAST_INPUT
   280  2228  21cc30                LD          HL,CHRRAM_WALL_F0_IDX                   ;= $20
   281                          CALC_MINIMAP_WALL:
   282  222b  13                    INC         DE
   283  222c  7a                    LD          A,D
   284  222d  fe39                  CP          $39
   285  222f  ca5d22                JP          Z,SET_MINIMAP_PLAYER_LOC
   286  2232  1a                    LD          A,(DE)
   287  2233  b7                    OR          A
   288  2234  ca4122                JP          Z,SET_MINIMAP_NO_WALLS
   289  2237  e60f                  AND         0xf
   290  2239  c24b22                JP          NZ,LAB_ram_e2d6
   291                          SET_MINIMAP_N_WALL:
   292  223c  3ea3                  LD          A,$a3                                  ;A = $a3, map CHAR N wall
   293  223e  c35322                JP          DRAW_MINIMAP_WALL
   294                          SET_MINIMAP_NO_WALLS:
   295  2241  3ea0                  LD          A,$a0                                  ;A = $a0, map CHAR no walls
   296  2243  c35322                JP          DRAW_MINIMAP_WALL
   297                          SET_MINIMAP_NW_WALLS:
   298  2246  3eb7                  LD          A,$b7                                  ;A = $b7, map CHAR N and W walls
   299  2248  c35322                JP          DRAW_MINIMAP_WALL
   300                          LAB_ram_e2d6:
   301  224b  1a                    LD          A,(DE)
   302  224c  e6f0                  AND         $f0
   303  224e  c24622                JP          NZ,SET_MINIMAP_NW_WALLS
   304                          SET_MINIMAP_W_WALL:
   305  2251  3eb5                  LD          A,$b5                                  ;A = $b5, map CHAR W wall
   306                          DRAW_MINIMAP_WALL:
   307  2253  77                    LD          (HL),A              ;= $20
   308  2254  23                    INC         HL
   309  2255  10d4                  DJNZ        CALC_MINIMAP_WALL
   310  2257  09                    ADD         HL,BC
   311  2258  0610                  LD          B,$10
   312  225a  c32b22                JP          CALC_MINIMAP_WALL
   313                          SET_MINIMAP_PLAYER_LOC:
   314  225d  3a793a                LD          A,(PLAYER_MAP_POS)
   315  2260  16b7                  LD          D,$b7                                  ;Set player position color
   316                                                                                  ;to $b7 DKBLU on WHT
   317                                                                                  ;was DKGRN on WHT
   318  2262  cda122                CALL        UPDATE_COLRAM_FROM_OFFSET
   319  2265  cda028                CALL        WAIT_A_TICK
   320                          READ_KEY:
   321  2268  01ff00                LD          BC,$ff
   322  226b  ed78                  IN          A,(C)
   323  226d  3c                    INC         A
   324  226e  c26822                JP          NZ,READ_KEY
   325                          ENABLE_HC:
   326  2271  0ef7                  LD          C,$f7
   327  2273  3e0f                  LD          A,0xf
   328  2275  ed79                  OUT         (C),A                              ;= db
   329  2277  0d                    DEC         C
   330                          READ_HC:
   331  2278  ed78                  IN          A,(C)                     ;= db
   332  227a  3c                    INC         A
   333  227b  c26822                JP          NZ,READ_KEY
   334  227e  0c                    INC         C
   335  227f  3e0e                  LD          A,0xe
   336                          DISABLE_HC:
   337  2281  ed79                  OUT         (C),A                              ;= db
   338  2283  0d                    DEC         C
   339  2284  ed78                  IN          A,(C)                     ;= db
   340  2286  3c                    INC         A
   341  2287  c26822                JP          NZ,READ_KEY
   342  228a  c3002a                JP          UPDATE_VIEWPORT
   343                          MAP_ITEM_MONSTER:
   344  228d  010039                LD          BC,MAP_LADDER_OFFSET
   345                          FIND_NEXT_ITEM_MONSTER_LOOP:
   346  2290  0a                    LD          A,(BC)
   347  2291  03                    INC         BC
   348  2292  3c                    INC         A
   349  2293  c8                    RET         Z
   350  2294  0a                    LD          A,(BC)
   351  2295  bc                    CP          H                                       ;CP A to H (low end of itemRange)
   352  2296  03                    INC         BC
   353  2297  da9022                JP          C,FIND_NEXT_ITEM_MONSTER_LOOP
   354  229a  bd                    CP          L                                       ;CP A to L (high end of itemRange)
   355  229b  d29022                JP          NC,FIND_NEXT_ITEM_MONSTER_LOOP
   356  229e  0d                    DEC         C
   357  229f  0b                    DEC         BC
   358  22a0  c9                    RET
   359                          UPDATE_COLRAM_FROM_OFFSET:
   360  22a1  f5                    PUSH        AF
   361  22a2  e60f                  AND         0xf
   362  22a4  21cc34                LD          HL,COLRAM_F0_WALL_MAP_IDX               ;= $60    `
   363  22a7  4f                    LD          C,A
   364  22a8  0600                  LD          B,0x0
   365  22aa  09                    ADD         HL,BC
   366  22ab  f1                    POP         AF
   367  22ac  e6f0                  AND         $f0
   368  22ae  1f                    RRA
   369  22af  4f                    LD          C,A
   370  22b0  09                    ADD         HL,BC
   371  22b1  17                    RLA
   372  22b2  17                    RLA
   373  22b3  cb10                  RL          B
   374  22b5  4f                    LD          C,A
   375  22b6  09                    ADD         HL,BC
   376  22b7  72                    LD          (HL),D                                  ;LD (HL),D
   377  22b8  c9                    RET
   378                          CHK_ITEM_BREAK:
   379  22b9  78                    LD          A,B                                     ;A  = itemLevel (0-3)
   380  22ba  07                    RLCA                                                ;A  = A * 2
   381  22bb  07                    RLCA                                                ;A  = A * 2
   382  22bc  07                    RLCA                                                ;A  = A * 2
   383  22bd  4f                    LD          C,A                                     ;B  = A
   384  22be  cd8a3a                CALL        MAKE_RANDOM_BYTE                        ;A  = Random Byte
   385  22c1  81                    ADD         A,C                                     ;A  = A + B (orig A * 8)
   386  22c2  dac822                JP          C,ITEM_POOFS_RH                         ;If A > 255, item breaks
   387  22c5  c605                  ADD         A,0x5                                   ;A  = A + 5
   388  22c7  d0                    RET         NC                                      ;If A < 255, item doesn't break
   389                          ITEM_POOFS_RH:
   390  22c8  37                    SCF                                                 ;Set C
   391  22c9  08                    EX          AF,AF'
   392  22ca  216c33                LD          HL,CHRRAM_RH_POOF_IDX                   ;= $20
   393  22cd  cdbd10                CALL        PLAY_POOF_ANIM
   394                          FIX_RH_COLORS:
   395  22d0  f5                    PUSH        AF
   396  22d1  c5                    PUSH        BC
   397  22d2  e5                    PUSH        HL
   398  22d3  3ef0                  LD          A,$f0                                  ;DKGRN on BLK
   399  22d5  010404                LD          BC,$404                                ; 4 x 4 rectangle
   400  22d8  214337                LD          HL,COLRAM_RH_ITEM_IDX                   ;= $60    `
   401  22db  cd3e09                CALL        FILL_CHRCOL_RECT
   402  22de  e1                    POP         HL
   403  22df  c1                    POP         BC
   404  22e0  f1                    POP         AF
   405  22e1  37                    SCF
   406  22e2  c9                    RET
   407                          SUB_ram_e39a:
   408  22e3  cdd10e                CALL        SOUND_05
   409  22e6  3a873a                LD          A,(BYTE_ram_3a87)
   410  22e9  2a853a                LD          HL,(BYTE_ram_3a85)
   411  22ec  3d                    DEC         A
   412  22ed  c21623                JP          NZ,LAB_ram_e3cd
   413  22f0  2d                    DEC         L
   414  22f1  c2ff22                JP          NZ,LAB_ram_e3b6
   415  22f4  25                    DEC         H
   416  22f5  caa623                JP          Z,LAB_ram_e45a
   417  22f8  3e31                  LD          A,$31
   418  22fa  32643a                LD          (RAM_AC),A
   419  22fd  2e04                  LD          L,0x4
   420                          LAB_ram_e3b6:
   421  22ff  3e04                  LD          A,0x4
   422  2301  32873a                LD          (BYTE_ram_3a87),A
   423  2304  22853a                LD          (BYTE_ram_3a85),HL
   424  2307  2a833a                LD          HL,(BYTE_ram_3a83)
   425  230a  012900                LD          BC,$29
   426  230d  af                    XOR         A
   427  230e  ed42                  SBC         HL,BC
   428  2310  22833a                LD          (BYTE_ram_3a83),HL
   429  2313  c32023                JP          LAB_ram_e3d7
   430                          LAB_ram_e3cd:
   431  2316  32873a                LD          (BYTE_ram_3a87),A
   432  2319  2a833a                LD          HL,(BYTE_ram_3a83)
   433  231c  2b                    DEC         HL
   434  231d  22833a                LD          (BYTE_ram_3a83),HL
   435                          LAB_ram_e3d7:
   436  2320  01c800                LD          BC,$c8
   437  2323  af                    XOR         A
   438  2324  ed42                  SBC         HL,BC
   439  2326  e5                    PUSH        HL
   440  2327  09                    ADD         HL,BC
   441  2328  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
   442  232b  cdc528                CALL        UPDATE_MELEE_OBJECTS
   443  232e  e1                    POP         HL
   444  232f  4d                    LD          C,L
   445  2330  3a643a                LD          A,(RAM_AC)
   446  2333  32633a                LD          (MON_FS),A
   447  2336  3a823a                LD          A,(BYTE_ram_3a82)
   448  2339  cd362c                CALL        CHK_ITEM
   449  233c  3e32                  LD          A,$32
   450  233e  32633a                LD          (MON_FS),A
   451  2341  3a693a                LD          A,(TIMER_A)
   452  2344  c6ff                  ADD         A,$ff
   453  2346  32893a                LD          (BYTE_ram_3a89),A
   454  2349  c9                    RET
   455                          SUB_ram_e401:
   456  234a  7d                    LD          A,L
   457  234b  e60f                  AND         0xf
   458  234d  47                    LD          B,A
   459  234e  04                    INC         B
   460  234f  cd6623                CALL        SUB_ram_e41d
   461  2352  4f                    LD          C,A
   462  2353  7d                    LD          A,L
   463  2354  e6f0                  AND         $f0
   464  2356  07                    RLCA
   465  2357  07                    RLCA
   466  2358  07                    RLCA
   467  2359  07                    RLCA
   468  235a  47                    LD          B,A
   469  235b  04                    INC         B
   470  235c  cd6623                CALL        SUB_ram_e41d
   471  235f  07                    RLCA
   472  2360  07                    RLCA
   473  2361  07                    RLCA
   474  2362  07                    RLCA
   475  2363  81                    ADD         A,C
   476  2364  6f                    LD          L,A
   477  2365  c9                    RET
   478                          SUB_ram_e41d:
   479  2366  cda93a                CALL        UPDATE_SCR_SAVER_TIMER
   480  2369  e60f                  AND         0xf
   481                          LAB_ram_e422:
   482  236b  90                    SUB         B
   483  236c  d26b23                JP          NC,LAB_ram_e422
   484  236f  80                    ADD         A,B
   485  2370  c9                    RET
   486                          SUB_ram_e427:
   487  2371  7d                    LD          A,L
   488  2372  83                    ADD         A,E
   489  2373  27                    DAA
   490  2374  6f                    LD          L,A
   491  2375  7a                    LD          A,D
   492  2376  8c                    ADC         A,H
   493  2377  27                    DAA
   494  2378  67                    LD          H,A
   495  2379  c9                    RET
   496                          RECALC_PHYS_HEALTH:
   497  237a  7d                    LD          A,L
   498  237b  93                    SUB         E
   499  237c  27                    DAA                                                 ;Normalize BCD
   500  237d  6f                    LD          L,A
   501  237e  7c                    LD          A,H
   502  237f  9a                    SBC         A,D
   503  2380  27                    DAA                                                 ;Normalize BCD
   504  2381  67                    LD          H,A
   505  2382  c9                    RET
   506                          SUB_ram_e439:
   507  2383  af                    XOR         A
   508  2384  cb1c                  RR          H
   509  2386  d29223                JP          NC,LAB_ram_e446
   510  2389  cb1d                  RR          L
   511  238b  7d                    LD          A,L
   512  238c  d630                  SUB         $30
   513  238e  6f                    LD          L,A
   514  238f  c39423                JP          LAB_ram_e448
   515                          LAB_ram_e446:
   516  2392  cb1d                  RR          L
   517                          LAB_ram_e448:
   518  2394  cb5d                  BIT         0x3,L
   519  2396  c8                    RET         Z
   520  2397  7d                    LD          A,L
   521  2398  d603                  SUB         0x3
   522  239a  6f                    LD          L,A
   523  239b  c9                    RET
   524                          SUB_ram_e450:
   525  239c  ed5b833a              LD          DE,(BYTE_ram_3a83)
   526  23a0  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
   527  23a3  c3e228                JP          SUB_ram_e97d
   528                          LAB_ram_e45a:
   529  23a6  cd9c23                CALL        SUB_ram_e450
   530  23a9  3e32                  LD          A,$32
   531  23ab  32643a                LD          (RAM_AC),A
   532  23ae  32653a                LD          (RAM_AD),A
   533  23b1  3a9b3a                LD          A,(WEAPON_SPRT)
   534  23b4  5f                    LD          E,A
   535  23b5  1600                  LD          D,0x0
   536  23b7  fe00                  CP          0x0
   537  23b9  c26224                JP          NZ,LAB_ram_e50f
   538  23bc  ed5b993a              LD          DE,(WEAPON_PHYS)
   539  23c0  d9                    EXX
   540  23c1  cd8c26                CALL        NEW_RIGHT_HAND_ITEM
   541  23c4  d9                    EXX
   542  23c5  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
   543  23c8  cd8323                CALL        SUB_ram_e439
   544  23cb  cd7a23                CALL        RECALC_PHYS_HEALTH
   545  23ce  d2d423                JP          NC,LAB_ram_e487
   546  23d1  210000                LD          HL,0x0
   547                          LAB_ram_e487:
   548  23d4  cd4a23                CALL        SUB_ram_e401
   549  23d7  6c                    LD          L,H
   550  23d8  67                    LD          H,A
   551  23d9  cd4a23                CALL        SUB_ram_e401
   552  23dc  6c                    LD          L,H
   553  23dd  67                    LD          H,A
   554  23de  eb                    EX          DE,HL
   555  23df  cd8323                CALL        SUB_ram_e439
   556  23e2  eb                    EX          DE,HL
   557  23e3  cd7123                CALL        SUB_ram_e427
   558  23e6  eb                    EX          DE,HL
   559  23e7  cd4a23                CALL        SUB_ram_e401
   560  23ea  cd7123                CALL        SUB_ram_e427
   561  23ed  ed5ba63a              LD          DE,(NEW_DAMAGE)
   562  23f1  cd7a23                CALL        RECALC_PHYS_HEALTH
   563  23f4  da0b24                JP          C,LAB_ram_e4bb
   564                          LAB_ram_e4a9:
   565  23f7  eb                    EX          DE,HL
   566  23f8  2aa33a                LD          HL,(CURR_MONSTER_PHYS)
   567  23fb  cd7a23                CALL        RECALC_PHYS_HEALTH
   568  23fe  da1424                JP          C,LAB_ram_e4c3
   569  2401  b5                    OR          L
   570  2402  ca1424                JP          Z,LAB_ram_e4c3
   571  2405  22a33a                LD          (CURR_MONSTER_PHYS),HL
   572  2408  c32832                JP          REDRAW_MONSTER_HEALTH
   573                          LAB_ram_e4bb:
   574  240b  210600                LD          HL,0x6
   575  240e  cd4a23                CALL        SUB_ram_e401
   576  2411  c3f723                JP          LAB_ram_e4a9
   577                          LAB_ram_e4c3:
   578  2414  d9                    EXX
   579  2415  210000                LD          HL,0x0
   580  2418  22a33a                LD          (CURR_MONSTER_PHYS),HL
   581  241b  cd2832                CALL        REDRAW_MONSTER_HEALTH
   582  241e  d9                    EXX
   583  241f  2c                    INC         L
   584  2420  3e99                  LD          A,$99
   585  2422  bc                    CP          H
   586  2423  c20511                JP          NZ,MONSTER_KILLED
   587  2426  3e61                  LD          A,$61
   588  2428  bd                    CP          L
   589  2429  d20511                JP          NC,MONSTER_KILLED
   590  242c  3a4134                LD          A,(COLRAM_PHYS_STATS_1000)              ;= $60
   591  242f  cdfc24                CALL        SUB_ram_e5ba
   592  2432  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
   593  2435  cd8323                CALL        SUB_ram_e439
   594  2438  7d                    LD          A,L
   595  2439  b8                    CP          B
   596  243a  d20511                JP          NC,MONSTER_KILLED
   597                          LAB_ram_e4ec:
   598  243d  cda93a                CALL        UPDATE_SCR_SAVER_TIMER
   599  2440  d640                  SUB         $40
   600  2442  da4924                JP          C,INCREASE_MAX_PHYS_HEALTH
   601  2445  b9                    CP          C
   602  2446  d20511                JP          NC,MONSTER_KILLED
   603                          INCREASE_MAX_PHYS_HEALTH:
   604  2449  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
   605  244c  7d                    LD          A,L
   606  244d  c601                  ADD         A,0x1
   607  244f  27                    DAA                                                 ;Correct for BCD
   608  2450  6f                    LD          L,A
   609  2451  7c                    LD          A,H
   610  2452  ce00                  ADC         A,0x0
   611  2454  67                    LD          H,A
   612  2455  22953a                LD          (PLAYER_PHYS_HEALTH_MAX),HL
   613  2458  79                    LD          A,C
   614  2459  d610                  SUB         $10
   615  245b  da0511                JP          C,MONSTER_KILLED
   616  245e  4f                    LD          C,A
   617  245f  c33d24                JP          LAB_ram_e4ec
   618                          LAB_ram_e50f:
   619  2462  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
   620  2465  2600                  LD          H,0x0
   621  2467  6f                    LD          L,A
   622  2468  d9                    EXX
   623  2469  cd8c26                CALL        NEW_RIGHT_HAND_ITEM
   624  246c  d9                    EXX
   625  246d  cd8323                CALL        SUB_ram_e439
   626  2470  7d                    LD          A,L
   627  2471  93                    SUB         E
   628  2472  27                    DAA
   629  2473  6f                    LD          L,A
   630  2474  d27924                JP          NC,LAB_ram_e525
   631  2477  2e00                  LD          L,0x0
   632                          LAB_ram_e525:
   633  2479  cd4a23                CALL        SUB_ram_e401
   634  247c  eb                    EX          DE,HL
   635  247d  cd8323                CALL        SUB_ram_e439
   636  2480  7d                    LD          A,L
   637  2481  83                    ADD         A,E
   638  2482  27                    DAA
   639  2483  5f                    LD          E,A
   640  2484  cd4a23                CALL        SUB_ram_e401
   641  2487  83                    ADD         A,E
   642  2488  27                    DAA
   643  2489  6f                    LD          L,A
   644  248a  3aa53a                LD          A,(BYTE_ram_3aa5)
   645  248d  5f                    LD          E,A
   646  248e  7d                    LD          A,L
   647  248f  93                    SUB         E
   648  2490  27                    DAA
   649  2491  daa624                JP          C,LAB_ram_e54f
   650  2494  6f                    LD          L,A
   651                          MONSTER_TAKES_SPRT_DAMAGE:
   652  2495  3aa23a                LD          A,(CURR_MONSTER_SPRT)
   653  2498  95                    SUB         L
   654  2499  27                    DAA
   655  249a  daaf24                JP          C,LAB_ram_e557
   656  249d  caaf24                JP          Z,LAB_ram_e557
   657  24a0  32a23a                LD          (CURR_MONSTER_SPRT),A
   658  24a3  c32832                JP          REDRAW_MONSTER_HEALTH
   659                          LAB_ram_e54f:
   660  24a6  210300                LD          HL,0x3
   661  24a9  cd4a23                CALL        SUB_ram_e401
   662  24ac  c39524                JP          MONSTER_TAKES_SPRT_DAMAGE
   663                          LAB_ram_e557:
   664  24af  f5                    PUSH        AF
   665  24b0  af                    XOR         A
   666  24b1  32a23a                LD          (CURR_MONSTER_SPRT),A
   667  24b4  cd2832                CALL        REDRAW_MONSTER_HEALTH
   668  24b7  f1                    POP         AF
   669  24b8  3d                    DEC         A
   670  24b9  fe86                  CP          $86
   671  24bb  daea24                JP          C,ITEM_USED_UP
   672  24be  3a4634                LD          A,(COLRAM_SPRT_STATS_10)                ;= $60
   673  24c1  cdfc24                CALL        SUB_ram_e5ba
   674  24c4  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
   675  24c7  b8                    CP          B
   676  24c8  d2ea24                JP          NC,ITEM_USED_UP
   677                          REDUCE_ITEM_BY_30:
   678  24cb  cda93a                CALL        UPDATE_SCR_SAVER_TIMER
   679  24ce  d630                  SUB         $30
   680  24d0  dad724                JP          C,INCREASE_MAX_SPRT_HEALTH
   681  24d3  b9                    CP          C
   682  24d4  d2ea24                JP          NC,ITEM_USED_UP
   683                          INCREASE_MAX_SPRT_HEALTH:
   684  24d7  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
   685  24da  c601                  ADD         A,0x1
   686  24dc  27                    DAA                                                 ;Correct for BCD
   687  24dd  32983a                LD          (PLAYER_SPRT_HEALTH_MAX),A
   688  24e0  79                    LD          A,C
   689  24e1  d610                  SUB         $10
   690  24e3  daea24                JP          C,ITEM_USED_UP
   691  24e6  4f                    LD          C,A
   692  24e7  c3cb24                JP          REDUCE_ITEM_BY_30
   693                          ITEM_USED_UP:
   694  24ea  c30511                JP          MONSTER_KILLED
   695                          CLEAR_MONSTER_STATS:
   696  24ed  af                    XOR         A                                       ;A  = $fe on entry (usually)
   697                                                                                  ;A  = $00 after
   698                                                                                  ;Reset C & N, Set Z
   699                                                                                  ;
   700  24ee  32783a                LD          (LAST_ITEM_HELD),A                   ;ItemHolder = $00
   701  24f1  010304                LD          BC,$403
   702  24f4  213d33                LD          HL,CHRRAM_LEVEL_IDX                     ;= $20
   703  24f7  3e20                  LD          A,$20
   704  24f9  c33e09                JP          FILL_CHRCOL_RECT
   705                          SUB_ram_e5ba:
   706  24fc  e60f                  AND         0xf
   707  24fe  3c                    INC         A
   708  24ff  3c                    INC         A
   709  2500  47                    LD          B,A
   710  2501  07                    RLCA
   711  2502  07                    RLCA
   712  2503  07                    RLCA
   713  2504  07                    RLCA
   714  2505  4f                    LD          C,A
   715  2506  78                    LD          A,B
   716  2507  87                    ADD         A,A
   717  2508  27                    DAA
   718  2509  87                    ADD         A,A
   719  250a  27                    DAA
   720  250b  87                    ADD         A,A
   721  250c  27                    DAA
   722  250d  87                    ADD         A,A
   723  250e  27                    DAA
   724  250f  47                    LD          B,A
   725  2510  c9                    RET
   726                          MELEE_ANIM_LOOP:
   727  2511  cdd10e                CALL        SOUND_05
   728  2514  3a8b3a                LD          A,(MELEE_ANIM_STATE)
   729  2517  2a8d3a                LD          HL,(MONSTER_ATT_POS_COUNT)
   730  251a  3d                    DEC         A
   731  251b  c24225                JP          NZ,LAB_ram_e600
   732  251e  2d                    DEC         L
   733  251f  c22d25                JP          NZ,LAB_ram_e5eb
   734  2522  25                    DEC         H
   735  2523  ca8125                JP          Z,LAB_ram_e63f
   736  2526  3e32                  LD          A,$32
   737  2528  32673a                LD          (RAM_AF),A
   738  252b  2e02                  LD          L,0x2
   739                          LAB_ram_e5eb:
   740  252d  3e03                  LD          A,0x3
   741  252f  328b3a                LD          (MELEE_ANIM_STATE),A
   742  2532  228d3a                LD          (MONSTER_ATT_POS_COUNT),HL
   743  2535  2a8f3a                LD          HL,(MONSTER_ATT_POS_OFFSET)
   744  2538  012900                LD          BC,$29
   745  253b  09                    ADD         HL,BC
   746  253c  228f3a                LD          (MONSTER_ATT_POS_OFFSET),HL
   747  253f  c34c25                JP          ANIMATE_MELEE_ROUND
   748                          LAB_ram_e600:
   749  2542  328b3a                LD          (MELEE_ANIM_STATE),A
   750  2545  2a8f3a                LD          HL,(MONSTER_ATT_POS_OFFSET)
   751  2548  23                    INC         HL
   752  2549  228f3a                LD          (MONSTER_ATT_POS_OFFSET),HL
   753                          ANIMATE_MELEE_ROUND:
   754  254c  01c800                LD          BC,$c8
   755  254f  af                    XOR         A
   756  2550  ed42                  SBC         HL,BC
   757  2552  e5                    PUSH        HL
   758  2553  09                    ADD         HL,BC
   759  2554  11203a                LD          DE,BYTE_ram_3a20
   760  2557  cdc528                CALL        UPDATE_MELEE_OBJECTS
   761  255a  c1                    POP         BC
   762  255b  0600                  LD          B,0x0
   763  255d  3a673a                LD          A,(RAM_AF)
   764  2560  32633a                LD          (MON_FS),A
   765  2563  3a8a3a                LD          A,(BYTE_ram_3a8a)
   766  2566  cd362c                CALL        CHK_ITEM
   767  2569  3e32                  LD          A,$32
   768  256b  32633a                LD          (MON_FS),A
   769  256e  3a693a                LD          A,(TIMER_A)
   770  2571  c6ff                  ADD         A,$ff
   771  2573  328c3a                LD          (BYTE_ram_3a8c),A
   772  2576  c9                    RET
   773                          SUB_ram_e635:
   774  2577  ed5b8f3a              LD          DE,(MONSTER_ATT_POS_OFFSET)
   775  257b  21203a                LD          HL,BYTE_ram_3a20
   776  257e  c3e228                JP          SUB_ram_e97d
   777                          LAB_ram_e63f:
   778  2581  cd7725                CALL        SUB_ram_e635
   779  2584  3e31                  LD          A,$31
   780  2586  32673a                LD          (RAM_AF),A
   781  2589  32663a                LD          (RAM_AE),A
   782  258c  3a6c3a                LD          A,(INPUT_HOLDER)
   783  258f  47                    LD          B,A
   784  2590  2600                  LD          H,0x0
   785  2592  3aa83a                LD          A,(WEAPON_VALUE_HOLDER)
   786  2595  6f                    LD          L,A
   787  2596  c39b25                JP          LAB_ram_e658
   788                          LAB_ram_e656:
   789  2599  85                    ADD         A,L
   790  259a  27                    DAA
   791                          LAB_ram_e658:
   792  259b  10fc                  DJNZ        LAB_ram_e656
   793  259d  6f                    LD          L,A
   794  259e  3a8a3a                LD          A,(BYTE_ram_3a8a)
   795  25a1  e6fc                  AND         $fc
   796  25a3  fe24                  CP          $24
   797  25a5  c2da25                JP          NZ,LAB_ram_e693
   798  25a8  3a733a                LD          A,(SHIELD_SPRT)
   799  25ab  5f                    LD          E,A
   800  25ac  cd8323                CALL        SUB_ram_e439
   801  25af  55                    LD          D,L
   802  25b0  cd4a23                CALL        SUB_ram_e401
   803  25b3  7d                    LD          A,L
   804  25b4  82                    ADD         A,D
   805  25b5  27                    DAA
   806  25b6  93                    SUB         E
   807  25b7  27                    DAA
   808  25b8  dad025                JP          C,LAB_ram_e68a
   809  25bb  5f                    LD          E,A
   810                          LAB_ram_e677:
   811  25bc  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
   812  25bf  93                    SUB         E
   813  25c0  27                    DAA
   814  25c1  da4d2f                JP          C,PLAYER_DIES
   815  25c4  ca4d2f                JP          Z,PLAYER_DIES
   816  25c7  32973a                LD          (PLAYER_SPRT_HEALTH),A
   817  25ca  cdc03c                CALL        REDRAW_STATS
   818  25cd  c30626                JP          LAB_ram_e6be
   819                          LAB_ram_e68a:
   820  25d0  210200                LD          HL,0x2
   821  25d3  cd4a23                CALL        SUB_ram_e401
   822  25d6  5d                    LD          E,L
   823  25d7  c3bc25                JP          LAB_ram_e677
   824                          LAB_ram_e693:
   825  25da  cd4a23                CALL        SUB_ram_e401
   826  25dd  3aa83a                LD          A,(WEAPON_VALUE_HOLDER)
   827  25e0  85                    ADD         A,L
   828  25e1  27                    DAA
   829  25e2  6f                    LD          L,A
   830  25e3  7c                    LD          A,H
   831  25e4  ce00                  ADC         A,0x0
   832  25e6  27                    DAA
   833  25e7  67                    LD          H,A
   834  25e8  ed5b713a              LD          DE,(SHIELD_PHYS)
   835  25ec  cd7a23                CALL        RECALC_PHYS_HEALTH
   836  25ef  da0c26                JP          C,LAB_ram_e6c4
   837                          LAB_ram_e6aa:
   838  25f2  eb                    EX          DE,HL
   839  25f3  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
   840  25f6  cd7a23                CALL        RECALC_PHYS_HEALTH
   841  25f9  da4d2f                JP          C,PLAYER_DIES
   842  25fc  b5                    OR          L
   843  25fd  ca4d2f                JP          Z,PLAYER_DIES
   844  2600  22933a                LD          (PLAYER_PHYS_HEALTH),HL
   845  2603  cdc03c                CALL        REDRAW_STATS
   846                          LAB_ram_e6be:
   847  2606  cdda34                CALL        REDRAW_START
   848  2609  c3e237                JP          REDRAW_VIEWPORT
   849                          LAB_ram_e6c4:
   850  260c  210300                LD          HL,0x3
   851  260f  cd4a23                CALL        SUB_ram_e401
   852  2612  c3f225                JP          LAB_ram_e6aa
   853                          DO_SWAP_HANDS:
   854  2615  217a3a                LD          HL,RIGHT_HAND_ITEM
   855  2618  017b3a                LD          BC,LEFT_HAND_ITEM
   856  261b  cdcc29                CALL        SUB_ram_ea62
   857  261e  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
   858  2621  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
   859  2624  cdc528                CALL        UPDATE_MELEE_OBJECTS
   860  2627  213933                LD          HL,CHRRAM_LEFT_HD_GFX_IDX               ;= $20
   861  262a  114333                LD          DE,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
   862  262d  cd0329                CALL        SUB_ram_e99e
   863  2630  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
   864  2633  113933                LD          DE,CHRRAM_LEFT_HD_GFX_IDX               ;= $20
   865  2636  cde228                CALL        SUB_ram_e97d
   866  2639  cd8c26                CALL        NEW_RIGHT_HAND_ITEM
   867  263c  010000                LD          BC,0x0
   868  263f  217a3a                LD          HL,RIGHT_HAND_ITEM
   869  2642  cd6926                CALL        SUB_ram_e720
   870  2645  3a733a                LD          A,(SHIELD_SPRT)
   871  2648  91                    SUB         C
   872  2649  27                    DAA
   873  264a  32733a                LD          (SHIELD_SPRT),A
   874  264d  3a713a                LD          A,(SHIELD_PHYS)
   875  2650  90                    SUB         B
   876  2651  27                    DAA
   877  2652  32713a                LD          (SHIELD_PHYS),A
   878  2655  3a723a                LD          A,(SHIELD_PHYS+1)
   879  2658  de00                  SBC         A,0x0
   880  265a  32723a                LD          (SHIELD_PHYS+1),A
   881  265d  010000                LD          BC,0x0
   882  2660  217b3a                LD          HL,LEFT_HAND_ITEM
   883  2663  cd6926                CALL        SUB_ram_e720
   884  2666  c36f27                JP          LAB_ram_e812
   885                          SUB_ram_e720:
   886  2669  7e                    LD          A,(HL)
   887  266a  fe14                  CP          $14
   888  266c  d0                    RET         NC
   889  266d  fe10                  CP          $10
   890  266f  d27526                JP          NC,LAB_ram_e72b
   891  2672  fe04                  CP          0x4
   892  2674  d0                    RET         NC
   893                          LAB_ram_e72b:
   894  2675  e603                  AND         0x3
   895  2677  3c                    INC         A
   896  2678  cd2629                CALL        SUB_ram_e9c1
   897  267b  7e                    LD          A,(HL)
   898  267c  e6fc                  AND         $fc
   899  267e  c0                    RET         NZ
   900  267f  2600                  LD          H,0x0
   901  2681  68                    LD          L,B
   902  2682  cd8323                CALL        SUB_ram_e439
   903  2685  45                    LD          B,L
   904  2686  69                    LD          L,C
   905  2687  cd8323                CALL        SUB_ram_e439
   906  268a  4d                    LD          C,L
   907  268b  c9                    RET
   908                          NEW_RIGHT_HAND_ITEM:
   909  268c  3a7a3a                LD          A,(RIGHT_HAND_ITEM)
   910  268f  fe18                  CP          $18                                    ;Less than RED Bow
   911  2691  da1727                JP          C,LAB_ram_e7c0
   912  2694  fe34                  CP          $34                                    ;Greater than WHITE Crossbow
   913  2696  d21727                JP          NC,LAB_ram_e7c0
   914  2699  010000                LD          BC,0x0                                  ;C = 0
   915  269c  1e00                  LD          E,0x0                                   ;E = 0
   916  269e  cb3f                  SRL         A                                       ;Div A by 2
   917  26a0  cb18                  RR          B
   918  26a2  1f                    RRA
   919  26a3  cb10                  RL          B
   920  26a5  cb10                  RL          B
   921  26a7  d606                  SUB         0x6
   922  26a9  c2b126                JP          NZ,LAB_ram_e763
   923  26ac  1606                  LD          D,0x6
   924  26ae  c3e126                JP          LAB_ram_e78b
   925                          LAB_ram_e763:
   926  26b1  3d                    DEC         A
   927  26b2  c2ba26                JP          NZ,LAB_ram_e76a
   928  26b5  1606                  LD          D,0x6
   929  26b7  c3f526                JP          LAB_ram_e79e
   930                          LAB_ram_e76a:
   931  26ba  3d                    DEC         A
   932  26bb  c2c326                JP          NZ,LAB_ram_e771
   933  26be  1616                  LD          D,$16
   934  26c0  c3e126                JP          LAB_ram_e78b
   935                          LAB_ram_e771:
   936  26c3  3d                    DEC         A
   937  26c4  c2cc26                JP          NZ,LAB_ram_e778
   938  26c7  1620                  LD          D,$20
   939  26c9  c3f526                JP          LAB_ram_e79e
   940                          LAB_ram_e778:
   941  26cc  3d                    DEC         A
   942  26cd  c2d526                JP          NZ,LAB_ram_e77f
   943  26d0  1624                  LD          D,$24
   944  26d2  c3e126                JP          LAB_ram_e78b
   945                          LAB_ram_e77f:
   946  26d5  3d                    DEC         A
   947  26d6  c2de26                JP          NZ,LAB_ram_e786
   948  26d9  1615                  LD          D,$15
   949  26db  c3f526                JP          LAB_ram_e79e
   950                          LAB_ram_e786:
   951  26de  3d                    DEC         A
   952  26df  1618                  LD          D,$18
   953                          LAB_ram_e78b:
   954  26e1  cd4432                CALL        CALC_WEAPON_VALUE
   955  26e4  87                    ADD         A,A
   956  26e5  27                    DAA                                                 ;BCD Correction
   957  26e6  6f                    LD          L,A
   958  26e7  3e00                  LD          A,0x0
   959  26e9  17                    RLA
   960  26ea  67                    LD          H,A
   961  26eb  22993a                LD          (WEAPON_PHYS),HL
   962  26ee  af                    XOR         A
   963  26ef  329b3a                LD          (WEAPON_SPRT),A
   964  26f2  c30127                JP          LAB_ram_e7aa
   965                          LAB_ram_e79e:
   966  26f5  cd4432                CALL        CALC_WEAPON_VALUE
   967  26f8  329b3a                LD          (WEAPON_SPRT),A
   968  26fb  210000                LD          HL,0x0
   969  26fe  22993a                LD          (WEAPON_PHYS),HL
   970                          LAB_ram_e7aa:
   971  2701  119130                LD          DE,CHRRAM_PHYS_WEAPON_IDX               ;= $20
   972  2704  21993a                LD          HL,WEAPON_PHYS
   973  2707  0602                  LD          B,0x2
   974  2709  cdc032                CALL        RECALC_AND_REDRAW_BCD
   975  270c  119730                LD          DE,CHRRAM_SPRT_WEAPON_IDX               ;= $20
   976  270f  219b3a                LD          HL,WEAPON_SPRT
   977  2712  0601                  LD          B,0x1
   978  2714  c3c032                JP          RECALC_AND_REDRAW_BCD
   979                          LAB_ram_e7c0:
   980  2717  210000                LD          HL,0x0                                  ;HL = 0
   981  271a  af                    XOR         A                                       ;A  = 0
   982  271b  22993a                LD          (WEAPON_PHYS),HL
   983  271e  329b3a                LD          (WEAPON_SPRT),A
   984  2721  c30127                JP          LAB_ram_e7aa
   985                          DO_PICK_UP:
   986  2724  3aa13a                LD          A,(ITEM_HOLDER)
   987  2727  47                    LD          B,A
   988  2728  3a793a                LD          A,(PLAYER_MAP_POS)
   989  272b  b8                    CP          B                                       ;Check difference between
   990                                                                                  ;item and item location
   991  272c  caa521                JP          Z,NO_ACTION_TAKEN
   992  272f  3c                    INC         A
   993  2730  caa521                JP          Z,NO_ACTION_TAKEN
   994  2733  3d                    DEC         A
   995  2734  cdcf37                CALL        ITEM_MAP_CHECK
   996  2737  caa127                JP          Z,LAB_ram_e844
   997  273a  fe04                  CP          0x4                                     ;Compare to RING (0x4)
   998  273c  daa427                JP          C,CHECK_FOOD_ARROWS                     ;Jump if less than RING (C)
   999  273f  fe10                  CP          $10                                    ;Compare to PAVICE ($10)
  1000  2741  d2a427                JP          NC,CHECK_FOOD_ARROWS                    ;Jump if PAVICE or greater (NC)
  1001                          PROCESS_RHA:
  1002  2744  cda628                CALL        PICK_UP_F0_ITEM
  1003  2747  21743a                LD          HL,ARMOR_INV_SLOT                       ;Start with ARMOR slot
  1004  274a  3d                    DEC         A                                       ;Subtract 1 from A:
  1005                                                                                  ;- Armor
  1006  274b  c25027                JP          NZ,NOT_ARMOR                            ;Treat as NOT ARMOR
  1007  274e  23                    INC         HL                                      ;HL = HELMET_INV_SLOT
  1008  274f  23                    INC         HL                                      ;HL = RING_INV_SLOT
  1009                          NOT_ARMOR:
  1010  2750  3d                    DEC         A
  1011  2751  c25527                JP          NZ,NOT_HELMET
  1012  2754  23                    INC         HL
  1013                          NOT_HELMET:
  1014  2755  7e                    LD          A,(HL)
  1015  2756  14                    INC         D
  1016  2757  ba                    CP          D
  1017  2758  d2062a                JP          NC,INPUT_DEBOUNCE
  1018  275b  08                    EX          AF,AF'
  1019  275c  7a                    LD          A,D
  1020  275d  77                    LD          (HL),A
  1021  275e  cd2629                CALL        SUB_ram_e9c1
  1022  2761  59                    LD          E,C
  1023  2762  50                    LD          D,B
  1024  2763  08                    EX          AF,AF'
  1025  2764  cd2629                CALL        SUB_ram_e9c1
  1026  2767  7b                    LD          A,E
  1027  2768  91                    SUB         C
  1028  2769  27                    DAA                                                 ;BCD Correction
  1029  276a  4f                    LD          C,A
  1030  276b  7a                    LD          A,D
  1031  276c  90                    SUB         B
  1032  276d  27                    DAA                                                 ;BCD Correction
  1033  276e  47                    LD          B,A
  1034                          LAB_ram_e812:
  1035  276f  3a733a                LD          A,(SHIELD_SPRT)
  1036  2772  81                    ADD         A,C
  1037  2773  27                    DAA                                                 ;BCD Correction
  1038  2774  32733a                LD          (SHIELD_SPRT),A
  1039  2777  3a713a                LD          A,(SHIELD_PHYS)
  1040  277a  80                    ADD         A,B
  1041  277b  27                    DAA                                                 ;BCD Correction
  1042  277c  32713a                LD          (SHIELD_PHYS),A
  1043  277f  3a723a                LD          A,(SHIELD_PHYS+1)
  1044  2782  ce00                  ADC         A,0x0
  1045  2784  27                    DAA                                                 ;BCD Correction
  1046  2785  32723a                LD          (SHIELD_PHYS+1),A
  1047  2788  21713a                LD          HL,SHIELD_PHYS
  1048  278b  116930                LD          DE,CHRRAM_PHYS_SHIELD_IDX               ;= $20
  1049  278e  0602                  LD          B,0x2
  1050  2790  cdc032                CALL        RECALC_AND_REDRAW_BCD
  1051  2793  21733a                LD          HL,SHIELD_SPRT
  1052  2796  116f30                LD          DE,CHRRAM_SPRT_SHIELD_IDX               ;= $20
  1053  2799  0601                  LD          B,0x1
  1054  279b  cdc032                CALL        RECALC_AND_REDRAW_BCD
  1055  279e  c3093d                JP          RHA_REDRAW                              ;Was JP AWAITING_INPUT
  1056                                                                                  ;(c3 9c ea)
  1057                          LAB_ram_e844:
  1058  27a1  cc4a29                CALL        Z,SUB_ram_e9e1
  1059                          CHECK_FOOD_ARROWS:
  1060  27a4  fe48                  CP          $48
  1061  27a6  daf827                JP          C,CHECK_MAP_NECKLACE_CHARMS             ;CHEST or lower
  1062  27a9  fe50                  CP          $50
  1063  27ab  d2f827                JP          NC,CHECK_MAP_NECKLACE_CHARMS            ;LOCKED CHEST or higher
  1064  27ae  cda628                CALL        PICK_UP_F0_ITEM
  1065  27b1  14                    INC         D
  1066  27b2  cb12                  RL          D
  1067  27b4  14                    INC         D
  1068  27b5  fe12                  CP          $12
  1069  27b7  c2e727                JP          NZ,PICK_UP_ARROWS
  1070  27ba  d5                    PUSH        DE
  1071  27bb  cdc527                CALL        PICK_UP_FOOD
  1072  27be  d1                    POP         DE
  1073  27bf  cdc527                CALL        PICK_UP_FOOD
  1074  27c2  c3062a                JP          INPUT_DEBOUNCE
  1075                          PICK_UP_FOOD:
  1076  27c5  3aab3a                LD          A,(FOOD_INV)
  1077  27c8  82                    ADD         A,D
  1078  27c9  d2d427                JP          NC,LAB_ram_e872
  1079  27cc  3c                    INC         A
  1080  27cd  4f                    LD          C,A
  1081  27ce  7a                    LD          A,D
  1082  27cf  91                    SUB         C
  1083  27d0  57                    LD          D,A
  1084  27d1  c3c527                JP          PICK_UP_FOOD
  1085                          LAB_ram_e872:
  1086  27d4  32ab3a                LD          (FOOD_INV),A
  1087  27d7  2aa93a                LD          HL,(BYTE_ram_3aa9)
  1088  27da  7a                    LD          A,D
  1089  27db  85                    ADD         A,L
  1090  27dc  27                    DAA                                                 ;BCD correct
  1091  27dd  6f                    LD          L,A
  1092  27de  7c                    LD          A,H
  1093  27df  ce00                  ADC         A,0x0
  1094  27e1  27                    DAA                                                 ;BCD correct
  1095  27e2  67                    LD          H,A
  1096  27e3  22a93a                LD          (BYTE_ram_3aa9),HL
  1097  27e6  c9                    RET
  1098                          PICK_UP_ARROWS:
  1099  27e7  3aac3a                LD          A,(ARROW_INV)
  1100  27ea  82                    ADD         A,D
  1101  27eb  fe33                  CP          $33
  1102  27ed  daf227                JP          C,ADD_ARROWS_TO_INV
  1103  27f0  3e32                  LD          A,$32
  1104                          ADD_ARROWS_TO_INV:
  1105  27f2  32ac3a                LD          (ARROW_INV),A
  1106  27f5  c3062a                JP          INPUT_DEBOUNCE
  1107                          CHECK_MAP_NECKLACE_CHARMS:
  1108  27f8  fe6c                  CP          $6c                                    ;Red MAP
  1109  27fa  ca1c28                JP          Z,PROCESS_MAP
  1110  27fd  fe6d                  CP          $6d                                    ;Yellow MAP
  1111  27ff  ca1c28                JP          Z,PROCESS_MAP
  1112  2802  fede                  CP          $de                                    ;Purple MAP
  1113  2804  ca1c28                JP          Z,PROCESS_MAP
  1114  2807  fedf                  CP          $df                                    ;White MAP
  1115  2809  ca1c28                JP          Z,PROCESS_MAP
  1116  280c  fe5c                  CP          $5c                                    ;WHITE KEY or lower
  1117  280e  da3b28                JP          C,PICK_UP_NON_TREASURE
  1118  2811  fe64                  CP          $64
  1119  2813  d23b28                JP          NC,PICK_UP_NON_TREASURE                 ;WARRIOR POTION or higher
  1120  2816  cda628                CALL        PICK_UP_F0_ITEM
  1121  2819  c3062a                JP          INPUT_DEBOUNCE
  1122                          PROCESS_MAP:
  1123  281c  f5                    PUSH        AF
  1124  281d  3ab93a                LD          A,(GAME_BOOLEANS)
  1125  2820  cbd7                  SET         0x2,A
  1126  2822  32b93a                LD          (GAME_BOOLEANS),A
  1127  2825  f1                    POP         AF
  1128  2826  cda628                CALL        PICK_UP_F0_ITEM
  1129  2829  ed53ad3a              LD          (MAP_INV_SLOT),DE
  1130  282d  f5                    PUSH        AF
  1131  282e  3aad3a                LD          A,(MAP_INV_SLOT)
  1132  2831  cdfd3c                CALL        LEVEL_TO_COLRAM_FIX
  1133  2834  321134                LD          (COLRAM_MAP_IDX),A                      ;= $60    `
  1134  2837  f1                    POP         AF
  1135  2838  c3062a                JP          INPUT_DEBOUNCE
  1136                          PICK_UP_NON_TREASURE:
  1137  283b  217a3a                LD          HL,RIGHT_HAND_ITEM
  1138  283e  7e                    LD          A,(HL)
  1139  283f  32ea37                LD          (ITEM_F0),A                             ;= $60
  1140  2842  cdcc29                CALL        SUB_ram_ea62
  1141  2845  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1142  2848  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
  1143  284b  cdc528                CALL        UPDATE_MELEE_OBJECTS
  1144  284e  215233                LD          HL,CHRRAM_FO_ITEM_IDX                   ;= $20
  1145  2851  114333                LD          DE,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1146  2854  cd0329                CALL        SUB_ram_e99e
  1147  2857  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
  1148  285a  115233                LD          DE,CHRRAM_FO_ITEM_IDX                   ;= $20
  1149  285d  cde228                CALL        SUB_ram_e97d
  1150  2860  215237                LD          HL,COLRAM_FO_ITEM_IDX                   ;= $60    `
  1151  2863  11000f                LD          DE,$f00                                ;BLK on DKGY /
  1152                                                                                  ;BLK on BLK
  1153                                                                                  ;WAS BLK on DKCYN /
  1154                                                                                  ;    BLK on BLK
  1155                                                                                  ;WAS LD DE,$0900
  1156  2866  0ef0                  LD          C,$f0                                  ;Floor color (for compare)
  1157                                                                                  ;DKGRY on BLK
  1158                                                                                  ;WAS DKCYN on BLK
  1159  2868  cd7c28                CALL        RECOLOR_ITEM
  1160  286b  214337                LD          HL,COLRAM_RH_ITEM_IDX                   ;= $60    `
  1161  286e  11f000                LD          DE,$f0                                 ;Floor color (for fill)
  1162                                                                                  ;DKGRY on BLK
  1163                                                                                  ;WAS DKCYN on BLK
  1164  2871  0e00                  LD          C,0x0
  1165  2873  cd7c28                CALL        RECOLOR_ITEM
  1166  2876  cd8c26                CALL        NEW_RIGHT_HAND_ITEM
  1167  2879  c3062a                JP          INPUT_DEBOUNCE
  1168                          RECOLOR_ITEM:
  1169  287c  3e04                  LD          A,0x4
  1170                          LAB_ram_e91c:
  1171  287e  08                    EX          AF,AF'
  1172  287f  0604                  LD          B,0x4
  1173                          LAB_ram_e91f:
  1174  2881  7e                    LD          A,(HL)
  1175  2882  e6f0                  AND         $f0
  1176  2884  bb                    CP          E
  1177  2885  ca9928                JP          Z,LAB_ram_e935
  1178  2888  b2                    OR          D
  1179                          LAB_ram_e926:
  1180  2889  77                    LD          (HL),A
  1181  288a  23                    INC         HL
  1182  288b  10f4                  DJNZ        LAB_ram_e91f
  1183  288d  d5                    PUSH        DE
  1184  288e  112400                LD          DE,$24                                 ;Jump ahead 36 cells
  1185                                                                                  ;(40 - 4)
  1186  2891  19                    ADD         HL,DE
  1187  2892  d1                    POP         DE
  1188  2893  08                    EX          AF,AF'
  1189  2894  3d                    DEC         A
  1190  2895  c27e28                JP          NZ,LAB_ram_e91c
  1191  2898  c9                    RET
  1192                          LAB_ram_e935:
  1193  2899  7e                    LD          A,(HL)
  1194  289a  e60f                  AND         0xf
  1195  289c  b1                    OR          C
  1196  289d  c38928                JP          LAB_ram_e926
  1197                          WAIT_A_TICK:
  1198  28a0  010086                LD          BC,$8600                               ;Sleep for 134 "cycles"
  1199  28a3  c34b1d                JP          SLEEP                                   ;byte SLEEP(short cycleCount)
  1200                          PICK_UP_F0_ITEM:
  1201  28a6  a7                    AND         A                                       ;Reset flags
  1202  28a7  08                    EX          AF,AF'                                  ;Save item
  1203  28a8  3efe                  LD          A,$fe                                  ;Empty item
  1204  28aa  02                    LD          (BC),A
  1205  28ab  215233                LD          HL,CHRRAM_FO_ITEM_IDX                   ;= $20
  1206  28ae  3e20                  LD          A,$20                                  ;SPACE char
  1207  28b0  cdaa09                CALL        UPDATE_FO_ITEM
  1208  28b3  215237                LD          HL,COLRAM_FO_ITEM_IDX                   ;= $60    `
  1209  28b6  3edf                  LD          A,$df                                  ;DKGRN on DKGRY
  1210  28b8  cdaa09                CALL        UPDATE_FO_ITEM
  1211  28bb  08                    EX          AF,AF'                                  ;Restore item
  1212  28bc  1f                    RRA                                                 ;Rotate A right, A:0 to carry
  1213  28bd  cb1a                  RR          D                                       ;Rotate D right
  1214                                                                                  ;Carry (from A:0) to D:7
  1215  28bf  1f                    RRA                                                 ;Rotate A right, A:0 (was A:1) to carry
  1216  28c0  cb12                  RL          D                                       ;Rotate D left, carry to D:0
  1217                                                                                  ;D:7 to carry
  1218  28c2  cb12                  RL          D                                       ;Rotate D left, carry to D;0
  1219                                                                                  ;D:7 to carry
  1220                                                                                  ;D  = item level
  1221  28c4  c9                    RET
  1222                          UPDATE_MELEE_OBJECTS:
  1223  28c5  3e04                  LD          A,0x4
  1224                          LAB_ram_e962:
  1225  28c7  010400                LD          BC,0x4
  1226  28ca  edb0                  LDIR                                                ;= "OM"
  1227  28cc  3d                    DEC         A
  1228  28cd  cad728                JP          Z,LAB_ram_e972
  1229  28d0  012400                LD          BC,$24
  1230  28d3  09                    ADD         HL,BC
  1231  28d4  c3c728                JP          LAB_ram_e962
  1232                          LAB_ram_e972:
  1233  28d7  7c                    LD          A,H
  1234  28d8  fe34                  CP          $34
  1235  28da  d0                    RET         NC
  1236  28db  018403                LD          BC,$384
  1237  28de  09                    ADD         HL,BC
  1238  28df  c3c528                JP          UPDATE_MELEE_OBJECTS
  1239                          SUB_ram_e97d:
  1240  28e2  3e04                  LD          A,0x4
  1241                          LAB_ram_e97f:
  1242  28e4  010400                LD          BC,0x4
  1243  28e7  edb0                  LDIR                                                ;= "OM"
  1244  28e9  3d                    DEC         A
  1245  28ea  caf628                JP          Z,LAB_ram_e991
  1246  28ed  eb                    EX          DE,HL
  1247  28ee  012400                LD          BC,$24
  1248  28f1  09                    ADD         HL,BC
  1249  28f2  eb                    EX          DE,HL
  1250  28f3  c3e428                JP          LAB_ram_e97f
  1251                          LAB_ram_e991:
  1252  28f6  7a                    LD          A,D
  1253  28f7  fe34                  CP          $34
  1254  28f9  d0                    RET         NC
  1255  28fa  018403                LD          BC,$384
  1256  28fd  eb                    EX          DE,HL
  1257  28fe  09                    ADD         HL,BC
  1258  28ff  eb                    EX          DE,HL
  1259  2900  c3e228                JP          SUB_ram_e97d
  1260                          SUB_ram_e99e:
  1261  2903  3e04                  LD          A,0x4
  1262                          LAB_ram_e9a0:
  1263  2905  010400                LD          BC,0x4
  1264  2908  edb0                  LDIR                                                ;= "OM"
  1265  290a  3d                    DEC         A
  1266  290b  ca1829                JP          Z,LAB_ram_e9b3
  1267  290e  012400                LD          BC,$24
  1268  2911  09                    ADD         HL,BC
  1269  2912  eb                    EX          DE,HL
  1270  2913  09                    ADD         HL,BC
  1271  2914  eb                    EX          DE,HL
  1272  2915  c30529                JP          LAB_ram_e9a0
  1273                          LAB_ram_e9b3:
  1274  2918  7c                    LD          A,H
  1275  2919  fe34                  CP          $34
  1276  291b  d0                    RET         NC
  1277  291c  018403                LD          BC,$384
  1278  291f  09                    ADD         HL,BC
  1279  2920  eb                    EX          DE,HL
  1280  2921  09                    ADD         HL,BC
  1281  2922  eb                    EX          DE,HL
  1282  2923  c30329                JP          SUB_ram_e99e
  1283                          SUB_ram_e9c1:
  1284  2926  3d                    DEC         A
  1285  2927  c22e29                JP          NZ,LAB_ram_e9c8
  1286  292a  010105                LD          BC,$501                                ;PHYS = 5
  1287                                                                                  ;SPRT = 1
  1288  292d  c9                    RET
  1289                          LAB_ram_e9c8:
  1290  292e  3d                    DEC         A
  1291  292f  c23629                JP          NZ,LAB_ram_e9cf
  1292  2932  010408                LD          BC,$804
  1293  2935  c9                    RET
  1294                          LAB_ram_e9cf:
  1295  2936  3d                    DEC         A
  1296  2937  c23e29                JP          NZ,LAB_ram_e9d6
  1297  293a  010812                LD          BC,LAB_ram_1208
  1298  293d  c9                    RET
  1299                          LAB_ram_e9d6:
  1300  293e  3d                    DEC         A
  1301  293f  c24629                JP          NZ,LAB_ram_e9dd
  1302  2942  011326                LD          BC,BYTE_ram_2613                        ;= $FF
  1303  2945  c9                    RET
  1304                          LAB_ram_e9dd:
  1305  2946  010000                LD          BC,0x0
  1306  2949  c9                    RET
  1307                          SUB_ram_e9e1:
  1308  294a  3a7a3a                LD          A,(RIGHT_HAND_ITEM)
  1309  294d  fefe                  CP          $fe
  1310  294f  c25629                JP          NZ,LAB_ram_e9ec
  1311  2952  e1                    POP         HL
  1312  2953  c3a521                JP          NO_ACTION_TAKEN
  1313                          LAB_ram_e9ec:
  1314  2956  3eff                  LD          A,$ff
  1315  2958  02                    LD          (BC),A
  1316  2959  0d                    DEC         C
  1317  295a  0d                    DEC         C
  1318  295b  7c                    LD          A,H
  1319  295c  02                    LD          (BC),A
  1320  295d  0c                    INC         C
  1321  295e  3efe                  LD          A,$fe
  1322  2960  02                    LD          (BC),A
  1323  2961  c9                    RET
  1324                          DO_ROTATE_PACK:
  1325  2962  217c3a                LD          HL,INV_ITEM_SLOT_1
  1326  2965  01103a                LD          BC,ITEM_MOVE_COL_BUFFER
  1327  2968  af                    XOR         A
  1328  2969  02                    LD          (BC),A
  1329  296a  cdcc29                CALL        SUB_ram_ea62
  1330  296d  23                    INC         HL
  1331  296e  017c3a                LD          BC,INV_ITEM_SLOT_1
  1332  2971  cdcc29                CALL        SUB_ram_ea62
  1333  2974  1e04                  LD          E,0x4
  1334                          LAB_ram_ea0c:
  1335  2976  23                    INC         HL
  1336  2977  03                    INC         BC
  1337  2978  cdcc29                CALL        SUB_ram_ea62
  1338  297b  1d                    DEC         E
  1339  297c  c27629                JP          NZ,LAB_ram_ea0c
  1340  297f  21103a                LD          HL,ITEM_MOVE_COL_BUFFER
  1341  2982  03                    INC         BC
  1342  2983  cdcc29                CALL        SUB_ram_ea62
  1343  2986  21b431                LD          HL,DAT_ram_31b4                         ;= $20
  1344  2989  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
  1345  298c  cdc528                CALL        UPDATE_MELEE_OBJECTS
  1346  298f  211131                LD          HL,DAT_ram_3111                         ;= $20
  1347  2992  11b431                LD          DE,DAT_ram_31b4                         ;= $20
  1348  2995  cd0329                CALL        SUB_ram_e99e
  1349  2998  210c31                LD          HL,DAT_ram_310c                         ;= $20
  1350  299b  111131                LD          DE,DAT_ram_3111                         ;= $20
  1351  299e  cd0329                CALL        SUB_ram_e99e
  1352  29a1  21a931                LD          HL,CHHRAM_INV_4_IDX                     ;= $20
  1353  29a4  110c31                LD          DE,DAT_ram_310c                         ;= $20
  1354  29a7  cd0329                CALL        SUB_ram_e99e
  1355  29aa  214c32                LD          HL,DAT_ram_324c                         ;= $20
  1356  29ad  11a931                LD          DE,CHHRAM_INV_4_IDX                     ;= $20
  1357  29b0  cd0329                CALL        SUB_ram_e99e
  1358  29b3  215132                LD          HL,CHHRAM_INV_6_IDX                     ;= $20
  1359  29b6  114c32                LD          DE,DAT_ram_324c                         ;= $20
  1360  29b9  cd0329                CALL        SUB_ram_e99e
  1361  29bc  21092a                LD          HL,WAIT_FOR_INPUT                    ; WAIT FOR INPUT label --- UNDO???
  1362  29bf  e5                    PUSH        HL
  1363  29c0  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
  1364  29c3  115132                LD          DE,CHHRAM_INV_6_IDX                     ;= $20
  1365  29c6  cde228                CALL        SUB_ram_e97d
  1366  29c9  c3a028                JP          WAIT_A_TICK
  1367                          SUB_ram_ea62:
  1368  29cc  56                    LD          D,(HL)
  1369  29cd  0a                    LD          A,(BC)
  1370  29ce  77                    LD          (HL),A
  1371  29cf  7a                    LD          A,D
  1372  29d0  02                    LD          (BC),A
  1373  29d1  c9                    RET
  1374                          DO_SWAP_PACK:
  1375  29d2  217c3a                LD          HL,INV_ITEM_SLOT_1
  1376  29d5  017a3a                LD          BC,RIGHT_HAND_ITEM
  1377  29d8  cdcc29                CALL        SUB_ram_ea62
  1378  29db  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1379  29de  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
  1380  29e1  cdc528                CALL        UPDATE_MELEE_OBJECTS
  1381  29e4  21b431                LD          HL,DAT_ram_31b4                         ;= $20
  1382  29e7  114333                LD          DE,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1383  29ea  cd0329                CALL        SUB_ram_e99e
  1384  29ed  21092a                LD          HL,WAIT_FOR_INPUT                    ; WAIT FOR INPUT label --- UNDO???
  1385  29f0  e5                    PUSH        HL
  1386  29f1  21003a                LD          HL,ITEM_MOVE_CHR_BUFFER
  1387  29f4  11b431                LD          DE,DAT_ram_31b4                         ;= $20
  1388  29f7  cde228                CALL        SUB_ram_e97d
  1389  29fa  cd8c26                CALL        NEW_RIGHT_HAND_ITEM
  1390  29fd  c3a028                JP          WAIT_A_TICK
  1391                          UPDATE_VIEWPORT:
  1392  2a00  cdda34                CALL        REDRAW_START
  1393  2a03  cde237                CALL        REDRAW_VIEWPORT
  1394                          INPUT_DEBOUNCE:
  1395  2a06  cda028                CALL        WAIT_A_TICK
  1396                          WAIT_FOR_INPUT:
  1397  2a09  cd5911                CALL        TIMER_UPDATE
  1398  2a0c  cd6411                CALL        BLINK_ROUTINE
  1399  2a0f  d2732a                JP          NC,TIMER_UPDATED_CHECK_INPUT
  1400  2a12  216b3a                LD          HL,TIMER_C
  1401  2a15  34                    INC         (HL)
  1402  2a16  7e                    LD          A,(HL)
  1403  2a17  fe15                  CP          $15
  1404  2a19  da732a                JP          C,TIMER_UPDATED_CHECK_INPUT
  1405  2a1c  af                    XOR         A
  1406  2a1d  77                    LD          (HL),A
  1407                          SCREEN_SAVER_FULL_SCREEN:
  1408  2a1e  210008                LD          HL,$800
  1409                          SCREEN_SAVER_REDRAW_LOOP:
  1410  2a21  110034                LD          DE,COLRAM                               ;= $60
  1411                          RECALC_SCREEN_SAVER_COLORS:
  1412  2a24  1a                    LD          A,(DE)                          ;= $60
  1413  2a25  0f                    RRCA
  1414  2a26  12                    LD          (DE),A                          ;= $60
  1415  2a27  13                    INC         DE
  1416  2a28  3e38                  LD          A,$38
  1417  2a2a  ba                    CP          D
  1418  2a2b  c2242a                JP          NZ,RECALC_SCREEN_SAVER_COLORS
  1419  2a2e  25                    DEC         H
  1420  2a2f  c2342a                JP          NZ,CHECK_INPUT_DURING_SCREEN_SAVER
  1421  2a32  2608                  LD          H,0x8
  1422                          CHECK_INPUT_DURING_SCREEN_SAVER:
  1423  2a34  2d                    DEC         L
  1424  2a35  ca212a                JP          Z,SCREEN_SAVER_REDRAW_LOOP
  1425  2a38  014001                LD          BC,$140
  1426  2a3b  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  1427  2a3e  01ff00                LD          BC,$ff
  1428  2a41  ed78                  IN          A,(C)
  1429  2a43  3c                    INC         A
  1430  2a44  c2602a                JP          NZ,LAB_ram_eaf5
  1431  2a47  0ef7                  LD          C,$f7
  1432  2a49  3e0f                  LD          A,0xf
  1433  2a4b  ed79                  OUT         (C),A                              ;= db
  1434  2a4d  0d                    DEC         C
  1435  2a4e  ed78                  IN          A,(C)                     ;= db
  1436  2a50  3c                    INC         A
  1437  2a51  c2602a                JP          NZ,LAB_ram_eaf5
  1438  2a54  0c                    INC         C
  1439  2a55  3e0e                  LD          A,0xe
  1440  2a57  ed79                  OUT         (C),A                              ;= db
  1441  2a59  0d                    DEC         C
  1442  2a5a  ed78                  IN          A,(C)                     ;= db
  1443  2a5c  3c                    INC         A
  1444  2a5d  ca342a                JP          Z,CHECK_INPUT_DURING_SCREEN_SAVER
  1445                          LAB_ram_eaf5:
  1446  2a60  110034                LD          DE,COLRAM                               ;= $60
  1447                          LAB_ram_eaf8:
  1448  2a63  44                    LD          B,H
  1449  2a64  1a                    LD          A,(DE)                          ;= $60
  1450                          LAB_ram_eafa:
  1451  2a65  0f                    RRCA
  1452  2a66  10fd                  DJNZ        LAB_ram_eafa
  1453  2a68  12                    LD          (DE),A                          ;= $60
  1454  2a69  13                    INC         DE                  ;= $60
  1455  2a6a  3e38                  LD          A,$38
  1456  2a6c  ba                    CP          D
  1457  2a6d  c2632a                JP          NZ,LAB_ram_eaf8
  1458  2a70  c3062a                JP          INPUT_DEBOUNCE
  1459                          TIMER_UPDATED_CHECK_INPUT:
  1460  2a73  3a653a                LD          A,(RAM_AD)
  1461  2a76  fe32                  CP          $32
  1462  2a78  cac22a                JP          Z,LAB_ram_eb53
  1463  2a7b  3a663a                LD          A,(RAM_AE)
  1464  2a7e  fe31                  CP          $31
  1465  2a80  c2962a                JP          NZ,LAB_ram_eb27
  1466  2a83  21693a                LD          HL,TIMER_A
  1467  2a86  3a893a                LD          A,(BYTE_ram_3a89)
  1468  2a89  be                    CP          (HL)
  1469  2a8a  c2092a                JP          NZ,WAIT_FOR_INPUT
  1470  2a8d  cd9c23                CALL        SUB_ram_e450
  1471  2a90  cde322                CALL        SUB_ram_e39a
  1472  2a93  c3092a                JP          WAIT_FOR_INPUT
  1473                          LAB_ram_eb27:
  1474  2a96  21693a                LD          HL,TIMER_A
  1475  2a99  3a8c3a                LD          A,(BYTE_ram_3a8c)
  1476  2a9c  be                    CP          (HL)
  1477  2a9d  c2092a                JP          NZ,WAIT_FOR_INPUT
  1478  2aa0  cd7725                CALL        SUB_ram_e635
  1479  2aa3  cd9c23                CALL        SUB_ram_e450
  1480  2aa6  cde322                CALL        SUB_ram_e39a
  1481  2aa9  cd1125                CALL        MELEE_ANIM_LOOP
  1482  2aac  c3092a                JP          WAIT_FOR_INPUT
  1483                          LAB_ram_eb40:
  1484  2aaf  21693a                LD          HL,TIMER_A
  1485  2ab2  3a8c3a                LD          A,(BYTE_ram_3a8c)
  1486  2ab5  be                    CP          (HL)
  1487  2ab6  c2092a                JP          NZ,WAIT_FOR_INPUT
  1488  2ab9  cd7725                CALL        SUB_ram_e635
  1489  2abc  cd1125                CALL        MELEE_ANIM_LOOP
  1490  2abf  c3092a                JP          WAIT_FOR_INPUT
  1491                          LAB_ram_eb53:
  1492  2ac2  3a663a                LD          A,(RAM_AE)
  1493  2ac5  fe31                  CP          $31
  1494  2ac7  c2af2a                JP          NZ,LAB_ram_eb40
  1495  2aca  cda93a                CALL        UPDATE_SCR_SAVER_TIMER
  1496  2acd  3a783a                LD          A,(LAST_ITEM_HELD)
  1497  2ad0  a7                    AND         A
  1498  2ad1  c2572b                JP          NZ,LAB_ram_ebd6
  1499  2ad4  0604                  LD          B,0x4
  1500  2ad6  21e937                LD          HL,ITEM_F1                              ;= $60
  1501  2ad9  7e                    LD          A,(HL)                         ;= $60
  1502  2ada  3c                    INC         A
  1503  2adb  3c                    INC         A
  1504  2adc  21ec37                LD          HL,ITEM_FR1                             ;= $60
  1505                          LAB_ram_eb6f:
  1506  2adf  fe7a                  CP          $7a
  1507  2ae1  d2ed2a                JP          NC,LAB_ram_eb7b
  1508  2ae4  23                    INC         HL
  1509  2ae5  7e                    LD          A,(HL)                         ;= $60
  1510  2ae6  3c                    INC         A
  1511  2ae7  3c                    INC         A
  1512  2ae8  10f5                  DJNZ        LAB_ram_eb6f
  1513  2aea  c3572b                JP          LAB_ram_ebd6
  1514                          LAB_ram_eb7b:
  1515  2aed  3a883a                LD          A,(TIMER_D)
  1516  2af0  fe05                  CP          0x5
  1517  2af2  d2572b                JP          NC,LAB_ram_ebd6
  1518  2af5  cd8a3a                CALL        MAKE_RANDOM_BYTE
  1519  2af8  c608                  ADD         A,0x8
  1520  2afa  d2572b                JP          NC,LAB_ram_ebd6
  1521  2afd  05                    DEC         B
  1522  2afe  c2162b                JP          NZ,LAB_ram_eb9e
  1523  2b01  3afd33                LD          A,(DAT_ram_33fd)                        ;= $20
  1524  2b04  cb57                  BIT         0x2,A
  1525  2b06  c20d2b                JP          NZ,LAB_ram_eb96
  1526  2b09  a7                    AND         A
  1527  2b0a  c2572b                JP          NZ,LAB_ram_ebd6
  1528                          LAB_ram_eb96:
  1529  2b0d  cdb92d                CALL        SUB_ram_ee23
  1530  2b10  cdb92d                CALL        SUB_ram_ee23
  1531  2b13  c33f2b                JP          LAB_ram_ebc0
  1532                          LAB_ram_eb9e:
  1533  2b16  05                    DEC         B
  1534  2b17  c22c2b                JP          NZ,LAB_ram_ebb0
  1535  2b1a  3af533                LD          A,(DAT_ram_33f5)                        ;= $20
  1536  2b1d  cb57                  BIT         0x2,A
  1537  2b1f  c2262b                JP          NZ,LAB_ram_ebab
  1538  2b22  a7                    AND         A
  1539  2b23  c2572b                JP          NZ,LAB_ram_ebd6
  1540                          LAB_ram_ebab:
  1541  2b26  cda12d                CALL        SUB_ram_ee0b
  1542  2b29  c33f2b                JP          LAB_ram_ebc0
  1543                          LAB_ram_ebb0:
  1544  2b2c  05                    DEC         B
  1545  2b2d  c24b2b                JP          NZ,LAB_ram_ebcc
  1546  2b30  3af933                LD          A,(DAT_ram_33f9)                        ;= $20
  1547  2b33  cb57                  BIT         0x2,A
  1548  2b35  c23c2b                JP          NZ,LAB_ram_ebbd
  1549  2b38  a7                    AND         A
  1550  2b39  c2572b                JP          NZ,LAB_ram_ebd6
  1551                          LAB_ram_ebbd:
  1552  2b3c  cdb92d                CALL        SUB_ram_ee23
  1553                          LAB_ram_ebc0:
  1554  2b3f  cdda34                CALL        REDRAW_START
  1555  2b42  cde237                CALL        REDRAW_VIEWPORT
  1556                          LAB_ram_ebc6:
  1557  2b45  cdbf0d                CALL        SUB_ram_cd5f
  1558  2b48  c3dc30                JP          SUB_ram_f130
  1559                          LAB_ram_ebcc:
  1560  2b4b  3ae833                LD          A,(WALL_F0_STATE)                       ;= $20
  1561  2b4e  cb57                  BIT         0x2,A
  1562  2b50  c2452b                JP          NZ,LAB_ram_ebc6
  1563  2b53  a7                    AND         A
  1564  2b54  ca452b                JP          Z,LAB_ram_ebc6
  1565                          LAB_ram_ebd6:
  1566  2b57  01ff00                LD          BC,$ff
  1567  2b5a  ed78                  IN          A,(C)
  1568  2b5c  3c                    INC         A
  1569  2b5d  c2da2b                JP          NZ,LAB_ram_ec52
  1570  2b60  0ef7                  LD          C,$f7
  1571  2b62  3e0f                  LD          A,0xf
  1572  2b64  ed79                  OUT         (C),A                              ;= db
  1573  2b66  0d                    DEC         C
  1574  2b67  ed78                  IN          A,(C)                     ;= db
  1575  2b69  3c                    INC         A
  1576  2b6a  c2792b                JP          NZ,LAB_ram_ebf7
  1577  2b6d  0c                    INC         C
  1578  2b6e  3e0e                  LD          A,0xe
  1579  2b70  ed79                  OUT         (C),A                              ;= db
  1580  2b72  0d                    DEC         C
  1581  2b73  ed78                  IN          A,(C)                     ;= db
  1582  2b75  3c                    INC         A
  1583  2b76  ca092a                JP          Z,WAIT_FOR_INPUT
  1584                          LAB_ram_ebf7:
  1585  2b79  cdbe2b                CALL        PLAY_DESCENDING_SOUND
  1586  2b7c  21fe37                LD          HL,HC_INPUT_HOLDER                      ;= $6060
  1587                          DISABLE_JOY_04:
  1588  2b7f  0ef7                  LD          C,$f7
  1589  2b81  3e0f                  LD          A,0xf
  1590  2b83  ed79                  OUT         (C),A                              ;= db
  1591  2b85  0d                    DEC         C
  1592  2b86  ed78                  IN          A,(C)                     ;= db
  1593  2b88  77                    LD          (HL),A                 ;= $6060
  1594  2b89  23                    INC         HL
  1595  2b8a  0c                    INC         C
  1596                          ENABLE_JOY_04:
  1597  2b8b  3e0e                  LD          A,0xe
  1598  2b8d  ed79                  OUT         (C),A                              ;= db
  1599  2b8f  0d                    DEC         C
  1600  2b90  ed78                  IN          A,(C)                     ;= db
  1601  2b92  77                    LD          (HL),A
  1602  2b93  3a6c3a                LD          A,(INPUT_HOLDER)
  1603  2b96  a7                    AND         A
  1604  2b97  c2160f                JP          NZ,HC_JOY_INPUT_COMPARE
  1605  2b9a  3a683a                LD          A,(DUNGEON_LEVEL)
  1606  2b9d  a7                    AND         A
  1607  2b9e  c21020                JP          NZ,GAMEINIT
  1608  2ba1  7e                    LD          A,(HL)
  1609  2ba2  3c                    INC         A
  1610  2ba3  cab82b                JP          Z,TITLE_CHK_FOR_HC_INPUT
  1611                          HC_LEVEL_SELECT_LOOP:
  1612  2ba6  fe60                  CP          $60                                    ;K3 pressed on title screen
  1613  2ba8  ca272c                JP          Z,SET_DIFFICULTY_1
  1614  2bab  fe7c                  CP          $7c
  1615  2bad  ca2c2c                JP          Z,SET_DIFFICULTY_2
  1616  2bb0  fec0                  CP          $c0
  1617  2bb2  ca312c                JP          Z,SET_DIFFICULTY_3
  1618  2bb5  c3172c                JP          SET_DIFFICULTY_4
  1619                          TITLE_CHK_FOR_HC_INPUT:
  1620  2bb8  2b                    DEC         HL
  1621  2bb9  7e                    LD          A,(HL)                 ;= $6060
  1622  2bba  3c                    INC         A
  1623  2bbb  c3a62b                JP          HC_LEVEL_SELECT_LOOP
  1624                          PLAY_DESCENDING_SOUND:
  1625  2bbe  af                    XOR         A
  1626  2bbf  32693a                LD          (TIMER_A),A
  1627  2bc2  326a3a                LD          (TIMER_B),A
  1628  2bc5  326b3a                LD          (TIMER_C),A
  1629  2bc8  d3fc                  OUT         (SPEAKER),A                             ;= db
  1630  2bca  01f000                LD          BC,$f0
  1631  2bcd  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  1632  2bd0  3c                    INC         A
  1633  2bd1  d3fc                  OUT         (SPEAKER),A                             ;= db
  1634  2bd3  01c004                LD          BC,$4c0
  1635  2bd6  cd4b1d                CALL        SLEEP                                   ;byte SLEEP(short cycleCount)
  1636  2bd9  c9                    RET
  1637                          LAB_ram_ec52:
  1638  2bda  cdbe2b                CALL        PLAY_DESCENDING_SOUND
  1639  2bdd  21f637                LD          HL,KEY_INPUT_COL0                       ;= $60
  1640  2be0  01fffe                LD          BC,0xfeff                               ; Was LD, BC, GFX_POINTERS
  1641  2be3  1608                  LD          D,0x8
  1642                          SELECT_DIFFICULTY_LOOP:
  1643  2be5  ed78                  IN          A,(C)
  1644  2be7  77                    LD          (HL),A                  ;= $20
  1645                                                                                  ;= $60
  1646  2be8  2c                    INC         L
  1647  2be9  cb00                  RLC         B
  1648  2beb  15                    DEC         D
  1649  2bec  c2e52b                JP          NZ,SELECT_DIFFICULTY_LOOP
  1650  2bef  3a6c3a                LD          A,(INPUT_HOLDER)
  1651  2bf2  a7                    AND         A
  1652  2bf3  c2883b                JP          NZ,KEY_COMPARE                          ;OLD = e12c ; NEW = fbe0
  1653  2bf6  3a683a                LD          A,(DUNGEON_LEVEL)
  1654  2bf9  a7                    AND         A
  1655  2bfa  c21020                JP          NZ,GAMEINIT
  1656  2bfd  3afc37                LD          A,(KEY_INPUT_COL6)                      ;= $60
  1657  2c00  fefe                  CP          $fe
  1658  2c02  ca272c                JP          Z,SET_DIFFICULTY_1                      ;Key 3 pressed on Title Screen
  1659  2c05  fedf                  CP          $df
  1660  2c07  ca4911                JP          Z,SHOW_AUTHOR                           ;Key A pressed (and held)
  1661                                                                                  ;on title screen
  1662  2c0a  3afd37                LD          A,(KEY_INPUT_COL7)                      ;= $60
  1663  2c0d  fefe                  CP          $fe
  1664  2c0f  ca2c2c                JP          Z,SET_DIFFICULTY_2                      ;Key 2 pressed on Title Screen
  1665  2c12  fefb                  CP          $fb
  1666  2c14  ca312c                JP          Z,SET_DIFFICULTY_3                      ;Key 1 pressed on Title Screen
  1667                          SET_DIFFICULTY_4:
  1668  2c17  3e00                  LD          A,0x0                                   ;Some other key pressed on Title Screen
  1669                          GOTO_GAME_START:
  1670  2c19  326c3a                LD          (INPUT_HOLDER),A
  1671  2c1c  3ab93a                LD          A,(GAME_BOOLEANS)
  1672  2c1f  cbc7                  SET         0x0,A
  1673  2c21  32b93a                LD          (GAME_BOOLEANS),A
  1674  2c24  c38120                JP          BLANK_SCRN
  1675                          SET_DIFFICULTY_1:
  1676  2c27  3e01                  LD          A,0x1
  1677  2c29  c3192c                JP          GOTO_GAME_START
  1678                          SET_DIFFICULTY_2:
  1679  2c2c  3e02                  LD          A,0x2
  1680  2c2e  c3192c                JP          GOTO_GAME_START
  1681                          SET_DIFFICULTY_3:
  1682  2c31  3e03                  LD          A,0x3
  1683  2c33  c3192c                JP          GOTO_GAME_START
  1684                          CHK_ITEM:
  1685  2c36  fefe                  CP          $fe                             ; Compare A to $FE
  1686  2c38  c8                    RET         Z                               ; If A == Z, exit ($FE = no item)
  1687  2c39  cb3f                  SRL         A                               ; Shift A right logical, Bit 0 to C
  1688  2c3b  5f                    LD          E,A                             ; New value A into E
  1689  2c3c  da442c                JP          C,ITEM_WAS_YL_WH                ; If C (ITEM was YEL or WHT), jump ahead
  1690  2c3f  1610                  LD          D,$10                           ; (ITEM was RED or MAG) D = $10
  1691  2c41  c3462c                JP          ITEM_WAS_RD_MG                  ; Jump ahead
  1692                          ITEM_WAS_YL_WH:
  1693  2c44  1630                  LD          D,$30                           ; (ITEM was YEL or WHTD D = $30
  1694                          ITEM_WAS_RD_MG:
  1695  2c46  cb3f                  SRL         A                               ; Shift A right logical, Bit 0 to C
  1696  2c48  d24f2c                JP          NC,ITEM_NOT_RD_YL               ; If not C (ITEM was not RED or YEL), jump ahead
  1697  2c4b  3e40                  LD          A,$40                           ; A = $40
  1698  2c4d  82                    ADD         A,D                             ; Add D to A
  1699  2c4e  57                    LD          D,A                             ; D = $40 + $10 (RD MG) or D = $40 + $30 (YL WH)
  1700                          ITEM_NOT_RD_YL:
  1701  2c4f  cb83                  RES         0x0,E                           ; Set Bit 0 of E (old ITEM SRL)
  1702  2c51  7b                    LD          A,E                             ; Save E back into A
  1703  2c52  cb27                  SLA         A                               ; Shift A right logical
  1704  2c54  83                    ADD         A,E                             ; Add E () to A
  1705  2c55  80                    ADD         A,B                             ; Add B (color?) to A
  1706  2c56  42                    LD          B,D                             ; Put D ($10, $30, or $40) into B
  1707  2c57  6f                    LD          L,A                             ; Put A into L
  1708  2c58  26ff                  LD          H,$ff                           ; Put $FF into H
  1709  2c5a  5e                    LD          E,(HL)                          ; ITEM/MONSTER GFX_PTR, E = low byte
  1710  2c5b  23                    INC         HL                              ; Increment HL
  1711  2c5c  56                    LD          D,(HL)                          ; ITEM/MONSTER GFX_PTR, D = high byte
  1712  2c5d  3a633a                LD          A,(MON_FS)
  1713  2c60  67                    LD          H,A
  1714  2c61  69                    LD          L,C
  1715  2c62  c3fa32                JP          GFX_DRAW
  1716                          DO_OPEN_CLOSE:
  1717  2c65  3aea37                LD          A,(ITEM_F0)                             ;= $60
  1718  2c68  0e00                  LD          C,0x0                                   ;C  = 0
  1719  2c6a  cb3f                  SRL         A                                       ;Move item LEVEL
  1720                                                                                  ;into C
  1721  2c6c  cb19                  RR          C
  1722  2c6e  cb3f                  SRL         A
  1723  2c70  cb11                  RL          C
  1724  2c72  cb11                  RL          C
  1725  2c74  fe11                  CP          $11                                    ;Compare to BOX
  1726                                                                                  ;44,45,46,47 2 @ SRL = 11
  1727  2c76  c2a92c                JP          NZ,LAB_ram_ed1b
  1728  2c79  79                    LD          A,C                                     ;A = C (item level)
  1729  2c7a  a7                    AND         A
  1730  2c7b  ca882c                JP          Z,DO_OPEN_BOX
  1731  2c7e  cda93a                CALL        UPDATE_SCR_SAVER_TIMER
  1732  2c81  0c                    INC         C
  1733                          LAB_ram_ecf6:
  1734  2c82  91                    SUB         C
  1735  2c83  d2822c                JP          NC,LAB_ram_ecf6
  1736  2c86  81                    ADD         A,C
  1737  2c87  4f                    LD          C,A
  1738                          DO_OPEN_BOX:
  1739  2c88  ed5f                  LD          A,R                                     ;Semi-random number into A
  1740  2c8a  e607                  AND         0x7
  1741                          PICK_RANDOM_ITEM:
  1742  2c8c  d607                  SUB         0x7
  1743  2c8e  d28c2c                JP          NC,PICK_RANDOM_ITEM
  1744  2c91  c61d                  ADD         A,$1d                                  ;$1d is +1 above range
  1745  2c93  cb19                  RR          C
  1746  2c95  cb18                  RR          B
  1747  2c97  cb19                  RR          C                                       ;C = C/8
  1748  2c99  17                    RLA
  1749  2c9a  cb10                  RL          B
  1750  2c9c  17                    RLA
  1751  2c9d  08                    EX          AF,AF'
  1752  2c9e  3a793a                LD          A,(PLAYER_MAP_POS)
  1753  2ca1  cdcf37                CALL        ITEM_MAP_CHECK
  1754  2ca4  08                    EX          AF,AF'
  1755  2ca5  02                    LD          (BC),A
  1756  2ca6  c3002a                JP          UPDATE_VIEWPORT
  1757                          LAB_ram_ed1b:
  1758  2ca9  3a793a                LD          A,(PLAYER_MAP_POS)
  1759  2cac  2638                  LD          H,$38
  1760  2cae  6f                    LD          L,A
  1761  2caf  3a623a                LD          A,(DIR_FACING_SHORT)
  1762  2cb2  3d                    DEC         A
  1763  2cb3  cac22c                JP          Z,NORTH_OPEN_CLOSE_DOOR                 ;Is facing NORTH
  1764  2cb6  3d                    DEC         A
  1765  2cb7  cadd2c                JP          Z,SHIFT_EAST_OPEN_CLOSE_DOOR            ;Is facing EAST
  1766  2cba  3d                    DEC         A
  1767  2cbb  c2de2c                JP          NZ,LAB_ram_ed4b                         ;Is facing WEST
  1768  2cbe  7d                    LD          A,L                                     ;Is facing SOUTH
  1769  2cbf  c610                  ADD         A,$10
  1770  2cc1  6f                    LD          L,A                                     ;Shift SOUTH and process as NORTH
  1771                          NORTH_OPEN_CLOSE_DOOR:
  1772  2cc2  cb76                  BIT         0x6,(HL)                                ;N WALL check
  1773  2cc4  caa521                JP          Z,NO_ACTION_TAKEN                       ;...if no N WALL
  1774  2cc7  cb6e                  BIT         0x5,(HL)                                ;N hidden DOOR check
  1775  2cc9  cad12c                JP          Z,SET_N_DOOR_MASK                       ;...if no N hidden DOOR
  1776  2ccc  3e44                  LD          A,$44                                  ;WALL mask
  1777  2cce  c3d32c                JP          OPEN_N_CHECK
  1778                          SET_N_DOOR_MASK:
  1779  2cd1  3e22                  LD          A,$22                                  ;DOOR mask
  1780                          OPEN_N_CHECK:
  1781  2cd3  cb7e                  BIT         0x7,(HL)                                ;N DOOR-OPEN check
  1782  2cd5  c2572d                JP          NZ,CLOSE_N_DOOR                         ;...if N DOOR not OPEN
  1783  2cd8  cbfe                  SET         0x7,(HL)                                ;Set N door closed on wall map
  1784  2cda  c3f62c                JP          SET_F0_DOOR_OPEN
  1785                          SHIFT_EAST_OPEN_CLOSE_DOOR:
  1786  2cdd  2c                    INC         L                                       ;Shift EAST and process as WEST
  1787                          LAB_ram_ed4b:
  1788  2cde  cb4e                  BIT         0x1,(HL)                                ;W WALL check
  1789  2ce0  caa521                JP          Z,NO_ACTION_TAKEN                       ;...if no W WALL
  1790  2ce3  cb46                  BIT         0x0,(HL)                                ;W DOOR check
  1791  2ce5  caed2c                JP          Z,SET_W_DOOR_MASK                       ;...if no W DOOR
  1792  2ce8  3e44                  LD          A,$44                                  ;WALL mask
  1793  2cea  c3ef2c                JP          LAB_ram_ed5c
  1794                          SET_W_DOOR_MASK:
  1795  2ced  3e22                  LD          A,$22
  1796                          LAB_ram_ed5c:
  1797  2cef  cb56                  BIT         0x2,(HL)                                ;DOOR-OPEN check
  1798  2cf1  c25c2d                JP          NZ,CLOSE_W_DOOR                         ;...if DOOR-OPEN
  1799  2cf4  cbd6                  SET         0x2,(HL)                                ;Set W door closed on wall map
  1800                          SET_F0_DOOR_OPEN:
  1801  2cf6  21e833                LD          HL,WALL_F0_STATE                        ;= $20
  1802  2cf9  cbd6                  SET         0x2,(HL)                 ;= $20
  1803  2cfb  08                    EX          AF,AF'                                  ;Save MASK state from A
  1804                          WAIT_TO_REDRAW_F0_DOOR:
  1805  2cfc  dbfd                  IN          A,(VSYNC)                               ;= db
  1806  2cfe  3c                    INC         A
  1807  2cff  cafc2c                JP          Z,WAIT_TO_REDRAW_F0_DOOR
  1808  2d02  3e00                  LD          A,0x0                                   ;BLK on BLK
  1809                                                                                  ;WAS BLU on BLU
  1810                                                                                  ;WAS LD A,$bb
  1811  2d04  cd5e09                CALL        DRAW_DOOR_F0
  1812  2d07  3ae937                LD          A,(ITEM_F1)                             ;= $60
  1813  2d0a  018a02                LD          BC,$28a
  1814  2d0d  cd362c                CALL        CHK_ITEM
  1815  2d10  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
  1816  2d13  11003a                LD          DE,ITEM_MOVE_CHR_BUFFER
  1817  2d16  cd442d                CALL        SUB_ram_edaf
  1818  2d19  cd5c0e                CALL        SETUP_OPEN_DOOR_SOUND
  1819  2d1c  d9                    EXX
  1820  2d1d  21583a                LD          HL,BYTE_ram_3a58
  1821  2d20  112837                LD          DE,DAT_ram_3728                         ;= $60
  1822  2d23  3e0c                  LD          A,0xc
  1823                          LAB_ram_ed91:
  1824  2d25  08                    EX          AF,AF'
  1825  2d26  d9                    EXX
  1826  2d27  cd620e                CALL        LO_HI_PITCH_SOUND
  1827  2d2a  d9                    EXX
  1828  2d2b  010800                LD          BC,0x8
  1829  2d2e  edb0                  LDIR                                                ;= $60
  1830  2d30  011000                LD          BC,$10
  1831  2d33  ed42                  SBC         HL,BC
  1832  2d35  eb                    EX          DE,HL
  1833  2d36  013000                LD          BC,$30
  1834  2d39  ed42                  SBC         HL,BC
  1835  2d3b  eb                    EX          DE,HL
  1836  2d3c  08                    EX          AF,AF'
  1837  2d3d  3d                    DEC         A
  1838  2d3e  ca092a                JP          Z,WAIT_FOR_INPUT
  1839  2d41  c3252d                JP          LAB_ram_ed91
  1840                          SUB_ram_edaf:
  1841  2d44  3e0c                  LD          A,0xc
  1842                          LAB_ram_edb1:
  1843  2d46  010800                LD          BC,0x8
  1844  2d49  edb0                  LDIR
  1845  2d4b  012000                LD          BC,$20
  1846  2d4e  09                    ADD         HL,BC
  1847  2d4f  3d                    DEC         A
  1848  2d50  c2462d                JP          NZ,LAB_ram_edb1
  1849  2d53  08                    EX          AF,AF'
  1850  2d54  c35e09                JP          DRAW_DOOR_F0
  1851                          CLOSE_N_DOOR:
  1852  2d57  cbbe                  RES         0x7,(HL)                                ;Set N Door map flag to closed
  1853  2d59  c35e2d                JP          START_DOOR_CLOSE_ANIM
  1854                          CLOSE_W_DOOR:
  1855  2d5c  cb96                  RES         0x2,(HL)                                ;Set W Door map flag to closed
  1856                          START_DOOR_CLOSE_ANIM:
  1857  2d5e  21e833                LD          HL,WALL_F0_STATE                        ;= $20
  1858  2d61  cb96                  RES         0x2,(HL)                 ;= $20
  1859  2d63  08                    EX          AF,AF'
  1860  2d64  3a793a                LD          A,(PLAYER_MAP_POS)
  1861  2d67  32773a                LD          (PLAYER_PREV_MAP_LOC),A
  1862  2d6a  cd700e                CALL        SETUP_CLOSE_DOOR_SOUND
  1863  2d6d  d9                    EXX
  1864  2d6e  08                    EX          AF,AF'
  1865  2d6f  217035                LD          HL,COLRAM_F0_DOOR_IDX                   ;= $60
  1866  2d72  112000                LD          DE,$20
  1867  2d75  01080c                LD          BC,$c08
  1868                          DOOR_CLOSE_ANIM_LOOP:
  1869  2d78  77                    LD          (HL),A              ;= $60
  1870  2d79  2c                    INC         L
  1871  2d7a  0d                    DEC         C
  1872  2d7b  c2782d                JP          NZ,DOOR_CLOSE_ANIM_LOOP
  1873  2d7e  d9                    EXX
  1874  2d7f  08                    EX          AF,AF'
  1875  2d80  cd760e                CALL        HI_LO_PITCH_SOUND
  1876  2d83  08                    EX          AF,AF'
  1877  2d84  d9                    EXX
  1878  2d85  0e08                  LD          C,0x8
  1879  2d87  19                    ADD         HL,DE
  1880  2d88  10ee                  DJNZ        DOOR_CLOSE_ANIM_LOOP
  1881  2d8a  cded24                CALL        CLEAR_MONSTER_STATS
  1882  2d8d  c3092a                JP          WAIT_FOR_INPUT
  1883  2d90  010016                LD          BC,$1600
  1884  2d93  c34b1d                JP          SLEEP                                   ;byte SLEEP(short cycleCount)
  1885                          DO_TURN_LEFT:
  1886  2d96  3a783a                LD          A,(LAST_ITEM_HELD)
  1887  2d99  a7                    AND         A
  1888  2d9a  c2a521                JP          NZ,NO_ACTION_TAKEN
  1889  2d9d  21002a                LD          HL,UPDATE_VIEWPORT
  1890  2da0  e5                    PUSH        HL
  1891                          SUB_ram_ee0b:
  1892  2da1  3a623a                LD          A,(DIR_FACING_SHORT)
  1893  2da4  3d                    DEC         A
  1894  2da5  c2aa2d                JP          NZ,LAB_ram_ee14
  1895  2da8  3e04                  LD          A,0x4
  1896                          LAB_ram_ee14:
  1897  2daa  32623a                LD          (DIR_FACING_SHORT),A
  1898  2dad  c9                    RET
  1899                          DO_TURN_RIGHT:
  1900  2dae  3a783a                LD          A,(LAST_ITEM_HELD)
  1901  2db1  a7                    AND         A
  1902  2db2  c2a521                JP          NZ,NO_ACTION_TAKEN
  1903  2db5  21002a                LD          HL,UPDATE_VIEWPORT
  1904  2db8  e5                    PUSH        HL
  1905                          SUB_ram_ee23:
  1906  2db9  3a623a                LD          A,(DIR_FACING_SHORT)
  1907  2dbc  3c                    INC         A
  1908  2dbd  fe05                  CP          0x5
  1909  2dbf  c2c42d                JP          NZ,LAB_ram_ee2e
  1910  2dc2  3e01                  LD          A,0x1
  1911                          LAB_ram_ee2e:
  1912  2dc4  32623a                LD          (DIR_FACING_SHORT),A
  1913  2dc7  c9                    RET
  1914                          DO_GLANCE_RIGHT:
  1915  2dc8  3a783a                LD          A,(LAST_ITEM_HELD)
  1916  2dcb  a7                    AND         A
  1917  2dcc  c2a521                JP          NZ,NO_ACTION_TAKEN
  1918  2dcf  cdb92d                CALL        SUB_ram_ee23
  1919  2dd2  cdda34                CALL        REDRAW_START
  1920  2dd5  cde237                CALL        REDRAW_VIEWPORT
  1921  2dd8  cd481d                CALL        SLEEP_ZERO                              ;byte SLEEP_ZERO(void)
  1922  2ddb  c3962d                JP          DO_TURN_LEFT
  1923                          DO_GLANCE_LEFT:
  1924  2dde  3a783a                LD          A,(LAST_ITEM_HELD)
  1925  2de1  a7                    AND         A
  1926  2de2  c2a521                JP          NZ,NO_ACTION_TAKEN
  1927  2de5  cda12d                CALL        SUB_ram_ee0b
  1928  2de8  cdda34                CALL        REDRAW_START
  1929  2deb  cde237                CALL        REDRAW_VIEWPORT
  1930  2dee  cd481d                CALL        SLEEP_ZERO                              ;byte SLEEP_ZERO(void)
  1931  2df1  c3ae2d                JP          DO_TURN_RIGHT
  1932                          DO_USE_ATTACK:
  1933  2df4  3a7a3a                LD          A,(RIGHT_HAND_ITEM)
  1934  2df7  0600                  LD          B,0x0
  1935  2df9  cb3f                  SRL         A                                       ;Remove "color/level" in bit 0
  1936                                                                                  ;to compare item type, below.
  1937  2dfb  cb18                  RR          B                                       ;Push bit 0 from A
  1938                                                                                  ;(via Carry Flag) to B
  1939  2dfd  cb3f                  SRL         A                                       ;Remove second "color/level" in bit 1
  1940                                                                                  ;to compare item type, below
  1941  2dff  cb10                  RL          B                                       ;Move bits 0 & 1
  1942                                                                                  ;from A to B...
  1943  2e01  cb10                  RL          B                                       ;B now has the LEVEL value (0-3)
  1944  2e03  fe16                  CP          $16                                    ;Compare to KEY
  1945                                                                                  ;58,59,5A,5B 2 @ SRL = 16
  1946  2e05  cab92f                JP          Z,DO_USE_KEY
  1947  2e08  fe19                  CP          $19                                    ;Compare to PHYS POTION
  1948                                                                                  ;64,65,66,67 2 @ SRL = 19
  1949  2e0a  ca892f                JP          Z,DO_USE_PHYS_POTION
  1950  2e0d  fe1a                  CP          $1a                                    ;Compare to SPRT POTION
  1951                                                                                  ;68,69,6A,6B 2 @ SRL = 1A
  1952  2e0f  caa12f                JP          Z,DO_USE_SPRT_POTION
  1953  2e12  fe1c                  CP          $1c                                    ;Compare to CHAOS POTION
  1954                                                                                  ;70,71,72,73 2 @ SRL = 1c
  1955  2e14  c22030                JP          NZ,USE_SOMETHING_ELSE
  1956                          DO_USE_CHAOS_POTION:
  1957  2e17  cd2f2e                CALL        PLAY_USE_PHYS_POTION_SOUND
  1958  2e1a  04                    INC         B
  1959  2e1b  05                    DEC         B
  1960  2e1c  c2722e                JP          NZ,CHECK_YELLOW_L_POTION                ;If NZ, handle other colors
  1961                                                                                  ;of LARGE POTION
  1962  2e1f  cd4f2e                CALL        TOTAL_HEAL                              ;LARGE Potion is RED
  1963                                                                                  ;so do TOTAL HEAL
  1964                          PROCESS_POTION_UPDATES:
  1965  2e22  cdc03c                CALL        REDRAW_STATS
  1966  2e25  3a783a                LD          A,(LAST_ITEM_HELD)
  1967  2e28  a7                    AND         A
  1968  2e29  c20d32                JP          NZ,INIT_MELEE_ANIM
  1969  2e2c  c3062a                JP          INPUT_DEBOUNCE
  1970                          PLAY_USE_PHYS_POTION_SOUND:
  1971  2e2f  d9                    EXX
  1972  2e30  cda90e                CALL        SOUND_03
  1973  2e33  cda90e                CALL        SOUND_03
  1974  2e36  cda90e                CALL        SOUND_03
  1975  2e39  c33d2e                JP          CLEAR_RIGHT_HAND
  1976                          SUB_ram_eea9:
  1977  2e3c  d9                    EXX
  1978                          CLEAR_RIGHT_HAND:
  1979  2e3d  3efe                  LD          A,$fe
  1980  2e3f  327a3a                LD          (RIGHT_HAND_ITEM),A
  1981  2e42  11e307                LD          DE,POOF_6                               ;= "    ",$01
  1982  2e45  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  1983  2e48  06d0                  LD          B,$d0
  1984  2e4a  cdfa32                CALL        GFX_DRAW
  1985  2e4d  d9                    EXX
  1986  2e4e  c9                    RET
  1987                          TOTAL_HEAL:
  1988  2e4f  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
  1989  2e52  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  1990  2e55  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
  1991  2e58  32973a                LD          (PLAYER_SPRT_HEALTH),A
  1992  2e5b  c9                    RET
  1993                          REDRAW_STATS_OLD:
  1994  2e5c  21933a                LD          HL,PLAYER_PHYS_HEALTH
  1995  2e5f  114130                LD          DE,CHRRAM_PHYS_HEALTH_1000              ;= $20
  1996  2e62  0602                  LD          B,0x2
  1997  2e64  cdc032                CALL        RECALC_AND_REDRAW_BCD
  1998  2e67  21973a                LD          HL,PLAYER_SPRT_HEALTH
  1999  2e6a  114730                LD          DE,CHRRAM_SPRT_HEALTH_10                ;= $20
  2000  2e6d  0601                  LD          B,0x1
  2001  2e6f  c3c032                JP          RECALC_AND_REDRAW_BCD                   ;Waz JP FUN_ram_f2fd
  2002                                                                                  ;(c3 fd f2)
  2003                          CHECK_YELLOW_L_POTION:
  2004  2e72  05                    DEC         B
  2005  2e73  c2842e                JP          NZ,CHECK_PURPLE_L_POTION
  2006  2e76  011000                LD          BC,$10                                 ;Set PHYS increase to 10
  2007  2e79  1e00                  LD          E,0x0                                   ;Set SPRT increase to 0
  2008                          PROCESS_LARGE_POTION:
  2009  2e7b  cdcf2e                CALL        CALC_CURR_PHYS_HEALTH
  2010  2e7e  cdf52e                CALL        CALC_MAX_PHYS_HEALTH
  2011  2e81  c3222e                JP          PROCESS_POTION_UPDATES
  2012                          CHECK_PURPLE_L_POTION:
  2013  2e84  05                    DEC         B
  2014  2e85  c2902e                JP          NZ,CHECK_WHITE_L_POTION
  2015  2e88  010000                LD          BC,0x0                                  ;Set PHYS increase to 0
  2016  2e8b  1e06                  LD          E,0x6                    ;Set SPRT increase to 6
  2017  2e8d  c37b2e                JP          PROCESS_LARGE_POTION
  2018                          CHECK_WHITE_L_POTION:
  2019  2e90  cd8a3a                CALL        MAKE_RANDOM_BYTE                        ;Get RANDOM BYTE
  2020                                                                                  ;and put into A
  2021  2e93  e603                  AND         0x3                                     ;Range it to 0-3
  2022  2e95  3d                    DEC         A
  2023  2e96  c2a12e                JP          NZ,LAB_ram_ef08                         ;If NZ, check for case 1
  2024  2e99  1e00                  LD          E,0x0                    ;Case 0: set SPRT increase to 0
  2025  2e9b  012000                LD          BC,$20                                 ;Set PHYS increase to 20
  2026  2e9e  c37b2e                JP          PROCESS_LARGE_POTION                    ;...and reprocess
  2027                          LAB_ram_ef08:
  2028  2ea1  3d                    DEC         A
  2029  2ea2  c2ad2e                JP          NZ,LAB_ram_ef12
  2030  2ea5  010000                LD          BC,0x0                                  ;Set PHYS increase to 0
  2031  2ea8  1e12                  LD          E,$12                ;Set SPRT increase to 12
  2032  2eaa  c37b2e                JP          PROCESS_LARGE_POTION
  2033                          LAB_ram_ef12:
  2034  2ead  3d                    DEC         A
  2035  2eae  c2bc2e                JP          NZ,CHECK_CASE_3_WL_POTION
  2036  2eb1  cd4f2e                CALL        TOTAL_HEAL                              ;Fill up PHYS and SPRT
  2037  2eb4  011000                LD          BC,$10                                 ;Set PHYS increase to 10
  2038  2eb7  1e06                  LD          E,0x6                    ;Set SPRT increase to 6
  2039  2eb9  c37b2e                JP          PROCESS_LARGE_POTION
  2040                          CHECK_CASE_3_WL_POTION:
  2041  2ebc  013000                LD          BC,$30                                 ;Set PHYS decrease to 30
  2042  2ebf  1e15                  LD          E,$15                                  ;Set SPRT decrease to 15
  2043  2ec1  cd132f                CALL        REDUCE_HEALTH_BIG
  2044  2ec4  011500                LD          BC,$15
  2045  2ec7  1e07                  LD          E,0x7
  2046  2ec9  cd302f                CALL        REDUCE_HEALTH_SMALL
  2047  2ecc  c3222e                JP          PROCESS_POTION_UPDATES
  2048                          CALC_CURR_PHYS_HEALTH:
  2049  2ecf  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)                 ;Load current PHYS Health
  2050                                                                                  ;into HL
  2051  2ed2  7d                    LD          A,L
  2052  2ed3  81                    ADD         A,C
  2053  2ed4  27                    DAA                                                 ;Correct 1000s & 100s
  2054                                                                                  ;for BCD
  2055  2ed5  6f                    LD          L,A
  2056  2ed6  7c                    LD          A,H
  2057  2ed7  88                    ADC         A,B
  2058  2ed8  27                    DAA                                                 ;Correct 10s & 1s
  2059                                                                                  ;for BCD
  2060  2ed9  fe02                  CP          0x2
  2061  2edb  67                    LD          H,A
  2062  2edc  c2e32e                JP          NZ,UPDATE_HEALTH_VALUES
  2063  2edf  2601                  LD          H,0x1
  2064  2ee1  2e99                  LD          L,$99                                  ;Max PHYS Health of 199
  2065                          UPDATE_HEALTH_VALUES:
  2066  2ee3  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  2067  2ee6  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  2068  2ee9  83                    ADD         A,E
  2069  2eea  27                    DAA                                                 ;Correct for BCD
  2070  2eeb  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2071  2eee  d0                    RET         NC
  2072  2eef  3e99                  LD          A,$99                                  ;Max SPRT Health of 99
  2073  2ef1  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2074  2ef4  c9                    RET
  2075                          CALC_MAX_PHYS_HEALTH:
  2076  2ef5  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
  2077  2ef8  ed4b953a              LD          BC,(PLAYER_PHYS_HEALTH_MAX)
  2078  2efc  7c                    LD          A,H
  2079  2efd  b8                    CP          B
  2080  2efe  da092f                JP          C,CALC_MAX_SPRT_HEALTH
  2081  2f01  7d                    LD          A,L
  2082  2f02  b9                    CP          C
  2083  2f03  da092f                JP          C,CALC_MAX_SPRT_HEALTH
  2084  2f06  22953a                LD          (PLAYER_PHYS_HEALTH_MAX),HL
  2085                          CALC_MAX_SPRT_HEALTH:
  2086  2f09  21983a                LD          HL,PLAYER_SPRT_HEALTH_MAX
  2087  2f0c  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  2088  2f0f  be                    CP          (HL)
  2089  2f10  d8                    RET         C
  2090  2f11  77                    LD          (HL),A
  2091  2f12  c9                    RET
  2092                          REDUCE_HEALTH_BIG:
  2093  2f13  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
  2094  2f16  7d                    LD          A,L
  2095  2f17  91                    SUB         C
  2096  2f18  27                    DAA
  2097  2f19  6f                    LD          L,A
  2098  2f1a  7c                    LD          A,H
  2099  2f1b  98                    SBC         A,B
  2100  2f1c  27                    DAA
  2101  2f1d  67                    LD          H,A
  2102  2f1e  da4d2f                JP          C,PLAYER_DIES
  2103  2f21  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  2104  2f24  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  2105  2f27  93                    SUB         E
  2106  2f28  27                    DAA
  2107  2f29  da4d2f                JP          C,PLAYER_DIES
  2108  2f2c  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2109  2f2f  c9                    RET
  2110                          REDUCE_HEALTH_SMALL:
  2111  2f30  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)
  2112  2f33  7d                    LD          A,L
  2113  2f34  91                    SUB         C
  2114  2f35  27                    DAA
  2115  2f36  6f                    LD          L,A
  2116  2f37  7c                    LD          A,H
  2117  2f38  98                    SBC         A,B
  2118  2f39  27                    DAA
  2119  2f3a  67                    LD          H,A
  2120  2f3b  da4d2f                JP          C,PLAYER_DIES
  2121  2f3e  22953a                LD          (PLAYER_PHYS_HEALTH_MAX),HL
  2122  2f41  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
  2123  2f44  93                    SUB         E
  2124  2f45  27                    DAA
  2125  2f46  da4d2f                JP          C,PLAYER_DIES
  2126  2f49  32983a                LD          (PLAYER_SPRT_HEALTH_MAX),A
  2127  2f4c  c9                    RET
  2128                          PLAYER_DIES:
  2129  2f4d  212834                LD          HL,COLRAM_VIEWPORT_IDX                  ;= $60    `
  2130  2f50  011818                LD          BC,$1818                               ;18 x 18 rectangle
  2131  2f53  af                    XOR         A
  2132  2f54  cd3e09                CALL        FILL_CHRCOL_RECT
  2133  2f57  21e731                LD          HL,CHRRAM_YOU_DIED_IDX                  ;= $20
  2134  2f5a  11c808                LD          DE,YOU_DIED_TXT
  2135  2f5d  3a6c3a                LD          A,(INPUT_HOLDER)
  2136  2f60  32783a                LD          (LAST_ITEM_HELD),A
  2137  2f63  07                    RLCA
  2138  2f64  07                    RLCA
  2139  2f65  07                    RLCA
  2140  2f66  07                    RLCA
  2141  2f67  47                    LD          B,A
  2142  2f68  cdfa32                CALL        GFX_DRAW
  2143  2f6b  210000                LD          HL,0x0
  2144  2f6e  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  2145  2f71  af                    XOR         A
  2146  2f72  32973a                LD          (PLAYER_SPRT_HEALTH),A
  2147  2f75  326c3a                LD          (INPUT_HOLDER),A
  2148  2f78  cdc03c                CALL        REDRAW_STATS
  2149  2f7b  3e32                  LD          A,$32
  2150  2f7d  32653a                LD          (RAM_AD),A
  2151  2f80  cd340e                CALL        SUB_ram_cdd3
  2152  2f83  cd481d                CALL        SLEEP_ZERO                              ;byte SLEEP_ZERO(void)
  2153  2f86  c31e2a                JP          SCREEN_SAVER_FULL_SCREEN
  2154                          
  2155                          DO_USE_PHYS_POTION:
  2156  2f89  cd2f2e                CALL        PLAY_USE_PHYS_POTION_SOUND
  2157  2f8c  04                    INC         B                                       ;Change from LEVEL to
  2158                                                                                  ;COLOR value (Level + 1)
  2159  2f8d  60                    LD          H,B
  2160  2f8e  68                    LD          L,B
  2161  2f8f  224134                LD          (COLRAM_PHYS_STATS_1000),HL             ;Update PHYS color (1000s & 100s)
  2162                                                                                  ;to potion level on BLK
  2163  2f92  224334                LD          (COLRAM_PHYS_STATS_10),HL               ;Update PHYS color (10s & 1s)
  2164                                                                                  ;to potion level on BLK
  2165  2f95  26d0                  LD          H,$d0                                  ;DKGRN on BLK
  2166  2f97  6c                    LD          L,H
  2167  2f98  224634                LD          (COLRAM_SPRT_STATS_10),HL               ;Update SPRT color (10s)
  2168                                                                                  ;to DKGRN on BLACK
  2169  2f9b  224734                LD          (COLRAM_SPRT_STATS_1),HL                ;Update SPRT color (1s)
  2170                                                                                  ;to DKGRN on BLACK
  2171  2f9e  c3222e                JP          PROCESS_POTION_UPDATES
  2172                          DO_USE_SPRT_POTION:
  2173  2fa1  cd2f2e                CALL        PLAY_USE_PHYS_POTION_SOUND
  2174  2fa4  04                    INC         B                                       ;Change from LEVEL to
  2175                                                                                  ;COLOR value (Level + 1)
  2176  2fa5  60                    LD          H,B
  2177  2fa6  68                    LD          L,B
  2178  2fa7  224634                LD          (COLRAM_SPRT_STATS_10),HL               ;Update SPRT color (10s)
  2179                                                                                  ;to potion level on BLK
  2180  2faa  224734                LD          (COLRAM_SPRT_STATS_1),HL                ;Update SPRT color (1s)
  2181                                                                                  ;to potion level on BLK
  2182  2fad  26d0                  LD          H,$d0                                  ;DKGRN on BLK
  2183  2faf  6c                    LD          L,H
  2184  2fb0  224134                LD          (COLRAM_PHYS_STATS_1000),HL             ;Update PHYS color (1000s & 100s)
  2185                                                                                  ;to DKGRN on BLK
  2186  2fb3  224334                LD          (COLRAM_PHYS_STATS_10),HL               ;Update PHYS color (10s & 1s)
  2187                                                                                  ;to DKGRN on BLK
  2188  2fb6  c3222e                JP          PROCESS_POTION_UPDATES
  2189                          DO_USE_KEY:
  2190  2fb9  3aea37                LD          A,(ITEM_F0)                             ;= $60
  2191  2fbc  0e00                  LD          C,0x0
  2192  2fbe  cb3f                  SRL         A
  2193  2fc0  cb19                  RR          C
  2194  2fc2  cb3f                  SRL         A
  2195  2fc4  cb11                  RL          C
  2196  2fc6  cb11                  RL          C
  2197  2fc8  fe14                  CP          $14
  2198  2fca  c2a521                JP          NZ,NO_ACTION_TAKEN
  2199  2fcd  78                    LD          A,B
  2200  2fce  b9                    CP          C
  2201  2fcf  daa521                JP          C,NO_ACTION_TAKEN
  2202  2fd2  79                    LD          A,C
  2203  2fd3  47                    LD          B,A
  2204  2fd4  a7                    AND         A
  2205  2fd5  cae22f                JP          Z,LAB_ram_f048
  2206  2fd8  cda93a                CALL        UPDATE_SCR_SAVER_TIMER
  2207  2fdb  0c                    INC         C
  2208                          LAB_ram_f043:
  2209  2fdc  91                    SUB         C
  2210  2fdd  d2dc2f                JP          NC,LAB_ram_f043
  2211  2fe0  81                    ADD         A,C
  2212  2fe1  47                    LD          B,A
  2213                          LAB_ram_f048:
  2214  2fe2  ed5f                  LD          A,R                                     ;Semi-random number into A
  2215  2fe4  e607                  AND         0x7
  2216                          LAB_ram_f04c:
  2217  2fe6  ca0d30                JP          Z,LAB_ram_f071
  2218  2fe9  d607                  SUB         0x7
  2219                          LAB_ram_f050:
  2220  2feb  d2e62f                JP          NC,LAB_ram_f04c
  2221  2fee  c61d                  ADD         A,$1d
  2222                          LAB_ram_f054:
  2223  2ff0  cb18                  RR          B
  2224  2ff2  cb19                  RR          C
  2225  2ff4  cb18                  RR          B
  2226  2ff6  17                    RLA
  2227  2ff7  cb11                  RL          C
  2228  2ff9  17                    RLA
  2229  2ffa  08                    EX          AF,AF'
  2230  2ffb  3a793a                LD          A,(PLAYER_MAP_POS)
  2231  2ffe  cdcf37                CALL        ITEM_MAP_CHECK
  2232  3001  08                    EX          AF,AF'
  2233  3002  02                    LD          (BC),A
  2234  3003  3a783a                LD          A,(LAST_ITEM_HELD)
  2235  3006  a7                    AND         A
  2236  3007  c20d32                JP          NZ,INIT_MELEE_ANIM
  2237  300a  c3002a                JP          UPDATE_VIEWPORT
  2238                          LAB_ram_f071:
  2239  300d  79                    LD          A,C
  2240  300e  fe04                  CP          0x4
  2241  3010  ca1930                JP          Z,LAB_ram_f07c
  2242  3013  47                    LD          B,A
  2243  3014  3e16                  LD          A,$16
  2244  3016  c3f02f                JP          LAB_ram_f054
  2245                          LAB_ram_f07c:
  2246  3019  0603                  LD          B,0x3
  2247  301b  3e1c                  LD          A,$1c
  2248  301d  c3f02f                JP          LAB_ram_f054
  2249                          USE_SOMETHING_ELSE:
  2250  3020  08                    EX          AF,AF'
  2251  3021  3ae833                LD          A,(WALL_F0_STATE)                       ;= $20
  2252  3024  a7                    AND         A
  2253  3025  ca2d30                JP          Z,CHECK_FOR_NON_ITEMS
  2254  3028  cb57                  BIT         0x2,A
  2255  302a  ca3a30                JP          Z,CHECK_FOR_END_ITEM
  2256                          CHECK_FOR_NON_ITEMS:
  2257  302d  3ae937                LD          A,(ITEM_F1)                             ;= $60
  2258  3030  fefe                  CP          $fe                                    ;Compare to EMPTY
  2259  3032  ca3a30                JP          Z,CHECK_FOR_END_ITEM
  2260  3035  fe78                  CP          $78                                    ;Compare to MONSTERS
  2261  3037  d24130                JP          NC,CHECK_IF_BOW_XBOW
  2262                          CHECK_FOR_END_ITEM:
  2263  303a  08                    EX          AF,AF'
  2264  303b  feff                  CP          $ff                                    ;Compare to EMPTY-END
  2265  303d  c2a521                JP          NZ,NO_ACTION_TAKEN
  2266  3040  08                    EX          AF,AF'
  2267                          CHECK_IF_BOW_XBOW:
  2268  3041  08                    EX          AF,AF'
  2269  3042  fe06                  CP          0x6                                     ;Compare to BOW
  2270  3044  c26430                JP          NZ,CHECK_IF_SCROLL_STAFF
  2271                          USE_BOW_XBOW:
  2272  3047  c5                    PUSH        BC                                      ;Save BC
  2273  3048  3aac3a                LD          A,(ARROW_INV)                           ;Get Arrow Inventory
  2274  304b  d601                  SUB         0x1                                     ;Decrease by 1
  2275  304d  daa521                JP          C,NO_ACTION_TAKEN                       ;If Arrow Inv <1, end
  2276  3050  32ac3a                LD          (ARROW_INV),A
  2277  3053  cdb922                CALL        CHK_ITEM_BREAK
  2278  3056  c1                    POP         BC
  2279  3057  d25f30                JP          NC,BOW_XBOW_NO_BREAK
  2280  305a  3efe                  LD          A,$fe                                  ;$fe = EMPTY ITEM
  2281  305c  327a3a                LD          (RIGHT_HAND_ITEM),A                     ;Put EMPTY ITEM into Right Hand
  2282                          BOW_XBOW_NO_BREAK:
  2283  305f  1605                  LD          D,0x5
  2284  3061  c39330                JP          LAB_ram_f0e9
  2285                          CHECK_IF_SCROLL_STAFF:
  2286  3064  fe07                  CP          0x7                                     ;Compare to SCROLL
  2287  3066  c27b30                JP          NZ,CHECK_OTHERS
  2288                          USE_SCROLL_STAFF:
  2289  3069  c5                    PUSH        BC
  2290  306a  cdb922                CALL        CHK_ITEM_BREAK
  2291  306d  c1                    POP         BC
  2292  306e  d27630                JP          NC,SCROLL_STAFF_NO_BREAK
  2293  3071  3efe                  LD          A,$fe
  2294  3073  327a3a                LD          (RIGHT_HAND_ITEM),A
  2295                          SCROLL_STAFF_NO_BREAK:
  2296  3076  1609                  LD          D,0x9                                   ;Use FIREBALL ammo
  2297  3078  c39330                JP          LAB_ram_f0e9
  2298                          CHECK_OTHERS:
  2299  307b  fe0b                  CP          0xb                                     ;Compare to STAFF
  2300  307d  ca6930                JP          Z,USE_SCROLL_STAFF
  2301  3080  fe0c                  CP          0xc                                     ;Compare to XBOW
  2302  3082  ca4730                JP          Z,USE_BOW_XBOW
  2303  3085  fe06                  CP          0x6                                     ;Compare to BOW
  2304  3087  daa521                JP          C,NO_ACTION_TAKEN
  2305  308a  fe10                  CP          $10                                    ;Compare to LADDER
  2306  308c  d2bd30                JP          NC,LAB_ram_f113
  2307  308f  57                    LD          D,A
  2308  3090  cd3c2e                CALL        SUB_ram_eea9
  2309                          LAB_ram_f0e9:
  2310  3093  cd9c30                CALL        SUB_ram_f0f2
  2311  3096  c3dc30                JP          SUB_ram_f130
  2312                          SUB_ram_f0ef:
  2313  3099  cd3c2e                CALL        SUB_ram_eea9
  2314                          SUB_ram_f0f2:
  2315  309c  3e03                  LD          A,0x3
  2316  309e  32873a                LD          (BYTE_ram_3a87),A
  2317  30a1  7a                    LD          A,D
  2318  30a2  cb27                  SLA         A
  2319  30a4  cb27                  SLA         A
  2320  30a6  b0                    OR          B
  2321  30a7  32823a                LD          (BYTE_ram_3a82),A
  2322  30aa  210302                LD          HL,$203
  2323  30ad  22853a                LD          (BYTE_ram_3a85),HL
  2324  30b0  214333                LD          HL,CHRRAM_RIGHT_HD_GFX_IDX              ;= $20
  2325  30b3  22833a                LD          (BYTE_ram_3a83),HL
  2326  30b6  7d                    LD          A,L
  2327  30b7  32653a                LD          (RAM_AD),A
  2328  30ba  c32023                JP          LAB_ram_e3d7
  2329                          LAB_ram_f113:
  2330  30bd  fe11                  CP          $11
  2331  30bf  c2c530                JP          NZ,LAB_ram_f119
  2332  30c2  c3ca30                JP          LAB_ram_f11e
  2333                          LAB_ram_f119:
  2334  30c5  fe14                  CP          $14
  2335  30c7  c2a521                JP          NZ,NO_ACTION_TAKEN
  2336                          LAB_ram_f11e:
  2337  30ca  57                    LD          D,A
  2338  30cb  3a783a                LD          A,(LAST_ITEM_HELD)
  2339  30ce  a7                    AND         A
  2340  30cf  caa521                JP          Z,NO_ACTION_TAKEN
  2341  30d2  af                    XOR         A                                       ;A  = $00
  2342                                                                                  ;Reset C & N, Set Z
  2343  30d3  32783a                LD          (LAST_ITEM_HELD),A
  2344  30d6  cd9930                CALL        SUB_ram_f0ef
  2345  30d9  c3092a                JP          WAIT_FOR_INPUT
  2346                          SUB_ram_f130:
  2347  30dc  3a783a                LD          A,(LAST_ITEM_HELD)
  2348  30df  a7                    AND         A
  2349  30e0  c20d32                JP          NZ,INIT_MELEE_ANIM
  2350  30e3  3c                    INC         A
  2351  30e4  32783a                LD          (LAST_ITEM_HELD),A
  2352  30e7  3ae937                LD          A,(ITEM_F1)                             ;= $60
  2353  30ea  0600                  LD          B,0x0
  2354  30ec  cb3f                  SRL         A
  2355  30ee  cb18                  RR          B
  2356  30f0  1f                    RRA
  2357  30f1  cb10                  RL          B
  2358  30f3  cb10                  RL          B
  2359  30f5  08                    EX          AF,AF'
  2360  30f6  af                    XOR         A
  2361  30f7  21683a                LD          HL,DUNGEON_LEVEL
  2362  30fa  ed6f                  RLD
  2363  30fc  57                    LD          D,A
  2364  30fd  cb3f                  SRL         A
  2365  30ff  d20431                JP          NC,LAB_ram_f157
  2366  3102  c650                  ADD         A,$50
  2367                          LAB_ram_f157:
  2368  3104  07                    RLCA
  2369  3105  07                    RLCA
  2370  3106  07                    RLCA
  2371  3107  07                    RLCA
  2372  3108  5f                    LD          E,A
  2373  3109  7a                    LD          A,D
  2374  310a  ed6f                  RLD
  2375  310c  57                    LD          D,A
  2376  310d  cb3f                  SRL         A
  2377  310f  83                    ADD         A,E
  2378  3110  c603                  ADD         A,0x3
  2379  3112  27                    DAA
  2380  3113  4f                    LD          C,A
  2381  3114  7a                    LD          A,D
  2382  3115  ed6f                  RLD
  2383  3117  08                    EX          AF,AF'
  2384  3118  d61e                  SUB         $1e
  2385  311a  c22b31                JP          NZ,LAB_ram_f17d
  2386  311d  1607                  LD          D,0x7
  2387  311f  210403                LD          HL,$304
  2388  3122  3e3c                  LD          A,$3c
  2389  3124  80                    ADD         A,B
  2390  3125  328a3a                LD          (BYTE_ram_3a8a),A
  2391  3128  c3ea31                JP          LAB_ram_f22b
  2392                          LAB_ram_f17d:
  2393  312b  3d                    DEC         A
  2394  312c  c23d31                JP          NZ,LAB_ram_f18e
  2395  312f  1603                  LD          D,0x3
  2396  3131  210101                LD          HL,$101
  2397  3134  3e3c                  LD          A,$3c
  2398  3136  80                    ADD         A,B
  2399  3137  328a3a                LD          (BYTE_ram_3a8a),A
  2400  313a  c3ea31                JP          LAB_ram_f22b
  2401                          LAB_ram_f18e:
  2402  313d  3d                    DEC         A
  2403  313e  c24f31                JP          NZ,LAB_ram_f19f
  2404  3141  1604                  LD          D,0x4
  2405  3143  210200                LD          HL,0x2
  2406  3146  3e24                  LD          A,$24
  2407  3148  80                    ADD         A,B
  2408  3149  328a3a                LD          (BYTE_ram_3a8a),A
  2409  314c  c3ea31                JP          LAB_ram_f22b
  2410                          LAB_ram_f19f:
  2411  314f  3d                    DEC         A
  2412  3150  c26131                JP          NZ,LAB_ram_f1af
  2413  3153  1605                  LD          D,0x5
  2414  3155  210302                LD          HL,$203
  2415  3158  3e3c                  LD          A,$3c
  2416  315a  80                    ADD         A,B
  2417  315b  328a3a                LD          (BYTE_ram_3a8a),A
  2418  315e  c3ea31                JP          LAB_ram_f22b
  2419                          LAB_ram_f1af:
  2420  3161  3d                    DEC         A
  2421  3162  c27331                JP          NZ,LAB_ram_f1bf
  2422  3165  1603                  LD          D,0x3
  2423  3167  210203                LD          HL,$302
  2424  316a  3e24                  LD          A,$24
  2425  316c  80                    ADD         A,B
  2426  316d  328a3a                LD          (BYTE_ram_3a8a),A
  2427  3170  c3ea31                JP          LAB_ram_f22b
  2428                          LAB_ram_f1bf:
  2429  3173  3d                    DEC         A
  2430  3174  c28531                JP          NZ,LAB_ram_f1cf
  2431  3177  1608                  LD          D,0x8
  2432  3179  210504                LD          HL,$405
  2433  317c  3e24                  LD          A,$24
  2434  317e  80                    ADD         A,B
  2435  317f  328a3a                LD          (BYTE_ram_3a8a),A
  2436  3182  c3ea31                JP          LAB_ram_f22b
  2437                          LAB_ram_f1cf:
  2438  3185  3d                    DEC         A
  2439  3186  c29731                JP          NZ,LAB_ram_f1e0
  2440  3189  1606                  LD          D,0x6
  2441  318b  210402                LD          HL,$204
  2442  318e  3e3c                  LD          A,$3c
  2443  3190  80                    ADD         A,B
  2444  3191  328a3a                LD          (BYTE_ram_3a8a),A
  2445  3194  c3ea31                JP          LAB_ram_f22b
  2446                          LAB_ram_f1e0:
  2447  3197  3d                    DEC         A
  2448  3198  c2a931                JP          NZ,LAB_ram_f1f0
  2449  319b  1613                  LD          D,$13
  2450  319d  210505                LD          HL,$505
  2451  31a0  3e24                  LD          A,$24
  2452  31a2  80                    ADD         A,B
  2453  31a3  328a3a                LD          (BYTE_ram_3a8a),A
  2454  31a6  c3ea31                JP          LAB_ram_f22b
  2455                          LAB_ram_f1f0:
  2456  31a9  3d                    DEC         A
  2457  31aa  c2bb31                JP          NZ,LAB_ram_f200
  2458  31ad  1604                  LD          D,0x4
  2459  31af  210504                LD          HL,$405
  2460  31b2  3e3c                  LD          A,$3c
  2461  31b4  80                    ADD         A,B
  2462  31b5  328a3a                LD          (BYTE_ram_3a8a),A
  2463  31b8  c3ea31                JP          LAB_ram_f22b
  2464                          LAB_ram_f200:
  2465  31bb  3d                    DEC         A
  2466  31bc  c2e731                JP          NZ,LAB_ram_f228
  2467  31bf  1611                  LD          D,$11
  2468  31c1  210504                LD          HL,$405
  2469  31c4  d9                    EXX
  2470  31c5  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
  2471  31c8  cd8323                CALL        SUB_ram_e439
  2472  31cb  eb                    EX          DE,HL
  2473  31cc  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  2474  31cf  6f                    LD          L,A
  2475  31d0  2600                  LD          H,0x0
  2476  31d2  cd7a23                CALL        RECALC_PHYS_HEALTH
  2477  31d5  d9                    EXX
  2478  31d6  d2e231                JP          NC,LAB_ram_f224
  2479  31d9  3e24                  LD          A,$24
  2480                          LAB_ram_f21e:
  2481  31db  80                    ADD         A,B
  2482  31dc  328a3a                LD          (BYTE_ram_3a8a),A
  2483  31df  c3ea31                JP          LAB_ram_f22b
  2484                          LAB_ram_f224:
  2485  31e2  3e3c                  LD          A,$3c
  2486  31e4  c3db31                JP          LAB_ram_f21e
  2487                          LAB_ram_f228:
  2488  31e7  c3a521                JP          NO_ACTION_TAKEN
  2489                          LAB_ram_f22b:
  2490  31ea  cd3e32                CALL        SUB_ram_f27f
  2491  31ed  e5                    PUSH        HL
  2492  31ee  21a23a                LD          HL,CURR_MONSTER_SPRT
  2493  31f1  cd5932                CALL        SUB_ram_f298
  2494  31f4  e1                    POP         HL
  2495  31f5  54                    LD          D,H
  2496  31f6  cd3e32                CALL        SUB_ram_f27f
  2497  31f9  e5                    PUSH        HL
  2498  31fa  21a53a                LD          HL,BYTE_ram_3aa5
  2499  31fd  cd5932                CALL        SUB_ram_f298
  2500  3200  e1                    POP         HL
  2501  3201  55                    LD          D,L
  2502  3202  1e00                  LD          E,0x0
  2503  3204  cd4432                CALL        CALC_WEAPON_VALUE
  2504  3207  32a83a                LD          (WEAPON_VALUE_HOLDER),A
  2505  320a  cd2832                CALL        REDRAW_MONSTER_HEALTH
  2506                          INIT_MELEE_ANIM:
  2507  320d  3e03                  LD          A,0x3                                   ;A  = $03
  2508  320f  328b3a                LD          (MELEE_ANIM_STATE),A
  2509  3212  210602                LD          HL,$206                                ;HL = $ce
  2510  3215  228d3a                LD          (MONSTER_ATT_POS_COUNT),HL
  2511  3218  21ea31                LD          HL,$31ea                               ;HL = $0020 db?
  2512                                                                                  ;Always $20 (SPACE char)?
  2513  321b  228f3a                LD          (MONSTER_ATT_POS_OFFSET),HL
  2514  321e  7d                    LD          A,L
  2515  321f  32663a                LD          (RAM_AE),A
  2516  3222  cd4c25                CALL        ANIMATE_MELEE_ROUND
  2517  3225  c3092a                JP          WAIT_FOR_INPUT
  2518                          REDRAW_MONSTER_HEALTH:
  2519  3228  118930                LD          DE,CHRRAM_MONSTER_PHYS                  ;WAS LD DE,$333d
  2520  322b  21a33a                LD          HL,CURR_MONSTER_PHYS
  2521  322e  0602                  LD          B,0x2
  2522  3230  cdc032                CALL        RECALC_AND_REDRAW_BCD
  2523  3233  116330                LD          DE,CHRRAM_MONSTER_SPRT                  ;WAS LD DE,$338f
  2524  3236  21a23a                LD          HL,CURR_MONSTER_SPRT
  2525  3239  0601                  LD          B,0x1
  2526  323b  c3c032                JP          RECALC_AND_REDRAW_BCD
  2527                          SUB_ram_f27f:
  2528  323e  cda93a                CALL        UPDATE_SCR_SAVER_TIMER
  2529  3241  e607                  AND         0x7
  2530  3243  5f                    LD          E,A
  2531                          CALC_WEAPON_VALUE:
  2532  3244  c5                    PUSH        BC                                      ;Save original weaponLevel
  2533  3245  04                    INC         B                                       ;B = B + 1
  2534  3246  7a                    LD          A,D                                     ;A = D
  2535  3247  c34c32                JP          LAB_ram_f28c
  2536                          LAB_ram_f28a:
  2537  324a  82                    ADD         A,D                                     ;A = A + D
  2538  324b  27                    DAA                                                 ;Normalize for BCD
  2539                          LAB_ram_f28c:
  2540  324c  10fc                  DJNZ        LAB_ram_f28a                            ;B = B - 1
  2541  324e  93                    SUB         E                                       ;A = A - E
  2542  324f  27                    DAA                                                 ;Normalize for BCD
  2543  3250  d25532                JP          NC,LAB_ram_f294
  2544  3253  8b                    ADC         A,E                                     ;A = A + E (and CARRY)
  2545  3254  27                    DAA                                                 ;Normalize for BCD
  2546                          LAB_ram_f294:
  2547  3255  81                    ADD         A,C                                     ;A = A + C
  2548  3256  27                    DAA                                                 ;Normalize for BCD
  2549  3257  c1                    POP         BC                                      ;BC = Original weaponLevel
  2550  3258  c9                    RET                                                 ;A = new weaponValue
  2551                          SUB_ram_f298:
  2552  3259  77                    LD          (HL),A
  2553  325a  23                    INC         HL
  2554  325b  87                    ADD         A,A
  2555  325c  27                    DAA
  2556  325d  77                    LD          (HL),A
  2557  325e  23                    INC         HL
  2558  325f  3e00                  LD          A,0x0
  2559  3261  17                    RLA
  2560  3262  77                    LD          (HL),A
  2561  3263  c9                    RET
  2562                          DO_USE_LADDER:
  2563  3264  3a783a                LD          A,(LAST_ITEM_HELD)
  2564  3267  a7                    AND         A
  2565  3268  c2a521                JP          NZ,NO_ACTION_TAKEN
  2566  326b  3aea37                LD          A,(ITEM_F0)                             ;= $60
  2567  326e  fe42                  CP          $42
  2568  3270  c2a521                JP          NZ,NO_ACTION_TAKEN
  2569  3273  3a793a                LD          A,(PLAYER_MAP_POS)
  2570  3276  32773a                LD          (PLAYER_PREV_MAP_LOC),A
  2571  3279  cd7833                CALL        BUILD_MAP
  2572  327c  cd200e                CALL        SUB_ram_cdbf
  2573  327f  cd8532                CALL        SUB_ram_f2c4
  2574  3282  c33911                JP          RESET_SHIFT_MODE
  2575                          SUB_ram_f2c4:
  2576  3285  110230                LD          DE,$3002                               ;WAS $33df
  2577  3288  21683a                LD          HL,DUNGEON_LEVEL
  2578  328b  3e01                  LD          A,0x1
  2579  328d  86                    ADD         A,(HL)
  2580  328e  27                    DAA
  2581  328f  da9e32                JP          C,LAB_ram_f2dc
  2582                          LAB_ram_f2d0:
  2583  3292  77                    LD          (HL),A
  2584  3293  0601                  LD          B,0x1
  2585  3295  cdc032                CALL        RECALC_AND_REDRAW_BCD
  2586  3298  cdda34                CALL        REDRAW_START
  2587  329b  c3e237                JP          REDRAW_VIEWPORT
  2588                          LAB_ram_f2dc:
  2589  329e  cd5110                CALL        DRAW_BKGD
  2590  32a1  215130                LD          HL,DAT_ram_3051                         ;= $20
  2591  32a4  114908                LD          DE,LEVEL_99_LOOP                        ;= "Looks like this dungeon",$01
  2592  32a7  06f0                  LD          B,$f0
  2593  32a9  cdfa32                CALL        GFX_DRAW
  2594  32ac  061e                  LD          B,$1e
  2595                          LAB_ram_f2ec:
  2596  32ae  d9                    EXX
  2597  32af  cd481d                CALL        SLEEP_ZERO                              ;byte SLEEP_ZERO(void)
  2598  32b2  d9                    EXX
  2599  32b3  10f9                  DJNZ        LAB_ram_f2ec
  2600  32b5  3e90                  LD          A,$90
  2601  32b7  21683a                LD          HL,DUNGEON_LEVEL
  2602  32ba  11df33                LD          DE,CHHRAM_LVL_IDX                       ;= $20
  2603  32bd  c39232                JP          LAB_ram_f2d0
  2604                          RECALC_AND_REDRAW_BCD:
  2605  32c0  d5                    PUSH        DE
  2606  32c1  11503a                LD          DE,$3a50
  2607  32c4  78                    LD          A,B
  2608  32c5  cb27                  SLA         A
  2609  32c7  3d                    DEC         A
  2610  32c8  08                    EX          AF,AF'
  2611                          LAB_ram_f306:
  2612  32c9  7e                    LD          A,(HL)
  2613  32ca  e60f                  AND         0xf                                     ;Wipe upper nybble
  2614  32cc  c630                  ADD         A,$30                                  ;Numeric char offset
  2615  32ce  12                    LD          (DE),A
  2616  32cf  7e                    LD          A,(HL)
  2617  32d0  e6f0                  AND         $f0                                    ;Wipe lower nybble
  2618  32d2  0f                    RRCA                                                ;Move upper
  2619  32d3  0f                    RRCA                                                ;nybble to
  2620  32d4  0f                    RRCA                                                ;lower
  2621  32d5  0f                    RRCA                                                ;nybble
  2622  32d6  c630                  ADD         A,$30                                  ;Numeric char offset
  2623  32d8  13                    INC         DE
  2624  32d9  12                    LD          (DE),A
  2625  32da  13                    INC         DE
  2626  32db  23                    INC         HL
  2627  32dc  10eb                  DJNZ        LAB_ram_f306
  2628  32de  1b                    DEC         DE
  2629  32df  e1                    POP         HL
  2630  32e0  08                    EX          AF,AF'
  2631  32e1  47                    LD          B,A
  2632                          LAB_ram_f31f:
  2633  32e2  1a                    LD          A,(DE)
  2634  32e3  fe30                  CP          $30                                    ;Numeric char offset
  2635  32e5  c2f232                JP          NZ,LAB_ram_f32d
  2636  32e8  3620                  LD          (HL),$20                               ;SPACE char for ZERO
  2637  32ea  23                    INC         HL                                      ;Move forward one cell
  2638  32eb  1b                    DEC         DE                                      ;Move backwards one byte
  2639                                                                                  ;(big endian)
  2640  32ec  10f4                  DJNZ        LAB_ram_f31f
  2641  32ee  1a                    LD          A,(DE)
  2642  32ef  c3f832                JP          LAB_ram_f333
  2643                          LAB_ram_f32d:
  2644  32f2  77                    LD          (HL),A
  2645  32f3  23                    INC         HL                                      ;Move forward one cell
  2646  32f4  1b                    DEC         DE                                      ;Move backwards one byte
  2647                                                                                  ;(big endian)
  2648  32f5  1a                    LD          A,(DE)
  2649  32f6  10fa                  DJNZ        LAB_ram_f32d
  2650                          LAB_ram_f333:
  2651  32f8  77                    LD          (HL),A
  2652  32f9  c9                    RET
  2653                          GFX_DRAW:
  2654  32fa  e5                    PUSH        HL
  2655  32fb  0e28                  LD          C,$28                                  ;$28 = +40, down one row
  2656                          LAB_ram_f338:
  2657  32fd  1a                    LD          A,(DE)                       ;= "\b",$FF
  2658                                                                                  ;= $FF
  2659  32fe  13                    INC         DE
  2660  32ff  3c                    INC         A
  2661  3300  c20533                JP          NZ,LAB_ram_f33f                         ;Check for $ff end of graphic char
  2662  3303  e1                    POP         HL
  2663  3304  c9                    RET
  2664                          LAB_ram_f33f:
  2665  3305  3d                    DEC         A                                       ;$00 = no char, move right one column...
  2666  3306  c20d33                JP          NZ,LAB_ram_f345
  2667  3309  23                    INC         HL
  2668  330a  c3fd32                JP          LAB_ram_f338
  2669                          LAB_ram_f345:
  2670  330d  fe01                  CP          0x1                                     ;$01 = down one row, back to index
  2671  330f  c21c33                JP          NZ,LAB_ram_f352
  2672  3312  78                    LD          A,B
  2673  3313  0600                  LD          B,0x0
  2674  3315  e1                    POP         HL
  2675  3316  09                    ADD         HL,BC
  2676  3317  e5                    PUSH        HL
  2677  3318  47                    LD          B,A
  2678  3319  c3fd32                JP          LAB_ram_f338
  2679                          LAB_ram_f352:
  2680  331c  fe02                  CP          0x2                                     ;$02 = back up one column
  2681  331e  c22533                JP          NZ,LAB_ram_f359
  2682  3321  2b                    DEC         HL
  2683  3322  c3fd32                JP          LAB_ram_f338
  2684                          LAB_ram_f359:
  2685  3325  fe03                  CP          0x3                                     ;$03 = down one row, same column
  2686  3327  c23533                JP          NZ,LAB_ram_f367
  2687  332a  78                    LD          A,B
  2688  332b  0600                  LD          B,0x0
  2689  332d  09                    ADD         HL,BC
  2690  332e  e3                    EX          (SP),HL
  2691  332f  09                    ADD         HL,BC
  2692  3330  e3                    EX          (SP),HL
  2693  3331  47                    LD          B,A
  2694  3332  c3fd32                JP          LAB_ram_f338
  2695                          LAB_ram_f367:
  2696  3335  fe04                  CP          0x4                                     ;$04 = up one row, same column
  2697  3337  c24733                JP          NZ,LAB_ram_f377
  2698  333a  78                    LD          A,B
  2699  333b  0600                  LD          B,0x0
  2700  333d  ed42                  SBC         HL,BC
  2701  333f  e3                    EX          (SP),HL
  2702  3340  ed42                  SBC         HL,BC
  2703  3342  e3                    EX          (SP),HL
  2704  3343  47                    LD          B,A
  2705  3344  c3fd32                JP          LAB_ram_f338
  2706                          LAB_ram_f377:
  2707  3347  fea0                  CP          $a0                                    ;$a0 = reverse FG & BG colors
  2708  3349  c25733                JP          NZ,LAB_ram_f385
  2709  334c  cb08                  RRC         B                                       ;Swap hi and lo nybbles (FG & BG colo...
  2710  334e  cb08                  RRC         B
  2711  3350  cb08                  RRC         B
  2712  3352  cb08                  RRC         B
  2713  3354  c3fd32                JP          LAB_ram_f338
  2714                          LAB_ram_f385:
  2715  3357  77                    LD          (HL),A              ;= $20
  2716  3358  24                    INC         H
  2717  3359  24                    INC         H
  2718  335a  24                    INC         H
  2719  335b  24                    INC         H
  2720  335c  3e0f                  LD          A,0xf
  2721  335e  b8                    CP          B
  2722  335f  7e                    LD          A,(HL)                    ;= $60
  2723  3360  da6c33                JP          C,LAB_ram_f398
  2724  3363  07                    RLCA
  2725  3364  07                    RLCA
  2726  3365  07                    RLCA
  2727  3366  07                    RLCA
  2728  3367  e6f0                  AND         $f0
  2729  3369  c36e33                JP          LAB_ram_f39a
  2730                          LAB_ram_f398:
  2731  336c  e60f                  AND         0xf
  2732                          LAB_ram_f39a:
  2733  336e  b0                    OR          B
  2734  336f  77                    LD          (HL),A                    ;= $60
  2735  3370  25                    DEC         H
  2736  3371  25                    DEC         H
  2737  3372  25                    DEC         H
  2738  3373  25                    DEC         H
  2739  3374  23                    INC         HL
  2740  3375  c3fd32                JP          LAB_ram_f338
  2741                          BUILD_MAP:
  2742  3378  210038                LD          HL,MAPSPACE_WALLS
  2743  337b  0600                  LD          B,0x0
  2744                          GENERATE_MAPWALLS_LOOP:
  2745  337d  cd8a3a                CALL        MAKE_RANDOM_BYTE
  2746  3380  5f                    LD          E,A
  2747  3381  cd8a3a                CALL        MAKE_RANDOM_BYTE
  2748  3384  a3                    AND         E
  2749  3385  e663                  AND         $63
  2750  3387  77                    LD          (HL),A
  2751  3388  2c                    INC         L
  2752  3389  10f2                  DJNZ        GENERATE_MAPWALLS_LOOP
  2753  338b  3a793a                LD          A,(PLAYER_MAP_POS)
  2754  338e  6f                    LD          L,A
  2755  338f  3642                  LD          (HL),$42
  2756                          GEN_MAP_NW_WALL_LOOP:
  2757  3391  cda93a                CALL        UPDATE_SCR_SAVER_TIMER
  2758  3394  3c                    INC         A
  2759  3395  ca9133                JP          Z,GEN_MAP_NW_WALL_LOOP
  2760  3398  3d                    DEC         A
  2761  3399  32a13a                LD          (ITEM_HOLDER),A
  2762  339c  6f                    LD          L,A
  2763  339d  3663                  LD          (HL),$63
  2764  339f  210039                LD          HL,MAP_LADDER_OFFSET
  2765  33a2  77                    LD          (HL),A
  2766  33a3  2c                    INC         L
  2767  33a4  3642                  LD          (HL),$42                   ;Put ladder object into map
  2768                                                                                  ;(always 1st item after offset)
  2769  33a6  2c                    INC         L
  2770  33a7  3a6c3a                LD          A,(INPUT_HOLDER)
  2771  33aa  47                    LD          B,A
  2772  33ab  3e02                  LD          A,0x2
  2773  33ad  c3b233                JP          LAB_ram_f3db
  2774                          LAB_ram_f3d9:
  2775  33b0  87                    ADD         A,A
  2776  33b1  27                    DAA
  2777                          LAB_ram_f3db:
  2778  33b2  10fc                  DJNZ        LAB_ram_f3d9
  2779  33b4  4f                    LD          C,A
  2780  33b5  3a683a                LD          A,(DUNGEON_LEVEL)
  2781  33b8  b9                    CP          C
  2782  33b9  dad833                JP          C,LAB_ram_f3fd
  2783                          GEN_ITEM_MAP:
  2784  33bc  cda93a                CALL        UPDATE_SCR_SAVER_TIMER
  2785  33bf  3c                    INC         A
  2786  33c0  cabc33                JP          Z,GEN_ITEM_MAP
  2787  33c3  3d                    DEC         A
  2788  33c4  4f                    LD          C,A
  2789  33c5  3aa13a                LD          A,(ITEM_HOLDER)
  2790  33c8  b9                    CP          C
  2791  33c9  cabc33                JP          Z,GEN_ITEM_MAP
  2792  33cc  3a793a                LD          A,(PLAYER_MAP_POS)
  2793  33cf  b9                    CP          C
  2794  33d0  cabc33                JP          Z,GEN_ITEM_MAP
  2795  33d3  71                    LD          (HL),C
  2796  33d4  23                    INC         HL
  2797  33d5  369f                  LD          (HL),$9f                ;Full ITEM_monster range $009f
  2798  33d7  23                    INC         HL
  2799                          LAB_ram_f3fd:
  2800  33d8  0650                  LD          B,$50                                  ;Max 50 items+monstersdb?
  2801                          GEN_RND_ITEM:
  2802  33da  cd8a3a                CALL        MAKE_RANDOM_BYTE
  2803  33dd  3c                    INC         A
  2804  33de  cada33                JP          Z,GEN_RND_ITEM
  2805  33e1  3d                    DEC         A
  2806  33e2  08                    EX          AF,AF'
  2807  33e3  3a683a                LD          A,(DUNGEON_LEVEL)
  2808  33e6  a7                    AND         A
  2809  33e7  c2f633                JP          NZ,LAB_ram_f417
  2810  33ea  08                    EX          AF,AF'
  2811  33eb  fe01                  CP          0x1
  2812  33ed  cada33                JP          Z,GEN_RND_ITEM
  2813  33f0  fe10                  CP          $10
  2814  33f2  cada33                JP          Z,GEN_RND_ITEM
  2815  33f5  08                    EX          AF,AF'
  2816                          LAB_ram_f417:
  2817  33f6  08                    EX          AF,AF'
  2818  33f7  5f                    LD          E,A
  2819  33f8  3a793a                LD          A,(PLAYER_MAP_POS)
  2820  33fb  bb                    CP          E
  2821  33fc  cada33                JP          Z,GEN_RND_ITEM
  2822  33ff  3aa13a                LD          A,(ITEM_HOLDER)
  2823  3402  bb                    CP          E
  2824  3403  cada33                JP          Z,GEN_RND_ITEM
  2825  3406  73                    LD          (HL),E
  2826  3407  2c                    INC         L
  2827  3408  cda93a                CALL        UPDATE_SCR_SAVER_TIMER
  2828  340b  e6c0                  AND         $c0
  2829  340d  07                    RLCA
  2830  340e  07                    RLCA
  2831  340f  3d                    DEC         A
  2832  3410  c21a34                JP          NZ,LAB_ram_f437
  2833  3413  0e05                  LD          C,0x5
  2834  3415  1600                  LD          D,0x0
  2835  3417  c34f34                JP          LAB_ram_f465
  2836                          LAB_ram_f437:
  2837  341a  3d                    DEC         A
  2838  341b  c22f34                JP          NZ,LAB_ram_f449
  2839  341e  0e05                  LD          C,0x5
  2840  3420  1606                  LD          D,0x6
  2841  3422  3a683a                LD          A,(DUNGEON_LEVEL)
  2842  3425  fe06                  CP          0x6
  2843  3427  da4f34                JP          C,LAB_ram_f465
  2844  342a  0e07                  LD          C,0x7
  2845  342c  c34f34                JP          LAB_ram_f465
  2846                          LAB_ram_f449:
  2847  342f  3d                    DEC         A
  2848  3430  c23a34                JP          NZ,LAB_ram_f452
  2849  3433  0e04                  LD          C,0x4
  2850  3435  1611                  LD          D,$11
  2851  3437  c34f34                JP          LAB_ram_f465
  2852                          LAB_ram_f452:
  2853  343a  161e                  LD          D,$1e
  2854  343c  0e05                  LD          C,0x5
  2855  343e  3a683a                LD          A,(DUNGEON_LEVEL)
  2856  3441  fe06                  CP          0x6
  2857  3443  da4f34                JP          C,LAB_ram_f465
  2858  3446  0e07                  LD          C,0x7
  2859  3448  fe16                  CP          $16
  2860  344a  da4f34                JP          C,LAB_ram_f465
  2861  344d  0e09                  LD          C,0x9
  2862                          LAB_ram_f465:
  2863  344f  cd8a3a                CALL        MAKE_RANDOM_BYTE
  2864  3452  e60f                  AND         0xf
  2865                          LAB_ram_f46a:
  2866  3454  91                    SUB         C
  2867  3455  d25434                JP          NC,LAB_ram_f46a
  2868  3458  81                    ADD         A,C
  2869  3459  82                    ADD         A,D
  2870  345a  4f                    LD          C,A
  2871  345b  3a683a                LD          A,(DUNGEON_LEVEL)
  2872  345e  3c                    INC         A
  2873  345f  3c                    INC         A
  2874  3460  cb3f                  SRL         A
  2875  3462  57                    LD          D,A
  2876  3463  cda93a                CALL        UPDATE_SCR_SAVER_TIMER
  2877  3466  5f                    LD          E,A
  2878  3467  cd8a3a                CALL        MAKE_RANDOM_BYTE
  2879  346a  a3                    AND         E
  2880  346b  e603                  AND         0x3
  2881                          LAB_ram_f482:
  2882  346d  92                    SUB         D
  2883  346e  d26d34                JP          NC,LAB_ram_f482
  2884  3471  82                    ADD         A,D
  2885  3472  1f                    RRA
  2886  3473  1f                    RRA
  2887  3474  cb11                  RL          C
  2888  3476  17                    RLA
  2889  3477  cb11                  RL          C
  2890  3479  71                    LD          (HL),C
  2891  347a  2c                    INC         L
  2892  347b  05                    DEC         B
  2893  347c  c2da33                JP          NZ,GEN_RND_ITEM
  2894  347f  36ff                  LD          (HL),$ff
  2895  3481  11003b                LD          DE,TEMP_MAP
  2896  3484  210039                LD          HL,MAP_LADDER_OFFSET
  2897  3487  0600                  LD          B,0x0
  2898                          LAB_ram_f49d:
  2899  3489  7e                    LD          A,(HL)
  2900  348a  feff                  CP          $ff
  2901  348c  cab334                JP          Z,SETUP_MAP_COPY
  2902  348f  04                    INC         B
  2903  3490  cdc734                CALL        SUB_ram_f4d4
  2904  3493  d9                    EXX
  2905  3494  caa734                JP          Z,LAB_ram_f4b7
  2906  3497  12                    LD          (DE),A
  2907  3498  13                    INC         DE
  2908  3499  23                    INC         HL
  2909  349a  7e                    LD          A,(HL)
  2910  349b  fefe                  CP          $fe
  2911  349d  caad34                JP          Z,LAB_ram_f4bc
  2912  34a0  04                    INC         B
  2913  34a1  12                    LD          (DE),A
  2914  34a2  13                    INC         DE
  2915  34a3  23                    INC         HL
  2916  34a4  c38934                JP          LAB_ram_f49d
  2917                          LAB_ram_f4b7:
  2918  34a7  23                    INC         HL
  2919  34a8  23                    INC         HL
  2920  34a9  05                    DEC         B
  2921  34aa  c38934                JP          LAB_ram_f49d
  2922                          LAB_ram_f4bc:
  2923  34ad  23                    INC         HL
  2924  34ae  1b                    DEC         DE
  2925  34af  05                    DEC         B
  2926  34b0  c38934                JP          LAB_ram_f49d
  2927                          SETUP_MAP_COPY:
  2928  34b3  11003b                LD          DE,TEMP_MAP                             ;DE = Temp Map
  2929  34b6  210039                LD          HL,MAP_LADDER_OFFSET                    ;HL = Real Map
  2930  34b9  04                    INC         B
  2931  34ba  05                    DEC         B
  2932  34bb  cac434                JP          Z,MAP_DONE
  2933                          COPY_TEMP_MAP_TO_REAL_MAP:
  2934  34be  1a                    LD          A,(DE)
  2935  34bf  77                    LD          (HL),A
  2936  34c0  23                    INC         HL
  2937  34c1  13                    INC         DE
  2938  34c2  10fa                  DJNZ        COPY_TEMP_MAP_TO_REAL_MAP               ;Loop while B is not zero
  2939                          MAP_DONE:
  2940  34c4  36ff                  LD          (HL),$ff
  2941  34c6  c9                    RET
  2942                          SUB_ram_f4d4:
  2943  34c7  c5                    PUSH        BC
  2944  34c8  d9                    EXX
  2945  34c9  c1                    POP         BC
  2946  34ca  05                    DEC         B
  2947  34cb  cad834                JP          Z,LAB_ram_f4e4
  2948  34ce  21003b                LD          HL,TEMP_MAP
  2949                          LAB_ram_f4dd:
  2950  34d1  be                    CP          (HL)
  2951  34d2  c8                    RET         Z
  2952  34d3  05                    DEC         B
  2953  34d4  23                    INC         HL
  2954  34d5  23                    INC         HL
  2955  34d6  10f9                  DJNZ        LAB_ram_f4dd
  2956                          LAB_ram_f4e4:
  2957  34d8  05                    DEC         B
  2958  34d9  c9                    RET
  2959                          REDRAW_START:
  2960  34da  217d37                LD          HL,CALC_WEST_REDRAW_2                            ; CALC_WEST_REDRAW (0xF79B) + 7... UNDO? was 0xF7A1
  2961  34dd  e5                    PUSH        HL
  2962  34de  21793a                LD          HL,PLAYER_MAP_POS
  2963  34e1  5e                    LD          E,(HL)
  2964  34e2  1638                  LD          D,$38                                  ;DE = Player map position in RAM
  2965  34e4  21e833                LD          HL,WALL_F0_STATE                        ;= $20
  2966  34e7  0e05                  LD          C,0x5
  2967  34e9  3a623a                LD          A,(DIR_FACING_SHORT)
  2968  34ec  3d                    DEC         A
  2969  34ed  caa235                JP          Z,FACING_NORTH
  2970  34f0  3d                    DEC         A
  2971  34f1  cae136                JP          Z,FACING_EAST
  2972  34f4  3d                    DEC         A
  2973  34f5  ca3136                JP          Z,FACING_SOUTH
  2974  34f8  1a                    LD          A,(DE)
  2975  34f9  e607                  AND         0x7                                     ;Keep low 3 bits, reset top 5 bits
  2976  34fb  77                    LD          (HL),A                   ;= $20
  2977  34fc  1d                    DEC         E
  2978  34fd  cd7737                CALL        CALC_WEST_REDRAW
  2979  3500  1d                    DEC         E
  2980  3501  cd7737                CALL        CALC_WEST_REDRAW
  2981  3504  7b                    LD          A,E
  2982  3505  c610                  ADD         A,$10
  2983  3507  5f                    LD          E,A
  2984  3508  cd8e35                CALL        REDRAW_VIEW
  2985  350b  2c                    INC         L
  2986  350c  77                    LD          (HL),A                   ;= $20
  2987  350d  1a                    LD          A,(DE)
  2988  350e  e607                  AND         0x7
  2989  3510  cd9535                CALL        REDRAW_NORTH
  2990  3513  7b                    LD          A,E
  2991  3514  d610                  SUB         $10
  2992  3516  5f                    LD          E,A
  2993  3517  cd8e35                CALL        REDRAW_VIEW
  2994  351a  77                    LD          (HL),A                   ;= $20
  2995  351b  7b                    LD          A,E
  2996  351c  d610                  SUB         $10
  2997  351e  5f                    LD          E,A
  2998  351f  1a                    LD          A,(DE)
  2999  3520  e607                  AND         0x7
  3000  3522  cd9535                CALL        REDRAW_NORTH
  3001  3525  7b                    LD          A,E
  3002  3526  c621                  ADD         A,$21
  3003  3528  5f                    LD          E,A
  3004  3529  cd8e35                CALL        REDRAW_VIEW
  3005  352c  77                    LD          (HL),A                   ;= $20
  3006  352d  1a                    LD          A,(DE)
  3007  352e  e607                  AND         0x7
  3008  3530  cd9535                CALL        REDRAW_NORTH
  3009  3533  7b                    LD          A,E
  3010  3534  d610                  SUB         $10
  3011  3536  5f                    LD          E,A
  3012  3537  cd8e35                CALL        REDRAW_VIEW
  3013  353a  2c                    INC         L
  3014  353b  77                    LD          (HL),A                   ;= $20
  3015  353c  7b                    LD          A,E
  3016  353d  d610                  SUB         $10
  3017  353f  5f                    LD          E,A
  3018  3540  1a                    LD          A,(DE)
  3019  3541  e607                  AND         0x7
  3020  3543  cd9535                CALL        REDRAW_NORTH
  3021  3546  7b                    LD          A,E
  3022  3547  c621                  ADD         A,$21
  3023  3549  5f                    LD          E,A
  3024  354a  cd8e35                CALL        REDRAW_VIEW
  3025  354d  2c                    INC         L
  3026  354e  77                    LD          (HL),A                   ;= $20
  3027  354f  cd7737                CALL        CALC_WEST_REDRAW
  3028  3552  7b                    LD          A,E
  3029  3553  c60e                  ADD         A,0xe
  3030  3555  5f                    LD          E,A
  3031  3556  cd8e35                CALL        REDRAW_VIEW
  3032  3559  2c                    INC         L
  3033  355a  2c                    INC         L
  3034  355b  77                    LD          (HL),A                    ;= $20
  3035  355c  7b                    LD          A,E
  3036  355d  d61e                  SUB         $1e
  3037  355f  5f                    LD          E,A
  3038  3560  cd8e35                CALL        REDRAW_VIEW
  3039  3563  2c                    INC         L
  3040  3564  77                    LD          (HL),A                    ;= $20
  3041  3565  7b                    LD          A,E
  3042  3566  d610                  SUB         $10
  3043  3568  5f                    LD          E,A
  3044  3569  cd7737                CALL        CALC_WEST_REDRAW
  3045  356c  1d                    DEC         E
  3046  356d  1d                    DEC         E
  3047  356e  cd8e35                CALL        REDRAW_VIEW
  3048  3571  2c                    INC         L
  3049  3572  2c                    INC         L
  3050  3573  77                    LD          (HL),A                    ;= $20
  3051  3574  7b                    LD          A,E
  3052  3575  c613                  ADD         A,$13
  3053  3577  5f                    LD          E,A
  3054  3578  cd7737                CALL        CALC_WEST_REDRAW
  3055  357b  16ff                  LD          D,$ff
  3056  357d  1ef0                  LD          E,$f0
  3057  357f  ed53603a              LD          (DIR_FACING_FW),DE                      ;DE = 0xFFF0 (WEST)
  3058  3583  0610                  LD          B,$10                                  ;RED on BLK
  3059  3585  21d831                LD          HL,CHRRAM_POINTER_IDX                   ;WAS $31d6
  3060  3588  11d408                LD          DE,WEST_TXT                             ;= "\a",$FF
  3061  358b  c3fa32                JP          GFX_DRAW
  3062                          REDRAW_VIEW:
  3063  358e  1a                    LD          A,(DE)
  3064  358f  e6e0                  AND         $e0
  3065  3591  07                    RLCA
  3066  3592  07                    RLCA
  3067  3593  07                    RLCA
  3068  3594  c9                    RET
  3069                          REDRAW_NORTH:
  3070  3595  2c                    INC         L
  3071  3596  77                    LD          (HL),A
  3072  3597  47                    LD          B,A
  3073  3598  7d                    LD          A,L
  3074  3599  81                    ADD         A,C
  3075  359a  6f                    LD          L,A
  3076  359b  70                    LD          (HL),B
  3077  359c  7d                    LD          A,L
  3078  359d  91                    SUB         C
  3079  359e  6f                    LD          L,A
  3080  359f  2c                    INC         L
  3081  35a0  0c                    INC         C
  3082  35a1  c9                    RET
  3083                          FACING_NORTH:
  3084  35a2  cd8e35                CALL        REDRAW_VIEW
  3085  35a5  77                    LD          (HL),A
  3086  35a6  7b                    LD          A,E
  3087  35a7  d610                  SUB         $10
  3088  35a9  5f                    LD          E,A
  3089  35aa  cd8e35                CALL        REDRAW_VIEW
  3090  35ad  2c                    INC         L
  3091  35ae  77                    LD          (HL),A
  3092  35af  7b                    LD          A,E
  3093  35b0  d610                  SUB         $10
  3094  35b2  5f                    LD          E,A
  3095  35b3  cd8e35                CALL        REDRAW_VIEW
  3096  35b6  2c                    INC         L
  3097  35b7  77                    LD          (HL),A
  3098  35b8  cd7737                CALL        CALC_WEST_REDRAW
  3099  35bb  1d                    DEC         E
  3100  35bc  cd8e35                CALL        REDRAW_VIEW
  3101  35bf  cd9535                CALL        REDRAW_NORTH
  3102  35c2  1c                    INC         E
  3103  35c3  1c                    INC         E
  3104  35c4  1a                    LD          A,(DE)
  3105  35c5  e607                  AND         0x7
  3106  35c7  77                    LD          (HL),A
  3107  35c8  cd8e35                CALL        REDRAW_VIEW
  3108  35cb  cd9535                CALL        REDRAW_NORTH
  3109  35ce  7b                    LD          A,E
  3110  35cf  c60f                  ADD         A,0xf
  3111  35d1  5f                    LD          E,A
  3112  35d2  1a                    LD          A,(DE)
  3113  35d3  e607                  AND         0x7
  3114  35d5  77                    LD          (HL),A
  3115  35d6  1d                    DEC         E
  3116  35d7  cd8e35                CALL        REDRAW_VIEW
  3117  35da  cd9535                CALL        REDRAW_NORTH
  3118  35dd  1c                    INC         E
  3119  35de  1c                    INC         E
  3120  35df  cd7737                CALL        CALC_WEST_REDRAW
  3121  35e2  cd8e35                CALL        REDRAW_VIEW
  3122  35e5  cd9535                CALL        REDRAW_NORTH
  3123  35e8  7b                    LD          A,E
  3124  35e9  c60f                  ADD         A,0xf
  3125  35eb  5f                    LD          E,A
  3126  35ec  cd7737                CALL        CALC_WEST_REDRAW
  3127  35ef  1d                    DEC         E
  3128  35f0  cd8e35                CALL        REDRAW_VIEW
  3129  35f3  2c                    INC         L
  3130  35f4  77                    LD          (HL),A
  3131  35f5  7b                    LD          A,E
  3132  35f6  d620                  SUB         $20
  3133  35f8  5f                    LD          E,A
  3134  35f9  1a                    LD          A,(DE)
  3135  35fa  e607                  AND         0x7
  3136  35fc  2c                    INC         L
  3137  35fd  2c                    INC         L
  3138  35fe  77                    LD          (HL),A
  3139  35ff  7b                    LD          A,E
  3140  3600  c622                  ADD         A,$22
  3141  3602  5f                    LD          E,A
  3142  3603  cd7737                CALL        CALC_WEST_REDRAW
  3143  3606  cd8e35                CALL        REDRAW_VIEW
  3144  3609  2c                    INC         L
  3145  360a  77                    LD          (HL),A
  3146  360b  7b                    LD          A,E
  3147  360c  d61f                  SUB         $1f
  3148  360e  5f                    LD          E,A
  3149  360f  1a                    LD          A,(DE)
  3150  3610  e607                  AND         0x7
  3151  3612  2c                    INC         L
  3152  3613  2c                    INC         L
  3153  3614  77                    LD          (HL),A
  3154  3615  7b                    LD          A,E
  3155  3616  c62e                  ADD         A,$2e
  3156  3618  5f                    LD          E,A
  3157  3619  cd8e35                CALL        REDRAW_VIEW
  3158  361c  2c                    INC         L
  3159  361d  77                    LD          (HL),A
  3160  361e  16f0                  LD          D,$f0
  3161  3620  1e01                  LD          E,0x1
  3162  3622  ed53603a              LD          (DIR_FACING_FW),DE
  3163  3626  0610                  LD          B,$10                                  ;RED on BLK
  3164  3628  21d831                LD          HL,CHRRAM_POINTER_IDX                   ;WAS $31d6
  3165  362b  11d608                LD          DE,NORTH_TXT                            ;= "\b",$FF
  3166  362e  c3fa32                JP          GFX_DRAW
  3167                          FACING_SOUTH:
  3168  3631  7b                    LD          A,E
  3169  3632  c610                  ADD         A,$10
  3170  3634  5f                    LD          E,A
  3171  3635  cd8e35                CALL        REDRAW_VIEW
  3172  3638  77                    LD          (HL),A                   ;= $20
  3173  3639  7b                    LD          A,E
  3174  363a  c610                  ADD         A,$10
  3175  363c  5f                    LD          E,A
  3176  363d  cd8e35                CALL        REDRAW_VIEW
  3177  3640  2c                    INC         L
  3178  3641  77                    LD          (HL),A                   ;= $20
  3179  3642  7b                    LD          A,E
  3180  3643  c610                  ADD         A,$10
  3181  3645  5f                    LD          E,A
  3182  3646  cd8e35                CALL        REDRAW_VIEW
  3183  3649  2c                    INC         L
  3184  364a  77                    LD          (HL),A                   ;= $20
  3185  364b  7b                    LD          A,E
  3186  364c  d60f                  SUB         0xf
  3187  364e  5f                    LD          E,A
  3188  364f  cd7737                CALL        CALC_WEST_REDRAW
  3189  3652  7b                    LD          A,E
  3190  3653  c610                  ADD         A,$10
  3191  3655  5f                    LD          E,A
  3192  3656  cd8e35                CALL        REDRAW_VIEW
  3193  3659  cd9535                CALL        REDRAW_NORTH
  3194  365c  7b                    LD          A,E
  3195  365d  d611                  SUB         $11
  3196  365f  5f                    LD          E,A
  3197  3660  1a                    LD          A,(DE)
  3198  3661  e607                  AND         0x7
  3199  3663  77                    LD          (HL),A                   ;= $20
  3200  3664  7b                    LD          A,E
  3201  3665  c60f                  ADD         A,0xf
  3202  3667  5f                    LD          E,A
  3203  3668  cd8e35                CALL        REDRAW_VIEW
  3204  366b  cd9535                CALL        REDRAW_NORTH
  3205  366e  7b                    LD          A,E
  3206  366f  d61e                  SUB         $1e
  3207  3671  5f                    LD          E,A
  3208  3672  1a                    LD          A,(DE)
  3209  3673  e607                  AND         0x7
  3210  3675  77                    LD          (HL),A                   ;= $20
  3211  3676  7b                    LD          A,E
  3212  3677  c610                  ADD         A,$10
  3213  3679  5f                    LD          E,A
  3214  367a  cd8e35                CALL        REDRAW_VIEW
  3215  367d  cd9535                CALL        REDRAW_NORTH
  3216  3680  7b                    LD          A,E
  3217  3681  d611                  SUB         $11
  3218  3683  5f                    LD          E,A
  3219  3684  cd7737                CALL        CALC_WEST_REDRAW
  3220  3687  7b                    LD          A,E
  3221  3688  c60f                  ADD         A,0xf
  3222  368a  5f                    LD          E,A
  3223  368b  cd8e35                CALL        REDRAW_VIEW
  3224  368e  cd9535                CALL        REDRAW_NORTH
  3225  3691  7b                    LD          A,E
  3226  3692  d61e                  SUB         $1e
  3227  3694  5f                    LD          E,A
  3228  3695  cd7737                CALL        CALC_WEST_REDRAW
  3229  3698  7b                    LD          A,E
  3230  3699  c610                  ADD         A,$10
  3231  369b  5f                    LD          E,A
  3232  369c  cd8e35                CALL        REDRAW_VIEW
  3233  369f  2c                    INC         L
  3234  36a0  77                    LD          (HL),A                   ;= $20
  3235  36a1  7b                    LD          A,E
  3236  36a2  c611                  ADD         A,$11
  3237  36a4  5f                    LD          E,A
  3238  36a5  1a                    LD          A,(DE)
  3239  36a6  e607                  AND         0x7
  3240  36a8  2c                    INC         L
  3241  36a9  2c                    INC         L
  3242  36aa  77                    LD          (HL),A                    ;= $20
  3243  36ab  7b                    LD          A,E
  3244  36ac  d622                  SUB         $22
  3245  36ae  5f                    LD          E,A
  3246  36af  cd7737                CALL        CALC_WEST_REDRAW
  3247  36b2  7b                    LD          A,E
  3248  36b3  c60f                  ADD         A,0xf
  3249  36b5  5f                    LD          E,A
  3250  36b6  cd8e35                CALL        REDRAW_VIEW
  3251  36b9  2c                    INC         L
  3252  36ba  77                    LD          (HL),A                    ;= $20
  3253  36bb  7b                    LD          A,E
  3254  36bc  c610                  ADD         A,$10
  3255  36be  5f                    LD          E,A
  3256  36bf  1a                    LD          A,(DE)
  3257  36c0  e607                  AND         0x7
  3258  36c2  2c                    INC         L
  3259  36c3  2c                    INC         L
  3260  36c4  77                    LD          (HL),A                    ;= $20
  3261  36c5  7b                    LD          A,E
  3262  36c6  d61f                  SUB         $1f
  3263  36c8  5f                    LD          E,A
  3264  36c9  cd8e35                CALL        REDRAW_VIEW
  3265  36cc  2c                    INC         L
  3266  36cd  77                    LD          (HL),A                    ;= $20
  3267  36ce  1610                  LD          D,$10
  3268  36d0  1eff                  LD          E,$ff
  3269  36d2  ed53603a              LD          (DIR_FACING_FW),DE
  3270  36d6  0610                  LD          B,$10                                  ;RED on BLK
  3271  36d8  21d831                LD          HL,CHRRAM_POINTER_IDX                   ;WAS $31d6
  3272  36db  11d808                LD          DE,SOUTH_TXT                            ;= "\t",$FF
  3273  36de  c3fa32                JP          GFX_DRAW
  3274                          FACING_EAST:
  3275  36e1  1c                    INC         E
  3276  36e2  1a                    LD          A,(DE)
  3277  36e3  e607                  AND         0x7
  3278  36e5  77                    LD          (HL),A                   ;= $20
  3279  36e6  1c                    INC         E
  3280  36e7  cd7737                CALL        CALC_WEST_REDRAW
  3281  36ea  1c                    INC         E
  3282  36eb  cd7737                CALL        CALC_WEST_REDRAW
  3283  36ee  1d                    DEC         E
  3284  36ef  cd8e35                CALL        REDRAW_VIEW
  3285  36f2  2c                    INC         L
  3286  36f3  77                    LD          (HL),A                   ;= $20
  3287  36f4  7b                    LD          A,E
  3288  36f5  d60f                  SUB         0xf
  3289  36f7  5f                    LD          E,A
  3290  36f8  1a                    LD          A,(DE)
  3291  36f9  e607                  AND         0x7
  3292  36fb  cd9535                CALL        REDRAW_NORTH
  3293  36fe  7b                    LD          A,E
  3294  36ff  c61f                  ADD         A,$1f
  3295  3701  5f                    LD          E,A
  3296  3702  cd8e35                CALL        REDRAW_VIEW
  3297  3705  77                    LD          (HL),A                   ;= $20
  3298  3706  1c                    INC         E
  3299  3707  1a                    LD          A,(DE)
  3300  3708  e607                  AND         0x7
  3301  370a  cd9535                CALL        REDRAW_NORTH
  3302  370d  7b                    LD          A,E
  3303  370e  d612                  SUB         $12
  3304  3710  5f                    LD          E,A
  3305  3711  cd8e35                CALL        REDRAW_VIEW
  3306  3714  77                    LD          (HL),A                   ;= $20
  3307  3715  7b                    LD          A,E
  3308  3716  d60f                  SUB         0xf
  3309  3718  5f                    LD          E,A
  3310  3719  1a                    LD          A,(DE)
  3311  371a  e607                  AND         0x7
  3312  371c  cd9535                CALL        REDRAW_NORTH
  3313  371f  7b                    LD          A,E
  3314  3720  c61f                  ADD         A,$1f
  3315  3722  5f                    LD          E,A
  3316  3723  cd8e35                CALL        REDRAW_VIEW
  3317  3726  2c                    INC         L
  3318  3727  77                    LD          (HL),A                   ;= $20
  3319  3728  1c                    INC         E
  3320  3729  1a                    LD          A,(DE)
  3321  372a  e607                  AND         0x7
  3322  372c  cd9535                CALL        REDRAW_NORTH
  3323  372f  7b                    LD          A,E
  3324  3730  d612                  SUB         $12
  3325  3732  5f                    LD          E,A
  3326  3733  cd8e35                CALL        REDRAW_VIEW
  3327  3736  2c                    INC         L
  3328  3737  77                    LD          (HL),A                   ;= $20
  3329  3738  7b                    LD          A,E
  3330  3739  d60f                  SUB         0xf
  3331  373b  5f                    LD          E,A
  3332  373c  cd7737                CALL        CALC_WEST_REDRAW
  3333  373f  1c                    INC         E
  3334  3740  cd8e35                CALL        REDRAW_VIEW
  3335  3743  2c                    INC         L
  3336  3744  2c                    INC         L
  3337  3745  77                    LD          (HL),A                    ;= $20
  3338  3746  7b                    LD          A,E
  3339  3747  c61e                  ADD         A,$1e
  3340  3749  5f                    LD          E,A
  3341  374a  cd8e35                CALL        REDRAW_VIEW
  3342  374d  2c                    INC         L
  3343  374e  77                    LD          (HL),A                    ;= $20
  3344  374f  1c                    INC         E
  3345  3750  cd7737                CALL        CALC_WEST_REDRAW
  3346  3753  7b                    LD          A,E
  3347  3754  c611                  ADD         A,$11
  3348  3756  5f                    LD          E,A
  3349  3757  cd8e35                CALL        REDRAW_VIEW
  3350  375a  2c                    INC         L
  3351  375b  2c                    INC         L
  3352  375c  77                    LD          (HL),A                    ;= $20
  3353  375d  7b                    LD          A,E
  3354  375e  d622                  SUB         $22
  3355  3760  5f                    LD          E,A
  3356  3761  cd7737                CALL        CALC_WEST_REDRAW
  3357  3764  1601                  LD          D,0x1
  3358  3766  1e10                  LD          E,$10
  3359  3768  ed53603a              LD          (DIR_FACING_FW),DE
  3360  376c  0610                  LD          B,$10                                  ;RED on BLK
  3361  376e  21d831                LD          HL,CHRRAM_POINTER_IDX                   ;WAS $31d6
  3362  3771  11da08                LD          DE,EAST_TXT                             ;= $06,$FF
  3363  3774  c3fa32                JP          GFX_DRAW
  3364                          CALC_WEST_REDRAW:
  3365  3777  1a                    LD          A,(DE)
  3366  3778  e607                  AND         0x7
  3367  377a  2c                    INC         L
  3368  377b  77                    LD          (HL),A
  3369  377c  c9                    RET
  3370                          CALC_WEST_REDRAW_2:
  3371  377d  dd21e837              LD          IX,ITEM_F2                              ;= $60
  3372  3781  ed5b603a              LD          DE,(DIR_FACING_FW)
  3373  3785  3a793a                LD          A,(PLAYER_MAP_POS)
  3374  3788  82                    ADD         A,D
  3375  3789  82                    ADD         A,D
  3376  378a  cdcf37                CALL        ITEM_MAP_CHECK
  3377  378d  dd7700                LD          (IX+0),A                     ;= $60
  3378  3790  7c                    LD          A,H
  3379  3791  92                    SUB         D
  3380  3792  cdcf37                CALL        ITEM_MAP_CHECK
  3381  3795  dd7701                LD          (IX+1),A                     ;= $60
  3382  3798  7c                    LD          A,H
  3383  3799  92                    SUB         D
  3384  379a  cdcf37                CALL        ITEM_MAP_CHECK
  3385  379d  dd7702                LD          (IX+2),A                     ;= $60
  3386  37a0  7c                    LD          A,H
  3387  37a1  82                    ADD         A,D
  3388  37a2  93                    SUB         E
  3389  37a3  cdcf37                CALL        ITEM_MAP_CHECK
  3390  37a6  dd7703                LD          (IX+3),A                    ;= $60
  3391  37a9  7c                    LD          A,H
  3392  37aa  83                    ADD         A,E
  3393  37ab  83                    ADD         A,E
  3394  37ac  cdcf37                CALL        ITEM_MAP_CHECK
  3395  37af  dd7704                LD          (IX+4),A                    ;= $60
  3396  37b2  7c                    LD          A,H
  3397  37b3  92                    SUB         D
  3398  37b4  cdcf37                CALL        ITEM_MAP_CHECK
  3399  37b7  dd7705                LD          (IX+5),A                     ;= $60
  3400  37ba  7c                    LD          A,H
  3401  37bb  93                    SUB         E
  3402  37bc  93                    SUB         E
  3403  37bd  cdcf37                CALL        ITEM_MAP_CHECK
  3404  37c0  dd7706                LD          (IX+6),A                     ;= $60
  3405  37c3  7c                    LD          A,H
  3406  37c4  92                    SUB         D
  3407  37c5  83                    ADD         A,E
  3408  37c6  cdcf37                CALL        ITEM_MAP_CHECK
  3409  37c9  dd7707                LD          (IX+7),A                     ;= $60
  3410                          LAB_ram_f7f0:
  3411  37cc  3efe                  LD          A,$fe
  3412  37ce  c9                    RET
  3413                          ITEM_MAP_CHECK:
  3414  37cf  67                    LD          H,A
  3415  37d0  010039                LD          BC,MAP_LADDER_OFFSET
  3416                          LAB_ram_f7f7:
  3417  37d3  0a                    LD          A,(BC)
  3418  37d4  03                    INC         BC
  3419  37d5  03                    INC         BC
  3420  37d6  3c                    INC         A
  3421  37d7  cacc37                JP          Z,LAB_ram_f7f0
  3422  37da  3d                    DEC         A
  3423  37db  bc                    CP          H
  3424  37dc  c2d337                JP          NZ,LAB_ram_f7f7
  3425  37df  0d                    DEC         C
  3426  37e0  0a                    LD          A,(BC)
  3427  37e1  c9                    RET
  3428                          REDRAW_VIEWPORT:
  3429  37e2  cd5110                CALL        DRAW_BKGD
  3430  37e5  01e837                LD          BC,ITEM_F2                              ;BC = ITEM_F2
  3431  37e8  11e833                LD          DE,WALL_F0_STATE                        ;DE = wallAheadTemp
  3432  37eb  1a                    LD          A,(DE)                   ;A = (wallAheadTemp)
  3433  37ec  0f                    RRCA
  3434  37ed  d20338                JP          NC,F0_NO_HD                             ;Jump if no hidden door
  3435  37f0  08                    EX          AF,AF'
  3436  37f1  cd4e09                CALL        DRAW_F0_WALL
  3437  37f4  08                    EX          AF,AF'
  3438  37f5  0f                    RRCA
  3439  37f6  d26d39                JP          NC,F0_HD_NO_WALL                        ;Jump if no wall
  3440  37f9  0f                    RRCA
  3441  37fa  d26d39                JP          NC,F0_HD_NO_WALL                        ;Jump if door closed
  3442                          F0_NO_HD_WALL_OPEN:
  3443  37fd  cd6709                CALL        DRAW_WALL_F0_AND_OPEN_DOOR
  3444  3800  c36439                JP          LAB_ram_f986
  3445                          F0_NO_HD:
  3446  3803  0f                    RRCA
  3447  3804  d21138                JP          NC,F0_NO_HD_NO_WALL                     ;Jump if no wall
  3448  3807  0f                    RRCA
  3449  3808  dafd37                JP          C,F0_NO_HD_WALL_OPEN                    ;Jump if door open
  3450  380b  cd5909                CALL        DRAW_F0_WALL_AND_CLOSED_DOOR
  3451  380e  c36d39                JP          F0_HD_NO_WALL
  3452                          F0_NO_HD_NO_WALL:
  3453  3811  13                    INC         DE
  3454  3812  1a                    LD          A,(DE)                   ;= $20
  3455  3813  0f                    RRCA
  3456  3814  d22a38                JP          NC,F1_NO_HD                             ;Jump if no hidden door
  3457  3817  08                    EX          AF,AF'
  3458  3818  cd6f09                CALL        DRAW_WALL_F1
  3459  381b  08                    EX          AF,AF'
  3460  381c  0f                    RRCA
  3461  381d  d29e38                JP          NC,F1_HD_NO_WALL                        ;Jump if no wall
  3462  3820  0f                    RRCA
  3463  3821  d29e38                JP          NC,F1_HD_NO_WALL                        ;Jump if door closed
  3464                          F1_NO_HD_WALL_OPEN:
  3465  3824  cd9209                CALL        DRAW_WALL_F1_AND_OPEN_DOOR
  3466  3827  c39538                JP          LAB_ram_f8b7
  3467                          F1_NO_HD:
  3468  382a  0f                    RRCA
  3469  382b  d23838                JP          NC,LAB_ram_f85a
  3470  382e  0f                    RRCA
  3471  382f  da2438                JP          C,F1_NO_HD_WALL_OPEN
  3472  3832  cd8409                CALL        DRAW_WALL_F1_AND_CLOSED_DOOR
  3473  3835  c39e38                JP          F1_HD_NO_WALL
  3474                          LAB_ram_f85a:
  3475  3838  13                    INC         DE
  3476  3839  1a                    LD          A,(DE)                   ;= $20
  3477  383a  0f                    RRCA
  3478  383b  d24438                JP          NC,CHECK_WALL_F2
  3479                          F2_WALL:
  3480  383e  cd9a09                CALL        DRAW_WALL_F2
  3481  3841  c34b38                JP          LAB_ram_f86d
  3482                          CHECK_WALL_F2:
  3483  3844  0f                    RRCA
  3484  3845  da3e38                JP          C,F2_WALL
  3485  3848  cda509                CALL        DRAW_DOOR_F2_OPEN
  3486                          LAB_ram_f86d:
  3487  384b  11eb33                LD          DE,WALL_F3_STATE                        ;= $20
  3488  384e  1a                    LD          A,(DE)                   ;= $20
  3489  384f  0f                    RRCA
  3490  3850  d25938                JP          NC,LAB_ram_f87b
  3491                          LAB_ram_f875:
  3492  3853  cd4a0b                CALL        DRAW_WALL_FL2_EMPTY
  3493  3856  c37038                JP          LAB_ram_f892
  3494                          LAB_ram_f87b:
  3495  3859  0f                    RRCA
  3496  385a  da5338                JP          C,LAB_ram_f875
  3497  385d  13                    INC         DE
  3498  385e  1a                    LD          A,(DE)                    ;= $20
  3499  385f  0f                    RRCA
  3500  3860  d26938                JP          NC,LAB_ram_f88b
  3501                          LAB_ram_f885:
  3502  3863  cd950b                CALL        DRAW_WALL_L2_C
  3503  3866  c37038                JP          LAB_ram_f892
  3504                          LAB_ram_f88b:
  3505  3869  0f                    RRCA
  3506  386a  da6338                JP          C,LAB_ram_f885
  3507  386d  cda00b                CALL        DRAW_WALL_L2_C_EMPTY
  3508                          LAB_ram_f892:
  3509  3870  11ed33                LD          DE,DAT_ram_33ed                         ;= $20
  3510  3873  1a                    LD          A,(DE)                    ;= $20
  3511  3874  0f                    RRCA
  3512  3875  d27e38                JP          NC,LAB_ram_f8a0
  3513                          LAB_ram_f89a:
  3514  3878  cd430d                CALL        DRAW_WALL_FR2
  3515  387b  c39538                JP          LAB_ram_f8b7
  3516                          LAB_ram_f8a0:
  3517  387e  0f                    RRCA
  3518  387f  da7838                JP          C,LAB_ram_f89a
  3519  3882  13                    INC         DE
  3520  3883  1a                    LD          A,(DE)                    ;= $20
  3521  3884  0f                    RRCA
  3522  3885  d28e38                JP          NC,LAB_ram_f8b0
  3523                          LAB_ram_f8aa:
  3524  3888  cd810d                CALL        SUB_ram_cd21
  3525  388b  c39538                JP          LAB_ram_f8b7
  3526                          LAB_ram_f8b0:
  3527  388e  0f                    RRCA
  3528  388f  da8838                JP          C,LAB_ram_f8aa
  3529  3892  cd8c0d                CALL        SUB_ram_cd2c
  3530                          LAB_ram_f8b7:
  3531  3895  3ae837                LD          A,(ITEM_F2)                             ;= $60
  3532  3898  018a04                LD          BC,$48a
  3533  389b  cd362c                CALL        CHK_ITEM
  3534                          F1_HD_NO_WALL:
  3535  389e  11ef33                LD          DE,DAT_ram_33ef                         ;= $20
  3536  38a1  1a                    LD          A,(DE)                    ;= $20
  3537  38a2  0f                    RRCA
  3538  38a3  d2b938                JP          NC,LAB_ram_f8db
  3539  38a6  08                    EX          AF,AF'
  3540  38a7  cd9a0a                CALL        DRAW_L1_WALL
  3541  38aa  08                    EX          AF,AF'
  3542  38ab  0f                    RRCA
  3543  38ac  d20139                JP          NC,LAB_ram_f923
  3544  38af  0f                    RRCA
  3545  38b0  d20139                JP          NC,LAB_ram_f923
  3546                          LAB_ram_f8d5:
  3547  38b3  cddd0a                CALL        DRAW_FL1_DOOR
  3548  38b6  c30139                JP          LAB_ram_f923
  3549                          LAB_ram_f8db:
  3550  38b9  0f                    RRCA
  3551  38ba  d2c738                JP          NC,LAB_ram_f8e9
  3552  38bd  0f                    RRCA
  3553  38be  dab338                JP          C,LAB_ram_f8d5
  3554  38c1  cdeb0a                CALL        DRAW_L1
  3555  38c4  c30139                JP          LAB_ram_f923
  3556                          LAB_ram_f8e9:
  3557  38c7  1c                    INC         E
  3558  38c8  1a                    LD          A,(DE)                    ;= $20
  3559  38c9  0f                    RRCA
  3560  38ca  d2e038                JP          NC,LAB_ram_f902
  3561  38cd  08                    EX          AF,AF'
  3562  38ce  cd0b0b                CALL        SUB_ram_cab0
  3563  38d1  08                    EX          AF,AF'
  3564  38d2  0f                    RRCA
  3565  38d3  d20139                JP          NC,LAB_ram_f923
  3566  38d6  0f                    RRCA
  3567  38d7  d20139                JP          NC,LAB_ram_f923
  3568                          LAB_ram_f8fc:
  3569  38da  cd200b                CALL        SUB_ram_cac5
  3570  38dd  c30139                JP          LAB_ram_f923
  3571                          LAB_ram_f902:
  3572  38e0  0f                    RRCA
  3573  38e1  d2ee38                JP          NC,LAB_ram_f910
  3574  38e4  0f                    RRCA
  3575  38e5  dada38                JP          C,LAB_ram_f8fc
  3576  38e8  cd270b                CALL        DRAW_L1_DOOR_CLOSED
  3577  38eb  c30139                JP          LAB_ram_f923
  3578                          LAB_ram_f910:
  3579  38ee  1c                    INC         E
  3580  38ef  1a                    LD          A,(DE)                    ;= $20
  3581  38f0  0f                    RRCA
  3582  38f1  d2fa38                JP          NC,LAB_ram_f91c
  3583                          LAB_ram_f916:
  3584  38f4  cd5b12                CALL        DRAW_WALL_FL2_NEW
  3585  38f7  c30139                JP          LAB_ram_f923
  3586                          LAB_ram_f91c:
  3587  38fa  0f                    RRCA
  3588  38fb  daf438                JP          C,LAB_ram_f916
  3589  38fe  cd4a0b                CALL        DRAW_WALL_FL2_EMPTY
  3590                          LAB_ram_f923:
  3591  3901  11f233                LD          DE,DAT_ram_33f2                         ;= $20
  3592  3904  1a                    LD          A,(DE)                    ;= $20
  3593  3905  0f                    RRCA
  3594  3906  d21c39                JP          NC,LAB_ram_f93e
  3595  3909  08                    EX          AF,AF'
  3596  390a  cd890c                CALL        DRAW_WALL_FR1
  3597  390d  08                    EX          AF,AF'
  3598  390e  0f                    RRCA
  3599  390f  d26439                JP          NC,LAB_ram_f986
  3600  3912  0f                    RRCA
  3601  3913  d26439                JP          NC,LAB_ram_f986
  3602                          LAB_ram_f938:
  3603  3916  cdcb0c                CALL        SUB_ram_cc6d
  3604  3919  c36439                JP          LAB_ram_f986
  3605                          LAB_ram_f93e:
  3606  391c  0f                    RRCA
  3607  391d  d22a39                JP          NC,LAB_ram_f94c
  3608  3920  0f                    RRCA
  3609  3921  da1639                JP          C,LAB_ram_f938
  3610  3924  cdd90c                CALL        SUB_ram_cc7a
  3611  3927  c36439                JP          LAB_ram_f986
  3612                          LAB_ram_f94c:
  3613  392a  1c                    INC         E
  3614  392b  1a                    LD          A,(DE)                    ;= $20
  3615  392c  0f                    RRCA
  3616  392d  d24339                JP          NC,LAB_ram_f965
  3617  3930  08                    EX          AF,AF'
  3618  3931  cdf90c                CALL        SUB_ram_cc9a
  3619  3934  08                    EX          AF,AF'
  3620  3935  0f                    RRCA
  3621  3936  d26439                JP          NC,LAB_ram_f986
  3622  3939  0f                    RRCA
  3623  393a  d26439                JP          NC,LAB_ram_f986
  3624                          LAB_ram_f95f:
  3625  393d  cd0e0d                CALL        SUB_ram_ccaf
  3626  3940  c36439                JP          LAB_ram_f986
  3627                          LAB_ram_f965:
  3628  3943  0f                    RRCA
  3629  3944  d25139                JP          NC,LAB_ram_f973
  3630  3947  0f                    RRCA
  3631  3948  da3d39                JP          C,LAB_ram_f95f
  3632  394b  cd150d                CALL        SUB_ram_ccb5
  3633  394e  c36439                JP          LAB_ram_f986
  3634                          LAB_ram_f973:
  3635  3951  1c                    INC         E
  3636  3952  1a                    LD          A,(DE)                    ;= $20
  3637  3953  0f                    RRCA
  3638  3954  d25d39                JP          NC,LAB_ram_f97f
  3639                          LAB_ram_f979:
  3640  3957  cd230d                CALL        SUB_ram_ccc3
  3641  395a  c36439                JP          LAB_ram_f986
  3642                          LAB_ram_f97f:
  3643  395d  0f                    RRCA
  3644  395e  da5739                JP          C,LAB_ram_f979
  3645  3961  cd380d                CALL        DRAW_WALL_FR2_EMPTY
  3646                          LAB_ram_f986:
  3647  3964  3ae937                LD          A,(ITEM_F1)                             ;= $60
  3648  3967  018a02                LD          BC,$28a
  3649  396a  cd362c                CALL        CHK_ITEM
  3650                          F0_HD_NO_WALL:
  3651  396d  11f533                LD          DE,DAT_ram_33f5                         ;= $20
  3652  3970  1a                    LD          A,(DE)                    ;= $20
  3653  3971  0f                    RRCA
  3654  3972  d28839                JP          NC,LAB_ram_f9aa
  3655  3975  08                    EX          AF,AF'
  3656  3976  cdb009                CALL        DRAW_WALL_FL0
  3657  3979  08                    EX          AF,AF'
  3658  397a  0f                    RRCA
  3659  397b  d2f739                JP          NC,LAB_ram_fa19
  3660  397e  0f                    RRCA
  3661  397f  d2f739                JP          NC,LAB_ram_fa19
  3662                          LAB_ram_f9a4:
  3663  3982  cde409                CALL        DRAW_DOOR_FLO
  3664  3985  c3f739                JP          LAB_ram_fa19
  3665                          LAB_ram_f9aa:
  3666  3988  0f                    RRCA
  3667  3989  d29639                JP          NC,LAB_ram_f9b8
  3668  398c  0f                    RRCA
  3669  398d  da8239                JP          C,LAB_ram_f9a4
  3670  3990  cdef09                CALL        SUB_ram_c996
  3671  3993  c3f739                JP          LAB_ram_fa19
  3672                          LAB_ram_f9b8:
  3673  3996  1c                    INC         E
  3674  3997  1a                    LD          A,(DE)                    ;= $20
  3675  3998  0f                    RRCA
  3676  3999  d2a239                JP          NC,LAB_ram_f9c4
  3677                          LAB_ram_f9be:
  3678  399c  cd1e0a                CALL        SUB_ram_c9c5
  3679  399f  c3f739                JP          LAB_ram_fa19
  3680                          LAB_ram_f9c4:
  3681  39a2  0f                    RRCA
  3682  39a3  da9c39                JP          C,LAB_ram_f9be
  3683  39a6  1c                    INC         E
  3684  39a7  1a                    LD          A,(DE)                    ;= $20
  3685  39a8  0f                    RRCA
  3686  39a9  d2ce39                JP          NC,LAB_ram_f9f0
  3687  39ac  08                    EX          AF,AF'
  3688  39ad  cd290a                CALL        SUB_ram_c9d0
  3689  39b0  cdc539                CALL        SUB_ram_f9e7
  3690  39b3  08                    EX          AF,AF'
  3691  39b4  0f                    RRCA
  3692  39b5  d2f739                JP          NC,LAB_ram_fa19
  3693  39b8  0f                    RRCA
  3694  39b9  d2f739                JP          NC,LAB_ram_fa19
  3695                          LAB_ram_f9de:
  3696  39bc  cd4c0a                CALL        SUB_ram_c9f3
  3697  39bf  cdc539                CALL        SUB_ram_f9e7
  3698  39c2  c3f739                JP          LAB_ram_fa19
  3699                          SUB_ram_f9e7:
  3700  39c5  3aeb37                LD          A,(ITEM_FL1)                            ;= $60
  3701  39c8  01d004                LD          BC,$4d0
  3702  39cb  c3362c                JP          CHK_ITEM
  3703                          LAB_ram_f9f0:
  3704  39ce  0f                    RRCA
  3705  39cf  d2df39                JP          NC,LAB_ram_fa01
  3706  39d2  0f                    RRCA
  3707  39d3  dabc39                JP          C,LAB_ram_f9de
  3708  39d6  cd3e0a                CALL        SUB_ram_c9e5
  3709  39d9  cdc539                CALL        SUB_ram_f9e7
  3710  39dc  c3f739                JP          LAB_ram_fa19
  3711                          LAB_ram_fa01:
  3712  39df  1c                    INC         E
  3713  39e0  0f                    RRCA
  3714  39e1  d2ed39                JP          NC,LAB_ram_fa0f
  3715                          LAB_ram_fa06:
  3716  39e4  cd530a                CALL        SUB_ram_c9f9
  3717  39e7  cdc539                CALL        SUB_ram_f9e7
  3718  39ea  c3f739                JP          LAB_ram_fa19
  3719                          LAB_ram_fa0f:
  3720  39ed  0f                    RRCA
  3721  39ee  dae439                JP          C,LAB_ram_fa06
  3722  39f1  cd4512                CALL        DRAW_WALL_FL22_EMPTY
  3723  39f4  cdc539                CALL        SUB_ram_f9e7
  3724                          LAB_ram_fa19:
  3725  39f7  11f933                LD          DE,DAT_ram_33f9                         ;= $20
  3726  39fa  1a                    LD          A,(DE)                    ;= $20
  3727  39fb  0f                    RRCA
  3728  39fc  d2123a                JP          NC,LAB_ram_fa34
  3729  39ff  08                    EX          AF,AF'
  3730  3a00  cdab0b                CALL        SUB_ram_cb4f
  3731  3a03  08                    EX          AF,AF'
  3732  3a04  0f                    RRCA
  3733  3a05  d2813a                JP          NC,LAB_ram_faa3
  3734  3a08  0f                    RRCA
  3735  3a09  d2813a                JP          NC,LAB_ram_faa3
  3736                          LAB_ram_fa2e:
  3737  3a0c  cdd00b                CALL        DRAW_FRO_DOOR
  3738  3a0f  c3813a                JP          LAB_ram_faa3
  3739                          LAB_ram_fa34:
  3740  3a12  0f                    RRCA
  3741  3a13  d2203a                JP          NC,LAB_ram_fa42
  3742  3a16  0f                    RRCA
  3743  3a17  da0c3a                JP          C,LAB_ram_fa2e
  3744  3a1a  cddb0b                CALL        SUB_ram_cb7e
  3745  3a1d  c3813a                JP          LAB_ram_faa3
  3746                          LAB_ram_fa42:
  3747  3a20  1c                    INC         E
  3748  3a21  1a                    LD          A,(DE)                    ;= $20
  3749  3a22  0f                    RRCA
  3750  3a23  d2353a                JP          NC,LAB_ram_fa57
  3751                          LAB_ram_fa48:
  3752  3a26  cd0b0c                CALL        SUB_ram_cbae
  3753  3a29  c3813a                JP          LAB_ram_faa3
  3754                          SUB_ram_fa4e:
  3755  3a2c  3aec37                LD          A,(ITEM_FR1)                            ;= $60
  3756  3a2f  01e404                LD          BC,$4e4
  3757  3a32  c3362c                JP          CHK_ITEM
  3758                          LAB_ram_fa57:
  3759  3a35  0f                    RRCA
  3760  3a36  da263a                JP          C,LAB_ram_fa48
  3761  3a39  1c                    INC         E
  3762  3a3a  1a                    LD          A,(DE)                    ;= $20
  3763  3a3b  0f                    RRCA
  3764  3a3c  d2583a                JP          NC,LAB_ram_fa7a
  3765  3a3f  08                    EX          AF,AF'
  3766  3a40  cd160c                CALL        SUB_ram_cbb9
  3767  3a43  cd2c3a                CALL        SUB_ram_fa4e
  3768  3a46  08                    EX          AF,AF'
  3769  3a47  0f                    RRCA
  3770  3a48  d2813a                JP          NC,LAB_ram_faa3
  3771  3a4b  0f                    RRCA
  3772  3a4c  d2813a                JP          NC,LAB_ram_faa3
  3773                          LAB_ram_fa71:
  3774  3a4f  cd2b0c                CALL        SUB_ram_cbce
  3775  3a52  cd2c3a                CALL        SUB_ram_fa4e
  3776  3a55  c3813a                JP          LAB_ram_faa3
  3777                          LAB_ram_fa7a:
  3778  3a58  0f                    RRCA
  3779  3a59  d2693a                JP          NC,LAB_ram_fa8b
  3780  3a5c  0f                    RRCA
  3781  3a5d  da4f3a                JP          C,LAB_ram_fa71
  3782  3a60  cd320c                CALL        SUB_ram_cbd4
  3783  3a63  cd2c3a                CALL        SUB_ram_fa4e
  3784  3a66  c3813a                JP          LAB_ram_faa3
  3785                          LAB_ram_fa8b:
  3786  3a69  1c                    INC         E
  3787  3a6a  0f                    RRCA
  3788  3a6b  d2773a                JP          NC,LAB_ram_fa99
  3789                          LAB_ram_fa90:
  3790  3a6e  cd400c                CALL        SUB_ram_cbe2
  3791  3a71  cd2c3a                CALL        SUB_ram_fa4e
  3792  3a74  c3813a                JP          LAB_ram_faa3
  3793                          LAB_ram_fa99:
  3794  3a77  0f                    RRCA
  3795  3a78  da6e3a                JP          C,LAB_ram_fa90
  3796  3a7b  cd7e0c                CALL        DRAW_WALL_FR222_EMPTY
  3797  3a7e  cd2c3a                CALL        SUB_ram_fa4e
  3798                          LAB_ram_faa3:
  3799  3a81  3aea37                LD          A,(ITEM_F0)                             ;= $60
  3800  3a84  018a00                LD          BC,$8a
  3801  3a87  c3362c                JP          CHK_ITEM
  3802                          MAKE_RANDOM_BYTE:
  3803  3a8a  c5                    PUSH        BC
  3804  3a8b  e5                    PUSH        HL
  3805  3a8c  0605                  LD          B,0x5                                   ;Run data randomizer 5x
  3806  3a8e  2a913a                LD          HL,(RNDHOLD_AA)
  3807                          RANDOM_BYTE_LOOP:
  3808  3a91  cb25                  SLA         L                                       ;L x 2
  3809  3a93  cb14                  RL          H
  3810  3a95  daa03a                JP          C,FINISH_BYTE_LOOP
  3811  3a98  3e87                  LD          A,$87
  3812  3a9a  ad                    XOR         L
  3813  3a9b  6f                    LD          L,A
  3814  3a9c  3e1d                  LD          A,$1d
  3815  3a9e  ac                    XOR         H
  3816  3a9f  67                    LD          H,A
  3817                          FINISH_BYTE_LOOP:
  3818  3aa0  10ef                  DJNZ        RANDOM_BYTE_LOOP
  3819  3aa2  22913a                LD          (RNDHOLD_AA),HL
  3820  3aa5  7c                    LD          A,H
  3821  3aa6  e1                    POP         HL
  3822  3aa7  c1                    POP         BC
  3823  3aa8  c9                    RET
  3824                          UPDATE_SCR_SAVER_TIMER:
  3825  3aa9  c5                    PUSH        BC
  3826  3aaa  e5                    PUSH        HL
  3827  3aab  2a9c3a                LD          HL,(TIMER_E)
  3828  3aae  44                    LD          B,H
  3829  3aaf  4d                    LD          C,L
  3830  3ab0  cb21                  SLA         C
  3831  3ab2  cb10                  RL          B
  3832  3ab4  cb21                  SLA         C
  3833  3ab6  cb10                  RL          B
  3834  3ab8  09                    ADD         HL,BC
  3835  3ab9  7c                    LD          A,H
  3836  3aba  ad                    XOR         L
  3837  3abb  32883a                LD          (TIMER_D),A
  3838  3abe  44                    LD          B,H
  3839  3abf  4d                    LD          C,L
  3840  3ac0  cb21                  SLA         C
  3841  3ac2  cb10                  RL          B
  3842  3ac4  cb21                  SLA         C
  3843  3ac6  cb10                  RL          B
  3844  3ac8  09                    ADD         HL,BC
  3845  3ac9  011300                LD          BC,$13
  3846  3acc  09                    ADD         HL,BC
  3847  3acd  229c3a                LD          (TIMER_E),HL
  3848  3ad0  e1                    POP         HL
  3849  3ad1  c1                    POP         BC
  3850  3ad2  c9                    RET
  3851                          MINOTAUR_DEAD:
  3852  3ad3  cd5110                CALL        DRAW_BKGD
  3853  3ad6  215030                LD          HL,DAT_ram_3050                         ;= $20
  3854  3ad9  11a408                LD          DE,THE_END_PART_A                       ;WAS LD DE, 0xC25D
  3855  3adc  0610                  LD          B,$10                                  ;RED on BLK
  3856  3ade  cdfa32                CALL        GFX_DRAW
  3857  3ae1  21a030                LD          HL,DAT_ram_30a0                         ;= $20
  3858  3ae4  cdfa32                CALL        GFX_DRAW
  3859  3ae7  cd8a3a                CALL        MAKE_RANDOM_BYTE
  3860  3aea  e603                  AND         0x3
  3861  3aec  c60a                  ADD         A,0xa
  3862  3aee  47                    LD          B,A
  3863  3aef  3a6c3a                LD          A,(INPUT_HOLDER)
  3864  3af2  07                    RLCA
  3865  3af3  07                    RLCA
  3866  3af4  07                    RLCA
  3867  3af5  07                    RLCA
  3868  3af6  47                    LD          B,A
  3869  3af7  af                    XOR         A
  3870  3af8  326c3a                LD          (INPUT_HOLDER),A
  3871  3afb  110f07                LD          DE,MINOTAUR                             ;= $04,$04,$04,$04
  3872  3afe  21da32                LD          HL,DAT_ram_32da                         ;= $20
  3873  3b01  cdfa32                CALL        GFX_DRAW
  3874  3b04  cd4f2e                CALL        TOTAL_HEAL
  3875  3b07  cdc03c                CALL        REDRAW_STATS
  3876  3b0a  0602                  LD          B,0x2                                   ;Was LD B,0x6
  3877                          MINOTAUR_DEAD_SOUND_LOOP:
  3878  3b0c  d9                    EXX
  3879  3b0d  cdbf0d                CALL        SUB_ram_cd5f
  3880  3b10  cddc0d                CALL        END_OF_GAME_SOUND
  3881  3b13  d9                    EXX
  3882  3b14  10f6                  DJNZ        MINOTAUR_DEAD_SOUND_LOOP
  3883  3b16  c31e2a                JP          SCREEN_SAVER_FULL_SCREEN
  3884                          DO_REST:
  3885  3b19  3a783a                LD          A,(LAST_ITEM_HELD)                   ;Load food inventory into A
  3886  3b1c  a7                    AND         A
  3887  3b1d  c2a521                JP          NZ,NO_ACTION_TAKEN                      ;If food is empty, do nothing
  3888                          CHK_NEEDS_HEALING:
  3889  3b20  2a953a                LD          HL,(PLAYER_PHYS_HEALTH_MAX)             ;HL = max PHYS health
  3890  3b23  ed5b933a              LD          DE,(PLAYER_PHYS_HEALTH)                 ;DE = current PHYS health
  3891  3b27  cd7a23                CALL        RECALC_PHYS_HEALTH
  3892  3b2a  b5                    OR          L
  3893  3b2b  c23c3b                JP          NZ,HEAL_PLAYER_PHYS_HEALTH
  3894  3b2e  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
  3895  3b31  4f                    LD          C,A
  3896  3b32  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  3897  3b35  b9                    CP          C
  3898  3b36  ca062a                JP          Z,INPUT_DEBOUNCE
  3899  3b39  c3663b                JP          HEAL_PLAYER_SPRT_HEALTH
  3900                          HEAL_PLAYER_PHYS_HEALTH:
  3901  3b3c  2aa93a                LD          HL,(BYTE_ram_3aa9)
  3902  3b3f  110100                LD          DE,0x1
  3903  3b42  cd7a23                CALL        RECALC_PHYS_HEALTH
  3904  3b45  da062a                JP          C,INPUT_DEBOUNCE
  3905  3b48  22a93a                LD          (BYTE_ram_3aa9),HL
  3906  3b4b  21ab3a                LD          HL,FOOD_INV
  3907  3b4e  35                    DEC         (HL)
  3908  3b4f  2a933a                LD          HL,(PLAYER_PHYS_HEALTH)
  3909  3b52  cd7123                CALL        SUB_ram_e427
  3910  3b55  22933a                LD          (PLAYER_PHYS_HEALTH),HL
  3911  3b58  cdc03c                CALL        REDRAW_STATS
  3912  3b5b  3a983a                LD          A,(PLAYER_SPRT_HEALTH_MAX)
  3913  3b5e  4f                    LD          C,A
  3914  3b5f  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  3915  3b62  b9                    CP          C
  3916  3b63  ca203b                JP          Z,CHK_NEEDS_HEALING
  3917                          HEAL_PLAYER_SPRT_HEALTH:
  3918  3b66  2aa93a                LD          HL,(BYTE_ram_3aa9)
  3919  3b69  110100                LD          DE,0x1
  3920  3b6c  cd7a23                CALL        RECALC_PHYS_HEALTH
  3921  3b6f  da062a                JP          C,INPUT_DEBOUNCE
  3922  3b72  22a93a                LD          (BYTE_ram_3aa9),HL
  3923  3b75  21ab3a                LD          HL,FOOD_INV
  3924  3b78  35                    DEC         (HL)
  3925  3b79  3a973a                LD          A,(PLAYER_SPRT_HEALTH)
  3926  3b7c  c601                  ADD         A,0x1
  3927  3b7e  27                    DAA
  3928  3b7f  32973a                LD          (PLAYER_SPRT_HEALTH),A
  3929  3b82  cdc03c                CALL        REDRAW_STATS
  3930  3b85  c3203b                JP          CHK_NEEDS_HEALING
  3931                          KEY_COMPARE:
  3932  3b88  3a663a                LD          A,(RAM_AE)
  3933  3b8b  fe31                  CP          $31                                    ;Compare to "1" db?
  3934  3b8d  c2092a                JP          NZ,WAIT_FOR_INPUT
  3935                          KEY_COL_0:
  3936  3b90  21f637                LD          HL,KEY_INPUT_COL0                       ;= $60
  3937  3b93  7e                    LD          A,(HL)                  ;A = Key Column 0
  3938  3b94  fefe                  CP          $fe                                    ;If Key Row = 0 "="
  3939  3b96  caa521                JP          Z,NO_ACTION_TAKEN
  3940  3b99  fefd                  CP          $fd                                    ;If Key Row = 1 "BKSP"
  3941  3b9b  caa521                JP          Z,NO_ACTION_TAKEN
  3942  3b9e  fefb                  CP          $fb                                    ;If Key Row = 2 ":"
  3943  3ba0  caa521                JP          Z,NO_ACTION_TAKEN
  3944  3ba3  fef7                  CP          $f7                                    ;If Key Row = 3 "RET"
  3945  3ba5  caa521                JP          Z,NO_ACTION_TAKEN
  3946  3ba8  feef                  CP          $ef                                    ;If Key Row = 4 ";"
  3947  3baa  cac82d                JP          Z,DO_GLANCE_RIGHT
  3948  3bad  fedf                  CP          $df                                    ;If Key Row = 5 "."
  3949  3baf  caae2d                JP          Z,DO_TURN_RIGHT
  3950                          KEY_COL_1:
  3951  3bb2  2c                    INC         L
  3952  3bb3  7e                    LD          A,(HL)                  ;A = Key Column 1
  3953  3bb4  fefe                  CP          $fe                                    ;If Key Row = 0 "-"
  3954  3bb6  caa521                JP          Z,NO_ACTION_TAKEN
  3955  3bb9  fefd                  CP          $fd                                    ;If Key Row = 1 "/"
  3956  3bbb  caa521                JP          Z,NO_ACTION_TAKEN
  3957  3bbe  fefb                  CP          $fb                                    ;If Key Row = 2 "0"
  3958  3bc0  caa521                JP          Z,NO_ACTION_TAKEN
  3959  3bc3  fef7                  CP          $f7                                    ;If Key Row = 3 "P"
  3960  3bc5  caa521                JP          Z,NO_ACTION_TAKEN
  3961  3bc8  feef                  CP          $ef                                    ;If Key Row = 4 "L"
  3962  3bca  ca1121                JP          Z,DO_MOVE_FW_CHK_WALLS
  3963  3bcd  fedf                  CP          $df                                    ;If Key Row = 5 ","
  3964  3bcf  ca4321                JP          Z,DO_JUMP_BACK
  3965                          KEY_COL_2:
  3966  3bd2  2c                    INC         L
  3967  3bd3  7e                    LD          A,(HL)                  ;A = Key Column 2
  3968  3bd4  fefe                  CP          $fe                                    ;If Key Row = 0 "9"
  3969  3bd6  caa521                JP          Z,NO_ACTION_TAKEN
  3970  3bd9  fefd                  CP          $fd                                    ;If Key Row = 1 "O"
  3971  3bdb  caa521                JP          Z,NO_ACTION_TAKEN
  3972  3bde  fefb                  CP          $fb                                    ;If Key Row = 2 "K"
  3973  3be0  ca1121                JP          Z,DO_MOVE_FW_CHK_WALLS
  3974  3be3  fef7                  CP          $f7                                    ;If Key Row = 3 "M"
  3975  3be5  ca962d                JP          Z,DO_TURN_LEFT
  3976  3be8  feef                  CP          $ef                                    ;If Key Row = 4 "N"
  3977  3bea  caf42d                JP          Z,DO_USE_ATTACK
  3978  3bed  fedf                  CP          $df                                    ;If Key Row = 5 "J"
  3979  3bef  cade2d                JP          Z,DO_GLANCE_LEFT
  3980                          KEY_COL_3:
  3981  3bf2  2c                    INC         L
  3982  3bf3  7e                    LD          A,(HL)                  ;A = Key Column 3
  3983  3bf4  fefe                  CP          $fe                                    ;If Key Row = 0 "8"
  3984  3bf6  caa521                JP          Z,NO_ACTION_TAKEN
  3985  3bf9  fefd                  CP          $fd                                    ;If Key Row = 1 "I"
  3986  3bfb  caa521                JP          Z,NO_ACTION_TAKEN
  3987  3bfe  fefb                  CP          $fb                                    ;If Key Row = 2 "7"
  3988  3c00  caa521                JP          Z,NO_ACTION_TAKEN
  3989  3c03  fef7                  CP          $f7                                    ;If Key Row = 3 "U"
  3990  3c05  caa521                JP          Z,NO_ACTION_TAKEN
  3991  3c08  feef                  CP          $ef                                    ;If Key Row = 4 "H"
  3992  3c0a  ca652c                JP          Z,DO_OPEN_CLOSE
  3993  3c0d  fedf                  CP          $df                                    ;If Key Row = 5 "B"
  3994  3c0f  caa521                JP          Z,NO_ACTION_TAKEN
  3995                          KEY_COL_4:
  3996  3c12  2c                    INC         L
  3997  3c13  7e                    LD          A,(HL)                  ;A = Key Column 4
  3998  3c14  fefe                  CP          $fe                                    ;If Key Row = 0 "6"
  3999  3c16  caa521                JP          Z,NO_ACTION_TAKEN
  4000  3c19  fefd                  CP          $fd                                    ;If Key Row = 1 "Y"
  4001  3c1b  cac221                JP          Z,USE_MAP
  4002  3c1e  fefb                  CP          $fb                                    ;If Key Row = 2 "G"
  4003  3c20  caa521                JP          Z,NO_ACTION_TAKEN
  4004  3c23  fef7                  CP          $f7                                    ;If Key Row = 3 "V"
  4005  3c25  caa521                JP          Z,NO_ACTION_TAKEN
  4006  3c28  feef                  CP          $ef                                    ;If Key Row = 4 "C"
  4007  3c2a  ca9f21                JP          Z,DO_COUNT_ARROWS
  4008  3c2d  fedf                  CP          $df                                    ;If Key Row = 5 "F"
  4009  3c2f  ca193b                JP          Z,DO_REST
  4010                          KEY_COL_5:
  4011  3c32  2c                    INC         L
  4012  3c33  7e                    LD          A,(HL)                  ;A = Key Column 5
  4013  3c34  fefe                  CP          $fe                                    ;If Key Row = 0 "5"
  4014  3c36  caa521                JP          Z,NO_ACTION_TAKEN
  4015  3c39  fefd                  CP          $fd                                    ;If Key Row = 1 "T"
  4016  3c3b  cab43c                JP          Z,DO_TELEPORT
  4017  3c3e  fefb                  CP          $fb                                    ;If Key Row = 2 "4"
  4018  3c40  caa521                JP          Z,NO_ACTION_TAKEN
  4019  3c43  fef7                  CP          $f7                                    ;If Key Row = 3 "R"
  4020  3c45  cad229                JP          Z,DO_SWAP_PACK
  4021  3c48  feef                  CP          $ef                                    ;If Key Row = 4 "D"
  4022  3c4a  ca6432                JP          Z,DO_USE_LADDER
  4023  3c4d  fedf                  CP          $df                                    ;If Key Row = 5 "X"
  4024  3c4f  ca8721                JP          Z,DO_COUNT_FOOD
  4025                          KEY_COL_6:
  4026  3c52  2c                    INC         L
  4027  3c53  7e                    LD          A,(HL)                  ;A = Key Column 6
  4028  3c54  fefe                  CP          $fe                                    ;If Key Row = 0 "3"
  4029  3c56  caa521                JP          Z,NO_ACTION_TAKEN
  4030  3c59  fefd                  CP          $fd                                    ;If Key Row = 1 "E"
  4031  3c5b  ca1526                JP          Z,DO_SWAP_HANDS
  4032  3c5e  fefb                  CP          $fb                                    ;If Key Row = 2 "S"
  4033  3c60  ca6229                JP          Z,DO_ROTATE_PACK
  4034  3c63  fef7                  CP          $f7                                    ;If Key Row = 3 "Z"
  4035  3c65  ca2d12                JP          Z,WIPE_WALLS
  4036  3c68  feef                  CP          $ef                                    ;If Key Row = 4 "SPC"
  4037  3c6a  caa521                JP          Z,NO_ACTION_TAKEN
  4038  3c6d  fedf                  CP          $df                                    ;If Key Row = 5 "A"
  4039  3c6f  caa521                JP          Z,NO_ACTION_TAKEN
  4040                          KEY_COL_7:
  4041  3c72  2c                    INC         L
  4042  3c73  7e                    LD          A,(HL)                  ;A = Key Column 7
  4043  3c74  fefe                  CP          $fe                                    ;If Key Row = 0 "2"
  4044  3c76  caa521                JP          Z,NO_ACTION_TAKEN
  4045  3c79  fefd                  CP          $fd                                    ;If Key Row = 1 "W"
  4046  3c7b  ca2427                JP          Z,DO_PICK_UP
  4047  3c7e  fefb                  CP          $fb                                    ;If Key Row = 2 "1"
  4048  3c80  caa521                JP          Z,NO_ACTION_TAKEN
  4049  3c83  fef7                  CP          $f7                                    ;If Key Row = 3 "Q"
  4050  3c85  ca953c                JP          Z,MAX_HEALTH_ARROWS_FOOD
  4051  3c88  feef                  CP          $ef                                    ;If Key Row = 4 "SHFT"
  4052  3c8a  caa521                JP          Z,NO_ACTION_TAKEN
  4053  3c8d  fedf                  CP          $df                                    ;If Key Row = 5 "CTRL"
  4054  3c8f  caa521                JP          Z,NO_ACTION_TAKEN
  4055  3c92  c3a521                JP          NO_ACTION_TAKEN
  4056                          MAX_HEALTH_ARROWS_FOOD:
  4057  3c95  21933a                LD          HL,PLAYER_PHYS_HEALTH
  4058  3c98  3e99                  LD          A,$99
  4059  3c9a  77                    LD          (HL),A
  4060  3c9b  23                    INC         HL
  4061  3c9c  77                    LD          (HL),A
  4062  3c9d  23                    INC         HL
  4063  3c9e  77                    LD          (HL),A
  4064  3c9f  23                    INC         HL
  4065  3ca0  77                    LD          (HL),A
  4066  3ca1  23                    INC         HL
  4067  3ca2  77                    LD          (HL),A
  4068  3ca3  23                    INC         HL
  4069  3ca4  77                    LD          (HL),A
  4070  3ca5  21ab3a                LD          HL,FOOD_INV
  4071  3ca8  77                    LD          (HL),A
  4072  3ca9  23                    INC         HL
  4073  3caa  77                    LD          (HL),A
  4074  3cab  cd3a3d                CALL        PLAY_POWER_UP_SOUND
  4075  3cae  cdc03c                CALL        REDRAW_STATS
  4076  3cb1  c3062a                JP          INPUT_DEBOUNCE
  4077                          DO_TELEPORT:
  4078  3cb4  3a0039                LD          A,(MAP_LADDER_OFFSET)
  4079  3cb7  32793a                LD          (PLAYER_MAP_POS),A
  4080  3cba  cd153d                CALL        PLAY_TELEPORT_SOUND
  4081  3cbd  c3002a                JP          UPDATE_VIEWPORT
  4082                          REDRAW_STATS:
  4083  3cc0  cde011                CALL        DRAW_ICON_BAR
  4084  3cc3  21933a                LD          HL,PLAYER_PHYS_HEALTH
  4085  3cc6  114130                LD          DE,CHRRAM_PHYS_HEALTH_1000              ;= $20
  4086  3cc9  0602                  LD          B,0x2
  4087  3ccb  cdc032                CALL        RECALC_AND_REDRAW_BCD
  4088  3cce  21973a                LD          HL,PLAYER_SPRT_HEALTH
  4089  3cd1  114730                LD          DE,CHRRAM_SPRT_HEALTH_10                ;= $20
  4090  3cd4  0601                  LD          B,0x1
  4091  3cd6  c3c032                JP          RECALC_AND_REDRAW_BCD
  4092                          CHECK_RING:
  4093  3cd9  f5                    PUSH        AF
  4094  3cda  3a763a                LD          A,(RING_INV_SLOT)
  4095  3cdd  cdfd3c                CALL        LEVEL_TO_COLRAM_FIX
  4096  3ce0  321734                LD          (COLRAM_RING_IDX),A                     ;= $60    `
  4097  3ce3  f1                    POP         AF
  4098  3ce4  c9                    RET
  4099                          CHECK_HELMET:
  4100  3ce5  f5                    PUSH        AF
  4101  3ce6  3a753a                LD          A,(HELMET_INV_SLOT)
  4102  3ce9  cdfd3c                CALL        LEVEL_TO_COLRAM_FIX
  4103  3cec  321534                LD          (COLRAM_HELMET_IDX),A                   ;= $60    `
  4104  3cef  f1                    POP         AF
  4105  3cf0  c9                    RET
  4106                          CHECK_ARMOR:
  4107  3cf1  f5                    PUSH        AF
  4108  3cf2  3a743a                LD          A,(ARMOR_INV_SLOT)
  4109  3cf5  cdfd3c                CALL        LEVEL_TO_COLRAM_FIX
  4110  3cf8  321334                LD          (COLRAM_ARMOR_IDX),A                    ;= $60    `
  4111  3cfb  f1                    POP         AF
  4112  3cfc  c9                    RET
  4113                          LEVEL_TO_COLRAM_FIX:
  4114  3cfd  87                    ADD         A,A
  4115  3cfe  d601                  SUB         0x1
  4116  3d00  cb27                  SLA         A
  4117  3d02  cb27                  SLA         A
  4118  3d04  cb27                  SLA         A
  4119  3d06  cb27                  SLA         A
  4120  3d08  c9                    RET
  4121                          RHA_REDRAW:
  4122  3d09  cdd93c                CALL        CHECK_RING
  4123  3d0c  cde53c                CALL        CHECK_HELMET
  4124  3d0f  cdf13c                CALL        CHECK_ARMOR
  4125  3d12  c3062a                JP          INPUT_DEBOUNCE
  4126                          PLAY_TELEPORT_SOUND:
  4127  3d15  012002                LD          BC,$220
  4128  3d18  111800                LD          DE,$18
  4129  3d1b  cdb121                CALL        PLAY_SOUND_LOOP
  4130  3d1e  011001                LD          BC,$110
  4131  3d21  111800                LD          DE,$18
  4132  3d24  cdb121                CALL        PLAY_SOUND_LOOP
  4133  3d27  018800                LD          BC,$88
  4134  3d2a  111800                LD          DE,$18
  4135  3d2d  cdb121                CALL        PLAY_SOUND_LOOP
  4136  3d30  014400                LD          BC,$44
  4137  3d33  111800                LD          DE,$18
  4138  3d36  cdb121                CALL        PLAY_SOUND_LOOP
  4139  3d39  c9                    RET
  4140                          PLAY_POWER_UP_SOUND:
  4141  3d3a  012002                LD          BC,$220
  4142  3d3d  111800                LD          DE,$18
  4143  3d40  cdb121                CALL        PLAY_SOUND_LOOP
  4144  3d43  010002                LD          BC,$200
  4145  3d46  111800                LD          DE,$18
  4146  3d49  cdb121                CALL        PLAY_SOUND_LOOP
  4147  3d4c  01e001                LD          BC,$1e0
  4148  3d4f  111800                LD          DE,$18
  4149  3d52  cdb121                CALL        PLAY_SOUND_LOOP
  4150  3d55  01c001                LD          BC,$1c0
  4151  3d58  116000                LD          DE,$60
  4152  3d5b  cdb121                CALL        PLAY_SOUND_LOOP
  4153  3d5e  c9                    RET
  4154                          
src/asterion.asm:
    20  3d5f  0000000000000000      defs         $3EFF - $, $00
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
    21                          
    22                          include "asterion_gfx_pointers.asm"
src/asterion_gfx_pointers.asm:
     1                          GFX_POINTERS:
     2  3eff  00                    db          0h
     3                          GFX_PTR_BUCKLER:
     4  3f00  0100                  dw        BUCKLER                                 ;= $01,$01,$01,$01,$01
     5                          GFX_PTR_BUCKLER_S:
     6  3f02  1400                  dw        BUCKLER_S                               ;= $01,$01
     7                          GFX_PTR_BUCKLER_T:
     8  3f04  1900                  dw        BUCKLER_T                               ;= $00,$87,$FF
     9                          GFX_PTR_RING:
    10  3f06  1c00                  dw        RING                                    ;= $01,$01,$01,$01,$01,$01,$01
    11                          GFX_PTR_RING_S:
    12  3f08  2600                  dw        RING_S                                  ;= $01,$01,$01
    13                          GFX_PTR_RING_T:
    14  3f0a  2c00                  dw        RING_T                                  ;= $00,".",$FF
    15                          GFX_PTR_HELMET:
    16  3f0c  2f00                  dw        HELMET                                  ;= $01,$01,$01,$01,$01,$01
    17                          GFX_PTR_HELMET_S:
    18  3f0e  3d00                  dw        HELMET_S                                ;= $01,$01,$01
    19                          GFX_PTR_HELMET_T:
    20  3f10  4700                  dw        HELMET_T                                ;= $00,"^",$FF
    21                          GFX_PTR_ARMOR:
    22  3f12  4a00                  dw        ARMOR                                   ;= $01,$01,$01,$01,$01
    23                          GFX_PTR_ARMOR_S:
    24  3f14  6200                  dw        ARMOR_S                                 ;= $01,$01
    25                          GFX_PTR_ARMOR_T:
    26  3f16  7300                  dw        ARMOR_T                                 ;= $00,$A0,$C7,$D9,$01
    27                          GFX_PTR_PAVISE:
    28  3f18  7d00                  dw        PAVICE                                  ;= $01,$01,$01,$01,$01
    29                          GFX_PTR_PAVISE_S:
    30  3f1a  9500                  dw        PAVICE_S                                ;= $01,$01
    31                          GFX_PTR_PAVISE_T:
    32  3f1c  a300                  dw        PAVICE_T                                ;= $00,$7F,$01
    33                          GFX_PTR_ARROW_L:
    34  3f1e  bf01                  dw        ARROW_FLYING_LEFT                       ;= $01,$01,$01,$01,$01,$01
    35                          GFX_PTR_ARROW_R:
    36  3f20  a900                  dw        ARROW_FLYING_RIGHT                      ;= $01,$01,$01,$01,$01,$01
    37                          GFX_PTR_ARROW_L_2:
    38  3f22  bf01                  dw        ARROW_FLYING_LEFT                       ;= $01,$01,$01,$01,$01,$01
    39                          GFX_PTR_BOW:
    40  3f24  b200                  dw        BOW                                     ;= $01,$01,$01,$01,$01
    41                          GFX_PTR_BOW_S:
    42  3f26  c600                  dw        BOW_S                                   ;= $01,$01
    43                          GFX_PTR_BOW_T:
    44  3f28  d100                  dw        BOW_T                                   ;= $00,"{",$FF
    45                          GFX_PTR_SCROLL:
    46  3f2a  d400                  dw        SCROLL                                  ;= $01,$01,$01,$01,$01
    47                          GFX_PTR_SCROLL_S:
    48  3f2c  ef00                  dw        SCROLL_S                                ;= $01,$01
    49                          GFX_PTR_SCROLL_NEW_T:
    50  3f2e  f900                  dw        SCROLL_T                                ;= $00,"H",$FF
    51                          GFX_PTR_AXE:
    52  3f30  fc00                  dw        AXE                                     ;= $01,$01,$01,$01,$01
    53                          GFX_PTR_AXE_S:
    54  3f32  1101                  dw        AXE_S                                   ;= $01,$01
    55                          GFX_PTR_AXE_T:
    56  3f34  2101                  dw        AXE_T                                   ;= $00,$11,$FF
    57                          GFX_PTR_FIREBALL:
    58  3f36  2401                  dw        FIREBALL                                ;= $01,$01,$01,$01,$01
    59                          GFX_PTR_FIREBALL_S:
    60  3f38  3501                  dw        FIREBALL_S                              ;= $01,$01
    61                          GFX_PTR_FIREBALL_T:
    62  3f3a  3a01                  dw        FIREBALL_T                              ;= $00,$D3,$FF
    63                          GFX_PTR_MACE:
    64  3f3c  3d01                  dw        MACE                                    ;= $01,$01,$01,$01,$01
    65                          GFX_PTR_MACE_S:
    66  3f3e  5801                  dw        MACE_S                                  ;= $01,$01
    67                          GFX_PTR_MACE_T:
    68  3f40  6a01                  dw        MACE_T                                  ;= $00,"T",$FF
    69                          GFX_PTR_STAFF:
    70  3f42  6d01                  dw        STAFF                                   ;= $01,$01,$01,$01,$01
    71                          GFX_PTR_STAFF_S:
    72  3f44  8001                  dw        STAFF_S                                 ;= $01,$01
    73                          GFX_PTR_STAFF_T:
    74  3f46  8901                  dw        STAFF_T                                 ;= $00,"\\",$FF
    75                          GFX_PTR_CROSSBOW:
    76  3f48  8c01                  dw        CROSSBOW                                ;= $01,$01,$01,$01,$01
    77                          GFX_PTR_CROSSBOW_S:
    78  3f4a  af01                  dw        CROSSBOW_S                              ;= $01,$01
    79                          GFX_PTR_CROSSBOW_T:
    80  3f4c  b701                  dw        CROSSBOW_T                              ;= $A0,$91,$A0,$D8,$02,$04,$90,$FF
    81  3f4e  8b03                  dw        EXCL_MARK_GFX
    82  3f50  8b03                  dw        EXCL_MARK_GFX
    83  3f52  8b03                  dw        EXCL_MARK_GFX
    84  3f54  8b03                  dw        EXCL_MARK_GFX
    85  3f56  8b03                  dw        EXCL_MARK_GFX
    86  3f58  8b03                  dw        EXCL_MARK_GFX
    87                          GFX_PTR_ARROW_R_2:
    88  3f5a  a900                  dw        ARROW_FLYING_RIGHT                      ;= $01,$01,$01,$01,$01,$01
    89  3f5c  8b03                  dw        EXCL_MARK_GFX
    90  3f5e  8b03                  dw        EXCL_MARK_GFX
    91                          GFX_PTR_LADDER:
    92  3f60  c801                  dw        LADDER                                  ;= $01,$01,$01,$01,$01
    93                          GFX_PTR_LADDER_S:
    94  3f62  e101                  dw        LADDER_S                                ;= $01,$01
    95                          GFX_PTR_LADDER_T:
    96  3f64  f101                  dw        LADDER_T                                ;= $00,$CD,$97,$FF
    97                          GFX_PTR_CHEST:
    98  3f66  f501                  dw        CHEST                                   ;= $01,$01,$01,$01,$01
    99                          GFX_PTR_CHEST_S:
   100  3f68  1402                  dw        CHEST_S                                 ;= $01,$E0,$1F,$1F,$B0,$01
   101                          GFX_PTR_CHEST_T:
   102  3f6a  2602                  dw        CHEST_T                                 ;= $00,$FC,$FF
   103                          GFX_PTR_FOOD:
   104  3f6c  2902                  dw        FOOD                                    ;= $01,$01,$01,$01,$01
   105                          GFX_PTR_FOOD_S:
   106  3f6e  4002                  dw        FOOD_S                                  ;= $01,$01
   107                          GFX_PTR_FOOD_T:
   108  3f70  4a02                  dw        FOOD_T                                  ;= $00,"#",$FF
   109                          GFX_PTR_QUIVER:
   110  3f72  4d02                  dw        QUIVER                                  ;= $01,$01,$01,$01,$01,$01
   111                          GFX_PTR_QUIVER_S:
   112  3f74  6402                  dw        QUIVER_S                                ;= $01,$01
   113                          GFX_PTR_QUIVER_T:
   114  3f76  6f02                  dw        QUIVER_T                                ;= $00,$F0,$FF
   115                          GFX_PTR_LOCK_CHEST:
   116  3f78  7202                  dw        LOCKED_CHEST                            ;= $01,$01,$01,$01,$01
   117                          GFX_PTR_LOCK_CHEST_S:
   118  3f7a  1402                  dw        CHEST_S                                 ;= $01,$E0,$1F,$1F,$B0,$01
   119                          GFX_PTR_LOCK_CHEST_T:
   120  3f7c  2602                  dw        CHEST_T                                 ;= $00,$FC,$FF
   121  3f7e  8b03                  dw        EXCL_MARK_GFX
   122  3f80  8b03                  dw        EXCL_MARK_GFX
   123  3f82  8b03                  dw        EXCL_MARK_GFX
   124                          GFX_PTR_KEY:
   125  3f84  9102                  dw        KEY                                     ;= $01,$01,$01,$01,$01,$01
   126                          GFX_PTR_KEY_S:
   127  3f86  a302                  dw        KEY_S                                   ;= $01,$01,$01
   128                          GFX_PTR_KEY_T:
   129  3f88  a902                  dw        KEY_T                                   ;= $FF,"-",$FF
   130                          GFX_PTR_AMULET:
   131  3f8a  ac02                  dw        AMULET                                  ;= $01,$01,$01,$01,$01
   132                          GFX_PTR_AMULET_S:
   133  3f8c  c402                  dw        AMULET_S                                ;= $01,$01
   134                          GFX_PTR_AMULET_T:
   135  3f8e  d402                  dw        AMULET_T                                ;= $00,"&",$FF
   136                          GFX_PTR_CHALICE:
   137  3f90  d702                  dw        CHALICE                                 ;= $01,$01,$01,$01,$01,$01
   138                          GFX_PTR_CHALICE_S:
   139  3f92  ea02                  dw        CHALICE_S                               ;= $01,$01
   140                          GFX_PTR_CHALICE_T:
   141  3f94  f202                  dw        CHALICE_T                               ;= $00,"Y",$FF
   142                          GFX_PTR_WARRIOR_POTION:
   143  3f96  f502                  dw        WARRIOR_POTION                          ;= $01,$01,$01,$01,$01
   144                          GFX_PTR_WARRIOR_POTION_S:
   145  3f98  0a03                  dw        WARRIOR_POTION_S                        ;= $01,$01
   146                          GFX_PTR_WARRIOR_POTION_T:
   147  3f9a  1503                  dw        POTION_T                                ;= $00,"U",$02,$04,"_",$FF
   148                          GFX_PTR_MAGE_POTION:
   149  3f9c  1b03                  dw        MAGE_POTION                             ;= $01,$01,$01,$01,$01
   150                          GFX_PTR_MAGE_POTION_S:
   151  3f9e  3003                  dw        MAGE_POTION_S                           ;= $01,$01
   152                          GFX_PTR_MAGE_POTION_T:
   153  3fa0  1503                  dw        POTION_T                                ;= $00,"U",$02,$04,"_",$FF
   154                          GFX_PTR_MAP:
   155  3fa2  3b03                  dw        MAP                                     ;= $01,$01,$01,$01,$01
   156                          GFX_PTR_MAP_S:
   157  3fa4  5a03                  dw        MAP_S                                   ;= $01,$01
   158                          GFX_PTR_MAP_T:
   159  3fa6  6803                  dw        MAP_T                                   ;= $00,$D5,$FF
   160                          GFX_PTR_CHAOS_POTION:
   161  3fa8  6b03                  dw        CHAOS_POTION                            ;= $01,$01,$01,$01,$01
   162                          GFX_PTR_CHAOS_POTION_S:
   163  3faa  8003                  dw        CHAOS_POTION_S                          ;= $01,$01
   164                          GFX_PTR_CHAOS_POTION_T:
   165  3fac  1503                  dw        POTION_T                                ;= $00,"U",$02,$04,"_",$FF
   166  3fae  8b03                  dw        EXCL_MARK_GFX
   167  3fb0  8b03                  dw        EXCL_MARK_GFX
   168  3fb2  8b03                  dw        EXCL_MARK_GFX
   169                          GFX_END_PT1:
   170  3fb4  0000                  dw        NO_GFX                                  ;= $FF
   171                          GFX_PTR_SKELETON:
   172  3fb6  8d03                  dw        SKELETON                                ;= $04,$04,$04,$04
   173                          GFX_PTR_SKELETON_S:
   174  3fb8  cb03                  dw        SKELETON_S                              ;= $04,$04,$04
   175  3fba  0000                  dw        NO_GFX                                  ;= $FF
   176                          GFX_PTR_SNAKE:
   177  3fbc  e103                  dw        SNAKE                                   ;= $04,$04,$04
   178                          GFX_PTR_SNAKE_S:
   179  3fbe  2204                  dw        SNAKE_S                                 ;= $04,$04,$04
   180  3fc0  0000                  dw        NO_GFX                                  ;= $FF
   181                          GFX_PTR_SPIDER:
   182  3fc2  3a04                  dw        SPIDER                                  ;= $04,$04
   183                          GFX_PTR_SPIDER_S:
   184  3fc4  6b04                  dw        SPIDER_S                                ;= $04,$04,$04,$04
   185  3fc6  0000                  dw        NO_GFX                                  ;= $FF
   186                          GFX_PTR_MIMIC:
   187  3fc8  8404                  dw        MIMIC                                   ;= $04,$02,$D7,$96,$00,$00,$96,$C9,$01
   188                          GFX_PTR_MIMIC_S:
   189  3fca  b704                  dw        MIMIC_S                                 ;= $01,$E0,$1F,$1F,$B0,$01
   190  3fcc  0000                  dw        NO_GFX                                  ;= $FF
   191                          GFX_PTR_MALOCCHIO:
   192  3fce  c904                  dw        MALOCCHIO                               ;= $04,$04,$04,$04
   193                          GFX_PTR_MALOCCHIO_S:
   194  3fd0  ff04                  dw        MALOCCHIO_S                             ;= $04,$04,$04,$04
   195  3fd2  0000                  dw        NO_GFX                                  ;= $FF
   196                          GFX_PTR_DRAGON:
   197  3fd4  1905                  dw        DRAGON                                  ;= $04,$04,$04,$04
   198                          GFX_PTR_DRAGON_S:
   199  3fd6  8505                  dw        DRAGON_S                                ;= $04,$04,$04,$C9,$C9,$C0,$C0,$01
   200                          GFX_PTR_END_A:
   201  3fd8  0000                  dw        NO_GFX                                  ;= $FF
   202                          GFX_PTR_MUMMY:
   203  3fda  a705                  dw        MUMMY                                   ;= $04,$04,$04,$04
   204                          GFX_PTR_MUMMY_S:
   205  3fdc  0a06                  dw        MUMMY_S                                 ;= $04,$04,$04
   206                          GFX_PTR_END_B:
   207  3fde  0000                  dw        NO_GFX                                  ;= $FF
   208                          GFX_PTR_NECRO:
   209  3fe0  2306                  dw        NECROMANCER                             ;= $04,$04,$04,$04
   210                          GFX_PTR_NECRO_S:
   211  3fe2  7e06                  dw        NECROMANCER_S                           ;= $04,$04,$04
   212                          GFX_PTR_END_C:
   213  3fe4  0000                  dw        NO_GFX                                  ;= $FF
   214                          GFX_PTR_GRYPHON:
   215  3fe6  9506                  dw        GRYPHON                                 ;= $04,$04,$04,$04
   216                          GFX_PTR_GRYPHON_S:
   217  3fe8  f506                  dw        GRYPHON_S                               ;= $04,$04,$04,$B8,$B8,$B0,$01
   218                          GFX_PTR_END_D:
   219  3fea  0000                  dw        NO_GFX                                  ;= $FF
   220                          GFX_PTR_MINOTAUR:
   221  3fec  0f07                  dw        MINOTAUR                                ;= $04,$04,$04,$04
   222                          GFX_PTR_MINOTAUR_S:
   223  3fee  5607                  dw        MINOTAUR_S                              ;= $04,$04,$04,$04
   224                          
src/asterion.asm:
    23  3ff0  0000000000000000      defs         $4000 - $, $00
              0000000000000000  
    24                          
